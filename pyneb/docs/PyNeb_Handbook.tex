
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font than Computer Modern for most use cases
    \usepackage{palatino}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{PyNeb\_Handbook}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{PyNeb's Handbook}

    \subsection{Introduction}

    PyNeb is a package for the analysis of emission lines, which evolved
from the IRAF package nebular (Shaw and Dufour 1995; Shaw et al 1998).
It is a library rather than a code: this means that, to use it, one has
to write a python script or enter an interactive python session to call
PyNeb classes and functions. In the following we'll provide some
examples on how to use the different classes and functions. Please note
that the name of the code and the tarball are CapitalCase (PyNeb,
PyNeb-{[}version-number{]}), whereas the module and directories are all
lowercase (pyneb, pynebcore.py, etc).

    References: Whenever you use PyNeb for calculations that lead to a
published paper, you are kindly asked to cite the code as:

Luridiana, V., Morisset, C., \& Shaw, R. A. 2015: PyNeb: a new tool for
the analysis of emission lines. I. Code description and validation of
results, A\&A, 573, 42

The paper is accessible at
http://adsabs.harvard.edu/abs/2015A\%26A\ldots{}573A..42L

    \subsection{Installation}

    \subsubsection{Requirements}

    To run PyNeb, you must have python v. 2.6 or above installed (but not
python v. 3.n, which is a different python branch), plus the matplotlib,
numpy and scipy libraries. Numpy minimum version is 1.5.1.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
        \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1.10.4

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{o}{\PYZpc{}}\PY{k}{config} InlineBackend.figure\PYZus{}format = \PYZsq{}svg\PYZsq{}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}
        \PY{k}{print} \PY{n}{matplotlib}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib} \PY{k+kn}{as} \PY{n+nn}{mpl}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1.5.1

    \end{Verbatim}

    \subsubsection{Installing the code with pip}

    This is the easiest way to install or upgrade PyNeb. You need to install
pip first: get it from http://pypi.python.org/pypi/pip and install it
either using:

\begin{verbatim}
sudo easy_install pip 
\end{verbatim}

or following the instructions on the pip web page. Once pip is
installed, enter from the command line:

\begin{verbatim}
pip install --user pyneb 
\end{verbatim}

to install PyNeb and:

\begin{verbatim}
pip install --upgrade --user pyneb
\end{verbatim}

for any subsequent upgrade. Uninstalling PyNeb is easy as well:

\begin{verbatim}
pip uninstall pyneb
\end{verbatim}

PyNeb's webpage at www.iac.es/proyecto/PyNeb contains a Troubleshooting
page to address most frequent installation problems.

    \subsubsection{Installing the code from the tar file}

    Download the PyNeb package from the pypi site
https://pypi.python.org/pypi/PyNeb. Unpack the PyNeb tarball in the
directory of your choice, enter the directory
PyNeb-{[}version-number{]}, which is PyNeb's root directory and contains
the following:

\begin{itemize}
\item
  setup.py (a file, which is the package installer)
\item
  pyneb (a directory, which contains the source files)
\item
  PKG-INFO and README.txt (information files)
\end{itemize}

To install the package, enter:

\begin{verbatim}
python setup.py install --user
\end{verbatim}

Once the package is installed, simply enter your favorite python
interface (e.g., python or ipython) and start using PyNeb by inputting:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn} \PY{c+c1}{\PYZsh{} We use the pn alias for PyNeb}
\end{Verbatim}

    (In the following, we will always assume that the PyNeb package has been
imported under the alias ``pn''.)

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{k}{print} \PY{n}{pn}\PY{o}{.}\PY{n}{\PYZus{}\PYZus{}version\PYZus{}\PYZus{}}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
1.0.20

    \end{Verbatim}

    \subsection{First steps using PyNeb}

    A sketch of the organization of PyNeb can help to understand the role
played by the different classes.

    \begin{figure}[htbp]
\centering
\includegraphics{PN_organisation.jpg}
\caption{PyNeb organisation}
\end{figure}

    The main classes are \textbf{Atom}, \textbf{RecAtom}, \textbf{EmisGrid},
\textbf{Observations}, and \textbf{Diagnostics}. Some classes use other
classes; for example, Atom is used in almost all the other classes. A
detailed description of each class is given in the following, and the
exhaustive list of all the methods of all the classes is available from
the reference manual.

Please note: PyNeb uses the Object Oriented (OO) method of programming
to define most of its features, but the scripts written as PyNeb
wrappers need not be OO; they may follow the more classical functional
or structured programming style.

    \subsection{How atoms are represented: the Atom and RecAtom classes}

    PyNeb distinguishes between atoms emitting collisionally-excited lines
(called here ``collisional atoms'') and atoms emitting recombination
lines (``recombination atoms''). Both are represented as n-level systems
and share the same basic syntax, but they are encoded in different
classes and their internal representation is different in either case,
as detailed in the following sections.

    \subsubsection{The Atom class}

    The critical features of the physical atom relevant for our scope are
encapsulated, for the collisional case, in the \textbf{Atom} data
structure. \textbf{Atom} contains the way atomic data are read and
managed to compute, for example, line emissivities and to determine
diagnostics from line ratios, as well as ionic and total abundances.

    Instantiation of the \textbf{Atom} class to create an \textbf{Atom}
object is done by specifying an ion:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
        \PY{n}{O3} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}

    This command tells the code to create an O++ ion model (corresponding to
the {[}O III{]} spectrum, hence the ``3'') by reading the {[}O III{]}
atomic data.

    You can create (instantiate) as many atoms as you need, or even create
atoms for the same ion using different atomic data. Some basic info on
an existing Atom object can be retrieved by the print command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{k}{print}\PY{p}{(}\PY{n}{O3}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Atom O3 from o\_iii\_atom\_SZ00-WFD96.dat and o\_iii\_coll\_AK99.dat

    \end{Verbatim}

    The two *.dat files mentioned contain the atomic data used to fill in
the structure of this particular \textbf{Atom} object. The organisation
of these data files will be explained in the section on atomic data.

The \textbf{Atom} object contains methods (functions) to explore it; for
example you can display the ion's intrinsic properties:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{name}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}7}]:} 'oxygen'
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{spec}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} 3
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{gs}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} 'p2'
\end{Verbatim}
        
    or the value of the data you are using, such as the energy of the fourth
level in eV:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getEnergy}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{unit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{eV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:} 2.5135650188001009
\end{Verbatim}
        
    The complete inventory of features and methods of the \textbf{Atom}
class can be displayed by entering:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{k}{print}\PY{p}{(}\PY{n+nb}{dir}\PY{p}{(}\PY{n}{O3}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
['AtomData', 'AtomHeader', 'CollData', 'EnergyNLevels', 'NIST', 'NLevels', '\_A', '\_Energy', '\_StatWeight', '\_Transition', '\_\_class\_\_', '\_\_delattr\_\_', '\_\_dict\_\_', '\_\_doc\_\_', '\_\_format\_\_', '\_\_getattribute\_\_', '\_\_hash\_\_', '\_\_init\_\_', '\_\_module\_\_', '\_\_new\_\_', '\_\_reduce\_\_', '\_\_reduce\_ex\_\_', '\_\_repr\_\_', '\_\_setattr\_\_', '\_\_sizeof\_\_', '\_\_str\_\_', '\_\_subclasshook\_\_', '\_\_weakref\_\_', '\_getTemDen\_1', '\_getTemDen\_MP', '\_test\_lev', 'atom', 'atomFile', 'atomFileType', 'atomFitsFile', 'atomFitsPath', 'atomNLevels', 'atomPath', 'calling', 'collFile', 'collFileType', 'collFitsFile', 'collFitsPath', 'collNLevels', 'collPath', 'elem', 'energy\_Ryd', 'energy\_eV', 'getA', 'getCollRates', 'getCritDensity', 'getDensityRange', 'getEmissivity', 'getEnergy', 'getHighDensRatio', 'getIonAbundance', 'getLowDensRatio', 'getOmega', 'getOmegaArray', 'getPopulations', 'getSources', 'getStatWeight', 'getTemArray', 'getTemDen', 'getTransition', 'gs', 'lineList', 'log\_', 'name', 'plotEmiss', 'plotGrotrian', 'printIonic', 'printSources', 'printTemDen', 'printTransition', 'spec', 'tem\_units', 'wave\_Ang']

    \end{Verbatim}

    The various methods, which can be either public or private, are
described in the PyNeb Reference Manual. Private methods have names
starting with underscore ``\_'' and are not supposed to be used by
``standard'' users.

As always, use the ``?'' from within an ipython session, or the
\textbf{help} method in any python session, or consult the User
Reference Manual, to gain access to the different options of the
methods:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{help}\PY{p}{(}\PY{n}{O3}\PY{o}{.}\PY{n}{getEnergy}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Help on method getEnergy in module pyneb.core.pynebcore:

getEnergy(self, level=-1, unit='1/Ang') method of pyneb.core.pynebcore.\_AtomDataAscii instance
    Return energy level of selected level (or array of energy levels, if level not given) 
        in Angstrom\^{}-1 (default) or another unit
    
    Usage:
        O3.getEnergy(4, unit='eV')
    Parameters:
        - level  selected atomic level (default= -1, returns complete array)
        - unit   [str] one of '1/Ang' (default), 'eV', or 'Ryd'


    \end{Verbatim}

    \subsubsection{Print and plot atomic properties}

    The \textbf{printIonic} method displays informations on the atom's
transitions:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{printIonic}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
elem = O
spec = 3

warng Atom O3: Cannot print populations as tem or den is missing
warng Atom O3: Cannot print critical densities as tem is missing
     88.33m 
    (2-->1) 


     32.65m      51.80m 
    (3-->1)     (3-->2) 


   4931.23A    4958.91A    5006.84A 
    (4-->1)     (4-->2)     (4-->3) 


   2314.87A    2320.95A    2331.40A    4363.21A 
    (5-->1)     (5-->2)     (5-->3)     (5-->4) 


   1657.69A    1660.81A    1666.15A    2496.03A    5833.01A 
    (6-->1)     (6-->2)     (6-->3)     (6-->4)     (6-->5) 



    \end{Verbatim}

    Some arguments can be passed to the method to obtain more information:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{printIonic}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{10000.}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e3}\PY{p}{,} \PY{n}{printA}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{printPop}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{printCrit}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
elem = O
spec = 3
temperature = 10000.0 K
density = 1000.0 cm-3

Level   Populations  Critical densities
Level 1:  3.150E-01  0.000E+00
Level 2:  4.888E-01  5.173E+02
Level 3:  1.961E-01  3.629E+03
Level 4:  4.252E-05  7.146E+05
Level 5:  2.933E-09  2.751E+07
Level 6:  2.407E-12  3.991E+10

2.620E-05   
     88.33m 
    (2-->1) 
  2.879E-22 

3.170E-11   9.760E-05   
     32.65m      51.80m 
    (3-->1)     (3-->2) 
  3.781E-28   7.337E-22 

2.410E-06   6.791E-03   2.046E-02   
   4931.23A    4958.91A    5006.84A 
    (4-->1)     (4-->2)     (4-->3) 
  4.127E-25   1.156E-21   3.451E-21 

0.000E+00   2.150E-01   6.340E-04   1.710E+00   
   2314.87A    2320.95A    2331.40A    4363.21A 
    (5-->1)     (5-->2)     (5-->3)     (5-->4) 
  0.000E+00   5.396E-24   1.584E-26   2.283E-23 

0.000E+00   2.200E+02   5.480E+02   4.740E-03   0.000E+00   
   1657.69A    1660.81A    1666.15A    2496.03A    5833.01A 
    (6-->1)     (6-->2)     (6-->3)     (6-->4)     (6-->5) 
  0.000E+00   6.334E-24   1.573E-23   9.078E-29   0.000E+00 

\# H-beta volume emissivity:
1.237E-25 N(H+) * N(e-)  (erg/s)

    \end{Verbatim}

    Each block describes a transition: the transition probability (in s-1;
first row), the wavelength of the corresponding emission line (in
Angstrom or microns; second row), the two atomic levels (third row), and
the emissivity of the line (fourth row).

You can plot the line emissivities using the following command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{O3}\PY{o}{.}\PY{n}{plotEmiss}\PY{p}{(}\PY{n}{tem\PYZus{}min}\PY{o}{=}\PY{l+m+mi}{1000}\PY{p}{,} \PY{n}{tem\PYZus{}max}\PY{o}{=}\PY{l+m+mi}{30000}\PY{p}{,} \PY{n}{ionic\PYZus{}abund}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e3}\PY{p}{,} \PY{n}{style}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{n}{legend\PYZus{}loc}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{temLog}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{plot\PYZus{}total}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{plot\PYZus{}only\PYZus{}total}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{,} 
                      \PY{n}{legend}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{,} \PY{n}{total\PYZus{}color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{black}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{total\PYZus{}label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TOTAL}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_45_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    You can use then take advantage of matplotlib's plotting tools to zoom,
crop, or move the figure as you need.

    A Grotrian diagram of the ion (i.e., a plot of the energy levels and
transition wavelengths) can be obtained using:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)}
         \PY{n}{O3}\PY{o}{.}\PY{n}{plotGrotrian}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e2}\PY{p}{,} \PY{n}{thresh\PYZus{}int}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}3}\PY{p}{,} \PY{n}{unit} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{eV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_48_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    The diagram can be tailored in various ways, zoomed in or saved into a
file.

    Atomic data are accessible using the following commands:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getA}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:} array([[  0.00000000e+00,   0.00000000e+00,   0.00000000e+00,
                   0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
                [  2.61999990e-05,   0.00000000e+00,   0.00000000e+00,
                   0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
                [  3.17000000e-11,   9.76000010e-05,   0.00000000e+00,
                   0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
                [  2.41000000e-06,   6.79099980e-03,   2.04600000e-02,
                   0.00000000e+00,   0.00000000e+00,   0.00000000e+00],
                [  0.00000000e+00,   2.15000000e-01,   6.34000000e-04,
                   1.71000000e+00,   0.00000000e+00,   0.00000000e+00],
                [  0.00000000e+00,   2.20000000e+02,   5.48000000e+02,
                   4.73999980e-03,   0.00000000e+00,   0.00000000e+00]])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getOmegaArray}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{shape} \PY{c+c1}{\PYZsh{} 6*6 levels, 20 temperatures}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}18}]:} (6, 6, 20)
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getOmega}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:} array([[ 0.     ,  0.     ,  0.     ,  0.     ,  0.     ,  0.     ],
                [ 0.5222 ,  0.     ,  0.     ,  0.     ,  0.     ,  0.     ],
                [ 0.2573 ,  1.232  ,  0.     ,  0.     ,  0.     ,  0.     ],
                [ 0.2434 ,  0.7302 ,  1.217  ,  0.     ,  0.     ,  0.     ],
                [ 0.0321 ,  0.09618,  0.1603 ,  0.5227 ,  0.     ,  0.     ],
                [ 0.1239 ,  0.3717 ,  0.6195 ,  0.     ,  0.     ,  0.     ]])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{help}\PY{p}{(}\PY{n}{O3}\PY{o}{.}\PY{n}{getOmega}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Help on method getOmega in module pyneb.core.pynebcore:

getOmega(self, tem, lev\_i=-1, lev\_j=-1, wave=-1) method of pyneb.core.pynebcore.Atom instance
    Return interpolated value of the collision strength value at the given temperature 
        for the complete array or a specified transition.
    If kappa is not None (non-maxwellian distribution of e-velocities), the collision 
        strength is corrected as in Mendoza \& Bautista, 2014 ApJ 785, 91.
    
    Usage:
        O3.getOmega(15000.)
        O3.getOmega([8e3, 1e4, 1.2e4])
        O3.getOmega([8e3, 1e4, 1.2e4], 5, 4)
    
    Parameters:
        - tem    electronic temperature in K. May be an array.
        - lev\_i  upper level
        - lev\_j  lower level


    \end{Verbatim}

    \subsubsection{Using Atom to compute populations and emissivities}

    The \textbf{Atom} class is equipped with method which give access to the
populations, emissivities, and other atomic quantities:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getEnergy}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{unit}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{eV}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}21}]:} 2.5135650188001009
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getStatWeight}\PY{p}{(}\PY{n}{level}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}22}]:} 5.0
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getPopulations}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e2}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}23}]:} array([  7.86836304e-01,   1.89131723e-01,   2.40277680e-02,
                  4.20451605e-06,   2.89220138e-10,   2.37725298e-13])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getCritDensity}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mi}{12000}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} array([  0.00000000e+00,   5.51173034e+02,   3.81837469e+03,
                  7.57552443e+05,   2.91357617e+07,   4.26266550e+10])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e2}\PY{p}{,} \PY{n}{wave}\PY{o}{=}\PY{l+m+mi}{5007}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} array(3.412033169270686e-21)
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getIonAbundance}\PY{p}{(}\PY{n}{int\PYZus{}ratio}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1.5e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{100.}\PY{p}{,} \PY{n}{wave}\PY{o}{=}\PY{l+m+mi}{5007}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}26}]:} 1.0943418702999062e-05
\end{Verbatim}
        
    Wavelengths should be entered with enough precision to avoid confusion
with nearby lines. Use \textbf{printTransition} to check if the
transition selected by the code actually correponds to the one you
intended:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{printTransition}\PY{p}{(}\PY{l+m+mi}{5007}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Input wave: 5007.0
Closest wave found: 5006.8
Relative error: 3E-05 
Transition: 4 -> 3

    \end{Verbatim}

    \textbf{getTransition} is an abridged version which only returns the
tuple of levels rather than an extended output, and is therefore apt to
be used in scripts.

    In addition to the wavelength, a transition can also be specified
through its defining levels, as in:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getIonAbundance}\PY{p}{(}\PY{n}{int\PYZus{}ratio}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1.5e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{100.}\PY{p}{,} \PY{n}{lev\PYZus{}i} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{lev\PYZus{}j}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}28}]:} 1.0943418702999062e-05
\end{Verbatim}
        
    In the case of \textbf{getEmissivity}, tem and den can be arrays. In
such a case, if they have different dimensions N and M, the function
will return an array of NxM emissivities corresponding to all tem-den
combinations; if both arrays have the same dimension, you can obtain the
emissivities of either the NxN array of tem-den combinations as in the
previous case, or of the 1D, N-length array obtained pairing tem and den
element by element. This is controlled by the ``product'' parameter:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{10000}\PY{p}{,} \PY{l+m+mi}{12000}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{product}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}29}]:} array([[  1.14345463e-21,   1.15206397e-21],
                [  1.74604704e-21,   1.75668558e-21]])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{10000}\PY{p}{,} \PY{l+m+mi}{12000}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mi}{100}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{]}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{,} \PY{n}{product}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}30}]:} array([  1.14345463e-21,   1.75668558e-21])
\end{Verbatim}
        
    \subsubsection{Physical conditions determined from line ratios}

    The \textbf{Atom} object also contains a method to compute the electron
temperature or density given a line ratio:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getTemDen}\PY{p}{(}\PY{n}{int\PYZus{}ratio}\PY{o}{=}\PY{l+m+mf}{150.}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{100.}\PY{p}{,} \PY{n}{wave1}\PY{o}{=}\PY{l+m+mi}{5007}\PY{p}{,} \PY{n}{wave2}\PY{o}{=}\PY{l+m+mi}{4363}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}31}]:} 10029.228788926666
\end{Verbatim}
        
    The keyword tem (or den) specifies the supplied value of the temperature
(or density). Which quantity is computed (temperature or density) is
determined by which quantity is provided to the method: if ``den'' is
given, then ``tem'' is computed, and vice versa.

If the intensity ratio is a simple ratio of two transitions, you can:

    \begin{itemize}
\item
  either give the wavelengths of the two transitions involved:
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getTemDen}\PY{p}{(}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1.e4}\PY{p}{,}  \PY{n}{wave1}\PY{o}{=}\PY{l+m+mi}{4363}\PY{p}{,} \PY{n}{wave2}\PY{o}{=}\PY{l+m+mi}{5007}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:} 14876.907035306589
\end{Verbatim}
        
    \begin{itemize}
\item
  or give the four levels that define the two transitions, in the
  following order: (upper level of numerator) (lower level of numerator)
  (upper level of denominator) (lower level of denominator); e. g.:
\end{itemize}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getTemDen}\PY{p}{(}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1.e4}\PY{p}{,} \PY{n}{lev\PYZus{}i1}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{lev\PYZus{}j1}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{lev\PYZus{}i2}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{lev\PYZus{}j2}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:} 14876.907035306589
\end{Verbatim}
        
    In the general case of an intensity ratio formed by any number of
transitions, an algebraic expression must be supplied as the argument of
the keyword \textbf{to\_eval}:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getTemDen}\PY{p}{(}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1.e4}\PY{p}{,} \PY{n}{to\PYZus{}eval}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{I(5, 4) / (I(4, 3) + I(4, 2))}\PY{l+s+s2}{\PYZdq{}} \PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}34}]:} 17133.865154187915
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n}{N2} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{N2}\PY{o}{.}\PY{n}{getTemDen}\PY{p}{(}\PY{l+m+mf}{150.}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{100.}\PY{p}{,} \PY{n}{to\PYZus{}eval} \PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{(L(6584) + L(6548)) / L(5755)}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}35}]:} 8314.4744402712549
\end{Verbatim}
        
    The \textbf{to\_eval} argument accepts either I(i, j) or L(wavelength)
to identify the transitions involved in the diagnostic. Both can be
mixed in the same string. If you do not know what transition corresponds
to a given wavelength, use \textbf{printTransition} to find it.

The parameters \textbf{tem} and \textbf{den}, as well as the line ratio,
may be arrays (1D or 2D, as in the case of observations obtained from
IFUs), in which case the result will have the same shape. Some
restrictions can be set to the domain explored by the method when
looking for the solution; see the method's documentation for further
details.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getTemDen}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{l+m+mf}{0.04}\PY{p}{]}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{1.e4}\PY{p}{,} \PY{l+m+mf}{1.1e4}\PY{p}{]}\PY{p}{,} \PY{n}{to\PYZus{}eval}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{I(5, 4) / (I(4, 3) + I(4, 2))}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}36}]:} array([ 17133.86515419,  26908.34313925])
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getTemDen}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{0.02}\PY{p}{,} \PY{l+m+mf}{0.04}\PY{p}{]}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1.e4}\PY{p}{,} \PY{n}{to\PYZus{}eval}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{I(5, 4) / (I(4, 3) + I(4, 2))}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}37}]:} array([ 17133.86515419,  26976.0393771 ])
\end{Verbatim}
        
    Notice that if you want to simultaneously determine both temperature and
density combining two diagnostics (from two different atoms), you need
to use the \textbf{getCrossTemDen} method of the \textbf{Diagnostic}
class

    \subsubsection{Ionic abundance determination}

    The ionic abundance is obtained from the intensity of a line normalized
to Hbeta=100.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{getIonAbundance}\PY{p}{(}\PY{n}{int\PYZus{}ratio}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1.5e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{100.}\PY{p}{,} \PY{n}{wave}\PY{o}{=}\PY{l+m+mi}{5007}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}38}]:} 1.0943418702999062e-05
\end{Verbatim}
        
    \subsubsection{Creating a dictionary of Atom objects}

    You can define all the atoms at once and put them in a dictionary by
creating each atom at a time through the commands:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{n}{O3} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{O2} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{N2} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    or rather use one of the following shortcuts:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{n}{atoms} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getAtomDict}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} a method always requires parenthesis, even without argument}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{n}{atoms} \PY{c+c1}{\PYZsh{} All the available atoms}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}41}]:} \{'3He2': Atom 3He2 from 3he\_ii\_atom\_cloudy.dat and 3he\_ii\_coll\_cloudy.dat,
          'Al2': Atom Al2 from al\_ii\_atom\_JSP86-HK87-VVF96-KS86.dat and al\_ii\_coll\_KHAF92-TBK85-TBK84.dat,
          'Ar2': Atom Ar2 from ar\_ii\_atom\_Bal06.dat and ar\_ii\_coll\_PB95.dat,
          'Ar3': Atom Ar3 from ar\_iii\_atom\_M83-KS86.dat and ar\_iii\_coll\_GMZ95.dat,
          'Ar4': Atom Ar4 from ar\_iv\_atom\_MZ82.dat and ar\_iv\_coll\_RB97.dat,
          'Ar5': Atom Ar5 from ar\_v\_atom\_LL93-MZ82-KS86.dat and ar\_v\_coll\_GMZ95.dat,
          'Ba2': Atom Ba2 from ba\_ii\_atom\_C04.dat and ba\_ii\_coll\_SB98.dat,
          'Ba4': Atom Ba4 from ba\_iv\_atom\_BHQZ95.dat and ba\_iv\_coll\_SB98.dat,
          'Br3': Atom Br3 from br\_iii\_atom\_BH86.dat and br\_iii\_coll\_S97.dat,
          'Br4': Atom Br4 from br\_iv\_atom\_BH86.dat and br\_iv\_coll\_S97.dat,
          'C1': Atom C1 from c\_i\_atom\_FFS85.dat and c\_i\_coll\_JBK87-PA76.dat,
          'C2': Atom C2 from c\_ii\_atom\_GMZ98.dat and c\_ii\_coll\_BP92.dat,
          'C3': Atom C3 from c\_iii\_atom\_G83-NS78-WFD96.dat and c\_iii\_coll\_Bal85.dat,
          'C4': Atom C4 from c\_iv\_atom\_WFD96.dat and c\_iv\_coll\_AK04.dat,
          'Ca5': Atom Ca5 from ca\_v\_atom\_M83-KS86.dat and ca\_v\_coll\_GMZ95.dat,
          'Cl2': Atom Cl2 from cl\_ii\_atom\_MZ83.dat and cl\_ii\_coll\_T04.dat,
          'Cl3': Atom Cl3 from cl\_iii\_atom\_M83-KS86.dat and cl\_iii\_coll\_BZ89.dat,
          'Cl4': Atom Cl4 from cl\_iv\_atom\_KS86-MZ82-EM84.dat and cl\_iv\_coll\_GMZ95.dat,
          'Fe3': Atom Fe3 from fe\_iii\_atom\_Q96\_J00.dat and fe\_iii\_coll\_Z96.dat,
          'Fe4': Atom Fe4 from fe\_iv\_atom\_FFRR08.dat and fe\_iv\_coll\_ZP97.dat,
          'Fe5': Atom Fe5 from fe\_v\_atom\_Nal00.dat and fe\_v\_coll\_BGMcL07.dat,
          'Fe6': Atom Fe6 from fe\_vi\_atom\_CP00.dat and fe\_vi\_coll\_CP99.dat,
          'Fe7': Atom Fe7 from fe\_vii\_atom\_WB08.dat and fe\_vii\_coll\_WB08.dat,
          'K4': Atom K4 from k\_iv\_atom\_M83-KS86.dat and k\_iv\_coll\_GMZ95.dat,
          'K5': Atom K5 from k\_v\_atom\_M83-KS86.dat and k\_v\_coll\_BZL88.dat,
          'Kr3': Atom Kr3 from kr\_iii\_atom\_BH86.dat and kr\_iii\_coll\_S97.dat,
          'Kr4': Atom Kr4 from kr\_iv\_atom\_BH86.dat and kr\_iv\_coll\_S97.dat,
          'Kr5': Atom Kr5 from kr\_v\_atom\_BH86.dat and kr\_v\_coll\_S97.dat,
          'Mg5': Atom Mg5 from mg\_v\_atom\_GMZ97.dat and mg\_v\_coll\_BZ94.dat,
          'Mg7': Atom Mg7 from mg\_vii\_atom\_GMZ97.dat and mg\_vii\_coll\_LB94-U.dat,
          'N1': Atom N1 from n\_i\_atom\_KS86-WFD96.dat and n\_i\_coll\_PA76-DMR76.dat,
          'N2': Atom N2 from n\_ii\_atom\_GMZ97-WFD96.dat and n\_ii\_coll\_T11.dat,
          'N3': Atom N3 from n\_iii\_atom\_GMZ98.dat and n\_iii\_coll\_BP92.dat,
          'N4': Atom N4 from n\_iv\_atom\_WFD96.dat and n\_iv\_coll\_RBHB94.dat,
          'Na4': Atom Na4 from na\_iv\_atom\_GMZ97.dat and na\_iv\_coll\_BZ94.dat,
          'Na6': Atom Na6 from na\_vi\_atom\_GMZ97.dat and na\_vi\_coll\_LB94.dat,
          'Ne2': Atom Ne2 from ne\_ii\_atom\_Bal06.dat and ne\_ii\_coll\_GMB01.dat,
          'Ne3': Atom Ne3 from ne\_iii\_atom\_GMZ97.dat and ne\_iii\_coll\_McLB00.dat,
          'Ne4': Atom Ne4 from ne\_iv\_atom\_BBZ89-BK88.dat and ne\_iv\_coll\_G81.dat,
          'Ne5': Atom Ne5 from ne\_v\_atom\_GMZ97-U-BD93.dat and ne\_v\_coll\_LB94.dat,
          'Ne6': Atom Ne6 from ne\_vi\_atom\_GMZ98.dat and ne\_vi\_coll\_ZGP94.dat,
          'Ni3': Atom Ni3 from ni\_iii\_atom\_B01.dat and ni\_iii\_coll\_B01.dat,
          'O1': Atom O1 from o\_i\_atom\_WFD96.dat and o\_i\_coll\_BK95.dat,
          'O2': Atom O2 from o\_ii\_atom\_Z82-WFD96.dat and o\_ii\_coll\_P06-T07.dat,
          'O3': Atom O3 from o\_iii\_atom\_SZ00-WFD96.dat and o\_iii\_coll\_AK99.dat,
          'O4': Atom O4 from o\_iv\_atom\_GMZ98.dat and o\_iv\_coll\_BP92.dat,
          'O5': Atom O5 from o\_v\_atom\_H80-NS79.dat and o\_v\_coll\_BBDK85.dat,
          'Rb4': Atom Rb4 from rb\_iv\_atom\_BH86.dat and rb\_iv\_coll\_S97.dat,
          'Rb5': Atom Rb5 from rb\_v\_atom\_BH86.dat and rb\_v\_coll\_S97.dat,
          'Rb6': Atom Rb6 from rb\_vi\_atom\_BH86.dat and rb\_vi\_coll\_S97.dat,
          'S2': Atom S2 from s\_ii\_atom\_PKW09.dat and s\_ii\_coll\_TZ10.dat,
          'S3': Atom S3 from s\_iii\_atom\_PKW09.dat and s\_iii\_coll\_TG99.dat,
          'S4': Atom S4 from s\_iv\_atom\_JKD86-DHKD82.dat and s\_iv\_coll\_DHKD82.dat,
          'Se3': Atom Se3 from se\_iii\_atom\_BH86.dat and se\_iii\_coll\_S97.dat,
          'Se4': Atom Se4 from se\_iv\_atom\_B05.dat and se\_iv\_coll\_B05.dat,
          'Si2': Atom Si2 from si\_ii\_atom\_BL93-CSB93-N77.dat and si\_ii\_coll\_DK91.dat,
          'Si3': Atom Si3 from si\_iii\_atom\_M83-OKH88-FW90-KS86.dat and si\_iii\_coll\_DK94.dat,
          'Xe3': Atom Xe3 from xe\_iii\_atom\_BHQZ95.dat and xe\_iii\_coll\_SB98.dat,
          'Xe4': Atom Xe4 from xe\_iv\_atom\_BHQZ95.dat and xe\_iv\_coll\_SB98.dat,
          'Xe6': Atom Xe6 from xe\_vi\_atom\_BHQZ95.dat and xe\_vi\_coll\_SB98.dat\}
\end{Verbatim}
        
    It is also possible to select only a subset of the elements or ions
available by specifying the arguments \textbf{elem\_list} or
\textbf{atom\_list}:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{n}{atoms} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getAtomDict}\PY{p}{(}\PY{n}{elem\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{C}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} all the ions with spectra from 1 to 6 are created}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
warng \_ManageAtomicData: data for C5 not available
warng \_ManageAtomicData: data for C5 not available
warng \_ManageAtomicData: data for C6 not available
warng \_ManageAtomicData: data for C6 not available
warng \_ManageAtomicData: data for C7 not available
warng \_ManageAtomicData: data for C7 not available
warng \_ManageAtomicData: data for N5 not available
warng \_ManageAtomicData: data for N5 not available
warng \_ManageAtomicData: data for N6 not available
warng \_ManageAtomicData: data for N6 not available
warng \_ManageAtomicData: data for N7 not available
warng \_ManageAtomicData: data for N7 not available
warng \_ManageAtomicData: data for O6 not available
warng \_ManageAtomicData: data for O6 not available
warng \_ManageAtomicData: data for O7 not available
warng \_ManageAtomicData: data for O7 not available

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{n}{atoms} \PY{c+c1}{\PYZsh{} All the CNO available atoms}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}43}]:} \{'C1': Atom C1 from c\_i\_atom\_FFS85.dat and c\_i\_coll\_JBK87-PA76.dat,
          'C2': Atom C2 from c\_ii\_atom\_GMZ98.dat and c\_ii\_coll\_BP92.dat,
          'C3': Atom C3 from c\_iii\_atom\_G83-NS78-WFD96.dat and c\_iii\_coll\_Bal85.dat,
          'C4': Atom C4 from c\_iv\_atom\_WFD96.dat and c\_iv\_coll\_AK04.dat,
          'N1': Atom N1 from n\_i\_atom\_KS86-WFD96.dat and n\_i\_coll\_PA76-DMR76.dat,
          'N2': Atom N2 from n\_ii\_atom\_GMZ97-WFD96.dat and n\_ii\_coll\_T11.dat,
          'N3': Atom N3 from n\_iii\_atom\_GMZ98.dat and n\_iii\_coll\_BP92.dat,
          'N4': Atom N4 from n\_iv\_atom\_WFD96.dat and n\_iv\_coll\_RBHB94.dat,
          'O1': Atom O1 from o\_i\_atom\_WFD96.dat and o\_i\_coll\_BK95.dat,
          'O2': Atom O2 from o\_ii\_atom\_Z82-WFD96.dat and o\_ii\_coll\_P06-T07.dat,
          'O3': Atom O3 from o\_iii\_atom\_SZ00-WFD96.dat and o\_iii\_coll\_AK99.dat,
          'O4': Atom O4 from o\_iv\_atom\_GMZ98.dat and o\_iv\_coll\_BP92.dat,
          'O5': Atom O5 from o\_v\_atom\_H80-NS79.dat and o\_v\_coll\_BBDK85.dat\}
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n}{atoms} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getAtomDict}\PY{p}{(}\PY{n}{atom\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ar3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{atoms}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}45}]:} \{'Ar3': Atom Ar3 from ar\_iii\_atom\_M83-KS86.dat and ar\_iii\_coll\_GMZ95.dat,
          'N2': Atom N2 from n\_ii\_atom\_GMZ97-WFD96.dat and n\_ii\_coll\_T11.dat,
          'O2': Atom O2 from o\_ii\_atom\_Z82-WFD96.dat and o\_ii\_coll\_P06-T07.dat,
          'O3': Atom O3 from o\_iii\_atom\_SZ00-WFD96.dat and o\_iii\_coll\_AK99.dat\}
\end{Verbatim}
        
    In all these cases, a dictionary is created whose keys are the
conventional atom names $<$element$><$spectrum$>$, and the corresponding
entries the atoms themselves; e. g.:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n}{atoms}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}46}]:} Atom N2 from n\_ii\_atom\_GMZ97-WFD96.dat and n\_ii\_coll\_T11.dat
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{n}{atoms}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e2}\PY{p}{,} \PY{n}{wave}\PY{o}{=}\PY{l+m+mi}{6584}\PY{p}{)}   \PY{c+c1}{\PYZsh{} example of use}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}47}]:} array(5.948363882838976e-21)
\end{Verbatim}
        
    This can be useful if you need to loop on a list of atoms, to plot
atomic data for example. To see what atoms have been created (which is
limited by the data included in the selected atomic data set), enter:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{atoms}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}48}]:} ['N2', 'Ar3', 'O3', 'O2']
\end{Verbatim}
        
    If you want to be able to access them directly rather than through a
dictionary, input from the command line:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{k}{for} \PY{n}{key} \PY{o+ow}{in} \PY{n}{atoms}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n+nb}{vars}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{n}{key}\PY{p}{]}\PY{o}{=}\PY{n}{atoms}\PY{p}{[}\PY{n}{key}\PY{p}{]}
\end{Verbatim}

    and then you will be able to do the following:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{n}{Ar3}\PY{o}{.}\PY{n}{elem}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}50}]:} 'Ar'
\end{Verbatim}
        
    \subsection{The atomic data}

    \subsubsection{Changing the data files used for atomic data}

    Since, for a given ion, there can be different calculations of atomic
data with slightly (or not so slightly!) different results, more than
one version of the data can exist for a given ion. The data are stored
in and read from different types of files depending on the mechanism of
line formation:

    \begin{itemize}
\item
  In the case of recombination data, a single xxx\_rec\_XYZ.fits file
  contains the line emissivities, in a 2D temperature-density dependent
  table.
\item
  In the case of collisionally excited lines, the data are organized in
  different way depending on the file format:

  \begin{itemize}
  \item
    The only data format admitted was, originally, fits (extension:
    .fits). Fits atomic data for a given ion are organized in two files
    (xxx here represents the ion {[}e.g., ``o\_iii'' for O III{]} and
    XYZ is the acronym of the source paper(s)):

    \begin{itemize}
    \item
      the xxx\_atom\_XYZ.fits file, containing the energies, the
      statistical weights and the transitions probabilities (the
      Einstein coefficients Aij)
    \item
      the xxx\_coll\_XYZ.fits file, containing the temperature-dependent
      collision strengths.
    \end{itemize}
  \item
    Since version 1.0.1, fits file have being totally replaced by plain
    ascii tables (extension .dat), which are organized as follows:

    \begin{itemize}
    \item
      xxx\_levels.dat contain the energy levels and statistical weights.
      These file are downloaded from NIST and the source papers are
      encoded within the file and translated by PyNeb into an explicit
      bibliographic reference.
    \item
      xxx\_atom\_XYZ.dat contain the transitions probabilities
    \item
      xxx\_coll\_XYZ.fits contain the temperature-dependent collision
      strengths
    \end{itemize}
  \end{itemize}
\end{itemize}

    Each of these file contains information for a finite number of levels N.
Specifically, the energy levels and the statistical weights are arrays
with N elements (one value per level), while the transition probability
tables are triangular N*N matrices with zeros on the main diagonal
(transition probabilities are different from zero only for (j
-\textgreater{} i) transitions with j \textgreater{} i).

    This number is a feature of the particular atomic calculation, not an
intrinsic feature of the physical atom, so that an Atom object created
within PyNeb will have a number of levels NLevels equal to the number of
levels of all the data used (or the minimum of them if either of the
atom, coll or levels is different).

    You can access the NIST raw data by:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{O3} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
         \PY{n}{O3}\PY{o}{.}\PY{n}{NIST}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}51}]:} array([('2s2.2p2', '3P', 0.0, 0.0, 'L7288'),
                ('2s2.2p2', '3P', 1.0, 113.178, 'L7288'),
                ('2s2.2p2', '3P', 2.0, 306.174, 'L7288'),
                ('2s2.2p2', '1D', 2.0, 20273.27, 'L7288'),
                ('2s2.2p2', '1S', 0.0, 43185.74, 'L7288'),
                ('2s.2p3', '5S*', 2.0, 60324.79, 'L7288')], 
               dtype=[('conf', 'S23'), ('term', 'S9'), ('J', '<f8'), ('energy', '<f8'), ('ref', 'S10')])
\end{Verbatim}
        
    You can access the full raw NIST data set by:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{utils}\PY{o}{.}\PY{n}{manage\PYZus{}atomic\PYZus{}data}\PY{o}{.}\PY{n}{getLevelsNIST}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{c+c1}{\PYZsh{}O2 is lighter than O3...}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}52}]:} array([('2s2.2p3', '4S*', 1.5, 0.0, 'L11267'),
                ('2s2.2p3', '2D*', 2.5, 26810.55, 'L11267'),
                ('2s2.2p3', '2D*', 1.5, 26830.57, 'L11267'),
                ('2s2.2p3', '2P*', 1.5, 40468.01, 'L11267'),
                ('2s2.2p3', '2P*', 0.5, 40470.0, 'L11267'),
                ('2s.2p4', '4P', 2.5, 119837.21, 'L11267'),
                ('2s.2p4', '4P', 1.5, 120000.43, 'L11267'),
                ('2s.2p4', '4P', 0.5, 120082.86, 'L11267'),
                ('2s.2p4', '2D', 2.5, 165988.46, 'L11267'),
                ('2s.2p4', '2D', 1.5, 165996.5, 'L11267'),
                ('2s2.2p2.(3P).3s', '4P', 0.5, 185235.281, 'L11267'),
                ('2s2.2p2.(3P).3s', '4P', 1.5, 185340.577, 'L11267'),
                ('2s2.2p2.(3P).3s', '4P', 2.5, 185499.124, 'L11267'),
                ('2s2.2p2.(3P).3s', '2P', 0.5, 188888.543, 'L11267'),
                ('2s2.2p2.(3P).3s', '2P', 1.5, 189068.514, 'L11267'),
                ('2s.2p4', '2S', 0.5, 195710.47, 'L11267'),
                ('2s2.2p2.(3P).3p', '2S*', 0.5, 203942.288, 'L11267'),
                ('2s2.2p2.(3P).3p', '4D*', 0.5, 206730.762, 'L11267'),
                ('2s2.2p2.(3P).3p', '4D*', 1.5, 206786.286, 'L11267'),
                ('2s2.2p2.(3P).3p', '4D*', 2.5, 206877.865, 'L11267'),
                ('2s2.2p2.(1D).3s', '2D', 2.5, 206971.68, 'L11267'),
                ('2s2.2p2.(1D).3s', '2D', 1.5, 206972.72, 'L11267'),
                ('2s2.2p2.(3P).3p', '4D*', 3.5, 207002.482, 'L11267'),
                ('2s2.2p2.(3P).3p', '4P*', 0.5, 208346.104, 'L11267'),
                ('2s2.2p2.(3P).3p', '4P*', 1.5, 208392.258, 'L11267'),
                ('2s2.2p2.(3P).3p', '4P*', 2.5, 208484.202, 'L11267'),
                ('2s2.2p2.(3P).3p', '2D*', 1.5, 211522.117, 'L11267'),
                ('2s2.2p2.(3P).3p', '2D*', 2.5, 211712.732, 'L11267'),
                ('2s2.2p2.(3P).3p', '4S*', 1.5, 212161.881, 'L11267'),
                ('2s.2p4', '2P', 1.5, 212593.82, 'L11267'),
                ('2s.2p4', '2P', 0.5, 212762.25, 'L11267'),
                ('2s2.2p2.(3P).3p', '2P*', 0.5, 214169.92, 'L11267'),
                ('2s2.2p2.(3P).3p', '2P*', 1.5, 214229.671, 'L11267'),
                ('2s2.2p2.(1D).3p', '2F*', 2.5, 228723.84, 'L11267'),
                ('2s2.2p2.(1D).3p', '2F*', 3.5, 228747.45, 'L11267'),
                ('2s2.2p2.(1D).3p', '2D*', 2.5, 229947.07, 'L11267'),
                ('2s2.2p2.(1D).3p', '2D*', 1.5, 229968.44, 'L11267'),
                ('2s2.2p2.(1S).3s', '2S', 0.5, 230609.45, 'L11267'),
                ('2s2.2p2.(3P).3d', '4F', 1.5, 231296.126, 'L11267'),
                ('2s2.2p2.(3P).3d', '4F', 2.5, 231350.087, 'L11267'),
                ('2s2.2p2.(3P).3d', '4F', 3.5, 231427.97, 'L11267'),
                ('2s2.2p2.(3P).3d', '4F', 4.5, 231530.246, 'L11267'),
                ('2s2.2p2.(3P).3d', '4P', 2.5, 232462.724, 'L11267'),
                ('2s2.2p2.(1D).3p', '2P*', 0.5, 232480.44, 'L11267'),
                ('2s2.2p2.(1D).3p', '2P*', 1.5, 232527.09, 'L11267'),
                ('2s2.2p2.(3P).3d', '4P', 1.5, 232535.949, 'L11267'),
                ('2s2.2p2.(3P).3d', '4P', 0.5, 232602.492, 'L11267'),
                ('2s2.2p2.(3P).3d', '4D', 0.5, 232711.642, 'L11267'),
                ('2s2.2p2.(3P).3d', '4D', 1.5, 232745.981, 'L11267'),
                ('2s2.2p2.(3P).3d', '4D', 2.5, 232747.562, 'L11267'),
                ('2s2.2p2.(3P).3d', '4D', 3.5, 232753.816, 'L11267'),
                ('2s2.2p2.(3P).3d', '2F', 2.5, 232796.298, 'L11267'),
                ('2s2.2p2.(3P).3d', '2F', 3.5, 232959.21, 'L11267'),
                ('2s2.2p2.(3P).3d', '2P', 1.5, 233430.53, 'L11267'),
                ('2s2.2p2.(3P).3d', '2P', 0.5, 233544.59, 'L11267'),
                ('2s2.2p2.(3P).3d', '2D', 1.5, 234402.797, 'L11267'),
                ('2s2.2p2.(3P).3d', '2D', 2.5, 234454.634, 'L11267'),
                ('2s2.2p2.(3P).4s', '4P', 0.5, 238627.46, 'L11267'),
                ('2s2.2p2.(3P).4s', '4P', 1.5, 238732.65, 'L11267'),
                ('2s2.2p2.(3P).4s', '4P', 2.5, 238893.96, 'L11267'),
                ('2s2.2p2.(3P).4s', '2P', 0.5, 240330.01, 'L11267'),
                ('2s2.2p2.(3P).4s', '2P', 1.5, 240517.35, 'L11267'),
                ('2s2.2p2.(3P).4p', '2S*', 0.5, 245037.29, 'L11267')], 
               dtype=[('conf', 'S23'), ('term', 'S9'), ('J', '<f8'), ('energy', '<f8'), ('ref', 'S10')])
\end{Verbatim}
        
    You can print the name of the atomic data used for a given ion with:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{k}{print}\PY{p}{(}\PY{n}{O3}\PY{o}{.}\PY{n}{atomFile}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
o\_iii\_atom\_SZ00-WFD96.dat

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{k}{print}\PY{p}{(}\PY{n}{O3}\PY{o}{.}\PY{n}{collFile}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
o\_iii\_coll\_AK99.dat

    \end{Verbatim}

    As the files can be located in different directories, you may also find
useful to print out the path:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{k}{print}\PY{p}{(}\PY{n}{O3}\PY{o}{.}\PY{n}{atomPath}\PY{p}{)}
         \PY{k}{print}\PY{p}{(}\PY{n}{O3}\PY{o}{.}\PY{n}{collPath}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
/home/morisset/anaconda2/lib/python2.7/site-packages/pyneb/utils/../atomic\_data/
/home/morisset/anaconda2/lib/python2.7/site-packages/pyneb/utils/../atomic\_data/

    \end{Verbatim}

    A set of data files for a given group of ions is called a data set. The
default data set (or the adopted data set, if a different one has been
set) can be displayed with the command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getDataFile}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}56}]:} \{'3He2': \{'atom': '3he\_ii\_atom\_cloudy.dat', 'coll': '3he\_ii\_coll\_cloudy.dat'\},
          'Al2': \{'atom': 'al\_ii\_atom\_JSP86-HK87-VVF96-KS86.dat',
           'coll': 'al\_ii\_coll\_KHAF92-TBK85-TBK84.dat'\},
          'Ar2': \{'atom': 'ar\_ii\_atom\_Bal06.dat', 'coll': 'ar\_ii\_coll\_PB95.dat'\},
          'Ar3': \{'atom': 'ar\_iii\_atom\_M83-KS86.dat', 'coll': 'ar\_iii\_coll\_GMZ95.dat'\},
          'Ar4': \{'atom': 'ar\_iv\_atom\_MZ82.dat', 'coll': 'ar\_iv\_coll\_RB97.dat'\},
          'Ar5': \{'atom': 'ar\_v\_atom\_LL93-MZ82-KS86.dat',
           'coll': 'ar\_v\_coll\_GMZ95.dat'\},
          'Ba2': \{'atom': 'ba\_ii\_atom\_C04.dat', 'coll': 'ba\_ii\_coll\_SB98.dat'\},
          'Ba4': \{'atom': 'ba\_iv\_atom\_BHQZ95.dat', 'coll': 'ba\_iv\_coll\_SB98.dat'\},
          'Br3': \{'atom': 'br\_iii\_atom\_BH86.dat', 'coll': 'br\_iii\_coll\_S97.dat'\},
          'Br4': \{'atom': 'br\_iv\_atom\_BH86.dat', 'coll': 'br\_iv\_coll\_S97.dat'\},
          'C1': \{'atom': 'c\_i\_atom\_FFS85.dat', 'coll': 'c\_i\_coll\_JBK87-PA76.dat'\},
          'C2': \{'atom': 'c\_ii\_atom\_GMZ98.dat', 'coll': 'c\_ii\_coll\_BP92.dat'\},
          'C3': \{'atom': 'c\_iii\_atom\_G83-NS78-WFD96.dat',
           'coll': 'c\_iii\_coll\_Bal85.dat'\},
          'C4': \{'atom': 'c\_iv\_atom\_WFD96.dat', 'coll': 'c\_iv\_coll\_AK04.dat'\},
          'Ca5': \{'atom': 'ca\_v\_atom\_M83-KS86.dat', 'coll': 'ca\_v\_coll\_GMZ95.dat'\},
          'Cl2': \{'atom': 'cl\_ii\_atom\_MZ83.dat', 'coll': 'cl\_ii\_coll\_T04.dat'\},
          'Cl3': \{'atom': 'cl\_iii\_atom\_M83-KS86.dat', 'coll': 'cl\_iii\_coll\_BZ89.dat'\},
          'Cl4': \{'atom': 'cl\_iv\_atom\_KS86-MZ82-EM84.dat',
           'coll': 'cl\_iv\_coll\_GMZ95.dat'\},
          'Fe3': \{'atom': 'fe\_iii\_atom\_Q96\_J00.dat', 'coll': 'fe\_iii\_coll\_Z96.dat'\},
          'Fe4': \{'atom': 'fe\_iv\_atom\_FFRR08.dat', 'coll': 'fe\_iv\_coll\_ZP97.dat'\},
          'Fe5': \{'atom': 'fe\_v\_atom\_Nal00.dat', 'coll': 'fe\_v\_coll\_BGMcL07.dat'\},
          'Fe6': \{'atom': 'fe\_vi\_atom\_CP00.dat', 'coll': 'fe\_vi\_coll\_CP99.dat'\},
          'Fe7': \{'atom': 'fe\_vii\_atom\_WB08.dat', 'coll': 'fe\_vii\_coll\_WB08.dat'\},
          'H1': \{'rec': 'h\_i\_rec\_SH95.fits'\},
          'He1': \{'rec': 'he\_i\_rec\_Pal12-Pal13.fits'\},
          'He2': \{'rec': 'he\_ii\_rec\_SH95.fits'\},
          'K4': \{'atom': 'k\_iv\_atom\_M83-KS86.dat', 'coll': 'k\_iv\_coll\_GMZ95.dat'\},
          'K5': \{'atom': 'k\_v\_atom\_M83-KS86.dat', 'coll': 'k\_v\_coll\_BZL88.dat'\},
          'Kr3': \{'atom': 'kr\_iii\_atom\_BH86.dat', 'coll': 'kr\_iii\_coll\_S97.dat'\},
          'Kr4': \{'atom': 'kr\_iv\_atom\_BH86.dat', 'coll': 'kr\_iv\_coll\_S97.dat'\},
          'Kr5': \{'atom': 'kr\_v\_atom\_BH86.dat', 'coll': 'kr\_v\_coll\_S97.dat'\},
          'Mg5': \{'atom': 'mg\_v\_atom\_GMZ97.dat', 'coll': 'mg\_v\_coll\_BZ94.dat'\},
          'Mg7': \{'atom': 'mg\_vii\_atom\_GMZ97.dat', 'coll': 'mg\_vii\_coll\_LB94-U.dat'\},
          'N1': \{'atom': 'n\_i\_atom\_KS86-WFD96.dat', 'coll': 'n\_i\_coll\_PA76-DMR76.dat'\},
          'N2': \{'atom': 'n\_ii\_atom\_GMZ97-WFD96.dat', 'coll': 'n\_ii\_coll\_T11.dat'\},
          'N3': \{'atom': 'n\_iii\_atom\_GMZ98.dat', 'coll': 'n\_iii\_coll\_BP92.dat'\},
          'N4': \{'atom': 'n\_iv\_atom\_WFD96.dat', 'coll': 'n\_iv\_coll\_RBHB94.dat'\},
          'Na4': \{'atom': 'na\_iv\_atom\_GMZ97.dat', 'coll': 'na\_iv\_coll\_BZ94.dat'\},
          'Na6': \{'atom': 'na\_vi\_atom\_GMZ97.dat', 'coll': 'na\_vi\_coll\_LB94.dat'\},
          'Ne2': \{'atom': 'ne\_ii\_atom\_Bal06.dat', 'coll': 'ne\_ii\_coll\_GMB01.dat'\},
          'Ne3': \{'atom': 'ne\_iii\_atom\_GMZ97.dat', 'coll': 'ne\_iii\_coll\_McLB00.dat'\},
          'Ne4': \{'atom': 'ne\_iv\_atom\_BBZ89-BK88.dat', 'coll': 'ne\_iv\_coll\_G81.dat'\},
          'Ne5': \{'atom': 'ne\_v\_atom\_GMZ97-U-BD93.dat', 'coll': 'ne\_v\_coll\_LB94.dat'\},
          'Ne6': \{'atom': 'ne\_vi\_atom\_GMZ98.dat', 'coll': 'ne\_vi\_coll\_ZGP94.dat'\},
          'Ni3': \{'atom': 'ni\_iii\_atom\_B01.dat', 'coll': 'ni\_iii\_coll\_B01.dat'\},
          'O1': \{'atom': 'o\_i\_atom\_WFD96.dat', 'coll': 'o\_i\_coll\_BK95.dat'\},
          'O2': \{'atom': 'o\_ii\_atom\_Z82-WFD96.dat', 'coll': 'o\_ii\_coll\_P06-T07.dat'\},
          'O3': \{'atom': 'o\_iii\_atom\_SZ00-WFD96.dat', 'coll': 'o\_iii\_coll\_AK99.dat'\},
          'O4': \{'atom': 'o\_iv\_atom\_GMZ98.dat', 'coll': 'o\_iv\_coll\_BP92.dat'\},
          'O5': \{'atom': 'o\_v\_atom\_H80-NS79.dat', 'coll': 'o\_v\_coll\_BBDK85.dat'\},
          'Rb4': \{'atom': 'rb\_iv\_atom\_BH86.dat', 'coll': 'rb\_iv\_coll\_S97.dat'\},
          'Rb5': \{'atom': 'rb\_v\_atom\_BH86.dat', 'coll': 'rb\_v\_coll\_S97.dat'\},
          'Rb6': \{'atom': 'rb\_vi\_atom\_BH86.dat', 'coll': 'rb\_vi\_coll\_S97.dat'\},
          'S2': \{'atom': 's\_ii\_atom\_PKW09.dat', 'coll': 's\_ii\_coll\_TZ10.dat'\},
          'S3': \{'atom': 's\_iii\_atom\_PKW09.dat', 'coll': 's\_iii\_coll\_TG99.dat'\},
          'S4': \{'atom': 's\_iv\_atom\_JKD86-DHKD82.dat', 'coll': 's\_iv\_coll\_DHKD82.dat'\},
          'Se3': \{'atom': 'se\_iii\_atom\_BH86.dat', 'coll': 'se\_iii\_coll\_S97.dat'\},
          'Se4': \{'atom': 'se\_iv\_atom\_B05.dat', 'coll': 'se\_iv\_coll\_B05.dat'\},
          'Si2': \{'atom': 'si\_ii\_atom\_BL93-CSB93-N77.dat',
           'coll': 'si\_ii\_coll\_DK91.dat'\},
          'Si3': \{'atom': 'si\_iii\_atom\_M83-OKH88-FW90-KS86.dat',
           'coll': 'si\_iii\_coll\_DK94.dat'\},
          'Xe3': \{'atom': 'xe\_iii\_atom\_BHQZ95.dat', 'coll': 'xe\_iii\_coll\_SB98.dat'\},
          'Xe4': \{'atom': 'xe\_iv\_atom\_BHQZ95.dat', 'coll': 'xe\_iv\_coll\_SB98.dat'\},
          'Xe6': \{'atom': 'xe\_vi\_atom\_BHQZ95.dat', 'coll': 'xe\_vi\_coll\_SB98.dat'\}\}
\end{Verbatim}
        
    while the data files set for a particular ion can be displayed by
providing an argument to the above; e.g.~for {[}SIV{]}:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getDataFile}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S4}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
warng \_ManageAtomicData: rec data not available for S4
warng \_ManageAtomicData: trc data not available for S4

    \end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}57}]:} ('s\_iv\_atom\_JKD86-DHKD82.dat', 's\_iv\_coll\_DHKD82.dat', None, None)
\end{Verbatim}
        
    The complete inventory of data available for a given ion can be
displayed with the command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getAllAvailableFiles}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}58}]:} ['o\_ii\_atom.chianti',
          'o\_ii\_atom\_FFT04.dat',
          'o\_ii\_atom\_WFD96.dat',
          'o\_ii\_atom\_Z82-WFD96.dat',
          'o\_ii\_coll.chianti',
          'o\_ii\_coll\_Kal09.dat',
          'o\_ii\_coll\_P06-T07.dat',
          'o\_ii\_coll\_P76-McLB93-v1.dat',
          'o\_ii\_coll\_P76-McLB93-v2.dat',
          'o\_ii\_coll\_T07.dat']
\end{Verbatim}
        
    This method looks for all the ``o\_ii\_*'' files in a set of paths which
includes the location of the atomic data provided with the package and
the current directory (the one from where the python session is
running); additional paths can be added with the following command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{addDataFilePath}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{/tmp}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

    When both a .dat and a .fits version of the same data are found, the
.fits files are ignored, but you can force PyNeb to include them by
running the command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{includeFitsPath}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    If you want to change the atomic data used for a given ion, use the
following command to point to an existing data file:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{setDataFile}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{s\PYZus{}iii\PYZus{}coll\PYZus{}HRS12.fits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    If you want to change several data files at once, it may be worth
defining a dictionary with all your preferred atomic data files within
your script:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{n}{DataFileDict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{atom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}i\PYZus{}atom\PYZus{}KS86\PYZhy{}WFD96.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coll}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}i\PYZus{}coll\PYZus{}PA76\PYZhy{}DMR76.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{atom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}ii\PYZus{}atom\PYZus{}GMZ97\PYZhy{}WFD96.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coll}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{n\PYZus{}ii\PYZus{}coll\PYZus{}LB94.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{atom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o\PYZus{}ii\PYZus{}atom\PYZus{}Z82\PYZhy{}WFD96.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coll}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o\PYZus{}ii\PYZus{}coll\PYZus{}P06\PYZhy{}T07.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{atom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o\PYZus{}iii\PYZus{}atom\PYZus{}FFT04\PYZhy{}SZ00.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coll}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{o\PYZus{}iii\PYZus{}coll\PYZus{}AK99.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ne3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{atom}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ne\PYZus{}iii\PYZus{}atom\PYZus{}GMZ97.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{coll}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ne\PYZus{}iii\PYZus{}coll\PYZus{}McLB00.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}\PY{p}{\PYZcb{}}          	
         \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{setDataFileDict}\PY{p}{(}\PY{n}{DataFileDict}\PY{p}{)}
\end{Verbatim}

    Make sure that all the files listed actually exist, as this is not
checked by the code.

    \subsubsection{Predefined sets of atomic data}

    Predefined atomic data sets are provided by PyNeb. Each data set is
identified by a label; the one of the default data set can be retrieved
by the following command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{defaultDict}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}63}]:} 'PYNEB\_14\_03'
\end{Verbatim}
        
    To display the complete list of the existing predefined dictionaries,
enter:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getAllPredefinedDict}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}64}]:} ['PYNEB\_14\_01',
          'PYNEB\_16\_01',
          'IRAF\_09',
          'PYNEB\_14\_02',
          'PYNEB\_14\_03',
          'PYNEB\_13\_01',
          'IRAF\_09\_orig']
\end{Verbatim}
        
    The following command can be used to set one of them:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{setDataFileDict}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{IRAF\PYZus{}09}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
\end{Verbatim}

    To revert to the default set:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{resetDataFileDict}\PY{p}{(}\PY{p}{)}
         \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{removeFitsPath}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    You can have a look at the other methods of pn.atomicData in the
Reference Manual, or using the \textbf{help} command.

    \subsubsection{Creating new atomic data files}

    The following is an example of a 6-level atom file of {[}O III{]},
containing the matrix of transition probabilities. The energy levels and
statistical weigths are not in this file.

    Aij\\1/s 1/s 1/s 1/s 1/s 1/s\\0.0000000e+00 0.0000000e+00 0.0000000e+00
0.0000000e+00 0.0000000e+00 0.0000000e+00\\2.5960000e-05 0.0000000e+00
0.0000000e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00\\3.0300000e-11
9.6320000e-05 0.0000000e+00 0.0000000e+00 0.0000000e+00
0.0000000e+00\\2.3220000e-06 6.9510000e-03 2.0290000e-02 0.0000000e+00
0.0000000e+00 0.0000000e+00\\0.0000000e+00 2.2550000e-01 6.9980000e-04
1.6850000e+00 0.0000000e+00 0.0000000e+00\\2.1910000e-03 2.3080000e+02
5.7650000e+02 5.7770000e-03 3.7600000e-11 0.0000000e+00\\*** ATOM
oxygen\\*** SPECTRUM 3\\*** GSCONFIG unknown\\*** SOURCE3 Froese Fischer
et al 2004, ADNDT 87, 1\\*** NOTE3 A-values from all levels

    The effective collision strengths are a function of electron temperature
(a collective property of the electron distribution) and are obtained as
the average over a Maxwellian distribution of the collision strengths,
which depend on the energy. (Note: in this document, we will often refer
to the effective collision strengths as collision strengths for short,
although this is not strictly correct.) They are usually published for a
handful of T values and must be interpolated to get the collision
strength at the desired values. As a result, there is a whole 1-D array
of collision strengths, with one element for each tabulated temperature
value, for each transition j -\textgreater{} i with j \textgreater{} i.
The existence of this 3rd dimension prevents the data from being simply
stored in a matrix as transition probabilities are. Instead, each
transition is presented in a line, as in the following example:

    *** OIII collision strengths data\\0 0 3.699e+00 4.000e+00 4.301e+00
4.477e+00\\1 2 5.240e-01 5.648e-01 6.007e-01 6.116e-01\\1 3 2.469e-01
2.766e-01 3.106e-01 3.264e-01\\1 4 2.347e-01 2.693e-01 3.094e-01
3.256e-01\\1 5 4.094e-02 4.069e-02 4.299e-02 4.424e-02\\1 6 1.130e-01
1.239e-01 1.346e-01 1.373e-01\\2 3 1.210e+00 1.330e+00 1.451e+00
1.499e+00\\2 4 7.067e-01 8.108e-01 9.313e-01 9.802e-01\\2 5 1.228e-01
1.223e-01 1.294e-01 1.332e-01\\2 6 3.390e-01 3.717e-01 4.038e-01
4.119e-01\\3 4 1.188e+00 1.363e+00 1.564e+00 1.645e+00\\3 5 2.045e-01
2.046e-01 2.170e-01 2.235e-01\\3 6 5.650e-01 6.195e-01 6.730e-01
6.865e-01\\4 5 4.544e-01 5.661e-01 6.230e-01 6.219e-01\\4 6 0.000e+00
0.000e+00 0.000e+00 0.000e+00\\5 6 0.000e+00 0.000e+00 0.000e+00
0.000e+00\\*** T\_UNIT log(K)\\*** ATOM oxygen\\*** SPECTRUM 3\\***
GSCONFIG p2\\*** SOURCE1 Palay, E. et al. 2012, MNRAS Letters, 423,
L35\\*** NOTE1 All collision strengths from levels up to 5\\*** SOURCE2
Aggarwal and Keenan 1999, ApJS 123, 311\\*** NOTE2 Collision strengths
of 6-1, 6-2, 6-3

    The first row of the data block (0 0 \ldots{}) contains, from the third
element on, the array of electron temperatures for which the collision
strengths are tabulated (in log10(K) or K/10000, depending on the
particular data set).

The \textbf{original fits data} for collision strengths support, by
default, a Chebyshev polynomial interpolation: each transition is
described by a Chebyshev polynomial of order n that interpolates the
tabulated values. The default value for the Chebyshev order is the
number of temperature values, but other order can be specified when
calling pn.writeColl. If, for some reason, a Chebyshev interpolation is
not desired, the data can also be interpolated linearly, when the
instantiation of the corresponding Atom is done.

The \textbf{ascii data} (those currently used by default) only support
linear interpolation among tabulated values.

Notice the use of \textbf{SOURCE} and \textbf{NOTE} keywords to store
the data references. It is very important to fill in these keywords and
to give a descriptive name to the file, i.e.~a name that reflects the
sources of the data. When an \textbf{Atom} object is built, this
information is stored and is retrievable thereafter through:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{n}{O3}\PY{o}{.}\PY{n}{printSources}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
O3: Energy levels: 
    Ref. 7288 of NIST 2014 (try this: http://physics.nist.gov/cgi-bin/ASBib1/get\_ASBib\_ref.cgi?db=el\&db\_id=7288\&comment\_code=\&element=O\&spectr\_charge=3\&)
O3: A values for 4-2 and 4-3: Storey and Zeippen 2000, 312, 813
O3: All other A values: Wiese, Fuhr \& Deters, 1996, JPCRD, Monograph 7, 403
O3: All collision strengths: Aggarwal and Keenan 1999, ApJS 123, 311

    \end{Verbatim}

    \subsubsection{Plotting atomic data}

    The atomic data available can be plotted using the methods of the
\textbf{DataPlot} class. The class must be instantiated by specifying
which data sets are to be plotted. The available methods are
\textbf{plotA}, \textbf{plotRelA} and \textbf{plotAllA} to plot
transition probabilities, and \textbf{plotOmega} to plot collision
strengths.

    You must first create an instantiation of DataPlot for a given atom,
e.g.:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{n}{dp\PYZus{}O3} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{DataPlot}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)} 
         \PY{n}{dp\PYZus{}S3} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{DataPlot}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)} 
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
warng \_ManageAtomicData: rec data not available for O3
warng \_ManageAtomicData: trc data not available for O3
warng \_ManageAtomicData: rec data not available for S3
warng \_ManageAtomicData: trc data not available for S3

    \end{Verbatim}

    Then you can plot the different As and Omegas~:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{dp\PYZus{}S3}\PY{o}{.}\PY{n}{plotA}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} transition probabilities plot}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
warng DataPlot.plotA: Problem in plotting A

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_161_1.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{n}{dp\PYZus{}S3}\PY{o}{.}\PY{n}{plotRelA}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} relative transition probabilities plot}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_162_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_162_1.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_162_2.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{n}{dp\PYZus{}S3}\PY{o}{.}\PY{n}{plotAllA}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)} 
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_163_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{dp\PYZus{}O3}\PY{o}{.}\PY{n}{plotOmega}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{)}\PY{p}{)} \PY{c+c1}{\PYZsh{} collision strength plot}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_164_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsubsection{Recombination lines: the RecAtom class}

    This object is similar to \textbf{Atom}, but some methods differ due to
the particularities of the recombination spectrum. It is instantiated
with the following command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}73}]:} \PY{n}{H1} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RecAtom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}

    The data are read from a fits file and interpolated in temperature and
density. The name of the file is retrievable through:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}74}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getDataFile}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{rec}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}74}]:} 'h\_i\_rec\_SH95.fits'
\end{Verbatim}
        
    The ions for which recombination lines are available are listed with the
command:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}75}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getAllAtoms}\PY{p}{(}\PY{n}{coll}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{,} \PY{n}{rec}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}75}]:} ['He1', 'He2', 'H1']
\end{Verbatim}
        
    You can list all the available data files for a given ion by:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}76}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getAllAvailableFiles}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}76}]:} ['h\_i\_atom.chianti',
          'h\_i\_coll.chianti',
          'h\_i\_rec\_SH95-caseA.fits',
          'h\_i\_rec\_SH95.fits',
          'h\_i\_trc\_SH95-caseA.dat',
          'h\_i\_trc\_SH95-caseB.dat']
\end{Verbatim}
        
    The emissivities are obtained by, e.g.:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}77}]:} \PY{n}{Hbeta} \PY{o}{=} \PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e3}\PY{p}{,} \PY{n}{lev\PYZus{}i}\PY{o}{=}\PY{l+m+mi}{4}\PY{p}{,} \PY{n}{lev\PYZus{}j}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{n}{Halpha} \PY{o}{=} \PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{den}\PY{o}{=}\PY{l+m+mf}{1e3}\PY{p}{,} \PY{n}{lev\PYZus{}i}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{lev\PYZus{}j}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
         \PY{k}{print} \PY{n}{Halpha}\PY{o}{/}\PY{n}{Hbeta}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
2.85691188359

    \end{Verbatim}

    The argument used to identify the various lines in the data file depend
on whether the atom is a hydrogenoid or not. In the first case, the
transition can be specified either as a pair of levels \textbf{lev\_i},
\textbf{lev\_j}, or as a label (labels are descriptive of level pairs):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}78}]:} \PY{k}{print} \PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1.8e4}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1e2}\PY{p}{]}\PY{p}{,} \PY{n}{lev\PYZus{}i} \PY{o}{=} \PY{l+m+mi}{4}\PY{p}{,} \PY{n}{lev\PYZus{}j} \PY{o}{=} \PY{l+m+mi}{2}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[[  1.24000000e-25   1.23500000e-25]
 [  7.40180000e-26   7.38740000e-26]]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{k}{print} \PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1.8e4}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1e2}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[[  1.24000000e-25   1.23500000e-25]
 [  7.40180000e-26   7.38740000e-26]]

    \end{Verbatim}

    As in the case of collisional lines, setting \textbf{product=False}
modifies the input array of temperature and density values:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{k}{print} \PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1.8e4}\PY{p}{]}\PY{p}{,} \PY{p}{[}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1e2}\PY{p}{]}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{product}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[  1.24000000e-25   7.38740000e-26]

    \end{Verbatim}

    In the case of non-hydrogenoids, the transition can be specified either
as a wavelength or as a label (labels are descriptive of wavelengths):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{n}{He1} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RecAtom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{He}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
         \PY{k}{print} \PY{n}{He1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1e2}\PY{p}{,} \PY{n}{wave}\PY{o}{=}\PY{l+m+mf}{4471.0}\PY{p}{)}
         \PY{k}{print} \PY{n}{He1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1e2}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4471.0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
6.11561306801e-26
6.11561306801e-26

    \end{Verbatim}

    Enter \textbf{$<$Atom.labels$>$} to display the valid labels for both
kind of recombiation atoms, i.e.:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{H1}\PY{o}{.}\PY{n}{labels}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}82}]:} ['2\_1', '3\_1', '3\_2', '4\_1', '4\_2', '4\_3', '5\_1', '5\_2', '5\_3', '5\_4']
\end{Verbatim}
        
    As an example application, you can easily generate a 2D table of H
alpha/ H Beta as a function of Te and Ne:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{tem} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{linspace}\PY{p}{(}\PY{l+m+mi}{5000}\PY{p}{,} \PY{l+m+mi}{20000}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{den} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mi}{2}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{im\PYZus{}Hab} \PY{o}{=} \PY{p}{(}\PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{3\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)} \PY{o}{/} \PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
         \PY{k}{print} \PY{n}{im\PYZus{}Hab}\PY{o}{.}\PY{n}{shape}
         \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{min}\PY{p}{(}\PY{n}{im\PYZus{}Hab}\PY{p}{)}
         \PY{k}{print} \PY{n}{np}\PY{o}{.}\PY{n}{max}\PY{p}{(}\PY{n}{im\PYZus{}Hab}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
(100, 100)
2.72452373753
3.04092769441

    \end{Verbatim}

    By default, H1 emissivities are computed under case B; to compute Case A
emissivities, the atomic data file must be changed:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{getAllAvailableFiles}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H1}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}84}]:} ['h\_i\_atom.chianti',
          'h\_i\_coll.chianti',
          'h\_i\_rec\_SH95-caseA.fits',
          'h\_i\_rec\_SH95.fits',
          'h\_i\_trc\_SH95-caseA.dat',
          'h\_i\_trc\_SH95-caseB.dat']
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{atomicData}\PY{o}{.}\PY{n}{setDataFile}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{h\PYZus{}i\PYZus{}rec\PYZus{}SH95\PYZhy{}caseA.fits}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{H1\PYZus{}A} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RecAtom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}87}]:} \PY{n}{im\PYZus{}caseAoverB} \PY{o}{=} \PY{p}{(}\PY{n}{H1\PYZus{}A}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{/}\PY{n}{H1}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{4\PYZus{}2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}88}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{imshow}\PY{p}{(}\PY{n}{im\PYZus{}caseAoverB}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}88}]:} <matplotlib.colorbar.Colorbar at 0x7fd89bdbcc10>
\end{Verbatim}
        
    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_192_1.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{The extinction class: RedCorr()}

    The class RedCorr manages the extinction (reddening) correction. It can
compute the logarithmic extinction at H$\beta$ by comparing an observed
ratio to a theoretical one (usually H$\alpha$/H$\beta$, but any other
ratio can be used). The object is also able to compute the correction to
be applied to any intensity, given the wavelength of the line.

Various extinction laws are included in the class, and any user-defined
function can also be implemented. The available extinction laws can be
listed by entering (here no need to instantiate an object):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}89}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{printLaws}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
'G03 LMC': 
        Extinction curve for the LMC
        Gordon et al. (2003, ApJ, 594,279)
        http://adsabs.harvard.edu/abs/2003ApJ{\ldots}594..279G
        
        Comments:
        Average curve for the LMC
        R\_V = 3.41

        Scope: LMC
        Range: 1200 through fIR   

        
'K76': 
        Kaler 1976, ApJS, 31, 517
        http://adsabs.harvard.edu/abs/1976ApJS{\ldots}31..517K
        
        Comments:
        This function returns the correction relative to Hbeta (f\_lambda) and not
        the extinction law (X(1/lambda)).
        It cannot be used for absolute correction.
        
        Range: 3000 to >20000
        
        
'F99-like': 
        In the UV, it returns the Fitzpatrick \& Massa 1990 law.
        In the opt/IR, it returns the Fitzpatrick \& Massa 1990 law. 
        
        Fitzpatrick 1999, PASP, 11, 63
        http://adsabs.harvard.edu/abs/1999PASP..111{\ldots}63F
        Fitzpatrick \& Massa 1990, ApJS, 72, 163
        http://adsabs.harvard.edu/abs/1990ApJS{\ldots}72..163F
        
        Comments:
        The FM90 depends on 6 parameters which must be set by the user and are stored in RedCorr.FitzParams.
        For the predefined set of parameters defined in FM99, use instead the F99 law.
        R\_V must be provided, as the law depends on it. The dependence with R\_V follows Table 4 in the F99 paper 

        Range: UV through IR
        
        
'F88 F99 LMC': 
        This method returns:
        - in the UV, the average LMC extinction curve derived by Fitzpatrick \& Massa 1988
        - in the opt/IR, the R-dependent extinction curve proposed by Fitzpatrick 1999.
        
        Fitzpatrick 1999, PASP, 11, 63
        http://adsabs.harvard.edu/abs/1999PASP..111{\ldots}63F
        Fitzpatrick \& Massa 1988, ApJ, 328, 734
        http://adsabs.harvard.edu/abs/1988ApJ{\ldots}328..734F
        
        Comments:
        The Fitzpatrick and Massa law in the UV depends on 6 parameters, stored in RedCorr.FitzParams and 
        here set to the LMC values derived in FM88
        R\_V must be provided, as the law depends on it
        
        Scope: LMC
        Range: UV through IR

        
'No correction': 
        No correction, return 0.0
        
        
'SM79 Gal': 
        Galactic extinction law
        Savage \& Mathis 1979, ARA\&A, 17, 73
        http://adsabs.harvard.edu/abs/1979ARA\%26A..17{\ldots}73S
        
        Comments:
        Average of several extinction laws
        R\_V=3.1
        
        Scope: Galactic
        Range: UV through IR
        
        
'MCC99 FM90 LMC': 
        In the UV, this method returns the extinction curve proposed for the LMC 
        by Misselt et al 1999 based on the 1990 variant of the Fitzpatrick \& Massa law
        In the opt/IR, it returns the Fitzpatrick \& Massa 1990 law.

        Misselt, Clayton \& Gordon 1999 , ApJ, 515, 128 
        http://adsabs.harvard.edu/abs/1999ApJ{\ldots}515..128M
        Fitzpatrick \& Massa 1990, ApJS, 72, 163
        http://adsabs.harvard.edu/abs/1990ApJS{\ldots}72..163F
        
        Comments:
        The Fitzpatrick \& Massa 1990 law in the UV depends on 6 parameters, stored in RedCorr.FitzParams.
        The method sets RedCorr.FitzParams to the values of set in the Fitzpatrick 1999 paper, 
        which includes an explicit dependence on R\_V.
        R\_V must be provided, as the law depends on its value.
        We refer to FM90 and not to the original FM88 because the value of a constant in F(lambda) slightly changed (0.0564 -> 0.05644)
        The value of another constant of F(lambda) appears to change from FM90 to MCC99, but it is probably a typo (0.5392 -> 0.5329) 
        
        Scope: LMC

        
'CCM89 Bal07': 
        Galactic extinction law based on Cardelli et al 1989, modified by Blagrave et al 2007 
        for 3.3 < x < 8 (1250 < lambda < 3030)
        
        Blagrave et al 2007, ApJ, 655, 299 
        http://adsabs.harvard.edu/abs/2007ApJ{\ldots}655..299B
        Cardelli, Clayton \& Mathis 1989, ApJ 345, 245
        http://adsabs.harvard.edu/abs/1989ApJ{\ldots}345..245C

        Comments:
        Same as CCM89 for x<3.3 and x>8
        Revised values for 3.3<x<8
        Based on observation of Orion stars
        Depends on R\_V, default value being 3.1

        Range: UV through IR
        
        
'CCM89 oD94': 
        Galactic extinction law based on Cardelli et al 1989, modified by O'Donnell 1994
        for 1.1 < x < 3.3 (9100 < lambda < 3030)
        
        O'Donnell 1994, ApJ, 422, 1580
        http://adsabs.harvard.edu/abs/1994ApJ{\ldots}422..158O
        Cardelli, Clayton \& Mathis 1989, ApJ 345, 245
        http://adsabs.harvard.edu/abs/1989ApJ{\ldots}345..245C

        Comments:
        Same as CCM89 for x<1.1 and x>3.3
        Revised values for 1.1<x<3.3
        Produces lower correction in the near UV at low R\_V
        
        Scope: Galactic
        Range: UV through IR
        
        
'S79 H83 CCM89': 
        Galactic extinction law (0-33000 A range):
        - In the UV, from Seaton 1979
        - In the opt/NIR (3600-9100) Howarth 1983
        - In the FIR (9100-33000) Cardelly et al 1989
        
        Seaton 1979, MNRAS, 187, 73) and 
        http://adsabs.harvard.edu/abs/1979MNRAS.187P..73S
        Howarth 1983, MNRAS, 203, 301) Galactic law
        http://adsabs.harvard.edu/abs/1983MNRAS.204.1091H
        Cardelli, Clayton and Mathis 1989, ApJ, 345, 245
        http://adsabs.harvard.edu/abs/1989ApJ{\ldots}345..245C
        
        Scope: Galactic
        Range: UV through IR
        
        
'F99': 
        This method returns the R-dependent IR-through-UV extinction curve proposed by Fitzpatrick 1999.

        Fitzpatrick 1999, PASP, 11, 63
        http://adsabs.harvard.edu/abs/1999PASP..111{\ldots}63F
        based on: 
        Fitzpatrick \& Massa 1990, ApJS, 72, 163
        http://adsabs.harvard.edu/abs/1990ApJS{\ldots}72..163F
        
        Comments:
        The Fitzpatrick \& Massa 1990 law in the UV depends on 6 parameters, stored in RedCorr.FitzParams.
        The method sets RedCorr.FitzParams to the values of set in the Fitzpatrick 1999 paper, 
        which includes an explicit dependence on R\_V.
        R\_V must be provided, as the law depends on its value.
        
        Range: UV through IR

        
'CCM89': 
        Cardelli, Clayton \& Mathis 1989, ApJ 345, 245
        http://adsabs.harvard.edu/abs/1989ApJ{\ldots}345..245C

        Comments: Depends on R\_V, default value being 3.1

        Scope: Applicable to both dense and diffuse ISM
        Range: UV through IR
        
        

    \end{Verbatim}

    Less detailed output is obtained with:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}90}]:} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{getLaws}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}90}]:} ['G03 LMC',
          'K76',
          'F99-like',
          'F88 F99 LMC',
          'No correction',
          'SM79 Gal',
          'MCC99 FM90 LMC',
          'CCM89 Bal07',
          'CCM89 oD94',
          'S79 H83 CCM89',
          'F99',
          'CCM89']
\end{Verbatim}
        
    To apply an extinction correction, you have to define a RedCorr object:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}91}]:} \PY{n}{rc} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{n}{E\PYZus{}BV} \PY{o}{=} \PY{l+m+mf}{1.2}\PY{p}{,} \PY{n}{R\PYZus{}V} \PY{o}{=} \PY{l+m+mf}{3.2}\PY{p}{,} \PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F99}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    The parameters can also be defined after the instantiation:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}92}]:} \PY{n}{rc} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{p}{)} 
         \PY{n}{rc}\PY{o}{.}\PY{n}{E\PYZus{}BV} \PY{o}{=} \PY{l+m+mf}{1.34}
         \PY{n}{rc}\PY{o}{.}\PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S79 H83 CCM89}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}

    $c(H\beta)$ and $E_{B-V}$ are related through:

\[(1-f_\lambda).c(H\beta) = 0.4 E_{B-V} X_\lambda\] applied to $\lambda$
= 4861, with $f_\beta$ = 0.:

    so that, once one of the two parameters is defined, the other is also
automatically defined; to output its value, enter:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}93}]:} \PY{n}{rc}\PY{o}{.}\PY{n}{cHbeta}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}93}]:} 1.9457101047071228
\end{Verbatim}
        
    The reddening of a given spectrum is determined by using the ratio of
two observed line intensities relative to the theoretical value, for
example:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}94}]:} \PY{n}{rc}\PY{o}{.}\PY{n}{setCorr}\PY{p}{(}\PY{l+m+mf}{6.5} \PY{o}{/} \PY{l+m+mf}{2.86}\PY{p}{,} \PY{l+m+mf}{6563.}\PY{p}{,} \PY{l+m+mf}{4861.}\PY{p}{)}
\end{Verbatim}

    Once a law and either c(H$\beta$) or E$_{B-V}$ are defined, the
correction for any wavelength is obtained by:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}95}]:} \PY{n}{wave} \PY{o}{=} \PY{l+m+mf}{5007.0}
         \PY{n}{corr} \PY{o}{=} \PY{n}{rc}\PY{o}{.}\PY{n}{getCorr}\PY{p}{(}\PY{n}{wave}\PY{p}{)}
         \PY{k}{print} \PY{n}{corr}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
11.8468982794

    \end{Verbatim}

    where \textbf{wave} can either be a single wavelength or a list or array
of wavelengths.

    The correction relative to the H$\beta$ correction is given by:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}96}]:} \PY{n}{corr} \PY{o}{=} \PY{n}{rc}\PY{o}{.}\PY{n}{getCorrHb}\PY{p}{(}\PY{n}{wave}\PY{p}{)}
         \PY{k}{print} \PY{n}{corr}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
0.912421020017

    \end{Verbatim}

    and the correction relative to any other wavelength (p.~ej., H$\alpha$)
is given by:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}97}]:} \PY{n}{corr} \PY{o}{=} \PY{n}{rc}\PY{o}{.}\PY{n}{getCorr}\PY{p}{(}\PY{l+m+mf}{5007.}\PY{p}{,} \PY{l+m+mf}{6563.}\PY{p}{)}
         \PY{k}{print} \PY{n}{corr}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
2.07325069463

    \end{Verbatim}

    The class includes a plotting tool to have a quick look at the different
extinction laws:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}98}]:} \PY{n}{f}\PY{p}{,} \PY{n}{ax} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{rc}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{laws} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_215_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    A user-defined method can also be used. User-defined methods must accept
2 parameters: the first is the wavelength (or wavelength array), in
Angstrom, and the second is an optional parameter (which can also be a
list). The method must return
$X(\lambda) = A(\lambda)/E_{B-V} = R_V A(\lambda)/A_V$. The correction
is then: $10^{0.4 E_{B-V} X(\lambda)}$

    Here is an example of a user-defined function:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}99}]:} \PY{k}{def} \PY{n+nf}{my\PYZus{}X}\PY{p}{(}\PY{n}{wave}\PY{p}{,} \PY{n}{params} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{5000.}\PY{p}{,} \PY{l+m+mf}{1.}\PY{p}{,} \PY{l+m+mf}{2.}\PY{p}{,} \PY{l+m+mf}{3.}\PY{p}{]}\PY{p}{)}\PY{p}{:}
             \PY{k}{return} \PY{n}{params}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{*} \PY{p}{(}\PY{n}{wave}\PY{o}{/}\PY{n}{params}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)} \PY{o}{+} \PY{n}{params}\PY{p}{[}\PY{l+m+mi}{2}\PY{p}{]} \PY{o}{*} \PY{p}{(}\PY{n}{wave}\PY{o}{/}\PY{n}{params}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1} \PY{o}{+} \PY{n}{params}\PY{p}{[}\PY{l+m+mi}{3}\PY{p}{]} \PY{o}{*} \PY{p}{(}\PY{n}{wave}\PY{o}{/}\PY{n}{params}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{o}{*}\PY{o}{\PYZhy{}}\PY{l+m+mi}{2}
         \PY{n}{rc}\PY{o}{.}\PY{n}{UserFunction} \PY{o}{=} \PY{n}{my\PYZus{}X}
         \PY{n}{rc}\PY{o}{.}\PY{n}{UserParams} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{6000.}\PY{p}{,} \PY{l+m+mf}{1.}\PY{p}{,} \PY{l+m+mf}{5.}\PY{p}{,} \PY{l+m+mf}{1.}\PY{p}{]}
         \PY{n}{rc}\PY{o}{.}\PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{user}\PY{l+s+s1}{\PYZsq{}}
         \PY{k}{print} \PY{n}{rc}\PY{o}{.}\PY{n}{getCorr}\PY{p}{(}\PY{l+m+mi}{5007}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
342.093161202

    \end{Verbatim}

    \subsection{The EmissionLine class}

    This is the class characterizing emission lines. An emission line is
identified by an element and a spectrum (which identify the emitting
ion), a wavelength in Angstrom, a blend flag, a label in the standard
PyNeb format, an observed intensity, a reddening-corrected intensity, an
expression describing how the intensity depends on the included
wavelengths, an observational error and an error on the corrected
intensity. Other programs determine one or more of these values.

    To instantiate an Emission Line object, use the following:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}100}]:} \PY{n}{line} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmissionLine}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+m+mi}{5007}\PY{p}{,} \PY{n}{obsIntens}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{1.4}\PY{p}{,} \PY{l+m+mf}{1.3}\PY{p}{]}\PY{p}{)}
          \PY{n}{line2} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmissionLine}\PY{p}{(}\PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3\PYZus{}5007A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{obsIntens}\PY{o}{=}\PY{l+m+mi}{320}\PY{p}{,} \PY{n}{corrected}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    obsIntens is a value, a list or a numpy array of values corresponding to
the observed intensity of the given emission line.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}101}]:} \PY{k}{print} \PY{n}{line}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Line O3 O3\_5007A

    \end{Verbatim}

    To know how the label of a given line is exactly spelled, you can print
the dictionary pn.LINE\_LABEL\_LIST

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}102}]:} \PY{k}{print} \PY{n}{pn}\PY{o}{.}\PY{n}{LINE\PYZus{}LABEL\PYZus{}LIST}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
['4931A', '4959A', '5007A', '2315A', '2321A', '2331A', '4363A', '1658A', '1661A', '1666A', '2497A', '5833A', '88.3m', '32.6m', '51.8m']

    \end{Verbatim}

    It is possible to instantiate a line not contained in the
pn.LINE\_LABEL\_LIST. In this case a warning is issued, but the code
doesn't stop.

    The observed intensity is stored in \textbf{line.obsIntens} and the
extinction-corrected intensity is stored in \textbf{line.corrIntens}.
\textbf{line.corrIntens} is set to 0.0 when the line is instantiated,
unless the parameter corrected is set to \textbf{True}, in which case
the observed value \textbf{obsIntens} is copied to the
\textbf{corrIntens} slot (the same applies for \textbf{corrError}, which
is set to \textbf{obsError}).

    The \textbf{corrIntens} value can also be computed using an
instantiation of the \textbf{pn.RedCorr} class:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}103}]:} \PY{n}{redcorr} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{n}{E\PYZus{}BV} \PY{o}{=} \PY{l+m+mf}{0.87}\PY{p}{,} \PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F99}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}104}]:} \PY{n}{line}\PY{o}{.}\PY{n}{correctIntens}\PY{p}{(}\PY{n}{redcorr}\PY{p}{)} \PY{c+c1}{\PYZsh{}redcorr is used to compute line.corrIntens}
\end{Verbatim}

    The line information is printed using:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}105}]:} \PY{n}{line}\PY{o}{.}\PY{n}{printLine}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Line O3 O3\_5007A evaluated as L(5007)
Observed intensity: [ 1.4  1.3]
Observed error: [ 0.  0.]
Corrected intensity: [ 22.58352855  20.97041937]
Corrected error: [ 0.  0.]

    \end{Verbatim}

    Most of the times, users will not need to define or manipulate
EmissionLine objects, since most of the work on the EmissionLine objects
will be performed from the Observation class (read data, extinction
correction); see next section.

    WARNING: Note that the wavelengths assigned to EmissionLine objects are
simply the numerical part of the label:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}106}]:} \PY{n}{Hb1} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmissionLine}\PY{p}{(}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H1r\PYZus{}4861A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{wave}
          \PY{k}{print} \PY{n}{Hb1}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
4861.0

    \end{Verbatim}

    whereas pn.Atom computes them as the difference from energy levels:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}107}]:} \PY{n}{Hb2} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RecAtom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{getWave}\PY{p}{(}\PY{l+m+mi}{4}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
          \PY{k}{print} \PY{n}{Hb2}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
4861.33165987

    \end{Verbatim}

    This can cause small errors when both methods are used simultaneously.
For instance, the extinction correction at Hb1 is slightly different
from the expected value of 1:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}108}]:} \PY{n}{rc}\PY{o}{.}\PY{n}{getCorrHb}\PY{p}{(}\PY{n}{Hb1}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}108}]:} 1.0004052204507501
\end{Verbatim}
        
    This happens because the ExtCorr uses the precise H$\beta$ value
computed from energy levels. If this roundoff error exceeds your
tolerance, a possible workaround is forcing the emission line to have
exactly the wavelength computed from the energy levels:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}109}]:} \PY{n}{Hb11} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmissionLine}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{H}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{wave}\PY{o}{=}\PY{n}{Hb2}\PY{p}{)}\PY{o}{.}\PY{n}{wave}
          \PY{k}{print} \PY{n}{rc}\PY{o}{.}\PY{n}{getCorrHb}\PY{p}{(}\PY{n}{Hb11}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
warng EmissionLine: Atom H1 not valid
1.0

    \end{Verbatim}

    This will generate a warning (as the transition is not included in the
inventory for the specified atom), but the code won't stop.

    \subsection{The Observation class: reading and dealing with
observations}

    \subsubsection{Reading observation from a file}

    pn.Observation is the class characterizing observation records. An
observation record is composed of an object identifier, the observed
intensity of one or more emission lines, and, optionally, the dereddened
line intensities and the identifier of the extinction law used, and the
value of c(Hbeta).

Observations can be initialized by reading data files, which can be
organized with different emission lines either in rows or columns
(usually, in a survey of many objects with few emission lines emission
lines change across columns; and in a high-resolution observation of a
small sample of objects lines change across rows).

The following is an example of how to define an observation:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}110}]:} \PY{n}{obs} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}111}]:} \PY{o}{\PYZpc{}\PYZpc{}}\PY{k}{writefile} observations1.dat
          LINE SMC\PYZus{}24
          S4\PYZus{}10.5m   7.00000
          Ne2\PYZus{}12.8m  8.3000
          Ne3\PYZus{}15.6m 34.10
          S3\PYZus{}18.7m  10.
          O2\PYZus{}3726A  39.700
          O2\PYZus{}3729A  18.600
          Ne3\PYZus{}3869A 18.90
          Ne3\PYZus{}3968A  6.4
          S2\PYZus{}4069A   0.85
          S2\PYZus{}4076A   0.450
          O3\PYZus{}4363A   4.36
          H1r\PYZus{}4861A 100.00
          O3\PYZus{}5007A 435.09
          N2\PYZus{}5755A   0.510000
          S3\PYZus{}6312A   0.76
          O1\PYZus{}6300A   1.69
          O1\PYZus{}6364A   0.54
          N2\PYZus{}6548A   6.840000
          H1r\PYZus{}6563A   3.45
          N2\PYZus{}6584A  19.00
          S2\PYZus{}6716A   1.220000
          S2\PYZus{}6731A   2.180000
          Ar3\PYZus{}7136A  4.91
          O2\PYZus{}7319A+   6.540000
          O2\PYZus{}7330A+   5.17
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Overwriting observations1.dat

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}112}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{readData}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{observations1.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fileFormat}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines\PYZus{}in\PYZus{}rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{err\PYZus{}default}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{)} \PY{c+c1}{\PYZsh{} fill obs with data read from smc\PYZus{}24.dat}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}113}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{printIntens}\PY{p}{(}\PY{n}{returnObs}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
S4\_10.5m [ 7.]
Ne2\_12.8m [ 8.30000019]
Ne3\_15.6m [ 34.09999847]
S3\_18.7m [ 10.]
O2\_3726A [ 39.70000076]
O2\_3729A [ 18.60000038]
Ne3\_3869A [ 18.89999962]
Ne3\_3968A [ 6.4000001]
S2\_4069A [ 0.85000002]
S2\_4076A [ 0.44999999]
O3\_4363A [ 4.36000013]
H1r\_4861A [ 100.]
O3\_5007A [ 435.08999634]
N2\_5755A [ 0.50999999]
S3\_6312A [ 0.75999999]
O1\_6300A [ 1.69000006]
O1\_6364A [ 0.54000002]
N2\_6548A [ 6.84000015]
H1r\_6563A [ 3.45000005]
N2\_6584A [ 19.]
S2\_6716A [ 1.22000003]
S2\_6731A [ 2.18000007]
Ar3\_7136A [ 4.90999985]
O2\_7319A+ [ 6.53999996]
O2\_7330A+ [ 5.17000008]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}114}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{extinction}\PY{o}{.}\PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CCM89}\PY{l+s+s1}{\PYZsq{}}  \PY{c+c1}{\PYZsh{} define the extinction law from Cardelli et al.}
          \PY{n}{obs}\PY{o}{.}\PY{n}{correctData}\PY{p}{(}\PY{p}{)}                      \PY{c+c1}{\PYZsh{} the dereddened data are computed}
\end{Verbatim}

    The data can be read by the readData method as above or directly while
instantiating the object:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}115}]:} \PY{n}{obs} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{observations1.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fileFormat}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines\PYZus{}in\PYZus{}rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{corrected}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    The format of the data file from which the emission line intensities are
read can be one of three kinds: ``lines\_in\_rows'' as above, or
``lines\_in\_cols'' like this one:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}116}]:} \PY{o}{\PYZpc{}\PYZpc{}}\PY{k}{writefile} observations2.dat
          NAME O2\PYZus{}3726A  O2\PYZus{}3726Ae O2\PYZus{}3729A O2\PYZus{}3729Ae
          NGC3132 0.93000   0.05000   0.17224200 0.10  
          IC418 1.28000   0.05000   0.09920000 0.05 
          M33 0.03100   0.080     0.03100    0.10
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Overwriting observations2.dat

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}117}]:} \PY{n}{obs2} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{observations2.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fileFormat}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines\PYZus{}in\PYZus{}cols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{corrected}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    or fileFormat=`lines\_in\_rows\_err\_cols' (errors labeled ``err''.
Don't name an observation ``err''!) like this one:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}118}]:} \PY{o}{\PYZpc{}\PYZpc{}}\PY{k}{writefile} observations3.dat
          LINE     TT   err  TT2 err TT3 err
          cHbeta   1.2  0.0  1.5 0.2 1.1 0.2
          O3\PYZus{}5007A 1.5  0.15 1.3  .2 1.1 0.1
          H1\PYZus{}6563A 2.89 0.05 1.6 0.3 1.3 0.1
          N2\PYZus{}6584A 1.   0.20 0.3 0.5 1.5 0.1
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
Overwriting observations3.dat

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}119}]:} \PY{n}{obs3} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{observations3.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fileFormat}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines\PYZus{}in\PYZus{}rows\PYZus{}err\PYZus{}cols}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{corrected}\PY{o}{=}\PY{n+nb+bp}{False}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
warng EmissionLine: Atom H1 not valid

    \end{Verbatim}

    The delimiter between the columns is any sequence of spaces or TAB, but
it can be changed using the delimiter parameter. The line names are
defined by a label starting with the name of the atom (`O2'), followed
by an underscore, followed by a wavelength and ending with a unit (`A'
or `m'). The list of all the lines managed by PyNeb, ordered by atoms,
is obtained by entering:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}120}]:} \PY{k}{for} \PY{n}{atom} \PY{o+ow}{in} \PY{n}{pn}\PY{o}{.}\PY{n}{LINE\PYZus{}LABEL\PYZus{}LIST}\PY{p}{:}
              \PY{k}{print}\PY{p}{(}\PY{n}{atom}\PY{p}{,} \PY{n}{pn}\PY{o}{.}\PY{n}{LINE\PYZus{}LABEL\PYZus{}LIST}\PY{p}{[}\PY{n}{atom}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
('Ba4', ['5697A'])
('Ba2', ['4935A', '6497A', '6854A', '4555A', '5854A', '6142A', '2361A', '2668A', '2726A', '4524A', '4900A', '2.05m', '1.76m', '12.5m', '5.9m'])
('S3', ['8829A', '9069A', '9531A', '3681A', '3722A', '3798A', '6312A', '33.5m', '12.0m', '18.7m'])
('Kr3', ['6827A', '9902A', '3022A', '3504A', '3600A', '5423A', '2.2m', '1.88m', '13.1m', '1.07m'])
('H1r', ['1216A', '1026A', '973A', '6563A', '4861A', '4341A', '4102A', '3970A', '3889A', '3835A', '3798A', '1.87m', '1.28m', '1.09m', '9546A', '9229A'])
('Rb4', ['5760A', '9009A', '9604A', '2603A', '3110A', '3178A', '4750A', '1.6m', '1.44m', '14.5m'])
('Ca5', ['5309A', '6087A', '6428A', '2280A', '2413A', '2464A', '3998A', '4.16m', '3.05m', '11.5m'])
('Kr5', ['5069A', '6256A', '8243A', '2550A', '2819A', '3163A', '5132A', '2.67m', '1.32m', '2.6m'])
('Ne6', ['997A', '1010A', '993A', '1006A', '986A', '999A', '559A', '563A', '1271A', '1278A', '1289A', '559A', '563A', '1270A', '1277A', '1288A', '433A', '436A', '766A', '769A', '772A', '1928A', '1929A', '7.65m', '22.7m', '9.2m', '15.5m', '334.4m'])
('Kr4', ['5868A', '5346A', '3219A', '7131A', '8091A', '2993A', '6108A', '6798A', '6.0m', '4.26m'])
('K5', ['4163A', '4123A', '2514A', '6349A', '6446A', '2495A', '6222A', '6316A', '42.2m', '31.0m'])
('K4', ['6102A', '6796A', '7109A', '2594A', '2711A', '2760A', '4511A', '6.0m', '4.3m', '15.4m'])
('S2', ['6731A', '6716A', '4076A', '4069A', '1260A', '1549A', '1550A', '1823A', '1824A', '1254A', '1541A', '1542A', '1811A', '1812A', '1251A', '1536A', '1537A', '1804A', '1806A', '314.5m', '1.03m', '214.0m', '27.7m', '17.6m', '48.6m'])
('O5', ['1220A', '1218A', '1214A', '630A', '1301A', '1303A', '1309A', '73.5m', '22.6m', '32.6m'])
('O4', ['1400A', '1407A', '1397A', '1405A', '1394A', '1401A', '788A', '1801A', '1806A', '1812A', '608A', '610A', '1076A', '1078A', '1080A', '2671A', '2672A', '25.9m', '76.7m', '31.7m', '53.9m', '719.2m'])
('O3', ['4931A', '4959A', '5007A', '2315A', '2321A', '2331A', '4363A', '1658A', '1661A', '1666A', '2497A', '5833A', '88.3m', '32.6m', '51.8m'])
('Ne4', ['2425A', '2422A', '1602A', '4716A', '4726A', '1601A', '4714A', '4724A', '224.9m', '1579.3m'])
('O1', ['6300A', '6364A', '6392A', '2959A', '2973A', '2979A', '5577A', '63.2m', '44.1m', '145.5m'])
('Ar2', ['7.0m'])
('Ar3', ['7136A', '7751A', '8036A', '3005A', '3109A', '3154A', '5192A', '9.0m', '6.37m', '21.8m'])
('He1r', ['5876A', '2945A', '3188A', '3614A', '3889A', '3965A', '4026A', '4121A', '4388A', '4438A', '4471A', '4713A', '4922A', '5016A', '5048A', '5876A', '6678A', '7065A', '7281A', '9464A', '10830A', '11013A', '11969A', '12527A', '12756A', '12785A', '12790A', '12846A', '12968A', '12985A', '13412A', '15084A', '17003A', '18556A', '18685A', '18697A', '19089A', '19543A', '20425A', '20581A', '20602A', '21120A', '21132A', '21608A', '21617A'])
('Ar5', ['6133A', '6435A', '7005A', '2637A', '2692A', '2786A', '4626A', '1218A', '1229A', '1249A', '1520A', '2262A', '13.1m', '4.93m', '7.9m'])
('Ne5', ['3300A', '3346A', '3426A', '1565A', '1575A', '1592A', '2973A', '1132A', '1137A', '1146A', '1721A', '4083A', '24.3m', '9.0m', '14.3m'])
('Ne2', ['12.8m'])
('Br3', ['6646A', '6133A', '3714A', '8420A', '9419A', '3498A', '7385A', '8142A', '7.94m', '6.0m'])
('O2', ['3729A', '3726A', '2470A', '7319A', '7320A', '7330A', '7331A', '2470A', '834A', '1075A', '1260A', '833A', '1073A', '1258A', '833A', '1072A', '1256A', '499.3m', '5023.7m', '61.3m', '40.7m', '121.3m'])
('Xe4', ['7535A', '5709A', '3566A', '6769A', '9498A', '2804A', '4467A', '5511A', '2.36m', '1.31m'])
('Xe6', ['6409A'])
('Rb6', ['4210A', '5373A', '7220A', '2212A', '2495A', '2832A', '4660A', '1.95m', '1.01m', '2.1m'])
('C3', ['1910A', '1909A', '1907A', '977A', '2000A', '2001A', '2003A', '422.0m', '124.9m', '177.4m'])
('C2', ['2325A', '2328A', '2323A', '2327A', '2322A', '2325A', '1335A', '1336A', '3131A', '3133A', '3136A', '1036A', '1037A', '1869A', '1870A', '1871A', '4636A', '4637A', '157.6m', '454.4m', '198.8m', '353.3m', '3967.2m'])
('C1', ['9808A', '9824A', '9850A', '4618A', '4621A', '4627A', '8728A', '2963A', '2965A', '2967A', '4246A', '8271A', '609.6m', '230.3m', '370.3m'])
('Al2', ['2674A', '2670A', '2661A', '1671A', '4451A', '4463A', '4488A', '164.2m', '54.1m', '80.7m'])
('Rb5', ['5364A', '4742A', '2873A', '6188A', '7290A', '2609A', '5080A', '5800A', '4.1m', '2.84m'])
('C4', ['1551A', '1548A', '92.8m'])
('Si3', ['1897A', '1892A', '1883A', '1206A', '3315A', '3329A', '3359A', '77.7m', '25.7m', '38.2m'])
('Si2', ['2335A', '2351A', '2329A', '2345A', '2320A', '1808A', '1817A', '8007A', '8077A', '8193A', '7997A', '8067A', '8183A', '34.8m', '92.3m', '35.2m', '57.1m', '631.5m'])
('Se4', ['2.28m'])
('Xe3', ['5847A', '2769A', '3574A', '3800A', '5261A', '1.23m', '1.02m', '6.0m', '1.11m', '1.37m'])
('Fe6', ['3556A', '3929A', '5146A', '5176A', '5278A', '5335A', '5370A', '5424A', '5427A', '5485A', '5631A', '5677A'])
('Fe7', ['5159A', '5276A', '5721A', '6087A'])
('Fe4', ['4491A', '5685A', '5735A', '6740A'])
('Fe5', ['3783A', '3795A', '3829A', '3891A', '3895A', '3911A', '4071A', '4181A', '4227A'])
('Na6', ['2816A', '2872A', '2972A', '1343A', '1356A', '1378A', '2569A', '14.39m', '5.4m', '8.6m'])
('Fe3', ['4009A', '4659A', '4668A', '4701A', '4734A', '4755A', '5011A', '5085A', '5270A', '4881A', '4925A', '4931A', '5412A', '4987A', '8729A', '8838A', '3240A', '3286A', '3319A', '3323A', '3335A', '3355A', '3357A', '3366A', '3371A', '3406A', '4046A', '4080A', '4097A', '4607A', '4770A', '4778A', '9701A', '9960A', '5440A', '6096A'])
('Na4', ['3242A', '3362A', '3416A', '1504A', '1529A', '1540A', '2804A', '9.0m', '6.34m', '21.3m'])
('Ni3', ['7890A', '8500A', '6000A', '6401A', '6534A', '6682A', '6797A', '7125A', '6946A'])
('Cl4', ['7261A', '7531A', '8046A', '3071A', '3119A', '3204A', '5323A', '1463A', '1474A', '1493A', '1833A', '2793A', '20.3m', '7.45m', '11.8m'])
('Ar4', ['4740A', '4711A', '2868A', '7263A', '7332A', '2854A', '7170A', '7237A', '77.4m', '56.2m'])
('N2', ['6527A', '6548A', '6584A', '3058A', '3063A', '3071A', '5755A', '2137A', '2139A', '2143A', '3177A', '7092A', '205.3m', '76.4m', '121.8m'])
('N3', ['1749A', '1754A', '1747A', '1752A', '1744A', '1750A', '990A', '992A', '2280A', '2284A', '2288A', '2280A', '2283A', '2287A', '763A', '764A', '1356A', '1357A', '3334A', '3335A', '57.4m', '167.5m', '71.0m', '123.3m', '1492.1m'])
('N4', ['1488A', '1487A', '1483A', '765A', '1575A', '1576A', '1580A', '158.4m', '48.3m', '69.4m'])
('Ne3', ['3869A', '3968A', '4012A', '1794A', '1815A', '1824A', '3343A', '15.6m', '10.9m', '36.0m'])
('Cl2', ['8579A', '9124A', '9381A', '3586A', '3678A', '3719A', '6162A', '14.4m', '10.0m', '33.3m'])
('Cl3', ['5538A', '5518A', '3353A', '8500A', '8548A', '3343A', '8434A', '8481A', '151.5m', '108.0m'])
('S4', ['1405A', '1424A', '1398A', '1417A', '1387A', '1406A', '10.5m', '29.0m', '11.2m', '18.3m'])
('Se3', ['7671A', '8854A', '3516A', '3746A', '4082A', '6493A', '5.74m', '2.54m', '4.55m', '1.1m'])
('N1', ['5200A', '5198A', '3467A', '3466A'])
('Mg7', ['2441A', '2509A', '2629A', '1174A', '1190A', '1216A', '2261A', '943A', '953A', '970A', '1537A', '4790A', '9.0m', '3.42m', '5.5m'])
('3He2', ['3.50c'])
('Mg5', ['2783A', '2929A', '2992A', '1294A', '1325A', '1338A', '2418A', '5.6m', '3.96m', '13.5m'])
('Mg4', ['4.5m'])
('He2r', ['1640A', '1215A', '1084A', '4686A', '3203A', '6560A', '5411A', '4859A'])

    \end{Verbatim}

    The presence of a trailing ``e'' at the end of the label points to the
error associated to the line. The error is considered to be relative to
the intensity (i.e., 0.05 means 5\% of the intensity), unless the
parameter errIsRelative is set to False. A common value for all the
errors can be defined by the parameter \textbf{err\_default} (0.10 is
the default value).

    \subsubsection{Extinction correction in Observation class}

    Once the data have been read, they have to be corrected from extinction.
An instantiation of \textbf{RedCorr()} is available inside the
\textbf{Observation} object as \textbf{obs.extinction}.

If the data file contains \textbf{cHbeta} or \textbf{E(B-V)} alongside
of line labels, the corresponding information on extinction is
transmitted to the extinction correction object. Otherwise, the
extinction parameters must be set manually; for example:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}121}]:} \PY{n}{obs} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{observations1.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fileFormat}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines\PYZus{}in\PYZus{}rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{corrected}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
          \PY{n}{obs}\PY{o}{.}\PY{n}{extinction}\PY{o}{.}\PY{n}{cHbeta} \PY{o}{=} \PY{l+m+mf}{1.2}
          \PY{n}{obs}\PY{o}{.}\PY{n}{extinction}\PY{o}{.}\PY{n}{E\PYZus{}BV} \PY{o}{=} \PY{l+m+mf}{0.34}
\end{Verbatim}

    An extinction law has to be specified in either case:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}122}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{extinction}\PY{o}{.}\PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{F99}\PY{l+s+s1}{\PYZsq{}}
\end{Verbatim}

    To correct all the lines at once:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}123}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{correctData}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}124}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{printIntens}\PY{p}{(}\PY{n}{returnObs}\PY{o}{=}\PY{n+nb+bp}{True}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
S4\_10.5m [ 7.]
Ne2\_12.8m [ 8.30000019]
Ne3\_15.6m [ 34.09999847]
S3\_18.7m [ 10.]
O2\_3726A [ 39.70000076]
O2\_3729A [ 18.60000038]
Ne3\_3869A [ 18.89999962]
Ne3\_3968A [ 6.4000001]
S2\_4069A [ 0.85000002]
S2\_4076A [ 0.44999999]
O3\_4363A [ 4.36000013]
H1r\_4861A [ 100.]
O3\_5007A [ 435.08999634]
N2\_5755A [ 0.50999999]
S3\_6312A [ 0.75999999]
O1\_6300A [ 1.69000006]
O1\_6364A [ 0.54000002]
N2\_6548A [ 6.84000015]
H1r\_6563A [ 3.45000005]
N2\_6584A [ 19.]
S2\_6716A [ 1.22000003]
S2\_6731A [ 2.18000007]
Ar3\_7136A [ 4.90999985]
O2\_7319A+ [ 6.53999996]
O2\_7330A+ [ 5.17000008]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}125}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{printIntens}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
S4\_10.5m [ 7.11975803]
Ne2\_12.8m [ 8.41496764]
Ne3\_15.6m [ 34.48348489]
S3\_18.7m [ 10.09307839]
O2\_3726A [ 171.24206763]
O2\_3729A [ 80.15612017]
Ne3\_3869A [ 78.13399959]
Ne3\_3968A [ 25.71732799]
S2\_4069A [ 3.32014218]
S2\_4076A [ 1.75430783]
O3\_4363A [ 15.7036518]
H1r\_4861A [ 310.25435475]
O3\_5007A [ 1289.85131043]
N2\_5755A [ 1.24390974]
S3\_6312A [ 1.66198348]
O1\_6300A [ 3.70383903]
O1\_6364A [ 1.16980719]
N2\_6548A [ 14.34619111]
H1r\_6563A [ 7.21747442]
N2\_6584A [ 39.60657366]
S2\_6716A [ 2.48780908]
S2\_6731A [ 4.43455095]
Ar3\_7136A [ 9.38391466]
O2\_7319A+ [ 12.17965989]
O2\_7330A+ [ 9.61370718]

    \end{Verbatim}

    If you want the corrected line intensities to be normalized to a given
wavelength, use the following:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}126}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{correctData}\PY{p}{(}\PY{n}{normWave}\PY{o}{=}\PY{l+m+mf}{4861.}\PY{p}{)}
\end{Verbatim}

    The extinction correction can be determined by comparing the observed
values to a theoretical ratio, as in the following:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}127}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{printIntens}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
S4\_10.5m [ 2.29481325]
Ne2\_12.8m [ 2.71228027]
Ne3\_15.6m [ 11.11458529]
S3\_18.7m [ 3.25316252]
O2\_3726A [ 55.19408995]
O2\_3729A [ 25.83561486]
Ne3\_3869A [ 25.18385266]
Ne3\_3968A [ 8.28911105]
S2\_4069A [ 1.07013556]
S2\_4076A [ 0.56544181]
O3\_4363A [ 5.06154114]
H1r\_4861A [ 100.]
O3\_5007A [ 415.73995358]
N2\_5755A [ 0.40093224]
S3\_6312A [ 0.53568417]
O1\_6300A [ 1.19380727]
O1\_6364A [ 0.37704779]
N2\_6548A [ 4.62400959]
H1r\_6563A [ 2.32630882]
N2\_6584A [ 12.76583972]
S2\_6716A [ 0.80186113]
S2\_6731A [ 1.42932755]
Ar3\_7136A [ 3.02458757]
O2\_7319A+ [ 3.92570151]
O2\_7330A+ [ 3.09865342]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}128}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{def\PYZus{}EBV}\PY{p}{(}\PY{n}{label1}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{H1r\PYZus{}6563A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label2}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{H1r\PYZus{}4861A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{r\PYZus{}theo}\PY{o}{=}\PY{l+m+mf}{2.85}\PY{p}{)}
          \PY{k}{print}\PY{p}{(}\PY{n}{obs}\PY{o}{.}\PY{n}{extinction}\PY{o}{.}\PY{n}{E\PYZus{}BV}\PY{p}{)}
          \PY{n}{obs}\PY{o}{.}\PY{n}{correctData}\PY{p}{(}\PY{n}{normWave}\PY{o}{=}\PY{l+m+mf}{4861.}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
[-3.80825098]

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}129}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{printIntens}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
S4\_10.5m [ 1862873.3321508]
Ne2\_12.8m [ 2289624.63614709]
Ne3\_15.6m [ 9681842.82513927]
S3\_18.7m [ 2900918.21157661]
O2\_3726A [ 0.99069915]
O2\_3729A [ 0.46892362]
Ne3\_3869A [ 0.75888083]
Ne3\_3968A [ 0.35320246]
S2\_4069A [ 0.06443513]
S2\_4076A [ 0.03486379]
O3\_4363A [ 0.81982369]
H1r\_4861A [ 100.]
O3\_5007A [ 724.22886843]
N2\_5755A [ 7.55158652]
S3\_6312A [ 38.21722558]
O1\_6300A [ 82.92131172]
O1\_6364A [ 30.17724087]
N2\_6548A [ 549.03539807]
H1r\_6563A [ 285.]
N2\_6584A [ 1633.68483422]
S2\_6716A [ 134.21899293]
S2\_6731A [ 246.50683125]
Ar3\_7136A [ 1116.57610378]
O2\_7319A+ [ 1987.64418295]
O2\_7330A+ [ 1598.12655872]

    \end{Verbatim}

    By default, this method prints out the corrected intensities. To print
the observed intensities, use the \textbf{returnObs=True} parameter.

    The method \textbf{getSortedLines} returns the lines sorted in
alphabetical order according to either the emitting atoms (default) or
the wavelength (using the \textbf{crit=`wave'} parameter):

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}130}]:} \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{obs}\PY{o}{.}\PY{n}{getSortedLines}\PY{p}{(}\PY{p}{)}\PY{p}{:} 
              \PY{k}{print}\PY{p}{(}\PY{n}{line}\PY{o}{.}\PY{n}{label}\PY{p}{,} \PY{n}{line}\PY{o}{.}\PY{n}{corrIntens}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
('Ar3\_7136A', 1116.5761037772124)
('H1r\_4861A', 100.0)
('H1r\_6563A', 285.0000000000004)
('N2\_5755A', 7.5515865166910849)
('N2\_6548A', 549.03539806966057)
('N2\_6584A', 1633.6848342208623)
('Ne2\_12.8m', 2289624.6361470865)
('Ne3\_15.6m', 9681842.8251392711)
('Ne3\_3869A', 0.75888082682114033)
('Ne3\_3968A', 0.35320245770990177)
('O1\_6300A', 82.921311721997114)
('O1\_6364A', 30.177240871552701)
('O2\_3726A', 0.99069914508263235)
('O2\_3729A', 0.46892361850581255)
('O2\_7319A+', 1987.6441829484479)
('O2\_7330A+', 1598.1265587226821)
('O3\_4363A', 0.81982369301604263)
('O3\_5007A', 724.22886842764478)
('S2\_4069A', 0.064435128013150128)
('S2\_4076A', 0.034863794604422474)
('S2\_6716A', 134.21899293495827)
('S2\_6731A', 246.50683125182974)
('S3\_18.7m', 2900918.2115766057)
('S3\_6312A', 38.217225581304128)
('S4\_10.5m', 1862873.3321507953)

    \end{Verbatim}

    The following method, which gives the list of all the atoms implied in
the observed emission lines, will be useful later:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}131}]:} \PY{n}{atomList} \PY{o}{=} \PY{n}{obs}\PY{o}{.}\PY{n}{getUniqueAtoms}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}132}]:} \PY{n}{atomList}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}132}]:} array(['Ar3', 'H1r', 'N2', 'Ne2', 'Ne3', 'O1', 'O2', 'O3', 'S2', 'S3', 'S4'], 
                dtype='|S3')
\end{Verbatim}
        
    \subsubsection{Adding observations and lines}

    Once an \textbf{Observation} object is instantiated, you can add a new
observation (corresponding, e.g., to a new object or a new fiber) by
using:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}133}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{addObs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{test}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{np}\PY{o}{.}\PY{n}{random}\PY{o}{.}\PY{n}{rand}\PY{p}{(}\PY{l+m+mi}{25}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    where `test' is the name of the new observation. The new observation
must have the same size of \textbf{obs}, that is, it must contain
\textbf{obs.n\_lines} lines.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}134}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{printIntens}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
S4\_10.5m [  1.86287333e+06   9.89878231e-01]
Ne2\_12.8m [  2.28962464e+06   9.01003799e-01]
Ne3\_15.6m [  9.68184283e+06   1.76795879e-02]
S3\_18.7m [  2.90091821e+06   9.09521814e-01]
O2\_3726A [ 0.99069915  0.69847094]
O2\_3729A [ 0.46892362  0.51271245]
Ne3\_3869A [ 0.75888083  0.27264817]
Ne3\_3968A [ 0.35320246  0.29546079]
S2\_4069A [ 0.06443513  0.86307066]
S2\_4076A [ 0.03486379  0.43933782]
O3\_4363A [ 0.81982369  0.91910674]
H1r\_4861A [ 100.            0.60394002]
O3\_5007A [  7.24228868e+02   6.44575237e-01]
N2\_5755A [ 7.55158652  0.96374025]
S3\_6312A [ 38.21722558   0.51069208]
O1\_6300A [ 82.92131172   0.23916481]
O1\_6364A [ 30.17724087   0.1205119 ]
N2\_6548A [ 549.03539807    0.92044244]
H1r\_6563A [ 285.            0.57723395]
N2\_6584A [  1.63368483e+03   3.71812495e-01]
S2\_6716A [ 134.21899293    0.50811338]
S2\_6731A [ 246.50683125    0.3771552 ]
Ar3\_7136A [  1.11657610e+03   2.12588939e-01]
O2\_7319A+ [  1.98764418e+03   7.96377244e-01]
O2\_7330A+ [  1.59812656e+03   8.72629934e-01]

    \end{Verbatim}

    You can also add a new emission line by means of:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}135}]:} \PY{n}{line} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmissionLine}\PY{p}{(}\PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Cl3\PYZus{}5518A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{obsIntens}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{3.5}\PY{p}{,} \PY{l+m+mf}{2.5}\PY{p}{]}\PY{p}{)}
          \PY{n}{obs}\PY{o}{.}\PY{n}{addLine}\PY{p}{(}\PY{n}{line}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}136}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{printIntens}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
S4\_10.5m [  1.86287333e+06   9.89878231e-01]
Ne2\_12.8m [  2.28962464e+06   9.01003799e-01]
Ne3\_15.6m [  9.68184283e+06   1.76795879e-02]
S3\_18.7m [  2.90091821e+06   9.09521814e-01]
O2\_3726A [ 0.99069915  0.69847094]
O2\_3729A [ 0.46892362  0.51271245]
Ne3\_3869A [ 0.75888083  0.27264817]
Ne3\_3968A [ 0.35320246  0.29546079]
S2\_4069A [ 0.06443513  0.86307066]
S2\_4076A [ 0.03486379  0.43933782]
O3\_4363A [ 0.81982369  0.91910674]
H1r\_4861A [ 100.            0.60394002]
O3\_5007A [  7.24228868e+02   6.44575237e-01]
N2\_5755A [ 7.55158652  0.96374025]
S3\_6312A [ 38.21722558   0.51069208]
O1\_6300A [ 82.92131172   0.23916481]
O1\_6364A [ 30.17724087   0.1205119 ]
N2\_6548A [ 549.03539807    0.92044244]
H1r\_6563A [ 285.            0.57723395]
N2\_6584A [  1.63368483e+03   3.71812495e-01]
S2\_6716A [ 134.21899293    0.50811338]
S2\_6731A [ 246.50683125    0.3771552 ]
Ar3\_7136A [  1.11657610e+03   2.12588939e-01]
O2\_7319A+ [  1.98764418e+03   7.96377244e-01]
O2\_7330A+ [  1.59812656e+03   8.72629934e-01]
Cl3\_5518A [  8.85845356e-05   6.32746683e-05]

    \end{Verbatim}

    \subsubsection{Getting line intensities}

    You can extract the line intensities from an \textbf{Observation} object
by, for example:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}137}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{names}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}137}]:} ['SMC\_24', 'test']
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}138}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{getIntens}\PY{p}{(}\PY{n}{obsName}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SMC\PYZus{}24}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}138}]:} \{'Ar3\_7136A': 1116.5761037772124,
           'Cl3\_5518A': 8.8584535640522582e-05,
           'H1r\_4861A': 100.0,
           'H1r\_6563A': 285.0000000000004,
           'N2\_5755A': 7.5515865166910849,
           'N2\_6548A': 549.03539806966057,
           'N2\_6584A': 1633.6848342208623,
           'Ne2\_12.8m': 2289624.6361470865,
           'Ne3\_15.6m': 9681842.8251392711,
           'Ne3\_3869A': 0.75888082682114033,
           'Ne3\_3968A': 0.35320245770990177,
           'O1\_6300A': 82.921311721997114,
           'O1\_6364A': 30.177240871552701,
           'O2\_3726A': 0.99069914508263235,
           'O2\_3729A': 0.46892361850581255,
           'O2\_7319A+': 1987.6441829484479,
           'O2\_7330A+': 1598.1265587226821,
           'O3\_4363A': 0.81982369301604263,
           'O3\_5007A': 724.22886842764478,
           'S2\_4069A': 0.064435128013150128,
           'S2\_4076A': 0.034863794604422474,
           'S2\_6716A': 134.21899293495827,
           'S2\_6731A': 246.50683125182974,
           'S3\_18.7m': 2900918.2115766057,
           'S3\_6312A': 38.217225581304128,
           'S4\_10.5m': 1862873.3321507953\}
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}139}]:} \PY{n}{obs}\PY{o}{.}\PY{n}{getIntens}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2\PYZus{}7330A+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}139}]:} array([  1.59812656e+03,   8.72629934e-01])
\end{Verbatim}
        
    \subsection{Using Observation to determine ionic abundances}

    Once the electron temperature and density are determined, it is easy to
obtain the ionic abundances from a set of emission lines included in an
\textbf{Observation} object:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}140}]:} \PY{n}{obs} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{p}{)}
          \PY{n}{obs}\PY{o}{.}\PY{n}{readData}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{observations1.dat}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{fileFormat}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines\PYZus{}in\PYZus{}rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{err\PYZus{}default}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{)} \PY{c+c1}{\PYZsh{} fill obs with data read from observations1.dat}
          \PY{n}{obs}\PY{o}{.}\PY{n}{def\PYZus{}EBV}\PY{p}{(}\PY{n}{label1}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{H1r\PYZus{}6563A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{label2}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{H1r\PYZus{}4861A}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{r\PYZus{}theo}\PY{o}{=}\PY{l+m+mf}{2.85}\PY{p}{)}
          \PY{n}{obs}\PY{o}{.}\PY{n}{correctData}\PY{p}{(}\PY{n}{normWave}\PY{o}{=}\PY{l+m+mf}{4861.}\PY{p}{)}
          \PY{n}{Te} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{10000.}\PY{p}{]}
          \PY{n}{Ne} \PY{o}{=} \PY{p}{[}\PY{l+m+mf}{1e3}\PY{p}{]}
          \PY{c+c1}{\PYZsh{} Define a dictionary to hold all the Atom objects needed}
          \PY{n}{all\PYZus{}atoms} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getAtomDict}\PY{p}{(}\PY{n}{atom\PYZus{}list}\PY{o}{=}\PY{n}{obs}\PY{o}{.}\PY{n}{getUniqueAtoms}\PY{p}{(}\PY{p}{)}\PY{p}{)}
          \PY{c+c1}{\PYZsh{} define a dictionary to store the abundances}
          \PY{n}{ab\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}
          \PY{c+c1}{\PYZsh{} we  use the following lines to determine the ionic abundances}
          \PY{n}{ab\PYZus{}labels} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N2\PYZus{}6584A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2\PYZus{}3726A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3\PYZus{}5007A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S2\PYZus{}6716A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                       \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{S3\PYZus{}6312A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ar3\PYZus{}7136A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ne3\PYZus{}3869A}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
          \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{obs}\PY{o}{.}\PY{n}{getSortedLines}\PY{p}{(}\PY{p}{)}\PY{p}{:}
              \PY{k}{if} \PY{n}{line}\PY{o}{.}\PY{n}{label} \PY{o+ow}{in} \PY{n}{ab\PYZus{}labels}\PY{p}{:}
                  \PY{n}{ab} \PY{o}{=} \PY{n}{all\PYZus{}atoms}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{atom}\PY{p}{]}\PY{o}{.}\PY{n}{getIonAbundance}\PY{p}{(}\PY{n}{line}\PY{o}{.}\PY{n}{corrIntens}\PY{p}{,} \PY{n}{Te}\PY{p}{,} \PY{n}{Ne}\PY{p}{,} 
                                                            \PY{n}{to\PYZus{}eval}\PY{o}{=}\PY{n}{line}\PY{o}{.}\PY{n}{to\PYZus{}eval}\PY{p}{,} \PY{n}{Hbeta}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
                  \PY{n}{ab\PYZus{}dict}\PY{p}{[}\PY{n}{line}\PY{o}{.}\PY{n}{atom}\PY{p}{]} \PY{o}{=} \PY{n}{ab}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
warng \_ManageAtomicData: atom data not available for H1
warng \_ManageAtomicData: coll data not available for H1

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}141}]:} \PY{n}{ab\PYZus{}dict}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}141}]:} \{'Ar3': array([  2.96001201e-07]),
           'N2': array([  2.60645127e-06]),
           'Ne3': array([  1.37179504e-05]),
           'O2': array([  1.89336290e-05]),
           'O3': array([ 0.00010394]),
           'S2': array([  5.48539044e-08]),
           'S3': array([  1.12822738e-06])\}
\end{Verbatim}
        
    \subsection{Exploring line intensities with the EmisGrid class}

    \subsubsection{The EmisGrid class}

    Most plots are obtained by operating on emission maps, which are grids
of emissivities as a function of temperature and density generated by
the \textbf{EmisGrid} class.

\textbf{EmisGrid} instantiates an atom and computes the emissivities of
all its lines for the (tem, den) values of a regularly spaced grid (may
be log or linear in the case of the density). Each line is represented
in a 2D array (a grid), and there are as many arrays transitions in the
atom. The results can be operated on, saved for a later use in a cPickle
file, or restored.

The following command instantiates an {[}O III{]} atom and computes the
emissivity of all its lines in a 30x30 grid:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}142}]:} \PY{n}{O3\PYZus{}EG} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmisGrid}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{n\PYZus{}tem}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{,} \PY{n}{n\PYZus{}den}\PY{o}{=}\PY{l+m+mi}{30}\PY{p}{)}
\end{Verbatim}

    The arguments are described in more details in the Reference Manual.
Here is the list:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}143}]:} \PY{n}{O3\PYZus{}EG} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmisGrid}\PY{p}{(}\PY{n}{elem}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{spec}\PY{o}{=}\PY{l+m+mi}{3}\PY{p}{,} \PY{n}{n\PYZus{}tem}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{n\PYZus{}den}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} 
                              \PY{n}{tem\PYZus{}min}\PY{o}{=}\PY{l+m+mf}{5000.}\PY{p}{,} \PY{n}{tem\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{20000.}\PY{p}{,} \PY{n}{den\PYZus{}min}\PY{o}{=}\PY{l+m+mf}{10.}\PY{p}{,} 
                              \PY{n}{den\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{1.e8}\PY{p}{,} \PY{n}{restore\PYZus{}file}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{,} \PY{n}{atomObj}\PY{o}{=}\PY{n+nb+bp}{None}\PY{p}{)}
\end{Verbatim}

    The emissivity grid of a specific line can be obtained by means of:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}144}]:} \PY{n}{O3\PYZus{}5007} \PY{o}{=} \PY{n}{O3\PYZus{}EG}\PY{o}{.}\PY{n}{getGrid}\PY{p}{(}\PY{n}{wave}\PY{o}{=}\PY{l+m+mi}{5007}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}145}]:} \PY{n}{O3\PYZus{}5007}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}145}]:} (100, 100)
\end{Verbatim}
        
    The emissivity grid of a combination of lines can also be computed:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}146}]:} \PY{n}{O3\PYZus{}Te} \PY{o}{=} \PY{n}{O3\PYZus{}EG}\PY{o}{.}\PY{n}{getGrid}\PY{p}{(}\PY{n}{to\PYZus{}eval} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{L(4363)/L(5007)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    There are two plotting tools integrated in the \textbf{EmisGrid} object:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}147}]:} \PY{n}{O3\PYZus{}EG}\PY{o}{.}\PY{n}{plotImage}\PY{p}{(}\PY{n}{to\PYZus{}eval} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{L(4363)/L(5007)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_313_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}148}]:} \PY{n}{O3\PYZus{}EG}\PY{o}{.}\PY{n}{plotContours}\PY{p}{(}\PY{n}{to\PYZus{}eval} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{L(4363)/L(5007)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_314_0.pdf}
    \end{center}
    { \hspace*{\fill} \\}
    
    See the Reference Manual for more option and the \textbf{Diagnostic}
class for producing plots combining different atoms.

    \subsubsection{Instantiating various EmisGrid objects with
getEmisGridDict}

    It is quite common to have to instantiate various \textbf{EmisGrid}
objects, especially if you want to make a diagnostic diagram. This can
easily be done using the \textbf{getEmisGridDict} method, used for
example as follows:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}149}]:} \PY{n}{emisgrids} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getEmisGridDict}\PY{p}{(}\PY{n}{atom\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{N2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}150}]:} \PY{n}{emisgrids}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}150}]:} \{'N2': <pyneb.core.emisGrid.EmisGrid at 0x7fd8a059ec90>,
           'O2': <pyneb.core.emisGrid.EmisGrid at 0x7fd89b90a3d0>,
           'O3': <pyneb.core.emisGrid.EmisGrid at 0x7fd89b90a6d0>\}
\end{Verbatim}
        
    This command generates a dictionary of emission grids for {[}O II{]},
{[}O III{]} and {[}N II{]}. The resulting maps are saved in a directory
defined by default when PyNeb is started, in the pn.config.pypic\_path
variable. It first tries to use the \$HOME/.pypics directory; if it
fails, it tries to use /tmp/pypic; if it fails too, the value is set to
None and a user-defined value has to be provided by changing
pn.config.pypic\_path or using the pypic\_path parameter when calling
getEmisGridDict.

If a Diagnostic object is already available (see next Section), it can
be used to determine the relevant atoms for which a grid must be
computed or restored:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}151}]:} \PY{n}{diags} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Diagnostics}\PY{p}{(}\PY{p}{)} \PY{c+c1}{\PYZsh{} See next section}
          \PY{n}{emisgrids} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getEmisGridDict}\PY{p}{(}\PY{n}{atomDict}\PY{o}{=}\PY{n}{diags}\PY{o}{.}\PY{n}{atomDict}\PY{p}{,} \PY{n}{den\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{1e6}\PY{p}{)}
\end{Verbatim}

    This \textbf{EmisGrid} dictionary will be very useful to plot diagnostic
diagrams with the \textbf{Diagnostic} object, as is described in the
next section.

    \subsection{The Diagnostics class}

    \textbf{Diagnostics} is the class used to evaluate temperatures and
densities from line ratios. It is also the class that plots the
diagnostic Te-Ne diagrams. The object is instantiated like this:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}152}]:} \PY{n}{diags} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Diagnostics}\PY{p}{(}\PY{p}{)}        \PY{c+c1}{\PYZsh{} instantiate the Diagnostic class  }
\end{Verbatim}

    An optional parameter \textbf{addAll=True} (default is \textbf{False})
lets the object load all the available diagnostics. Most of the time
this option is not used and the diagnostics are added manually as they
are needed:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}153}]:} \PY{n}{diags}\PY{o}{.}\PY{n}{addDiag}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NI] 5198/5200}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NII] 5755/6548}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OII] 3726/3729}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}
\end{Verbatim}

    Each diagnostic is defined by a label and is associated to a tuple
containing 3 elements: the atom corresponding to the diagnostic lines,
the algebraic definition of the line ratios and the algebraic definition
of the error of the diagnostic, which depends on the error of each line
involved. In the present case, the diagnostic is the ratios of two {[}O
III{]} lines, 4363/5007, and the error is the quadratic sum of the
relative error of each line (E(lambda)): RMS(a, b) = sqrt(a\textbf{2 +
b}2).

    Users can also define their own diagnostics, for example using:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}154}]:} \PY{n}{diags}\PY{o}{.}\PY{n}{addDiag}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OIII] 4363/4959}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{L(4363)/L(4959)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RMS([E(4363),E(4959)])}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    Notice that the diagnostics are defined so that they tend to increase
with the main parameter they trace: {[}OIII{]} 4363/5007 increases with
the electron temperature.

The diagnostics contained in a \textbf{Diagnostics} object are listed by
means of the \textbf{diags.getDiagLabels()} and
\textbf{diags.getDiags()} methods. Once added to the
\textbf{Diagnostics} object, they can be used either to compute
\textbf{Te} and \textbf{Ne} via \textbf{getCrossTemDen} or to plot
diagrams (see below). A diagnostic can be removed from the list with the
\textbf{delDiag} method.

    \subsubsection{Determination of temperature and density}

    The \textbf{getCrossTemDen} method cross-converges the temperature and
density derived from two sensitive line ratios (not necessarily from the
same atom), by inputting the quantity derived with one line ratio into
the other and then iterating. When the iteration process ends, the two
diagnostics give self-consistent results. The first line ratio must be a
temperature-sensitive one and the second a density-sensitive one. The
temperature and density can be individual numbers as well as arrays
(provided they are equal in shape).

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}155}]:} \PY{n}{diags}\PY{o}{.}\PY{n}{getCrossTemDen}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NII] 5755/6548}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 6731/6716}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mf}{0.02}\PY{p}{,} \PY{l+m+mf}{1.0}\PY{p}{)}
\end{Verbatim}

            \begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}155}]:} (7622.597437360454, 444.7122084104995)
\end{Verbatim}
        
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}156}]:} \PY{k}{for} \PY{n}{diag} \PY{o+ow}{in} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{pn}\PY{o}{.}\PY{n}{diags\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{k}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{\PYZob{}0\PYZcb{}}\PY{l+s+s1}{\PYZdq{}}\PY{l+s+s1}{ : \PYZob{}1\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{diag}\PY{p}{,} \PY{n}{pn}\PY{o}{.}\PY{n}{diags\PYZus{}dict}\PY{p}{[}\PY{n}{diag}\PY{p}{]}\PY{p}{)}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
"[ArIII] (7751+7136)/9m" : ('Ar3', '(L(7751)+L(7136))/L(90000)', 'RMS([E(90000), E(7751)*L(7751)/(L(7751)+L(7136)), E(7136)*L(7136)/(L(7751)+L(7136))])')
"[ArIII] 5192/7136" : ('Ar3', 'L(5192)/L(7136)', 'RMS([E(7136), E(5192)])')
"[ArIII] 5192/7300+" : ('Ar3', 'L(5192)/(L(7751)+L(7136))', 'RMS([E(7751)*L(7751)/(L(7751)+L(7136)), E(7136)*L(7136)/(L(7751)+L(7136)), E(5192)])')
"[ArIII] 7136/9m" : ('Ar3', 'L(7136)/L(90000)', 'RMS([E(90000), E(7136)])')
"[ArIII] 9.0m/21.8m" : ('Ar3', 'L(89897)/L(218000)', 'RMS([E(89897), E(218000)])')
"[ArIV] 2860+/4720+" : ('Ar4', '(L(2854)+L(2868))/(L(4711)+L(4740))', 'RMS([E(4711)*L(4711)/(L(4711)+L(4740)), E(4740)*L(4740)/(L(4711)+L(4740)), E(2854)*L(2854)/(L(2854)+L(2868)), E(2868)*L(2854)/(L(2854)+L(2868))])')
"[ArIV] 4740/4711" : ('Ar4', 'L(4740)/L(4711)', 'RMS([E(4711), E(4740)])')
"[ArIV] 7230+/4720+" : ('Ar4', '(L(7170)+L(7263))/(L(4711)+L(4740))', 'RMS([E(4711)*L(4711)/(L(4711)+L(4740)), E(4740)*L(4740)/(L(4711)+L(4740)), E(7170)*L(7170)/(L(7170)+L(7263)), E(7263)*L(7263)/(L(7170)+L(7263))])')
"[ArV] 4626/6600+" : ('Ar5', 'L(4626)/(L(6435)+L(7005))', 'RMS([E(6435)*L(6435)/(L(6435)+L(7005)), E(7005)*L(7005)/(L(6435)+L(7005)), E(4626)])')
"[CIII] 1909/1907" : ('C3', 'L(1909)/L(1907)', 'RMS([E(1909), E(1907)])')
"[ClIII] 5538/5518" : ('Cl3', 'L(5538)/L(5518)', 'RMS([E(5518), E(5538)])')
"[ClIV] 5323/7531" : ('Cl4', 'L(5323)/L(7531)', 'RMS([E(7531), E(5323)])')
"[ClIV] 5323/7700+" : ('Cl4', 'L(5323)/(L(7531)+L(8046))', 'RMS([E(7531)*L(7531)/(L(7531)+L(8046)), E(8046)*L(8046)/(L(7531)+L(8046)), E(5323)])')
"[FeIII] 4659/4009" : ('Fe3', 'L(4659)/L(4009)', 'RMS([E(4659), E(4009)])')
"[FeIII] 4659/4701" : ('Fe3', 'L(4659)/L(4701)', 'RMS([E(4659), E(4701)])')
"[FeIII] 4659/4734" : ('Fe3', 'L(4659)/L(4734)', 'RMS([E(4659), E(4734)])')
"[FeIII] 4701/4009" : ('Fe3', 'L(4701)/L(4009)', 'RMS([E(4701), E(4009)])')
"[FeIII] 4701/4734" : ('Fe3', 'L(4701)/L(4734)', 'RMS([E(4701), E(4734)])')
"[FeIII] 4734/4009" : ('Fe3', 'L(4734)/L(4009)', 'RMS([E(4734), E(4009)])')
"[FeIII] 4881/4009" : ('Fe3', 'L(4881)/L(4009)', 'RMS([E(4881), E(4009)])')
"[FeIII] 4881/4659" : ('Fe3', 'L(4881)/L(4659)', 'RMS([E(4881), E(4659)])')
"[FeIII] 4881/4701" : ('Fe3', 'L(4881)/L(4701)', 'RMS([E(4881), E(4701)])')
"[FeIII] 4881/4734" : ('Fe3', 'L(4881)/L(4734)', 'RMS([E(4881), E(4734)])')
"[FeIII] 4881/4931" : ('Fe3', 'L(4881)/L(4931)', 'RMS([E(4881), E(4931)])')
"[FeIII] 4881/5011" : ('Fe3', 'L(4881)/L(5011)', 'RMS([E(4881), E(5011)])')
"[FeIII] 4925/4009" : ('Fe3', 'L(4925)/L(4009)', 'RMS([E(4925), E(4009)])')
"[FeIII] 4925/4659" : ('Fe3', 'L(4925)/L(4659)', 'RMS([E(4925), E(4659)])')
"[FeIII] 4925/4701" : ('Fe3', 'L(4925)/L(4701)', 'RMS([E(4925), E(4701)])')
"[FeIII] 4925/4734" : ('Fe3', 'L(4925)/L(4734)', 'RMS([E(4925), E(4734)])')
"[FeIII] 4925/4881" : ('Fe3', 'L(4925)/L(4881)', 'RMS([E(4925), E(4881)])')
"[FeIII] 4925/4931" : ('Fe3', 'L(4925)/L(4931)', 'RMS([E(4925), E(4931)])')
"[FeIII] 4925/5011" : ('Fe3', 'L(4925)/L(5011)', 'RMS([E(4925), E(5011)])')
"[FeIII] 4931/4009" : ('Fe3', 'L(4931)/L(4009)', 'RMS([E(4931), E(4009)])')
"[FeIII] 4931/4659" : ('Fe3', 'L(4931)/L(4659)', 'RMS([E(4931), E(4659)])')
"[FeIII] 4931/4701" : ('Fe3', 'L(4931)/L(4701)', 'RMS([E(4931), E(4701)])')
"[FeIII] 4931/4734" : ('Fe3', 'L(4931)/L(4734)', 'RMS([E(4931), E(4734)])')
"[FeIII] 4987/4009" : ('Fe3', 'L(4987)/L(4009)', 'RMS([E(4987), E(4009)])')
"[FeIII] 4987/4659" : ('Fe3', 'L(4987)/L(4659)', 'RMS([E(4987), E(4659)])')
"[FeIII] 4987/4701" : ('Fe3', 'L(4987)/L(4701)', 'RMS([E(4987), E(4701)])')
"[FeIII] 4987/4734" : ('Fe3', 'L(4987)/L(4734)', 'RMS([E(4987), E(4734)])')
"[FeIII] 4987/4881" : ('Fe3', 'L(4987)/L(4881)', 'RMS([E(4987), E(4881)])')
"[FeIII] 4987/4925" : ('Fe3', 'L(4987)/L(4925)', 'RMS([E(4987), E(4925)])')
"[FeIII] 4987/4931" : ('Fe3', 'L(4987)/L(4931)', 'RMS([E(4987), E(4931)])')
"[FeIII] 4987/5011" : ('Fe3', 'L(4987)/L(5011)', 'RMS([E(4987), E(5011)])')
"[FeIII] 5011/4009" : ('Fe3', 'L(5011)/L(4009)', 'RMS([E(5011), E(4009)])')
"[FeIII] 5011/4659" : ('Fe3', 'L(5011)/L(4659)', 'RMS([E(5011), E(4659)])')
"[FeIII] 5011/4701" : ('Fe3', 'L(5011)/L(4701)', 'RMS([E(5011), E(4701)])')
"[FeIII] 5011/4734" : ('Fe3', 'L(5011)/L(4734)', 'RMS([E(5011), E(4734)])')
"[FeIII] 5011/4931" : ('Fe3', 'L(5011)/L(4931)', 'RMS([E(5011), E(4931)])')
"[FeIII] 5270/4009" : ('Fe3', 'L(5270)/L(4009)', 'RMS([E(5270), E(4009)])')
"[FeIII] 5270/4659" : ('Fe3', 'L(5270)/L(4659)', 'RMS([E(5270), E(4659)])')
"[FeIII] 5270/4701" : ('Fe3', 'L(5270)/L(4701)', 'RMS([E(5270), E(4701)])')
"[FeIII] 5270/4734" : ('Fe3', 'L(5270)/L(4734)', 'RMS([E(5270), E(4734)])')
"[FeIII] 5270/4881" : ('Fe3', 'L(5270)/L(4881)', 'RMS([E(5270), E(4881)])')
"[FeIII] 5270/4925" : ('Fe3', 'L(5270)/L(4925)', 'RMS([E(5270), E(4925)])')
"[FeIII] 5270/4931" : ('Fe3', 'L(5270)/L(4931)', 'RMS([E(5270), E(4931)])')
"[FeIII] 5270/4987" : ('Fe3', 'L(5270)/L(4987)', 'RMS([E(5270), E(4987)])')
"[FeIII] 5270/5011" : ('Fe3', 'L(5270)/L(5011)', 'RMS([E(5270), E(5011)])')
"[NIII] 1751+/57.4m" : ('N3', 'B("1751A+")/L(574000)', 'RMS([E(574000), BE("1751A+")])')
"[NII] 121m/20.5m" : ('N2', 'L(1214747)/L(2054427)', 'RMS([E(2054427)/E(1214747)])')
"[NII] 5755/6548" : ('N2', 'L(5755)/L(6548)', 'RMS([E(6548), E(5755)])')
"[NII] 5755/6584" : ('N2', 'L(5755)/L(6584)', 'RMS([E(6584), E(5755)])')
"[NII] 5755/6584+" : ('N2', 'L(5755)/(L(6548)+L(6584))', 'RMS([E(6548)*L(6548)/(L(6548)+L(6584)), E(6584)*L(6584)/(L(6584)+L(6548)), E(5755)])')
"[NI] 5198/5200" : ('N1', 'I(3, 1)/I(2, 1)', 'RMS([E(5200), E(5198)])')
"[NeIII] 15.6m/36.0m" : ('Ne3', 'L(156000)/L(360000)', 'RMS([E(156000), E(360000)])')
"[NeIII] 3343/3930+" : ('Ne3', 'L(3343)/(L(3869)+L(3968))', 'RMS([E(3869)*L(3869)/(L(3869)+L(3968)), E(3968)*L(3968)/(L(3869)+L(3968)), E(3343)])')
"[NeIII] 3344/3930+" : ('Ne3', 'L(3343)/(L(3869)+L(3968))', 'RMS([E(3869)*L(3869)/(L(3869)+L(3968)), E(3968)*L(3968)/(L(3869)+L(3968)), E(3343)])')
"[NeIII] 3869/15.6m" : ('Ne3', 'L(3869)/L(156000)', 'RMS([E(156000), E(3869)])')
"[NeIII] 3930+/15.6m" : ('Ne3', '(L(3869)+L(3968))/L(156000)', 'RMS([E(156000), E(3869)*L(3869)/(L(3869)+L(3968)), E(3968)*L(3968)/(L(3869)+L(3968))])')
"[NeV] 14.3m/24.2m" : ('Ne5', 'L(143000)/L(242000)', 'RMS([E(143000), E(242000)])')
"[NeV] 1575/3426" : ('Ne5', 'L(1575)/L(3426)', 'RMS([E(1575), E(3426)])')
"[NeV] 2973/3370+" : ('Ne5', 'L(2973)/(L(3426)+L(3346))', 'RMS([E(3426)*L(3426)/(L(3426)+L(3346)), E(3346)*L(3346)/(L(3426)+L(3346)), E(2973)])')
"[NeV] 3426/24.2m" : ('Ne5', 'L(3426)/L(242000)', 'RMS([E(3426), E(242000)])')
"[NiIII] 6000/6401" : ('Ni3', 'L(6000)/L(6401)', 'RMS([E(6000), E(6401)])')
"[NiIII] 6000/6682" : ('Ni3', 'L(6000)/L(6682)', 'RMS([E(6000), E(6682)])')
"[NiIII] 6000/6797" : ('Ni3', 'L(6000)/L(6797)', 'RMS([E(6000), E(6797)])')
"[NiIII] 6000/7125" : ('Ni3', 'L(6000)/L(7125)', 'RMS([E(6000), E(7125)])')
"[NiIII] 6000/7890" : ('Ni3', 'L(6000)/L(7890)', 'RMS([E(6000), E(7890)])')
"[NiIII] 6000/8500" : ('Ni3', 'L(6000)/L(8500)', 'RMS([E(6000), E(8500)])')
"[NiIII] 6401/7125" : ('Ni3', 'L(6401)/L(7125)', 'RMS([E(6401), E(7125)])')
"[NiIII] 6401/7890" : ('Ni3', 'L(6401)/L(7890)', 'RMS([E(6401), E(7890)])')
"[NiIII] 6401/8500" : ('Ni3', 'L(6401)/L(8500)', 'RMS([E(6401), E(8500)])')
"[NiIII] 6534/6401" : ('Ni3', 'L(6534)/L(6401)', 'RMS([E(6534), E(6401)])')
"[NiIII] 6534/6682" : ('Ni3', 'L(6534)/L(6682)', 'RMS([E(6534), E(6682)])')
"[NiIII] 6534/6797" : ('Ni3', 'L(6534)/L(6797)', 'RMS([E(6534), E(6797)])')
"[NiIII] 6534/7125" : ('Ni3', 'L(6534)/L(7125)', 'RMS([E(6534), E(7125)])')
"[NiIII] 6534/7890" : ('Ni3', 'L(6534)/L(7890)', 'RMS([E(6534), E(7890)])')
"[NiIII] 6534/8500" : ('Ni3', 'L(6534)/L(8500)', 'RMS([E(6534), E(8500)])')
"[NiIII] 6682/7125" : ('Ni3', 'L(6682)/L(7125)', 'RMS([E(6682), E(7125)])')
"[NiIII] 6682/7890" : ('Ni3', 'L(6682)/L(7890)', 'RMS([E(6682), E(7890)])')
"[NiIII] 6682/8500" : ('Ni3', 'L(6682)/L(8500)', 'RMS([E(6682), E(8500)])')
"[NiIII] 6797/7125" : ('Ni3', 'L(6797)/L(7125)', 'RMS([E(6797), E(7125)])')
"[NiIII] 6797/7890" : ('Ni3', 'L(6797)/L(7890)', 'RMS([E(6797), E(7890)])')
"[NiIII] 6797/8500" : ('Ni3', 'L(6797)/L(8500)', 'RMS([E(6797), E(8500)])')
"[NiIII] 6946/6401" : ('Ni3', 'L(6946)/L(6401)', 'RMS([E(6946), E(6401)])')
"[NiIII] 6946/6682" : ('Ni3', 'L(6946)/L(6682)', 'RMS([E(6946), E(6682)])')
"[NiIII] 6946/6797" : ('Ni3', 'L(6946)/L(6797)', 'RMS([E(6946), E(6797)])')
"[NiIII] 6946/7125" : ('Ni3', 'L(6946)/L(7125)', 'RMS([E(6946), E(7125)])')
"[NiIII] 6946/7890" : ('Ni3', 'L(6946)/L(7890)', 'RMS([E(6946), E(7890)])')
"[NiIII] 6946/8500" : ('Ni3', 'L(6946)/L(8500)', 'RMS([E(6946), E(8500)])')
"[OIII] 1664+/5007" : ('O3', '(B("1664A+"))/L(5007)', 'RMS([BE("1664A+"), E(5007)])')
"[OIII] 1666/4363" : ('O3', 'L(1666)/L(4363)', 'RMS([E(4363), E(1666)])')
"[OIII] 1666/5007" : ('O3', 'L(1666)/L(5007)', 'RMS([E(5007), E(1666)])')
"[OIII] 1666/5007+" : ('O3', 'L(1666)/(L(5007)+L(4959))', 'RMS([E(5007)*L(5007)/(L(5007)+L(4959)), E(4959)*L(4959)/(L(5007)+L(4959)), E(1666)])')
"[OIII] 4363/5007" : ('O3', 'L(4363)/L(5007)', 'RMS([E(5007), E(4363)])')
"[OIII] 4363/5007+" : ('O3', 'L(4363)/(L(5007)+L(4959))', 'RMS([E(5007)*L(5007)/(L(5007)+L(4959)), E(4959)*L(4959)/(L(5007)+L(4959)), E(4363)])')
"[OIII] 5007/88m" : ('O3', 'L(5007)/L(883000)', 'RMS([E(883000), E(5007)])')
"[OIII] 51m/88m" : ('O3', 'L(518000)/L(883000)', 'RMS([E(883000), E(518000)])')
"[OII] 3726/3729" : ('O2', 'L(3726)/L(3729)', 'RMS([E(3729), E(3726)])')
"[OII] 3727+/7325+" : ('O2', '(L(3726)+L(3729))/(B("7319A+")+B("7330A+"))', 'RMS([E(3726)*L(3726)/(L(3726)+L(3729)), E(3729)*L(3729)/(L(3726)+L(3729)),BE("7319A+")*B("7319A+")/(B("7319A+")+B("7330A+")),BE("7330A+")*B("7330A+")/(B("7319A+")+B("7330A+"))])')
"[OIV] 1400+/25.9m" : ('O4', 'B("1400A+")/L(259000)', 'RMS([BE("1400A+"), E(259000)])')
"[OIV] 1401/1405" : ('O4', 'L(1401)/L(1405)', 'RMS([E(1401), E(1405)])')
"[OI] 5577/6300" : ('O1', 'L(5577)/L(6300)', 'RMS([E(6300), E(5577)])')
"[OI] 5577/6300+" : ('O1', 'L(5577)/(L(6300)+L(6364))', 'RMS([E(6300)*L(6300)/(L(6300)+L(6364)), E(6364)*L(6364)/(L(6300)+L(6364)), E(5577)])')
"[OI] 5577/6302" : ('O1', 'L(5577)/L(6300)', 'RMS([E(6300), E(5577)])')
"[OI] 63m/147m" : ('O1', 'L(632000)/L(1455000)', 'RMS([E(632000), E(1455000)])')
"[SIII] 18.7m/33.5m" : ('S3', 'L(187000)/L(335000)', 'RMS([E(335000), E(187000)])')
"[SIII] 6312/18.7m" : ('S3', 'L(6312)/L(187000)', 'RMS([E(187000), E(6312)])')
"[SIII] 6312/9069" : ('S3', 'L(6312)/L(9069)', 'RMS([E(9069), E(6312)])')
"[SIII] 6312/9200+" : ('S3', 'L(6312)/(L(9069)+L(9531))', 'RMS([E(9069)*L(9069)/(L(9069)+L(9531)), E(9531)*L(9531)/(L(9069)+L(9531)), E(6312)])')
"[SIII] 9069/18.7m" : ('S3', 'L(9069)/L(187000)', 'RMS([E(187000), E(9069)])')
"[SII] 4069/4076" : ('S2', 'L(4069)/L(4076)', 'RMS([E(4069), E(4076)])')
"[SII] 4072+/6720+" : ('S2', '(L(4069)+L(4076))/(L(6716)+L(6731))', 'RMS([E(6716)*L(6716)/(L(6716)+L(6731)), E(6731)*L(6731)/(L(6716)+L(6731)), E(4069)*L(4069)/(L(4069)+L(4076)), E(4076)*L(4076)/(L(4069)+L(4076))])')
"[SII] 6731/6716" : ('S2', 'L(6731)/L(6716)', 'RMS([E(6716), E(6731)])')

    \end{Verbatim}

    \subsubsection{Diagnostic diagram combining various atoms}

    The plotting tool included in the \textbf{Diagnostics} class requires an
\textbf{EmisGrid} dictionary (as returned by
\textbf{pn.getEmisGridDict}; see the previous section) and an
\textbf{Observation} object. The plot is obtained by:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}157}]:} \PY{n}{diags} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Diagnostics}\PY{p}{(}\PY{p}{)}
          \PY{n}{diags}\PY{o}{.}\PY{n}{addDiagsFromObs}\PY{p}{(}\PY{n}{obs}\PY{p}{)}
          \PY{k}{print}\PY{p}{(}\PY{n}{diags}\PY{o}{.}\PY{n}{diags}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
\{'[NeIII] 3869/15.6m': ('Ne3', 'L(3869)/L(156000)', 'RMS([E(156000), E(3869)])'), '[NII] 5755/6584': ('N2', 'L(5755)/L(6584)', 'RMS([E(6584), E(5755)])'), '[NeIII] 3930+/15.6m': ('Ne3', '(L(3869)+L(3968))/L(156000)', 'RMS([E(156000), E(3869)*L(3869)/(L(3869)+L(3968)), E(3968)*L(3968)/(L(3869)+L(3968))])'), '[OIII] 4363/5007': ('O3', 'L(4363)/L(5007)', 'RMS([E(5007), E(4363)])'), '[SIII] 6312/18.7m': ('S3', 'L(6312)/L(187000)', 'RMS([E(187000), E(6312)])'), '[SII] 4069/4076': ('S2', 'L(4069)/L(4076)', 'RMS([E(4069), E(4076)])'), '[SII] 4072+/6720+': ('S2', '(L(4069)+L(4076))/(L(6716)+L(6731))', 'RMS([E(6716)*L(6716)/(L(6716)+L(6731)), E(6731)*L(6731)/(L(6716)+L(6731)), E(4069)*L(4069)/(L(4069)+L(4076)), E(4076)*L(4076)/(L(4069)+L(4076))])'), '[OII] 3727+/7325+': ('O2', '(L(3726)+L(3729))/(B("7319A+")+B("7330A+"))', 'RMS([E(3726)*L(3726)/(L(3726)+L(3729)), E(3729)*L(3729)/(L(3726)+L(3729)),BE("7319A+")*B("7319A+")/(B("7319A+")+B("7330A+")),BE("7330A+")*B("7330A+")/(B("7319A+")+B("7330A+"))])'), '[OII] 3726/3729': ('O2', 'L(3726)/L(3729)', 'RMS([E(3729), E(3726)])'), '[NII] 5755/6548': ('N2', 'L(5755)/L(6548)', 'RMS([E(6548), E(5755)])'), '[SII] 6731/6716': ('S2', 'L(6731)/L(6716)', 'RMS([E(6716), E(6731)])'), '[NII] 5755/6584+': ('N2', 'L(5755)/(L(6548)+L(6584))', 'RMS([E(6548)*L(6548)/(L(6548)+L(6584)), E(6584)*L(6584)/(L(6584)+L(6548)), E(5755)])')\}

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}158}]:} \PY{o}{\PYZpc{}}\PY{k}{config} InlineBackend.figure\PYZus{}format = \PYZsq{}png\PYZsq{}
          \PY{n}{mpl}\PY{o}{.}\PY{n}{rc}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{savefig}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{dpi}\PY{o}{=}\PY{l+m+mi}{150}\PY{p}{)}
          \PY{n}{emisgrids} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getEmisGridDict}\PY{p}{(}\PY{n}{atomDict}\PY{o}{=}\PY{n}{diags}\PY{o}{.}\PY{n}{atomDict}\PY{p}{)}
          \PY{n}{diags}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{emisgrids}\PY{p}{,} \PY{n}{obs}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]

        ---------------------------------------------------------------------------

        ValueError                                Traceback (most recent call last)

        <ipython-input-158-2bf090738407> in <module>()
          2 mpl.rc("savefig", dpi=150)
          3 emisgrids = pn.getEmisGridDict(atomDict=diags.atomDict)
    ----> 4 diags.plot(emisgrids, obs)
    

        /home/morisset/anaconda2/lib/python2.7/site-packages/pyneb/core/diags.pyc in plot(self, emis\_grids, obs, quad, i\_obs, alpha, ax)
        535                     if tol\_value > 0.:
        536                         levels = [(1 - tol\_value) * diag\_value, (1 + tol\_value) * diag\_value]
    --> 537                         CS = ax.contourf(X, Y, diag\_map, levels=levels, alpha=alpha, colors=col)
        538                     CS = ax.contour(X, Y, diag\_map, levels=[diag\_value], colors=col, linestyles=style)
        539                     ax.set\_xlabel(r'log(n\$\_\{\textbackslash{}rm e\}\$) [cm\$\^{}\{-3\}\$]')


        /home/morisset/anaconda2/lib/python2.7/site-packages/matplotlib/\_\_init\_\_.pyc in inner(ax, *args, **kwargs)
       1810                     warnings.warn(msg \% (label\_namer, func.\_\_name\_\_),
       1811                                   RuntimeWarning, stacklevel=2)
    -> 1812             return func(ax, *args, **kwargs)
       1813         pre\_doc = inner.\_\_doc\_\_
       1814         if pre\_doc is None:


        /home/morisset/anaconda2/lib/python2.7/site-packages/matplotlib/axes/\_axes.pyc in contourf(self, *args, **kwargs)
       5650             self.cla()
       5651         kwargs['filled'] = True
    -> 5652         return mcontour.QuadContourSet(self, *args, **kwargs)
       5653     contourf.\_\_doc\_\_ = mcontour.QuadContourSet.contour\_doc
       5654 


        /home/morisset/anaconda2/lib/python2.7/site-packages/matplotlib/contour.pyc in \_\_init\_\_(self, ax, *args, **kwargs)
       1422         are described in QuadContourSet.contour\_doc.
       1423         """
    -> 1424         ContourSet.\_\_init\_\_(self, ax, *args, **kwargs)
       1425 
       1426     def \_process\_args(self, *args, **kwargs):


        /home/morisset/anaconda2/lib/python2.7/site-packages/matplotlib/contour.pyc in \_\_init\_\_(self, ax, *args, **kwargs)
        861         self.\_transform = kwargs.get('transform', None)
        862 
    --> 863         self.\_process\_args(*args, **kwargs)
        864         self.\_process\_levels()
        865 


        /home/morisset/anaconda2/lib/python2.7/site-packages/matplotlib/contour.pyc in \_process\_args(self, *args, **kwargs)
       1443                 self.\_corner\_mask = mpl.rcParams['contour.corner\_mask']
       1444 
    -> 1445             x, y, z = self.\_contour\_args(args, kwargs)
       1446 
       1447             \_mask = ma.getmask(z)


        /home/morisset/anaconda2/lib/python2.7/site-packages/matplotlib/contour.pyc in \_contour\_args(self, args, kwargs)
       1538             warnings.warn('Log scale: values of z <= 0 have been masked')
       1539             self.zmin = z.min()
    -> 1540         self.\_contour\_level\_args(z, args)
       1541         return (x, y, z)
       1542 


        /home/morisset/anaconda2/lib/python2.7/site-packages/matplotlib/contour.pyc in \_contour\_level\_args(self, z, args)
       1183             raise ValueError("Filled contours require at least 2 levels.")
       1184 
    -> 1185         if len(self.levels) > 1 and np.amin(np.diff(self.levels)) <= 0.0:
       1186             if hasattr(self, '\_corner\_mask') and self.\_corner\_mask == 'legacy':
       1187                 warnings.warn("Contour levels are not increasing")


        /home/morisset/anaconda2/lib/python2.7/site-packages/numpy/core/fromnumeric.pyc in amin(a, axis, out, keepdims)
       2352     else:
       2353         return \_methods.\_amin(a, axis=axis,
    -> 2354                               out=out, keepdims=keepdims)
       2355 
       2356 


        /home/morisset/anaconda2/lib/python2.7/site-packages/numpy/core/\_methods.pyc in \_amin(a, axis, out, keepdims)
         27 
         28 def \_amin(a, axis=None, out=None, keepdims=False):
    ---> 29     return umr\_minimum(a, axis, None, out, keepdims)
         30 
         31 def \_sum(a, axis=None, dtype=None, out=None, keepdims=False):


        ValueError: zero-size array to reduction operation minimum which has no identity

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_339_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    If there is more than one spectrum in the \textbf{Observation} object,
the index of the observation to be used is given by \textbf{i\_obs}:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{diags}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{emisgrids}\PY{p}{,} \PY{n}{obs}\PY{p}{,} \PY{n}{i\PYZus{}obs} \PY{o}{=} \PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{diags}\PY{o}{.}\PY{n}{diags}
\end{Verbatim}

    The label used to identify emission lines can be changed in the
\textbf{diags} object, using for example:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{diags}\PY{o}{.}\PY{n}{addClabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OIII] 4363/5007}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OIII]na}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \subsection{Determination of elemental abundances using ICFs}

    The determination of elemental abundances is complicated by the fact
that some ions are not observed. To take this into account when
computing the total abundances, it is necessary to use ionization
correction factors (ICFs). ICFs are expressions used to correct the
abundance of observed ions for unseen ions to get the total elemental
abundance of a given element: \[X(elem) = X(ion) * icf,\] where $X(ion)$
may be the abundance of one single ion or the sum of several ions of the
element. These expressions are generally obtained empirically or
semiempirically, based on the results of photoionization models or a
comparison between the ionization potentials of different ions. Most
expressions have been devised for a specific kind of object (e.g., PNe,
HII regions, etc) and should not be applied to objects of a different
kind.

In PyNeb, an icf formula is identified by an element (``elem'', e.g.
``O''), which is the element of which the total abundance is seeked for;
the ion or ions whose abundance is corrected (``atom'', e.g. ``O2+O3'');
and the icf proper, which is an expression involving the abundances of
other ions, assumed to be known (``icf'', e.g. ``1 + 0.5 * He3 / (He2 +
He3)''). In addition, each icf expressions is identified by a label and
holds the original reference and a brief comment specifying its intended
field of application. The label is formed by an acronym of the paper and
the equation number of the icf within the paper.

The following snippet illustrates how PyNeb manages icfs:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{atom\PYZus{}abun} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O2}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.001}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{0.002}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ne3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mf}{1.2e\PYZhy{}5}\PY{p}{\PYZcb{}}
        \PY{n}{icf} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{ICF}\PY{p}{(}\PY{p}{)}
        \PY{k}{print} \PY{n}{icf}\PY{o}{.}\PY{n}{getAvailableICFs}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ne}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}   \PY{c+c1}{\PYZsh{} lists all the available recipes for Ne}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{elem\PYZus{}abun} \PY{o}{=} \PY{n}{icf}\PY{o}{.}\PY{n}{getElemAbundance}\PY{p}{(}\PY{n}{atom\PYZus{}abun}\PY{p}{,} \PY{n}{icf\PYZus{}list}\PY{o}{=}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{TPP77\PYZus{}15}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)} \PY{c+c1}{\PYZsh{} Computes the Ne abundance with the TPP06 recipe}
        \PY{k}{print} \PY{n}{elem\PYZus{}abun}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{n}{elem\PYZus{}abun} \PY{o}{=} \PY{n}{icf}\PY{o}{.}\PY{n}{getElemAbundance}\PY{p}{(}\PY{n}{elem\PYZus{}abun}\PY{p}{)}  \PY{c+c1}{\PYZsh{} performs all the possible element abundance computations given the input ionic abundance set and available icf  }
        \PY{k}{print} \PY{n}{elem\PYZus{}abun}
\end{Verbatim}

    The first line above defines a set of ionic abundances; the second
defines an ICF object; the third lists the label of all the available
recipes for Ne; in the fourth, a specific one is selected to compute the
desired abundance; in the fifth line, all the possible element abundance
computations given the present icf set are performed (these may include
icfs not suitable for the object under study).

Additionally, PyNeb provides a series of single-line commands to explore
the icf collection and its source papers; e.g.:

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{icf}\PY{o}{.}\PY{n}{getAvailableICFs}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{icf}\PY{o}{.}\PY{n}{getExpression}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KH01\PYZus{}4g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}   \PY{c+c1}{\PYZsh{} returns the analytical expression of the icf identified by the label KH01\PYZus{}4g}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{icf}\PY{o}{.}\PY{n}{getReference}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KH01\PYZus{}4g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}   \PY{c+c1}{\PYZsh{} returns the bibliographic reference of the source paper}
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{k}{print} \PY{n}{icf}\PY{o}{.}\PY{n}{getURL}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KH01\PYZus{}4g}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}   \PY{c+c1}{\PYZsh{} returns the ADS URL of the source paper}
\end{Verbatim}

    PyNeb provides a large set of icfs compiled from the literature; each
icf is stored together with the bibliographic reference, the URL and a
comment with further details. Further expressions are being added
continuously, and a special function (\textbf{addICF}) enables users to
add customized expressions to the collection.

    \subsection{The logging facility}

    When importing PyNeb, a special object named \textbf{pn.log} is
instantiated to hold messages (error, warnings, normal messages and
debug tools). This object receives messages, writes them to the standard
output (and eventually to a file) and also holds them in memory. It can
also stop the execution and raise an error when error message is sent to
it. It also keeps track of which method in the code is sending the
message (the named \textbf{calling} parameter), and the time at which is
was sent.

There is a level of verbosity, which can be changed at any moment (e.g.
\emph{\emph{pn.log}.level = 2}\_), which determines the kind of messages
that will be printed to the standard output (commonly the screen).

\textbf{pn.log} can manage 5 types of messages:

    \begin{itemize}
\item
  \textbf{debug}: using \emph{\emph{pn.log}.debug(`This is the message',
  calling = `Routine1')}\_; it is printed if pn.log\_level
  \textgreater{}= 4.
\item
  \textbf{message}: using \emph{\emph{pn.log}.message(`This is the
  message', calling = `Routine1')}\_; it is printed if pn.log\_level
  \textgreater{}= 3.
\item
  \textbf{warning}: using \textbf{pn.log\_warn(`This is the warning',
  calling = `Routine1')}; it is printed if pn.log\_level \textgreater{}=
  2.
\item
  \textbf{error}: using \textbf{pn.log\_error(`This is the error',
  calling = `Routine1')}; it is printed if pn.log\_level \textgreater{}=
  1. When error is called, an error is raised using exception
  PyNebError, unless the exception argument is given. This default
  behavior is altered by changing pn.log\_.no\_exit to False, in which
  case a SystemExit~exception is raised (and the program stops).
\item
  \textbf{timer}: using \emph{\emph{pn.log}.timer(`Ending the process',
  calling = `Routine1', quiet = False)}\_. This method prints (if quiet
  = True) the message with the time spent since the last call of timer.
\end{itemize}

    At any moment in a script file, the verbosity can be changed either to
see what's happening, or to avoid being annoyed by too many messages.

    \section{Sample scripts}

    \subsection{Simple diagnostic diagram}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{o}{\PYZpc{}\PYZpc{}}\PY{k}{writefile} smc24.dat
        NAME SMC\PYZus{}24
        cHbeta     0.047
        S4\PYZus{}10.5m   7.00000
        Ne2\PYZus{}12.8m  8.3000
        Ne3\PYZus{}15.6m 34.10
        S3\PYZus{}18.7m  10.
        O2\PYZus{}3726A  39.700
        O2\PYZus{}3729A  18.600
        Ne3\PYZus{}3869A 18.90
        Ne3\PYZus{}3968A  6.4
        S2\PYZus{}4069A   0.85
        S2\PYZus{}4076A   0.450
        O3\PYZus{}4363A   4.36
        O3\PYZus{}5007A 435.09
        N2\PYZus{}5755A   0.510000
        S3\PYZus{}6312A   0.76
        O1\PYZus{}6300A   1.69
        O1\PYZus{}6364A   0.54
        N2\PYZus{}6548A   6.840000
        N2\PYZus{}6584A  19.00
        S2\PYZus{}6716A   1.220000
        S2\PYZus{}6731A   2.180000
        Ar3\PYZus{}7136A  4.91
        O2\PYZus{}7319A+   6.540000
        O2\PYZus{}7330A+   5.17
        S3\PYZus{}33.6m    8.
\end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Diagnostic plot}
        
        \PY{c+c1}{\PYZsh{} Imports}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
        \PY{o}{\PYZpc{}}\PY{k}{config} InlineBackend.figure\PYZus{}format = \PYZsq{}png\PYZsq{}
        \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} General settings}
        \PY{c+c1}{\PYZsh{} Setting verbosity level. Enter pn.my\PYZus{}logging? for details}
        \PY{n}{pn}\PY{o}{.}\PY{n}{log\PYZus{}}\PY{o}{.}\PY{n}{level} \PY{o}{=} \PY{l+m+mi}{2} \PY{c+c1}{\PYZsh{} set this to 3 to have more details}
        
        \PY{c+c1}{\PYZsh{} Adopt an extinction law}
        \PY{n}{extinction\PYZus{}law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CCM89}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} Define the data file}
        \PY{n}{obs\PYZus{}data} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{smc24.dat}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} Define plot title}
        \PY{n}{title} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SMC 24}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Read and deredden observational data}
        \PY{c+c1}{\PYZsh{} define an Observation object and assign it to name \PYZsq{}obs\PYZsq{}}
        \PY{n}{obs} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} fill obs with data read from file obs\PYZus{}data, with lines varying across rows and a default percent error on line intensities}
        \PY{n}{obs}\PY{o}{.}\PY{n}{readData}\PY{p}{(}\PY{n}{obs\PYZus{}data}\PY{p}{,} \PY{n}{fileFormat}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lines\PYZus{}in\PYZus{}rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{err\PYZus{}default}\PY{o}{=}\PY{l+m+mf}{0.05}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} deredden data with Cardelli\PYZsq{}s law}
        \PY{n}{obs}\PY{o}{.}\PY{n}{extinction}\PY{o}{.}\PY{n}{law} \PY{o}{=} \PY{n}{extinction\PYZus{}law}
        \PY{n}{obs}\PY{o}{.}\PY{n}{correctData}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Include the diagnostics of interest}
        \PY{c+c1}{\PYZsh{} instantiate the Diagnostics class}
        \PY{n}{diags} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Diagnostics}\PY{p}{(}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} include in diags the relevant line ratios}
        \PY{n}{diags}\PY{o}{.}\PY{n}{addDiag}\PY{p}{(}\PY{p}{[}
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NII] 5755/6584}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OII] 3726/3729}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OIII] 4363/5007}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 6731/6716}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 4072+/6720+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SIII] 6312/18.7m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NeIII] 3930+/15.6m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                      \PY{p}{]}\PY{p}{)}
        \PY{n}{diags}\PY{o}{.}\PY{n}{addClabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 6731/6716}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII]a}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{diags}\PY{o}{.}\PY{n}{addClabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 4072+/6720+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII]b}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Create the emission maps to be compared to the observation data (some overkill here)}
        \PY{n}{emisgrids} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getEmisGridDict}\PY{p}{(}\PY{n}{atom\PYZus{}list}\PY{o}{=}\PY{n}{diags}\PY{o}{.}\PY{n}{getUniqueAtoms}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{den\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{1e6}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}\PYZsh{}\PYZsh{} Plot}
        \PY{c+c1}{\PYZsh{} Create the contour plot as the intersection of tem\PYZhy{}den emission maps with dereddened line ratios}
        \PY{n}{diags}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{emisgrids}\PY{p}{,} \PY{n}{obs}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Place the title}
        \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{n}{title}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Display the plot}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{}The observed ratio can be automatically extracted from an Observation object named obs:}
        \PY{n}{Te}\PY{p}{,} \PY{n}{Ne} \PY{o}{=} \PY{n}{diags}\PY{o}{.}\PY{n}{getCrossTemDen}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NII] 5755/6548}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 6731/6716}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{obs}\PY{o}{=}\PY{n}{obs}\PY{p}{)}
        \PY{k}{print} \PY{n}{Te}\PY{p}{,} \PY{n}{Ne}
\end{Verbatim}

    \subsection{Extinction}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Sample extinction in PyNeb}
        \PY{c+c1}{\PYZsh{} shows how to display available extinction laws, select one or define a new one,}
        \PY{c+c1}{\PYZsh{} and do some simple dereddening calculations}
        \PY{c+c1}{\PYZsh{} Further examples can be found in other sample scripts}
        \PY{o}{\PYZpc{}}\PY{k}{config} InlineBackend.figure\PYZus{}format = \PYZsq{}svg\PYZsq{}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
        
        \PY{c+c1}{\PYZsh{} Convert wavelength to x}
        \PY{k}{def} \PY{n+nf}{x}\PY{p}{(}\PY{n}{wave}\PY{p}{)}\PY{p}{:}
            \PY{k}{return} \PY{l+m+mf}{10000.} \PY{o}{/} \PY{n}{wave}
        
        \PY{c+c1}{\PYZsh{} Define an extinction law (to be used below)}
        \PY{k}{def} \PY{n+nf}{my\PYZus{}X}\PY{p}{(}\PY{n}{wave}\PY{p}{,} \PY{n}{par}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}\PY{p}{:}
            \PY{n}{x} \PY{o}{=} \PY{l+m+mf}{10000.} \PY{o}{/} \PY{n}{wave}
            \PY{n}{Rv} \PY{o}{=} \PY{l+m+mf}{3.1}
            \PY{n}{X\PYZus{}lin} \PY{o}{=} \PY{n}{x}\PY{o}{/}\PY{l+m+mf}{2.} \PY{c+c1}{\PYZsh{} linear part of the extinction law}
            \PY{n}{X\PYZus{}bump} \PY{o}{=} \PY{l+m+mf}{0.5}\PY{o}{*}\PY{n}{x}\PY{o}{*}\PY{o}{*}\PY{l+m+mf}{2.} \PY{o}{\PYZhy{}}\PY{l+m+mi}{6}\PY{o}{*}\PY{n}{x} \PY{o}{+} \PY{l+m+mf}{20.} \PY{c+c1}{\PYZsh{} bump part of the extinction law}
            \PY{k}{return} \PY{n}{Rv}\PY{o}{*}\PY{n}{np}\PY{o}{.}\PY{n}{where}\PY{p}{(}\PY{n}{x}\PY{o}{\PYZlt{}}\PY{l+m+mf}{5.}\PY{p}{,} \PY{n}{X\PYZus{}lin}\PY{p}{,} \PY{n}{X\PYZus{}bump}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Define a reddening correction object}
        \PY{n}{RC} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} List the available laws}
        \PY{c+c1}{\PYZsh{}RC.printLaws()}
        
        \PY{c+c1}{\PYZsh{} Plot the available laws}
        \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
        \PY{n}{RC}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{laws}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{all}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Choose the one we intend to use }
        \PY{n}{RC}\PY{o}{.}\PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CCM89}\PY{l+s+s1}{\PYZsq{}}
        \PY{c+c1}{\PYZsh{} or define a new one}
        \PY{n}{RC}\PY{o}{.}\PY{n}{UserFunction} \PY{o}{=} \PY{n}{my\PYZus{}X}
        \PY{n}{RC}\PY{o}{.}\PY{n}{law} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{user}\PY{l+s+s1}{\PYZsq{}}
        
        \PY{c+c1}{\PYZsh{} Plot the selected law as a function of x}
        \PY{c+c1}{\PYZsh{} Define an array in lambda to do the plot}
        \PY{n}{wave}\PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{logspace}\PY{p}{(}\PY{l+m+mf}{2.5}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{,} \PY{l+m+mi}{100}\PY{p}{)}
        \PY{c+c1}{\PYZsh{} Plot commands}
        \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
        \PY{n}{ax} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{]}\PY{p}{)}
        \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}xlim}\PY{p}{(}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{]}\PY{p}{)}
        \PY{n}{ax}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{x}\PY{p}{(}\PY{n}{wave}\PY{p}{)}\PY{p}{,} \PY{n}{my\PYZus{}X}\PY{p}{(}\PY{n}{wave}\PY{p}{)}\PY{p}{,} \PY{n}{label}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+si}{\PYZpc{}s}\PY{l+s+s1}{\PYZsq{}} \PY{o}{\PYZpc{}} \PY{p}{(}\PY{n}{RC}\PY{o}{.}\PY{n}{law}\PY{p}{)}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{1/\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{lambda\PYZdl{} (\PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{mu\PYZca{}\PYZob{}\PYZhy{}1\PYZcb{}\PYZdl{})}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{A\PYZdl{}\PYZus{}V\PYZdl{}/E(B\PYZhy{}V)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{upper left}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Correct observed line ratios}
        \PY{n}{wave1} \PY{o}{=} \PY{l+m+mi}{5007}
        \PY{n}{I\PYZus{}obs1} \PY{o}{=} \PY{l+m+mf}{4.0}
        \PY{n}{wave2} \PY{o}{=} \PY{l+m+mi}{4686}
        \PY{n}{I\PYZus{}obs2} \PY{o}{=} \PY{l+m+mf}{0.10}
        
        \PY{c+c1}{\PYZsh{} Correct based on the given law and the observed Ha/Hb ratio}
        \PY{n}{RC} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{n}{law}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CCM89}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
        \PY{n}{I\PYZus{}obs\PYZus{}HaHb} \PY{o}{=} \PY{l+m+mf}{3.5} 
        \PY{n}{I\PYZus{}theo\PYZus{}HaHb} \PY{o}{=} \PY{l+m+mf}{2.86} 
        \PY{n}{RC}\PY{o}{.}\PY{n}{setCorr}\PY{p}{(}\PY{n}{I\PYZus{}obs\PYZus{}HaHb} \PY{o}{/} \PY{n}{I\PYZus{}theo\PYZus{}HaHb}\PY{p}{,} \PY{l+m+mf}{6563.}\PY{p}{,} \PY{l+m+mf}{4861.}\PY{p}{)}
        \PY{k}{print} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Correction based on the given law and the observed Ha/Hb ratio:}\PY{l+s+s1}{\PYZsq{}}
        \PY{k}{print} \PY{n+nb}{str}\PY{p}{(}\PY{n}{wave1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: I\PYZus{}obs =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ I\PYZus{}dered =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs1} \PY{o}{*} \PY{n}{RC}\PY{o}{.}\PY{n}{getCorrHb}\PY{p}{(}\PY{n}{wave1}\PY{p}{)}
        \PY{k}{print} \PY{n+nb}{str}\PY{p}{(}\PY{n}{wave2}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: I\PYZus{}obs =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ I\PYZus{}dered =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs2} \PY{o}{*} \PY{n}{RC}\PY{o}{.}\PY{n}{getCorrHb}\PY{p}{(}\PY{n}{wave2}\PY{p}{)}
        
        \PY{c+c1}{\PYZsh{} Correct based on the given law and c(Hb)}
        \PY{n}{RC} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{RedCorr}\PY{p}{(}\PY{n}{law}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CCM89}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cHbeta}\PY{o}{=}\PY{l+m+mf}{0.3}\PY{p}{)}
        \PY{k}{print} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+se}{\PYZbs{}n}\PY{l+s+s1}{Correction based on the given law and c(Hbeta):}\PY{l+s+s1}{\PYZsq{}}
        \PY{k}{print} \PY{n+nb}{str}\PY{p}{(}\PY{n}{wave1}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: I\PYZus{}obs =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ I\PYZus{}dered =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs1} \PY{o}{*} \PY{n}{RC}\PY{o}{.}\PY{n}{getCorrHb}\PY{p}{(}\PY{n}{wave1}\PY{p}{)}
        \PY{k}{print} \PY{n+nb}{str}\PY{p}{(}\PY{n}{wave2}\PY{p}{)} \PY{o}{+} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{: I\PYZus{}obs =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ I\PYZus{}dered =}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{I\PYZus{}obs2} \PY{o}{*} \PY{n}{RC}\PY{o}{.}\PY{n}{getCorrHb}\PY{p}{(}\PY{n}{wave2}\PY{p}{)}
\end{Verbatim}

    \subsection{Line ratio and diagnostics}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}159}]:} \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
          \PY{l+s+sd}{Sample PyNeb script}
          \PY{l+s+sd}{Plots the [O III] 4363/5007 ratio as a function of Te for several Ne values}
          \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
          
          \PY{c+c1}{\PYZsh{} Import relevant packages}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          
          \PY{c+c1}{\PYZsh{} Set high verbosity level to keep track of atom creation}
          \PY{n}{pn}\PY{o}{.}\PY{n}{log\PYZus{}}\PY{o}{.}\PY{n}{level} \PY{o}{=} \PY{l+m+mi}{2} \PY{c+c1}{\PYZsh{} Set to 3 if you want all the atoms to be printed out}
          
          \PY{c+c1}{\PYZsh{} Create a collection of atoms \PYZhy{} a bit overkill if we just need O III}
          \PY{n}{adict} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getAtomDict}\PY{p}{(}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Lower verbosity level}
          \PY{n}{pn}\PY{o}{.}\PY{n}{log\PYZus{}}\PY{o}{.}\PY{n}{level} \PY{o}{=} \PY{l+m+mi}{2}
          
          \PY{c+c1}{\PYZsh{} Function to compute line ratio}
          \PY{k}{def} \PY{n+nf}{line\PYZus{}ratio}\PY{p}{(}\PY{n}{atom}\PY{p}{,} \PY{n}{wave1}\PY{p}{,} \PY{n}{wave2}\PY{p}{,} \PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{)}\PY{p}{:}
              \PY{n}{emis1} \PY{o}{=} \PY{n}{adict}\PY{p}{[}\PY{n}{atom}\PY{p}{]}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{,} \PY{n}{wave} \PY{o}{=} \PY{n}{wave1}\PY{p}{)}
              \PY{n}{emis2} \PY{o}{=} \PY{n}{adict}\PY{p}{[}\PY{n}{atom}\PY{p}{]}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{,} \PY{n}{wave} \PY{o}{=} \PY{n}{wave2}\PY{p}{)}
              \PY{k}{return} \PY{n}{emis1} \PY{o}{/} \PY{n}{emis2}
          
          \PY{c+c1}{\PYZsh{} Define array of Te }
          \PY{n}{tem} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{5000}\PY{p}{,} \PY{l+m+mi}{18000}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot}
          \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{)}
          \PY{k}{for} \PY{n}{den} \PY{o+ow}{in} \PY{p}{[}\PY{l+m+mf}{1e2}\PY{p}{,} \PY{l+m+mf}{1e3}\PY{p}{,} \PY{l+m+mf}{1e4}\PY{p}{,} \PY{l+m+mf}{1e5}\PY{p}{]}\PY{p}{:}
              \PY{n}{plt}\PY{o}{.}\PY{n}{semilogy}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{line\PYZus{}ratio}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{4363}\PY{p}{,} \PY{l+m+mi}{5007}\PY{p}{,} \PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{)}\PY{p}{,} \PY{n}{label} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Ne=\PYZob{}0:.0e\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{den}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T\PYZdl{}\PYZus{}e\PYZdl{} [K]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{r\PYZsq{}}\PY{l+s+s1}{[OIII] 4363/5007 \PYZdl{}}\PY{l+s+s1}{\PYZbs{}}\PY{l+s+s1}{AA\PYZdl{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+m+mi}{2}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_367_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Contour plots}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}160}]:} \PY{c+c1}{\PYZsh{} Plot the contour diagram of the selected diagnostics}
          \PY{c+c1}{\PYZsh{} Warning: it takes a long time to plot the 80 contours}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          \PY{k+kn}{from} \PY{n+nn}{pyneb.core.diags} \PY{k+kn}{import} \PY{n}{diags\PYZus{}dict}
          
          \PY{n}{Nx} \PY{o}{=} \PY{l+m+mi}{2} 
          \PY{n}{Ny} \PY{o}{=} \PY{l+m+mi}{6} \PY{c+c1}{\PYZsh{} must be changed to 30 to obtain all the plots}
          \PY{n}{pn}\PY{o}{.}\PY{n}{log\PYZus{}}\PY{o}{.}\PY{n}{level}\PY{o}{=}\PY{l+m+mi}{1}
          \PY{n}{AA} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getAtomDict}\PY{p}{(}\PY{n}{OmegaInterp}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Linear}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{c+c1}{\PYZsh{} Loop over all the diags stored in pn.core.diags.diags\PYZus{}dict}
          \PY{n}{fig}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{n}{Ny}\PY{p}{,} \PY{n}{Nx}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{5}\PY{o}{*}\PY{n}{Nx}\PY{p}{,} \PY{l+m+mi}{5}\PY{o}{*}\PY{n}{Ny}\PY{p}{)}\PY{p}{)}
          \PY{n}{i\PYZus{}ax} \PY{o}{=} \PY{l+m+mi}{0}
          \PY{k}{for} \PY{n}{diag} \PY{o+ow}{in} \PY{n}{np}\PY{o}{.}\PY{n}{sort}\PY{p}{(}\PY{n}{diags\PYZus{}dict}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{:}
              \PY{n}{atom}\PY{p}{,} \PY{n}{diag\PYZus{}eval}\PY{p}{,} \PY{n}{err} \PY{o}{=} \PY{n}{diags\PYZus{}dict}\PY{p}{[}\PY{n}{diag}\PY{p}{]}
              \PY{c+c1}{\PYZsh{} Skip Fe III as they are so many}
              \PY{k}{if} \PY{p}{(}\PY{n}{atom} \PY{o+ow}{in} \PY{n}{AA}\PY{p}{)} \PY{o+ow}{and} \PY{p}{(}\PY{n}{atom} \PY{o}{!=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Fe3}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{:}
                  \PY{k}{if} \PY{n}{i\PYZus{}ax} \PY{o}{\PYZlt{}} \PY{n}{Nx}\PY{o}{*}\PY{n}{Ny}\PY{p}{:}
                      \PY{n}{ax} \PY{o}{=} \PY{n}{axes}\PY{o}{.}\PY{n}{ravel}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{n}{i\PYZus{}ax}\PY{p}{]}
                      \PY{n}{grid} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmisGrid}\PY{p}{(}\PY{n}{atomObj}\PY{o}{=}\PY{n}{AA}\PY{p}{[}\PY{n}{atom}\PY{p}{]}\PY{p}{)}
                      \PY{n}{grid}\PY{o}{.}\PY{n}{plotContours}\PY{p}{(}\PY{n}{to\PYZus{}eval}\PY{o}{=}\PY{n}{diag\PYZus{}eval}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{ax}\PY{p}{)}
                      \PY{k}{if} \PY{n}{i\PYZus{}ax} \PY{o}{!=} \PY{p}{(}\PY{n}{Nx} \PY{o}{*} \PY{p}{(}\PY{n}{Ny}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}\PY{p}{)}\PY{p}{:}
                          \PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}xaxis}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}visible}\PY{p}{(}\PY{n+nb+bp}{False}\PY{p}{)}
                          \PY{n}{ax}\PY{o}{.}\PY{n}{get\PYZus{}yaxis}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{set\PYZus{}visible}\PY{p}{(}\PY{n+nb+bp}{False}\PY{p}{)}
                      \PY{n}{i\PYZus{}ax} \PY{o}{+}\PY{o}{=} \PY{l+m+mi}{1}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_369_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \subsection{Diagnostic diagrams of a 2-components region}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}161}]:} \PY{c+c1}{\PYZsh{} Analysis plot of a simple two\PYZhy{}component model, meant to illustrate the bias arising }
          \PY{c+c1}{\PYZsh{} from assuming that the region is homogeneous in density}
          \PY{c+c1}{\PYZsh{} First, an emission region made up of two different subregions is modelled,}
          \PY{c+c1}{\PYZsh{} each with a different mass and density. The resulting overall emissivity is computed}
          \PY{c+c1}{\PYZsh{} Second, the region is analyzed as if it were a homogeneous region}
          
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          \PY{k+kn}{from} \PY{n+nn}{pyneb.utils.misc} \PY{k+kn}{import} \PY{n}{parseAtom}
          
          \PY{k}{def} \PY{n+nf}{plot\PYZus{}2comp}\PY{p}{(}\PY{n}{tem1}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{tem2}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{dens1}\PY{o}{=}\PY{l+m+mf}{3e2}\PY{p}{,} \PY{n}{dens2}\PY{o}{=}\PY{l+m+mf}{5e5}\PY{p}{,} \PY{n}{mass1}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mass2}\PY{o}{=}\PY{l+m+mf}{5e\PYZhy{}4}\PY{p}{)}\PY{p}{:}
                  
              \PY{c+c1}{\PYZsh{} List of diagnostics used to analyze the region}
              \PY{n}{diags} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Diagnostics}\PY{p}{(}\PY{p}{)}
              
              \PY{n}{diags}\PY{o}{.}\PY{n}{addDiag}\PY{p}{(}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NI] 5198/5200}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                             \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[NII] 5755/6548}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OII] 3726/3729}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OII] 3727+/7325+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[OIII] 4363/5007}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[ArIII] 5192/7136}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[ArIII] 5192/7300+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[ArIV] 4740/4711}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[ArIV] 7230+/4720+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 6731/6716}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SII] 4072+/6720+}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[SIII] 6312/9069}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                              \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[ClIII] 5538/5518}\PY{l+s+s1}{\PYZsq{}}
                              \PY{p}{]}\PY{p}{)}
              \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}    }
          \PY{l+s+sd}{    for diag in pn.diags\PYZus{}dict:}
          \PY{l+s+sd}{        if diag[0:7] != \PYZsq{}[FeIII]\PYZsq{}:}
          \PY{l+s+sd}{            diags.addDiag(diag)}
          \PY{l+s+sd}{            print \PYZsq{}Adding\PYZsq{}, diag}
          \PY{l+s+sd}{    diags.addClabel(\PYZsq{}[SIII] 6312/9069\PYZsq{}, \PYZsq{}[SIII]A\PYZsq{})}
          \PY{l+s+sd}{    diags.addClabel(\PYZsq{}[OIII] 4363/5007\PYZsq{}, \PYZsq{}[OIII]A\PYZsq{})}
          \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}    
              \PY{c+c1}{\PYZsh{} Define all the ions that are involved in the diagnostics}
              \PY{n}{adict} \PY{o}{=} \PY{n}{diags}\PY{o}{.}\PY{n}{atomDict}
              \PY{n}{pn}\PY{o}{.}\PY{n}{log\PYZus{}}\PY{o}{.}\PY{n}{message}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Atoms built}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              
              \PY{n}{obs} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{Observation}\PY{p}{(}\PY{n}{corrected} \PY{o}{=} \PY{n+nb+bp}{True}\PY{p}{)}
              \PY{k}{for} \PY{n}{atom} \PY{o+ow}{in} \PY{n}{adict}\PY{p}{:}
                  \PY{c+c1}{\PYZsh{} Computes all the intensities of all the lines of all the ions considered}
                   \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{pn}\PY{o}{.}\PY{n}{LINE\PYZus{}LABEL\PYZus{}LIST}\PY{p}{[}\PY{n}{atom}\PY{p}{]}\PY{p}{:}
                      \PY{k}{if} \PY{n}{line}\PY{p}{[}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]} \PY{o}{==} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{m}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}
                          \PY{n}{wavelength} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{line}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{o}{*}\PY{l+m+mf}{1e4}
                      \PY{k}{else}\PY{p}{:}
                          \PY{n}{wavelength} \PY{o}{=} \PY{n+nb}{float}\PY{p}{(}\PY{n}{line}\PY{p}{[}\PY{p}{:}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}
                      \PY{n}{elem}\PY{p}{,} \PY{n}{spec} \PY{o}{=} \PY{n}{parseAtom}\PY{p}{(}\PY{n}{atom}\PY{p}{)}
                      \PY{n}{intens1} \PY{o}{=} \PY{n}{adict}\PY{p}{[}\PY{n}{atom}\PY{p}{]}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem1}\PY{p}{,} \PY{n}{dens1}\PY{p}{,} \PY{n}{wave} \PY{o}{=} \PY{n}{wavelength}\PY{p}{)} \PY{o}{*} \PY{n}{dens1} \PY{o}{*} \PY{n}{mass1}
                      \PY{n}{intens2} \PY{o}{=} \PY{n}{adict}\PY{p}{[}\PY{n}{atom}\PY{p}{]}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem2}\PY{p}{,} \PY{n}{dens2}\PY{p}{,} \PY{n}{wave} \PY{o}{=} \PY{n}{wavelength}\PY{p}{)} \PY{o}{*} \PY{n}{dens2} \PY{o}{*} \PY{n}{mass2}
                      \PY{n}{obs}\PY{o}{.}\PY{n}{addLine}\PY{p}{(}\PY{n}{pn}\PY{o}{.}\PY{n}{EmissionLine}\PY{p}{(}\PY{n}{elem}\PY{p}{,} \PY{n}{spec}\PY{p}{,} \PY{n}{wavelength}\PY{p}{,}
                                                   \PY{n}{obsIntens}\PY{o}{=}\PY{p}{[}\PY{n}{intens1}\PY{p}{,} \PY{n}{intens2}\PY{p}{,} \PY{n}{intens1}\PY{o}{+}\PY{n}{intens2}\PY{p}{]}\PY{p}{,} 
                                                   \PY{n}{obsError}\PY{o}{=}\PY{p}{[}\PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{,} \PY{l+m+mf}{0.0}\PY{p}{]}\PY{p}{)}\PY{p}{)}
              
              \PY{n}{pn}\PY{o}{.}\PY{n}{log\PYZus{}}\PY{o}{.}\PY{n}{message}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Virtual observations computed}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              \PY{n}{emisgrids} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{getEmisGridDict}\PY{p}{(}\PY{n}{atomDict}\PY{o}{=}\PY{n}{adict}\PY{p}{)}
              
              \PY{n}{pn}\PY{o}{.}\PY{n}{log\PYZus{}}\PY{o}{.}\PY{n}{message}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EmisGrids available}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
              
              \PY{c+c1}{\PYZsh{} Produce a diagnostic plot for each of the two regions and another one for the }
              \PY{c+c1}{\PYZsh{} (misanalyzed) overall region}
              \PY{n}{f}\PY{p}{,} \PY{n}{axes} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{subplots}\PY{p}{(}\PY{l+m+mi}{3}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}\PY{p}{)}
              \PY{k}{for} \PY{n}{i\PYZus{}obs} \PY{o+ow}{in} \PY{p}{(}\PY{l+m+mi}{0}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{2}\PY{p}{)}\PY{p}{:}
                  \PY{n}{diags}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{emisgrids}\PY{p}{,} \PY{n}{obs}\PY{p}{,} \PY{n}{i\PYZus{}obs}\PY{o}{=}\PY{n}{i\PYZus{}obs}\PY{p}{,} \PY{n}{ax}\PY{o}{=}\PY{n}{axes}\PY{p}{[}\PY{n}{i\PYZus{}obs}\PY{p}{]}\PY{p}{)}
          
          \PY{n}{plot\PYZus{}2comp}\PY{p}{(}\PY{n}{tem1}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{tem2}\PY{o}{=}\PY{l+m+mf}{1e4}\PY{p}{,} \PY{n}{dens1}\PY{o}{=}\PY{l+m+mf}{3e2}\PY{p}{,} \PY{n}{dens2}\PY{o}{=}\PY{l+m+mf}{5e5}\PY{p}{,} \PY{n}{mass1}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{mass2}\PY{o}{=}\PY{l+m+mf}{5e\PYZhy{}4}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_371_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Diagnostic diagrams of a 2-components region¶}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}162}]:} \PY{c+c1}{\PYZsh{} Emissivity plot}
          \PY{c+c1}{\PYZsh{} For a quick and dirty plot, see also o3.plotEmiss}
          
          \PY{c+c1}{\PYZsh{} Imports}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k+kn}{as} \PY{n+nn}{np}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          
          \PY{c+c1}{\PYZsh{} Atom creation and definition of physical conditions }
          \PY{n}{o3}\PY{o}{=}\PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{)}
          \PY{n}{tem}\PY{o}{=}\PY{n}{np}\PY{o}{.}\PY{n}{arange}\PY{p}{(}\PY{l+m+mi}{100}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{300}\PY{o}{+}\PY{l+m+mi}{300}
          \PY{n}{den} \PY{o}{=} \PY{l+m+mi}{1000}
          
          \PY{c+c1}{\PYZsh{} Comment the second if you want all the lines to be plotted}
          \PY{n}{lineList}\PY{o}{=}\PY{n}{o3}\PY{o}{.}\PY{n}{lineList}
          \PY{n}{lineList}\PY{o}{=}\PY{p}{[}\PY{l+m+mi}{1666}\PY{p}{,} \PY{l+m+mi}{4363}\PY{p}{,} \PY{l+m+mi}{4959}\PY{p}{,} \PY{l+m+mi}{5007}\PY{p}{,} \PY{l+m+mi}{518000}\PY{p}{,} \PY{l+m+mi}{880000}\PY{p}{]}
          
          \PY{c+c1}{\PYZsh{} Plot	}
          \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{p}{)}
          \PY{n}{ax} \PY{o}{=} \PY{n}{fig}\PY{o}{.}\PY{n}{add\PYZus{}subplot}\PY{p}{(}\PY{l+m+mi}{111}\PY{p}{)}
          \PY{n}{ax}\PY{o}{.}\PY{n}{set\PYZus{}ylim}\PY{p}{(}\PY{p}{[}\PY{l+m+mf}{1.e\PYZhy{}30}\PY{p}{,} \PY{l+m+mf}{5e\PYZhy{}20}\PY{p}{]}\PY{p}{)}
          
          \PY{k}{for} \PY{n}{line} \PY{o+ow}{in} \PY{n}{lineList}\PY{p}{:}
              \PY{n}{y}\PY{o}{=}\PY{n}{o3}\PY{o}{.}\PY{n}{getEmissivity}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{den}\PY{p}{,} \PY{n}{wave}\PY{o}{=}\PY{n}{line}\PY{p}{)}
              \PY{n}{plt}\PY{o}{.}\PY{n}{semilogy}\PY{p}{(}\PY{n}{tem}\PY{p}{,} \PY{n}{y}\PY{p}{,}  \PY{n}{label}\PY{o}{=}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{\PYZob{}:.0f\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{line}\PY{p}{)}\PY{p}{)}
          
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{T\PYZdl{}\PYZus{}e\PYZdl{} [K]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{j(T) [erg cm\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{} s\PYZdl{}\PYZob{}\PYZhy{}1\PYZcb{}\PYZdl{}]}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{legend}\PY{p}{(}\PY{n}{loc}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{lower right}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{[O III] emissivities @ N\PYZdl{}\PYZus{}e\PYZdl{}=\PYZob{}:.0f\PYZcb{}}\PY{l+s+s1}{\PYZsq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{den}\PY{p}{)}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_373_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Grotrian diagrams}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}163}]:} \PY{c+c1}{\PYZsh{} Grotrian diagram of [O II]}
          
          \PY{c+c1}{\PYZsh{} Imports}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          
          \PY{c+c1}{\PYZsh{} \PYZsh{} Define the atom}
          \PY{n}{o2}\PY{o}{=}\PY{n}{pn}\PY{o}{.}\PY{n}{Atom}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Draw the diagram}
          \PY{n}{o2}\PY{o}{.}\PY{n}{plotGrotrian}\PY{p}{(}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_375_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Comparison of transition probabilities}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}164}]:} \PY{c+c1}{\PYZsh{} Transition probabilities plot}
          
          \PY{c+c1}{\PYZsh{} Imports}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          
          \PY{c+c1}{\PYZsh{} Define a dataplot object}
          \PY{n}{dp}\PY{o}{=}\PY{n}{pn}\PY{o}{.}\PY{n}{DataPlot}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot data}
          \PY{n}{dp}\PY{o}{.}\PY{n}{plotA}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_377_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Comparison of collision strengths for a given ion}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}165}]:} \PY{c+c1}{\PYZsh{} Collision strength plot}
          
          \PY{c+c1}{\PYZsh{} Imports}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          
          \PY{c+c1}{\PYZsh{} \PYZsh{} Define a dataplot object}
          \PY{n}{dp}\PY{o}{=}\PY{n}{pn}\PY{o}{.}\PY{n}{DataPlot}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot data}
          \PY{n}{dp}\PY{o}{.}\PY{n}{plotOmega}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_379_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Emissivity map of a line}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}166}]:} \PY{c+c1}{\PYZsh{} Emissivity map of [O III] 5007 }
          
          \PY{c+c1}{\PYZsh{} Imports}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          \PY{k+kn}{import} \PY{n+nn}{matplotlib.pyplot} \PY{k+kn}{as} \PY{n+nn}{plt}
          
          \PY{c+c1}{\PYZsh{} Compute the grid }
          \PY{n+nb}{map}\PY{o}{=}\PY{n}{pn}\PY{o}{.}\PY{n}{EmisGrid}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{tem\PYZus{}min}\PY{o}{=}\PY{l+m+mi}{10000}\PY{p}{,} \PY{n}{tem\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{23999.00}\PY{p}{,} \PY{n}{den\PYZus{}min}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{den\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{3.5e5}\PY{p}{,} \PY{n}{n\PYZus{}tem}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{n\PYZus{}den}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{)}
          \PY{n}{X}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{tem2D}
          \PY{n}{Y}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{den2D}
          \PY{n}{Z}\PY{o}{=}\PY{n+nb}{map}\PY{o}{.}\PY{n}{getGrid}\PY{p}{(}\PY{n}{wave}\PY{o}{=}\PY{l+m+mi}{5007}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot}
          \PY{n}{emap} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{pcolor}\PY{p}{(}\PY{n}{X}\PY{p}{,} \PY{n}{Y}\PY{p}{,} \PY{n}{Z}\PY{p}{)}
          \PY{n}{cbar} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{colorbar}\PY{p}{(}\PY{n}{emap}\PY{p}{)}
          \PY{n}{cbar}\PY{o}{.}\PY{n}{set\PYZus{}label}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{j([O III] 5007)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{r\PYZsq{}}\PY{l+s+s1}{T\PYZdl{}\PYZus{}e\PYZdl{} [K]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{r\PYZsq{}}\PY{l+s+s1}{Log N\PYZdl{}\PYZus{}e\PYZdl{} [cm\PYZdl{}\PYZca{}\PYZob{}\PYZhy{}3\PYZcb{}\PYZdl{}]}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
          \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_381_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \section{Emissivity map of a line ratio}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}167}]:} \PY{c+c1}{\PYZsh{} Emissivity map of the [O III] 4363/5007 line ratio}
          
          \PY{c+c1}{\PYZsh{} Imports}
          \PY{k+kn}{import} \PY{n+nn}{pyneb} \PY{k+kn}{as} \PY{n+nn}{pn}
          
          \PY{c+c1}{\PYZsh{} Compute the grid }
          \PY{n}{o3grid} \PY{o}{=} \PY{n}{pn}\PY{o}{.}\PY{n}{EmisGrid}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{,} \PY{n}{n\PYZus{}tem}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{n\PYZus{}den}\PY{o}{=}\PY{l+m+mi}{200}\PY{p}{,} \PY{n}{tem\PYZus{}min}\PY{o}{=}\PY{l+m+mi}{8000}\PY{p}{,} \PY{n}{tem\PYZus{}max}\PY{o}{=}\PY{l+m+mi}{25000}\PY{p}{,} \PY{n}{den\PYZus{}min}\PY{o}{=}\PY{l+m+mi}{100}\PY{p}{,} \PY{n}{den\PYZus{}max}\PY{o}{=}\PY{l+m+mf}{2.e5}\PY{p}{)}
          
          \PY{c+c1}{\PYZsh{} Plot the grid}
          \PY{n}{o3grid}\PY{o}{.}\PY{n}{plotImage}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{L(4363)/L(5007)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cblabel}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{I(4363)/I(5007)}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{PyNeb_Handbook_files/PyNeb_Handbook_383_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} 
\end{Verbatim}


    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
