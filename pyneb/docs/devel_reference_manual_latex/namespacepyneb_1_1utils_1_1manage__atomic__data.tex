\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data}{}\section{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data Namespace Reference}
\label{namespacepyneb_1_1utils_1_1manage__atomic__data}\index{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data@{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data}}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classpyneb_1_1utils_1_1manage__atomic__data_1_1___manage_atomic_data}{\+\_\+\+Manage\+Atomic\+Data}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a9c992b2ae01f2e369be5d539172f78a0}{atom2chianti} (atom)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a211c531a869b2e0789e557b2a15a892c}{extract\+\_\+flt} (str\+\_\+)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ab843a6f51ebb888e83a849835e49a885}{read\+N\+I\+S\+T} (N\+I\+S\+Tfile)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{get\+Levels\+N\+I\+S\+T}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a3e35c0ac9cfe657a18cb4a1a797edf32}{\+\_\+atom\+\_\+fits2ascii} (filename)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{\+\_\+coll\+\_\+fits2ascii}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a3e35c0ac9cfe657a18cb4a1a797edf32}{}\index{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}!\+\_\+atom\+\_\+fits2ascii@{\+\_\+atom\+\_\+fits2ascii}}
\index{\+\_\+atom\+\_\+fits2ascii@{\+\_\+atom\+\_\+fits2ascii}!pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}}
\subsubsection[{\+\_\+atom\+\_\+fits2ascii}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+atom\+\_\+fits2ascii (
\begin{DoxyParamCaption}
\item[{}]{filename}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a3e35c0ac9cfe657a18cb4a1a797edf32}
\begin{DoxyVerb}Transform a *atom*.fits file into an *atom*.dat file.\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00628}{628} of file \hyperlink{manage__atomic__data_8py_source}{manage\+\_\+atomic\+\_\+data.\+py}.



References \hyperlink{misc_8py_source_l00053}{pyneb.\+utils.\+misc.\+roman\+\_\+to\+\_\+int()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00628}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a3e35c0ac9cfe657a18cb4a1a797edf32}{00628} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a3e35c0ac9cfe657a18cb4a1a797edf32}{\_atom\_fits2ascii}(filename):
00629     \textcolor{stringliteral}{"""}
00630 \textcolor{stringliteral}{    Transform a *atom*.fits file into an *atom*.dat file.}
00631 \textcolor{stringliteral}{    }
00632 \textcolor{stringliteral}{    """}
00633     strs = filename.split(\textcolor{stringliteral}{'/'})[-1].split(\textcolor{stringliteral}{'\_'})
00634     elem = strs[0].capitalize()
00635     spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a97329c3ce57bd870421672b90e3e6541}{roman\_to\_int}(strs[1])
00636 \textcolor{comment}{#    type = strs[2]}
00637     pn.atomicData.setDataFile(filename.split(\textcolor{stringliteral}{'/'})[-1])
00638     atom = pn.Atom(elem, spec)
00639     atom.printSources()
00640     print(\textcolor{stringliteral}{''})
00641     fileout = raw\_input(\textcolor{stringliteral}{'Enter the name of the output file (between \{0[0]\}\_\{0[1]\}\_\{0[2]\}\_ and .dat:'}.format
      (strs))
00642     
00643     fout = open(\textcolor{stringliteral}{'\{0[0]\}\_\{0[1]\}\_\{0[2]\}\_\{1\}.dat'}.format(strs,fileout), \textcolor{stringliteral}{'w'})
00644     fout.write(\textcolor{stringliteral}{'Aij\(\backslash\)n'})
00645 \textcolor{comment}{#    str\_ = ''}
00646 \textcolor{comment}{#    for i in np.arange(atom.NLevels):}
00647 \textcolor{comment}{#        str\_ += '1/s '}
00648 \textcolor{comment}{#    str\_ += '\(\backslash\)n'}
00649     str\_ = \textcolor{stringliteral}{'1/s '} * atom.NLevels + \textcolor{stringliteral}{'\(\backslash\)n'}
00650     fout.write(str\_)
00651     \textcolor{keywordflow}{for} a1 \textcolor{keywordflow}{in} atom.getA():
00652         str\_ = \textcolor{stringliteral}{''}
00653         \textcolor{keywordflow}{for} a2 \textcolor{keywordflow}{in} a1:
00654             str\_ += \textcolor{stringliteral}{'\{0:10.7e\}'}.format(a2)
00655             str\_ += \textcolor{stringliteral}{' '}
00656         str\_ += \textcolor{stringliteral}{'\(\backslash\)n'}
00657         fout.write(str\_)
00658     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} atom.AtomData.AtomHeader.iteritems():
00659         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'SPECTRUM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'ATOM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'GSCONFIG'} \textcolor{keywordflow}{in} item[0]:
00660             fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00661         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'NOTE'} \textcolor{keywordflow}{in} item[0]:
00662             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'Energy'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} item[1]:
00663                 N\_Note = item[0].split(\textcolor{stringliteral}{'NOTE'})[1]
00664                 str\_N\_Note = str(N\_Note.split(\textcolor{stringliteral}{'\_'})[0])
00665                 fout.write(\textcolor{stringliteral}{'*** SOURCE'} + str\_N\_Note + \textcolor{stringliteral}{' '} + atom.AtomData.AtomHeader.get(\textcolor{stringliteral}{'SOURCE'}+
      str\_N\_Note)  + \textcolor{stringliteral}{'\(\backslash\)n'})
00666                 fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00667     
00668     fout.close()
00669     
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{}\index{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}!\+\_\+coll\+\_\+fits2ascii@{\+\_\+coll\+\_\+fits2ascii}}
\index{\+\_\+coll\+\_\+fits2ascii@{\+\_\+coll\+\_\+fits2ascii}!pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}}
\subsubsection[{\+\_\+coll\+\_\+fits2ascii}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+coll\+\_\+fits2ascii (
\begin{DoxyParamCaption}
\item[{}]{filename, }
\item[{}]{overwrite = {\ttfamily None}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}
\begin{DoxyVerb}Transform a *coll*.fits file into an *coll*.dat file.\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00670}{670} of file \hyperlink{manage__atomic__data_8py_source}{manage\+\_\+atomic\+\_\+data.\+py}.



References \hyperlink{misc_8py_source_l00053}{pyneb.\+utils.\+misc.\+roman\+\_\+to\+\_\+int()}, and \hyperlink{misc_8py_source_l00138}{pyneb.\+utils.\+misc.\+str\+Extract()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00670}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{00670} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{\_coll\_fits2ascii}(filename, overwrite=None):
00671     \textcolor{stringliteral}{"""}
00672 \textcolor{stringliteral}{    Transform a *coll*.fits file into an *coll*.dat file.}
00673 \textcolor{stringliteral}{    }
00674 \textcolor{stringliteral}{    """}
00675     strs = filename.split(\textcolor{stringliteral}{'/'})[-1].split(\textcolor{stringliteral}{'\_'})
00676     elem = strs[0].capitalize()
00677     spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a97329c3ce57bd870421672b90e3e6541}{roman\_to\_int}(strs[1])
00678     pn.atomicData.setDataFile(filename.split(\textcolor{stringliteral}{'/'})[-1])
00679     atom = pn.Atom(elem, spec)
00680     \textcolor{comment}{#atom.printSources()}
00681     fileout = \textcolor{stringliteral}{'\{\}.dat'}.format(filename.split(\textcolor{stringliteral}{'.'})[0])
00682     
00683     \textcolor{keywordflow}{if} overwrite \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keyword}{True}:
00684         \textcolor{keywordflow}{if} os.path.exists(fileout):
00685             erase = raw\_input(\textcolor{stringliteral}{'\{\} exists, overwrite?'}.format(fileout))
00686             \textcolor{keywordflow}{if} erase != \textcolor{stringliteral}{'y'}:
00687                 \textcolor{keywordflow}{return}
00688     fout = open(fileout, \textcolor{stringliteral}{'w'})
00689     fout.write(\textcolor{stringliteral}{'*** \{0\}\{1\} collision strengths data\(\backslash\)n'}.format(elem, strs[1].upper()))
00690     str\_ = \textcolor{stringliteral}{'0 0'}
00691     \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} atom.getTemArray():
00692         str\_ += \textcolor{stringliteral}{' \{0:9.3e\}'}.format(t)
00693     str\_ += \textcolor{stringliteral}{'\(\backslash\)n'}
00694     fout.write(str\_)
00695     \textcolor{keywordflow}{for} omega \textcolor{keywordflow}{in} atom.getOmegaArray():
00696         j = \hyperlink{namespacepyneb_1_1utils_1_1misc_aaf9c5249e3c3104e38854ca30f9df4b7}{strExtract}(omega, \textcolor{stringliteral}{'Omega('}, \textcolor{stringliteral}{'->'})
00697         i = \hyperlink{namespacepyneb_1_1utils_1_1misc_aaf9c5249e3c3104e38854ca30f9df4b7}{strExtract}(omega, \textcolor{stringliteral}{'->'}, \textcolor{stringliteral}{')'})
00698         omegs = \hyperlink{namespacepyneb_1_1utils_1_1misc_aaf9c5249e3c3104e38854ca30f9df4b7}{strExtract}(omega, \textcolor{stringliteral}{'['}, \textcolor{stringliteral}{']'})
00699         str\_ = \textcolor{stringliteral}{'\{0\} \{1\}'}.format(i,j)
00700         \textcolor{keywordflow}{for} omeg \textcolor{keywordflow}{in} omegs.split():
00701             str\_ += \textcolor{stringliteral}{' \{0:9.3e\}'}.format(float(omeg))
00702         str\_ += \textcolor{stringliteral}{'\(\backslash\)n'}
00703         fout.write(str\_)
00704         
00705     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} atom.CollData.CollHeader.iteritems():
00706         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'SPECTRUM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'ATOM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'GSCONFIG'} \textcolor{keywordflow}{in} item[0]:
00707             fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00708         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'TUNIT1'} == item[0]:
00709             fout.write(\textcolor{stringliteral}{'*** T\_UNIT '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'}) 
00710         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'SOURCE'} \textcolor{keywordflow}{in} item[0]:
00711             N\_Source = item[0].split(\textcolor{stringliteral}{'SOURCE'})[1]
00712             str\_N\_Source = str(N\_Source.split(\textcolor{stringliteral}{'\_'})[0])
00713             fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00714             \textcolor{keywordflow}{try}:
00715                 fout.write(\textcolor{stringliteral}{'*** NOTE'} + str\_N\_Source + \textcolor{stringliteral}{' '} + atom.CollData.CollHeader.get(\textcolor{stringliteral}{'NOTE'}+
      str\_N\_Source)  + \textcolor{stringliteral}{'\(\backslash\)n'})
00716             \textcolor{keywordflow}{except}:
00717                 fout.write(\textcolor{stringliteral}{'*** NOTE'} + str\_N\_Source + \textcolor{stringliteral}{' collision strengths \(\backslash\)n'})
00718     print(\textcolor{stringliteral}{'\{\} done'}.format(fileout))
00719     fout.close()
00720     
00721     
00722     
00723 \end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a9c992b2ae01f2e369be5d539172f78a0}{}\index{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}!atom2chianti@{atom2chianti}}
\index{atom2chianti@{atom2chianti}!pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}}
\subsubsection[{atom2chianti}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+atom2chianti (
\begin{DoxyParamCaption}
\item[{}]{atom}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a9c992b2ae01f2e369be5d539172f78a0}


Definition at line \hyperlink{manage__atomic__data_8py_source_l00009}{9} of file \hyperlink{manage__atomic__data_8py_source}{manage\+\_\+atomic\+\_\+data.\+py}.



References \hyperlink{misc_8py_source_l00117}{pyneb.\+utils.\+misc.\+parse\+Atom()}.



Referenced by \hyperlink{pn__chianti_8py_source_l00043}{pyneb.\+utils.\+pn\+\_\+chianti.\+get\+\_\+levs\+\_\+order()}, \hyperlink{manage__atomic__data_8py_source_l00190}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+\+Manage\+Atomic\+Data.\+get\+All\+Available\+Files()}, and \hyperlink{manage__atomic__data_8py_source_l00144}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+\+Manage\+Atomic\+Data.\+get\+Dir\+For\+File()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00009}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a9c992b2ae01f2e369be5d539172f78a0}{00009} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a9c992b2ae01f2e369be5d539172f78a0}{atom2chianti}(atom):
00010     elem = \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom)[0]
00011     spec = int(\hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom)[1])
00012     \textcolor{keywordflow}{return} \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(elem.lower(), spec)
00013 
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a211c531a869b2e0789e557b2a15a892c}{}\index{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}!extract\+\_\+flt@{extract\+\_\+flt}}
\index{extract\+\_\+flt@{extract\+\_\+flt}!pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}}
\subsubsection[{extract\+\_\+flt}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+extract\+\_\+flt (
\begin{DoxyParamCaption}
\item[{}]{str\+\_\+}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a211c531a869b2e0789e557b2a15a892c}
\begin{DoxyVerb}Return the first float in str_, removing the no digit (and no dot) leading part of it.
Ex:
extract_flt('123.00?') -> 123.00
\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00537}{537} of file \hyperlink{manage__atomic__data_8py_source}{manage\+\_\+atomic\+\_\+data.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00537}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a211c531a869b2e0789e557b2a15a892c}{00537} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a211c531a869b2e0789e557b2a15a892c}{extract\_flt}(str\_):
00538     \textcolor{stringliteral}{"""}
00539 \textcolor{stringliteral}{    Return the first float in str\_, removing the no digit (and no dot) leading part of it.}
00540 \textcolor{stringliteral}{    Ex:}
00541 \textcolor{stringliteral}{    extract\_flt('123.00?') -> 123.00}
00542 \textcolor{stringliteral}{    """}
00543     res = \textcolor{stringliteral}{''}
00544     \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} str\_:
00545         \textcolor{keywordflow}{if} l.isdigit() \textcolor{keywordflow}{or} l == \textcolor{stringliteral}{'.'}:
00546             res += l
00547         \textcolor{keywordflow}{else}:
00548             \textcolor{keywordflow}{break}
00549     \textcolor{keywordflow}{if} res == \textcolor{stringliteral}{''}:
00550         \textcolor{keywordflow}{return} np.nan
00551     \textcolor{keywordflow}{else}:
00552         \textcolor{keywordflow}{return} float(res)
00553 
00554 
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{}\index{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}!get\+Levels\+N\+I\+S\+T@{get\+Levels\+N\+I\+S\+T}}
\index{get\+Levels\+N\+I\+S\+T@{get\+Levels\+N\+I\+S\+T}!pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}}
\subsubsection[{get\+Levels\+N\+I\+S\+T}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+get\+Levels\+N\+I\+S\+T (
\begin{DoxyParamCaption}
\item[{}]{atom, }
\item[{}]{Nmax = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}
\begin{DoxyVerb}Return a numpy.array containing the NIST data related to the levels for the given atom
The keys of the recarry are: conf, term, J, energy, ref
Example:
    data = getLevelsNIST('O3')
    energies = data['energy']\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00602}{602} of file \hyperlink{manage__atomic__data_8py_source}{manage\+\_\+atomic\+\_\+data.\+py}.



References \hyperlink{misc_8py_source_l00007}{pyneb.\+utils.\+misc.\+execution\+\_\+path()}, \hyperlink{misc_8py_source_l00013}{pyneb.\+utils.\+misc.\+int\+\_\+to\+\_\+roman()}, \hyperlink{misc_8py_source_l00117}{pyneb.\+utils.\+misc.\+parse\+Atom()}, and \hyperlink{manage__atomic__data_8py_source_l00555}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+read\+N\+I\+S\+T()}.



Referenced by \hyperlink{apap_8py_source_l00078}{pyneb.\+utils.\+apap.\+apap2ascii()}, and \hyperlink{pn__chianti_8py_source_l00043}{pyneb.\+utils.\+pn\+\_\+chianti.\+get\+\_\+levs\+\_\+order()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00602}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{00602} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{getLevelsNIST}(atom, Nmax = None):
00603     \textcolor{stringliteral}{"""}
00604 \textcolor{stringliteral}{    Return a numpy.array containing the NIST data related to the levels for the given atom}
00605 \textcolor{stringliteral}{    The keys of the recarry are: conf, term, J, energy, ref}
00606 \textcolor{stringliteral}{    Example:}
00607 \textcolor{stringliteral}{        data = getLevelsNIST('O3')}
00608 \textcolor{stringliteral}{        energies = data['energy']}
00609 \textcolor{stringliteral}{        }
00610 \textcolor{stringliteral}{    """}
00611     elem, spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom)
00612     elem = elem.lower()
00613     spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_aec4e973d4cb9299f749ef190ea636a06}{int\_to\_roman}(int(spec)).lower()
00614     atom\_str = \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(elem, spec)
00615     level\_file = \textcolor{stringliteral}{'\{0\}\_levels.dat'}.format(atom\_str)
00616     file\_ = \hyperlink{namespacepyneb_1_1utils_1_1misc_a0e9572755930aabb03c6b0e5d66b8356}{execution\_path}(\textcolor{stringliteral}{'../atomic\_data/levels/\{0\}'}.format(level\_file))
00617     \textcolor{keywordflow}{if} os.path.isfile(file\_):
00618         data = \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ab843a6f51ebb888e83a849835e49a885}{readNIST}(file\_)
00619         pn.log\_.message(\textcolor{stringliteral}{'Reading energies and stat weights from \{0\}'}.format(level\_file), calling=\textcolor{stringliteral}{'
      getLevelsNIST'})
00620         \textcolor{keywordflow}{if} Nmax \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00621             \textcolor{keywordflow}{if} Nmax < len(data):
00622                 data = data[0:Nmax]
00623         \textcolor{keywordflow}{return} data
00624     \textcolor{keywordflow}{else}:
00625         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00626     
00627     
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_ab843a6f51ebb888e83a849835e49a885}{}\index{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}!read\+N\+I\+S\+T@{read\+N\+I\+S\+T}}
\index{read\+N\+I\+S\+T@{read\+N\+I\+S\+T}!pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data@{pyneb\+::utils\+::manage\+\_\+atomic\+\_\+data}}
\subsubsection[{read\+N\+I\+S\+T}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+read\+N\+I\+S\+T (
\begin{DoxyParamCaption}
\item[{}]{N\+I\+S\+Tfile}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_ab843a6f51ebb888e83a849835e49a885}
\begin{DoxyVerb}The NIST levels file must be obtained from this page:
    http://physics.nist.gov/PhysRefData/ASD/levels_form.html
with the following options:
    Level Units: cm-1
    Format output: ASCII
    Display output: in its entirely
    Energy ordered
    Level Information: Principal configuration, Principal term, Level, J
    Bibliographic references
\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00555}{555} of file \hyperlink{manage__atomic__data_8py_source}{manage\+\_\+atomic\+\_\+data.\+py}.



Referenced by \hyperlink{manage__atomic__data_8py_source_l00602}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+get\+Levels\+N\+I\+S\+T()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00555}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ab843a6f51ebb888e83a849835e49a885}{00555} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ab843a6f51ebb888e83a849835e49a885}{readNIST}(NISTfile):
00556     \textcolor{stringliteral}{"""}
00557 \textcolor{stringliteral}{    The NIST levels file must be obtained from this page:}
00558 \textcolor{stringliteral}{        http://physics.nist.gov/PhysRefData/ASD/levels\_form.html}
00559 \textcolor{stringliteral}{    with the following options:}
00560 \textcolor{stringliteral}{        Level Units: cm-1}
00561 \textcolor{stringliteral}{        Format output: ASCII}
00562 \textcolor{stringliteral}{        Display output: in its entirely}
00563 \textcolor{stringliteral}{        Energy ordered}
00564 \textcolor{stringliteral}{        Level Information: Principal configuration, Principal term, Level, J}
00565 \textcolor{stringliteral}{        Bibliographic references}
00566 \textcolor{stringliteral}{    """}
00567     data = np.genfromtxt(NISTfile, comments = \textcolor{stringliteral}{'-'}, 
00568                     delimiter = \textcolor{stringliteral}{'|'}, names = \textcolor{stringliteral}{'conf, term, J, energy, ref'}, 
00569                     dtype=(\textcolor{stringliteral}{'a23'}, \textcolor{stringliteral}{'a9'}, \textcolor{stringliteral}{'a4'}, \textcolor{stringliteral}{'float'}, \textcolor{stringliteral}{'a10'}), autostrip=\textcolor{keyword}{True},
00570                     converters = \{\textcolor{stringliteral}{'energy'}:extract\_flt\})
00571     data = data[data[\textcolor{stringliteral}{'J'}] != \textcolor{stringliteral}{''}]
00572     previous\_ref = \textcolor{stringliteral}{''}
00573     previous\_conf = \textcolor{stringliteral}{''}
00574     previous\_term = \textcolor{stringliteral}{''}
00575     \textcolor{keywordflow}{for} d \textcolor{keywordflow}{in} data:
00576         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'conf'}] == \textcolor{stringliteral}{''}:
00577             d[\textcolor{stringliteral}{'conf'}] = previous\_conf
00578         \textcolor{keywordflow}{else}:
00579             previous\_conf = d[\textcolor{stringliteral}{'conf'}]
00580         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'term'}] == \textcolor{stringliteral}{''}:
00581             d[\textcolor{stringliteral}{'term'}] = previous\_term
00582         \textcolor{keywordflow}{else}:
00583             previous\_term = d[\textcolor{stringliteral}{'term'}]
00584         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'ref'}] == \textcolor{stringliteral}{''}:
00585             d[\textcolor{stringliteral}{'ref'}] = previous\_ref
00586         \textcolor{keywordflow}{else}:
00587             previous\_ref = d[\textcolor{stringliteral}{'ref'}]
00588         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'?'} \textcolor{keywordflow}{in} d[\textcolor{stringliteral}{'J'}]:
00589             d[\textcolor{stringliteral}{'J'}] = d[\textcolor{stringliteral}{'J'}].split(\textcolor{stringliteral}{'?'})[0]
00590         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'J'}] == \textcolor{stringliteral}{''}:
00591             d[\textcolor{stringliteral}{'J'}] = 0.
00592         \textcolor{keywordflow}{elif} \textcolor{stringliteral}{'/'} \textcolor{keywordflow}{in} d[\textcolor{stringliteral}{'J'}]:
00593             d[\textcolor{stringliteral}{'J'}] = \textcolor{stringliteral}{'\{0:.1f\}'}.format(float(d[\textcolor{stringliteral}{'J'}].split(\textcolor{stringliteral}{'/'})[0]) / float(d[\textcolor{stringliteral}{'J'}].split(\textcolor{stringliteral}{'/'})[1]))
00594         \textcolor{keywordflow}{else}:
00595             d[\textcolor{stringliteral}{'J'}] = \textcolor{stringliteral}{'\{0:.1f\}'}.format(float(d[\textcolor{stringliteral}{'J'}]))
00596            
00597     data = data[data[\textcolor{stringliteral}{'energy'}].argsort()]
00598     data = data.astype([(\textcolor{stringliteral}{'conf'}, \textcolor{stringliteral}{'a23'}), (\textcolor{stringliteral}{'term'}, \textcolor{stringliteral}{'a9'}), (\textcolor{stringliteral}{'J'}, \textcolor{stringliteral}{'float'}), (\textcolor{stringliteral}{'energy'}, \textcolor{stringliteral}{'float'}), (\textcolor{stringliteral}{'ref'}, \textcolor{stringliteral}{'a10'}
      )])
00599     \textcolor{keywordflow}{return} data
00600 
00601 
\end{DoxyCode}
