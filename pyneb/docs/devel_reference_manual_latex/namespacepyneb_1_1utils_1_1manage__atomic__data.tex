\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data}{\section{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data Namespace Reference}
\label{namespacepyneb_1_1utils_1_1manage__atomic__data}\index{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data@{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data}}
}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classpyneb_1_1utils_1_1manage__atomic__data_1_1___manage_atomic_data}{\-\_\-\-Manage\-Atomic\-Data}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a2c05deb31d8bc74727659c88846651a1}{atom2chianti}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_afdff99c053c20f73c85c2f653a3e88cf}{extract\-\_\-flt}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a7cc94dc359981610066c8212bf4aed51}{read\-N\-I\-S\-T}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{get\-Levels\-N\-I\-S\-T}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a98c41f7a8ffa3a9e23d64909eba559e1}{\-\_\-atom\-\_\-fits2ascii}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{\-\_\-coll\-\_\-fits2ascii}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a98c41f7a8ffa3a9e23d64909eba559e1}{\index{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}!\-\_\-atom\-\_\-fits2ascii@{\-\_\-atom\-\_\-fits2ascii}}
\index{\-\_\-atom\-\_\-fits2ascii@{\-\_\-atom\-\_\-fits2ascii}!pyneb::utils::manage_atomic_data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}}
\subsubsection[{\-\_\-atom\-\_\-fits2ascii}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-atom\-\_\-fits2ascii (
\begin{DoxyParamCaption}
\item[{}]{filename}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a98c41f7a8ffa3a9e23d64909eba559e1}
\begin{DoxyVerb}Transform a *atom*.fits file into an *atom*.dat file.\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00629}{629} of file \hyperlink{manage__atomic__data_8py_source}{manage\-\_\-atomic\-\_\-data.\-py}.



References \hyperlink{misc_8py_source_l00095}{pyneb.\-utils.\-misc.\-roman\-\_\-to\-\_\-int()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00629}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a98c41f7a8ffa3a9e23d64909eba559e1}{00629} 
00630 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a98c41f7a8ffa3a9e23d64909eba559e1}{\_atom\_fits2ascii}(filename):
00631     \textcolor{stringliteral}{"""}
00632 \textcolor{stringliteral}{    Transform a *atom*.fits file into an *atom*.dat file.}
00633 \textcolor{stringliteral}{    }
00634 \textcolor{stringliteral}{    """}
00635     strs = filename.split(\textcolor{stringliteral}{'/'})[-1].split(\textcolor{stringliteral}{'\_'})
00636     elem = strs[0].capitalize()
00637     spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_ae67dbd6bb48d64216bc162ebdc25a183}{roman\_to\_int}(strs[1])
00638 \textcolor{comment}{#    type = strs[2]}
00639     pn.atomicData.setDataFile(filename.split(\textcolor{stringliteral}{'/'})[-1])
00640     atom = pn.Atom(elem, spec)
00641     atom.printSources()
00642     print(\textcolor{stringliteral}{''})
00643     fileout = raw\_input(\textcolor{stringliteral}{'Enter the name of the output file (between \{0[0]\}\_\{0[1]\}\_\{0[2]\}\_ and .dat:'}.format
      (strs))
00644     
00645     fout = open(\textcolor{stringliteral}{'\{0[0]\}\_\{0[1]\}\_\{0[2]\}\_\{1\}.dat'}.format(strs,fileout), \textcolor{stringliteral}{'w'})
00646     fout.write(\textcolor{stringliteral}{'Aij\(\backslash\)n'})
00647 \textcolor{comment}{#    str\_ = ''}
00648 \textcolor{comment}{#    for i in np.arange(atom.NLevels):}
00649 \textcolor{comment}{#        str\_ += '1/s '}
00650 \textcolor{comment}{#    str\_ += '\(\backslash\)n'}
00651     str\_ = \textcolor{stringliteral}{'1/s '} * atom.NLevels + \textcolor{stringliteral}{'\(\backslash\)n'}
00652     fout.write(str\_)
00653     \textcolor{keywordflow}{for} a1 \textcolor{keywordflow}{in} atom.getA():
00654         str\_ = \textcolor{stringliteral}{''}
00655         \textcolor{keywordflow}{for} a2 \textcolor{keywordflow}{in} a1:
00656             str\_ += \textcolor{stringliteral}{'\{0:10.7e\}'}.format(a2)
00657             str\_ += \textcolor{stringliteral}{' '}
00658         str\_ += \textcolor{stringliteral}{'\(\backslash\)n'}
00659         fout.write(str\_)
00660     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} atom.AtomData.AtomHeader.iteritems():
00661         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'SPECTRUM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'ATOM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'GSCONFIG'} \textcolor{keywordflow}{in} item[0]:
00662             fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00663         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'NOTE'} \textcolor{keywordflow}{in} item[0]:
00664             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'Energy'} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} item[1]:
00665                 N\_Note = item[0].split(\textcolor{stringliteral}{'NOTE'})[1]
00666                 str\_N\_Note = str(N\_Note.split(\textcolor{stringliteral}{'\_'})[0])
00667                 fout.write(\textcolor{stringliteral}{'*** SOURCE'} + str\_N\_Note + \textcolor{stringliteral}{' '} + atom.AtomData.AtomHeader.get(\textcolor{stringliteral}{'SOURCE'}+
      str\_N\_Note)  + \textcolor{stringliteral}{'\(\backslash\)n'})
00668                 fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00669     
00670     fout.close()
    
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{\index{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}!\-\_\-coll\-\_\-fits2ascii@{\-\_\-coll\-\_\-fits2ascii}}
\index{\-\_\-coll\-\_\-fits2ascii@{\-\_\-coll\-\_\-fits2ascii}!pyneb::utils::manage_atomic_data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}}
\subsubsection[{\-\_\-coll\-\_\-fits2ascii}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-coll\-\_\-fits2ascii (
\begin{DoxyParamCaption}
\item[{}]{filename, }
\item[{}]{overwrite = {\ttfamily None}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}
\begin{DoxyVerb}Transform a *coll*.fits file into an *coll*.dat file.\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00671}{671} of file \hyperlink{manage__atomic__data_8py_source}{manage\-\_\-atomic\-\_\-data.\-py}.



References \hyperlink{misc_8py_source_l00095}{pyneb.\-utils.\-misc.\-roman\-\_\-to\-\_\-int()}, and \hyperlink{misc_8py_source_l00180}{pyneb.\-utils.\-misc.\-str\-Extract()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00671}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{00671} 
00672 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a1d70a5d8b876f114e058506cd9998de4}{\_coll\_fits2ascii}(filename, overwrite=None):
00673     \textcolor{stringliteral}{"""}
00674 \textcolor{stringliteral}{    Transform a *coll*.fits file into an *coll*.dat file.}
00675 \textcolor{stringliteral}{    }
00676 \textcolor{stringliteral}{    """}
00677     strs = filename.split(\textcolor{stringliteral}{'/'})[-1].split(\textcolor{stringliteral}{'\_'})
00678     elem = strs[0].capitalize()
00679     spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_ae67dbd6bb48d64216bc162ebdc25a183}{roman\_to\_int}(strs[1])
00680     pn.atomicData.setDataFile(filename.split(\textcolor{stringliteral}{'/'})[-1])
00681     atom = pn.Atom(elem, spec)
00682     \textcolor{comment}{#atom.printSources()}
00683     fileout = \textcolor{stringliteral}{'\{\}.dat'}.format(filename.split(\textcolor{stringliteral}{'.'})[0])
00684     
00685     \textcolor{keywordflow}{if} overwrite \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keyword}{True}:
00686         \textcolor{keywordflow}{if} os.path.exists(fileout):
00687             erase = raw\_input(\textcolor{stringliteral}{'\{\} exists, overwrite?'}.format(fileout))
00688             \textcolor{keywordflow}{if} erase != \textcolor{stringliteral}{'y'}:
00689                 \textcolor{keywordflow}{return}
00690     fout = open(fileout, \textcolor{stringliteral}{'w'})
00691     fout.write(\textcolor{stringliteral}{'*** \{0\}\{1\} collision strengths data\(\backslash\)n'}.format(elem, strs[1].upper()))
00692     str\_ = \textcolor{stringliteral}{'0 0'}
00693     \textcolor{keywordflow}{for} t \textcolor{keywordflow}{in} atom.getTemArray():
00694         str\_ += \textcolor{stringliteral}{' \{0:9.3e\}'}.format(t)
00695     str\_ += \textcolor{stringliteral}{'\(\backslash\)n'}
00696     fout.write(str\_)
00697     \textcolor{keywordflow}{for} omega \textcolor{keywordflow}{in} atom.getOmegaArray():
00698         j = \hyperlink{namespacepyneb_1_1utils_1_1misc_aaf9c5249e3c3104e38854ca30f9df4b7}{strExtract}(omega, \textcolor{stringliteral}{'Omega('}, \textcolor{stringliteral}{'->'})
00699         i = \hyperlink{namespacepyneb_1_1utils_1_1misc_aaf9c5249e3c3104e38854ca30f9df4b7}{strExtract}(omega, \textcolor{stringliteral}{'->'}, \textcolor{stringliteral}{')'})
00700         omegs = \hyperlink{namespacepyneb_1_1utils_1_1misc_aaf9c5249e3c3104e38854ca30f9df4b7}{strExtract}(omega, \textcolor{stringliteral}{'['}, \textcolor{stringliteral}{']'})
00701         str\_ = \textcolor{stringliteral}{'\{0\} \{1\}'}.format(i,j)
00702         \textcolor{keywordflow}{for} omeg \textcolor{keywordflow}{in} omegs.split():
00703             str\_ += \textcolor{stringliteral}{' \{0:9.3e\}'}.format(float(omeg))
00704         str\_ += \textcolor{stringliteral}{'\(\backslash\)n'}
00705         fout.write(str\_)
00706         
00707     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} atom.CollData.CollHeader.iteritems():
00708         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'SPECTRUM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'ATOM'} \textcolor{keywordflow}{in} item[0] \textcolor{keywordflow}{or} \textcolor{stringliteral}{'GSCONFIG'} \textcolor{keywordflow}{in} item[0]:
00709             fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00710         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'TUNIT1'} == item[0]:
00711             fout.write(\textcolor{stringliteral}{'*** T\_UNIT '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'}) 
00712         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'SOURCE'} \textcolor{keywordflow}{in} item[0]:
00713             N\_Source = item[0].split(\textcolor{stringliteral}{'SOURCE'})[1]
00714             str\_N\_Source = str(N\_Source.split(\textcolor{stringliteral}{'\_'})[0])
00715             fout.write(\textcolor{stringliteral}{'*** '} + item[0] + \textcolor{stringliteral}{' '} + str(item[1]) + \textcolor{stringliteral}{'\(\backslash\)n'})
00716             \textcolor{keywordflow}{try}:
00717                 fout.write(\textcolor{stringliteral}{'*** NOTE'} + str\_N\_Source + \textcolor{stringliteral}{' '} + atom.CollData.CollHeader.get(\textcolor{stringliteral}{'NOTE'}+
      str\_N\_Source)  + \textcolor{stringliteral}{'\(\backslash\)n'})
00718             \textcolor{keywordflow}{except}:
00719                 fout.write(\textcolor{stringliteral}{'*** NOTE'} + str\_N\_Source + \textcolor{stringliteral}{' collision strengths \(\backslash\)n'})
00720     print(\textcolor{stringliteral}{'\{\} done'}.format(fileout))
00721     fout.close()
00722     
00723     
00724     
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a2c05deb31d8bc74727659c88846651a1}{\index{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}!atom2chianti@{atom2chianti}}
\index{atom2chianti@{atom2chianti}!pyneb::utils::manage_atomic_data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}}
\subsubsection[{atom2chianti}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-atom2chianti (
\begin{DoxyParamCaption}
\item[{}]{atom}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a2c05deb31d8bc74727659c88846651a1}


Definition at line \hyperlink{manage__atomic__data_8py_source_l00009}{9} of file \hyperlink{manage__atomic__data_8py_source}{manage\-\_\-atomic\-\_\-data.\-py}.



References \hyperlink{misc_8py_source_l00159}{pyneb.\-utils.\-misc.\-parse\-Atom()}.



Referenced by \hyperlink{pn__chianti_8py_source_l00051}{pyneb.\-utils.\-pn\-\_\-chianti.\-get\-\_\-levs\-\_\-order()}, \hyperlink{manage__atomic__data_8py_source_l00190}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-\-Manage\-Atomic\-Data.\-get\-All\-Available\-Files()}, and \hyperlink{manage__atomic__data_8py_source_l00144}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-\-Manage\-Atomic\-Data.\-get\-Dir\-For\-File()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00009}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a2c05deb31d8bc74727659c88846651a1}{00009} 
00010 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a2c05deb31d8bc74727659c88846651a1}{atom2chianti}(atom):
00011     elem = \hyperlink{namespacepyneb_1_1utils_1_1misc_a2bb6f906a75f26a882093e9ce9272507}{parseAtom}(atom)[0]
00012     spec = int(\hyperlink{namespacepyneb_1_1utils_1_1misc_a2bb6f906a75f26a882093e9ce9272507}{parseAtom}(atom)[1])
00013     \textcolor{keywordflow}{return} \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(elem.lower(), spec)

\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_afdff99c053c20f73c85c2f653a3e88cf}{\index{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}!extract\-\_\-flt@{extract\-\_\-flt}}
\index{extract\-\_\-flt@{extract\-\_\-flt}!pyneb::utils::manage_atomic_data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}}
\subsubsection[{extract\-\_\-flt}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-extract\-\_\-flt (
\begin{DoxyParamCaption}
\item[{}]{str\-\_\-}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_afdff99c053c20f73c85c2f653a3e88cf}
\begin{DoxyVerb}Return the first float in str_, removing the no digit (and no dot) leading part of it.
Ex:
extract_flt('123.00?') -> 123.00
\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00539}{539} of file \hyperlink{manage__atomic__data_8py_source}{manage\-\_\-atomic\-\_\-data.\-py}.



References \hyperlink{misc_8py_source_l00040}{pyneb.\-utils.\-misc.\-bs()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00539}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_afdff99c053c20f73c85c2f653a3e88cf}{00539} 
00540 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_afdff99c053c20f73c85c2f653a3e88cf}{extract\_flt}(str\_):
00541     \textcolor{stringliteral}{"""}
00542 \textcolor{stringliteral}{    Return the first float in str\_, removing the no digit (and no dot) leading part of it.}
00543 \textcolor{stringliteral}{    Ex:}
00544 \textcolor{stringliteral}{    extract\_flt('123.00?') -> 123.00}
00545 \textcolor{stringliteral}{    """}
00546     res = \textcolor{stringliteral}{''}
00547     \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} \hyperlink{namespacepyneb_1_1utils_1_1misc_ac280e2da31c4a00379cb0b5852ad0d8e}{bs}(str\_):
00548         \textcolor{keywordflow}{if} l.isdigit() \textcolor{keywordflow}{or} l == \textcolor{stringliteral}{'.'}:
00549             res += l
00550         \textcolor{keywordflow}{else}:
00551             \textcolor{keywordflow}{break}
00552     \textcolor{keywordflow}{if} res == \textcolor{stringliteral}{''}:
00553         \textcolor{keywordflow}{return} np.nan
00554     \textcolor{keywordflow}{else}:
00555         \textcolor{keywordflow}{return} float(res)
00556 

\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{\index{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}!get\-Levels\-N\-I\-S\-T@{get\-Levels\-N\-I\-S\-T}}
\index{get\-Levels\-N\-I\-S\-T@{get\-Levels\-N\-I\-S\-T}!pyneb::utils::manage_atomic_data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}}
\subsubsection[{get\-Levels\-N\-I\-S\-T}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-get\-Levels\-N\-I\-S\-T (
\begin{DoxyParamCaption}
\item[{}]{atom, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}
\begin{DoxyVerb}Return a numpy.array containing the NIST data related to the levels for the given atom
The keys of the recarry are: conf, term, J, energy, ref
Example:
    data = getLevelsNIST('O3')
    energies = data['energy']\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00606}{606} of file \hyperlink{manage__atomic__data_8py_source}{manage\-\_\-atomic\-\_\-data.\-py}.



References \hyperlink{misc_8py_source_l00049}{pyneb.\-utils.\-misc.\-execution\-\_\-path()}, \hyperlink{misc_8py_source_l00055}{pyneb.\-utils.\-misc.\-int\-\_\-to\-\_\-roman()}, \hyperlink{misc_8py_source_l00159}{pyneb.\-utils.\-misc.\-parse\-Atom()}, and \hyperlink{manage__atomic__data_8py_source_l00557}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-read\-N\-I\-S\-T()}.



Referenced by \hyperlink{apap_8py_source_l00078}{pyneb.\-utils.\-apap.\-apap2ascii()}, and \hyperlink{pn__chianti_8py_source_l00051}{pyneb.\-utils.\-pn\-\_\-chianti.\-get\-\_\-levs\-\_\-order()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00606}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{00606} 
00607 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{getLevelsNIST}(atom, NLevels = None):
00608     \textcolor{stringliteral}{"""}
00609 \textcolor{stringliteral}{    Return a numpy.array containing the NIST data related to the levels for the given atom}
00610 \textcolor{stringliteral}{    The keys of the recarry are: conf, term, J, energy, ref}
00611 \textcolor{stringliteral}{    Example:}
00612 \textcolor{stringliteral}{        data = getLevelsNIST('O3')}
00613 \textcolor{stringliteral}{        energies = data['energy']}
00614 \textcolor{stringliteral}{        }
00615 \textcolor{stringliteral}{    """}
00616     elem, spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a2bb6f906a75f26a882093e9ce9272507}{parseAtom}(atom)
00617     elem = elem.lower()
00618     spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a7a4c4b4ba1c884da72e0ea05aa8fb90b}{int\_to\_roman}(int(spec)).lower()
00619     atom\_str = \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(elem, spec)
00620     level\_file = \textcolor{stringliteral}{'\{0\}\_levels.dat'}.format(atom\_str)
00621     file\_ = \hyperlink{namespacepyneb_1_1utils_1_1misc_a937fc19e910346d9d288992e8eeab0ea}{execution\_path}(\textcolor{stringliteral}{'../atomic\_data/levels/\{0\}'}.format(level\_file))
00622     \textcolor{keywordflow}{if} os.path.isfile(file\_):
00623         data = \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a7cc94dc359981610066c8212bf4aed51}{readNIST}(file\_, NLevels=NLevels)
00624         pn.log\_.message(\textcolor{stringliteral}{'Reading energies and stat weights from \{0\}'}.format(level\_file), calling=\textcolor{stringliteral}{'
      getLevelsNIST'})
00625         \textcolor{keywordflow}{return} data
00626     \textcolor{keywordflow}{else}:
00627         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00628     
    
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_a7cc94dc359981610066c8212bf4aed51}{\index{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}!read\-N\-I\-S\-T@{read\-N\-I\-S\-T}}
\index{read\-N\-I\-S\-T@{read\-N\-I\-S\-T}!pyneb::utils::manage_atomic_data@{pyneb\-::utils\-::manage\-\_\-atomic\-\_\-data}}
\subsubsection[{read\-N\-I\-S\-T}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-read\-N\-I\-S\-T (
\begin{DoxyParamCaption}
\item[{}]{N\-I\-S\-Tfile, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1manage__atomic__data_a7cc94dc359981610066c8212bf4aed51}
\begin{DoxyVerb}The NIST levels file must be obtained from this page:
    http://physics.nist.gov/PhysRefData/ASD/levels_form.html
with the following options:
    Level Units: cm-1
    Format output: ASCIIda
    Display output: in its entirely
    Energy ordered
    Level Information: Principal configuration, Principal term, Level, J
    Bibliographic references
\end{DoxyVerb}
 

Definition at line \hyperlink{manage__atomic__data_8py_source_l00557}{557} of file \hyperlink{manage__atomic__data_8py_source}{manage\-\_\-atomic\-\_\-data.\-py}.



Referenced by \hyperlink{manage__atomic__data_8py_source_l00606}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-get\-Levels\-N\-I\-S\-T()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1manage__atomic__data_l00557}{}\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a7cc94dc359981610066c8212bf4aed51}{00557} 
00558 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a7cc94dc359981610066c8212bf4aed51}{readNIST}(NISTfile,NLevels=None):
00559     \textcolor{stringliteral}{"""}
00560 \textcolor{stringliteral}{    The NIST levels file must be obtained from this page:}
00561 \textcolor{stringliteral}{        http://physics.nist.gov/PhysRefData/ASD/levels\_form.html}
00562 \textcolor{stringliteral}{    with the following options:}
00563 \textcolor{stringliteral}{        Level Units: cm-1}
00564 \textcolor{stringliteral}{        Format output: ASCIIda}
00565 \textcolor{stringliteral}{        Display output: in its entirely}
00566 \textcolor{stringliteral}{        Energy ordered}
00567 \textcolor{stringliteral}{        Level Information: Principal configuration, Principal term, Level, J}
00568 \textcolor{stringliteral}{        Bibliographic references}
00569 \textcolor{stringliteral}{    """}
00570     data = np.genfromtxt(NISTfile, comments = \textcolor{stringliteral}{'-'}, 
00571                     delimiter = \textcolor{stringliteral}{'|'}, names = \textcolor{stringliteral}{'conf, term, J, energy, ref'}, 
00572                     dtype=(\textcolor{stringliteral}{'a23'}, \textcolor{stringliteral}{'a9'}, \textcolor{stringliteral}{'a4'}, \textcolor{stringliteral}{'float'}, \textcolor{stringliteral}{'a10'}), autostrip=\textcolor{keyword}{True},
00573                     converters = \{\textcolor{stringliteral}{'energy'}:extract\_flt, \textcolor{stringliteral}{'J'}:bs, \textcolor{stringliteral}{'conf'}:bs, \textcolor{stringliteral}{'term'}: bs, \textcolor{stringliteral}{'ref'}:bs\})
00574     data = data[data[\textcolor{stringliteral}{'J'}] != \textcolor{stringliteral}{''}]
00575     previous\_ref = \textcolor{stringliteral}{''}
00576     previous\_conf = \textcolor{stringliteral}{''}
00577     previous\_term = \textcolor{stringliteral}{''}
00578     \textcolor{keywordflow}{for} d \textcolor{keywordflow}{in} data:
00579         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'conf'}] == \textcolor{stringliteral}{''}:
00580             d[\textcolor{stringliteral}{'conf'}] = previous\_conf
00581         \textcolor{keywordflow}{else}:
00582             previous\_conf = d[\textcolor{stringliteral}{'conf'}]
00583         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'term'}] == \textcolor{stringliteral}{''}:
00584             d[\textcolor{stringliteral}{'term'}] = previous\_term
00585         \textcolor{keywordflow}{else}:
00586             previous\_term = d[\textcolor{stringliteral}{'term'}]
00587         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'ref'}] == \textcolor{stringliteral}{''}:
00588             d[\textcolor{stringliteral}{'ref'}] = previous\_ref
00589         \textcolor{keywordflow}{else}:
00590             previous\_ref = d[\textcolor{stringliteral}{'ref'}]
00591         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'?'} \textcolor{keywordflow}{in} d[\textcolor{stringliteral}{'J'}]:
00592             d[\textcolor{stringliteral}{'J'}] = d[\textcolor{stringliteral}{'J'}].split(\textcolor{stringliteral}{'?'})[0]
00593         \textcolor{keywordflow}{if} d[\textcolor{stringliteral}{'J'}] == \textcolor{stringliteral}{''}:
00594             d[\textcolor{stringliteral}{'J'}] = 0.
00595         \textcolor{keywordflow}{elif} \textcolor{stringliteral}{'/'} \textcolor{keywordflow}{in} d[\textcolor{stringliteral}{'J'}]:
00596             d[\textcolor{stringliteral}{'J'}] = \textcolor{stringliteral}{'\{0:.1f\}'}.format(float(d[\textcolor{stringliteral}{'J'}].split(\textcolor{stringliteral}{'/'})[0]) / float(d[\textcolor{stringliteral}{'J'}].split(\textcolor{stringliteral}{'/'})[1]))
00597         \textcolor{keywordflow}{else}:
00598             d[\textcolor{stringliteral}{'J'}] = \textcolor{stringliteral}{'\{0:.1f\}'}.format(float(d[\textcolor{stringliteral}{'J'}]))
00599            
00600     data = data[data[\textcolor{stringliteral}{'energy'}].argsort()]
00601     data = data.astype([(\textcolor{stringliteral}{'conf'}, \textcolor{stringliteral}{'a23'}), (\textcolor{stringliteral}{'term'}, \textcolor{stringliteral}{'a9'}), (\textcolor{stringliteral}{'J'}, \textcolor{stringliteral}{'float'}), (\textcolor{stringliteral}{'energy'}, \textcolor{stringliteral}{'float'}), (\textcolor{stringliteral}{'ref'}, \textcolor{stringliteral}{'a10'}
      )])
00602     \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00603         data = data[0:NLevels]
00604     \textcolor{keywordflow}{return} data
00605 

\end{DoxyCode}
