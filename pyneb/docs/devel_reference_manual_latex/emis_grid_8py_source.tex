\hypertarget{emis_grid_8py}{\section{emis\-Grid.\-py}
\label{emis_grid_8py}\index{pyneb/core/emis\-Grid.\-py@{pyneb/core/emis\-Grid.\-py}}
}

\begin{DoxyCode}
\hypertarget{emis_grid_8py_source_l00001}{}\hyperlink{namespacepyneb_1_1core_1_1emis_grid}{00001} \textcolor{keyword}{import} os
00002 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np
00003 
00004 \textcolor{keyword}{from} pyneb \textcolor{keyword}{import} config, log\_, atomicData
00005 \textcolor{keywordflow}{if} config.INSTALLED[\textcolor{stringliteral}{'plt'}]:
00006     \textcolor{keyword}{import} matplotlib.pyplot \textcolor{keyword}{as} plt
00007 \textcolor{keyword}{from} ..utils.misc \textcolor{keyword}{import} int\_to\_roman, parseAtom
00008 \textcolor{keyword}{from} ..core.pynebcore \textcolor{keyword}{import} Atom
00009 \textcolor{keyword}{from} ..utils.saverestore \textcolor{keyword}{import} save, restore
00010 
\hypertarget{emis_grid_8py_source_l00011}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid}{00011} \textcolor{keyword}{class }\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid}{EmisGrid}(object):
00012     \textcolor{stringliteral}{"""}
00013 \textcolor{stringliteral}{    Instantiates an atom and compute the emissivities of all the atom lines for the (tem, den) }
00014 \textcolor{stringliteral}{    values of a regularly spaced grid.}
00015 \textcolor{stringliteral}{    Each line is represented in a 2D array, and there are as many arrays as transitions in the atom.}
00016 \textcolor{stringliteral}{    The results can be saved for a later use in a cPickle file.}
00017 \textcolor{stringliteral}{}
00018 \textcolor{stringliteral}{    """}
00019 
00020     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a0d2694aa16812dc5b3dba4fb8da02f57}{\_\_init\_\_}(self, elem=None, spec=None, n\_tem=100, n\_den=100, tem\_min=5000., tem\_max=20000.,
\hypertarget{emis_grid_8py_source_l00021}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a0d2694aa16812dc5b3dba4fb8da02f57}{00021}                  den\_min=10., den\_max=1.e8, restore\_file=\textcolor{keywordtype}{None}, atomObj=\textcolor{keywordtype}{None}, **kwargs):
00022 
00023         \textcolor{stringliteral}{"""}
00024 \textcolor{stringliteral}{        Container for the emission line intensity grids depending on Te and Ne.}
00025 \textcolor{stringliteral}{}
00026 \textcolor{stringliteral}{        Usage:}
00027 \textcolor{stringliteral}{            O3map = pn.EmisGrid('O', 3, n\_tem=30, n\_den=30)}
00028 \textcolor{stringliteral}{            O3map = pn.EmisGrid(restore\_file='plot/O3\_10k.pypic') # Recovers the map from a previous
       computation}
00029 \textcolor{stringliteral}{}
00030 \textcolor{stringliteral}{        Parameters:}
00031 \textcolor{stringliteral}{            - elem               element (e.g. 'O')}
00032 \textcolor{stringliteral}{            - spec               spectrum (e.g. 3)}
00033 \textcolor{stringliteral}{            - n\_tem              number of points of the electron temperature sample}
00034 \textcolor{stringliteral}{            - n\_den              number of points of the electron density sample}
00035 \textcolor{stringliteral}{            - tem\_min, tem\_max   limits for the electron temperature}
00036 \textcolor{stringliteral}{            - den\_min, den\_max   limits for the electron density}
00037 \textcolor{stringliteral}{            - restore\_file       if set, the emissivities are loaded from this file, }
00038 \textcolor{stringliteral}{                                 otherwise (None) it is computed}
00039 \textcolor{stringliteral}{            - atomObj            an atom object. In this case, no need for elem and spec.}
00040 \textcolor{stringliteral}{}
00041 \textcolor{stringliteral}{        """}
00042         \textcolor{comment}{#TODO Check the boundaries of the restored maps.}
\hypertarget{emis_grid_8py_source_l00043}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a1a53003d1e4a12bbc4ff9233a3fcd54a}{00043}         self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a1a53003d1e4a12bbc4ff9233a3fcd54a}{log\_} = log\_
\hypertarget{emis_grid_8py_source_l00044}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{00044}         self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling} = \textcolor{stringliteral}{'EmisGrid'}
00045 
00046         \textcolor{keywordflow}{if} restore\_file \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00047             old = \hyperlink{namespacepyneb_1_1utils_1_1saverestore_a5d908e03433c3eb450865fbeffb366b4}{restore}(restore\_file)
\hypertarget{emis_grid_8py_source_l00048}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{00048}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem} = old[\textcolor{stringliteral}{'elem'}]
\hypertarget{emis_grid_8py_source_l00049}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{00049}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec} = old[\textcolor{stringliteral}{'spec'}]
00050             \textcolor{keywordflow}{if} atomObj \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
\hypertarget{emis_grid_8py_source_l00051}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2492fc08e2beca6d49dc2f1c2829b5c8}{00051}                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2492fc08e2beca6d49dc2f1c2829b5c8}{atom} = Atom(elem=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem}, spec=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec}, **kwargs)
00052             \textcolor{keywordflow}{else}:
00053                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2492fc08e2beca6d49dc2f1c2829b5c8}{atom} = atomObj
00054             \textcolor{keywordflow}{if} self.atom.atomFitsFile != old[\textcolor{stringliteral}{'atomFitsFile'}]:
00055                 self.log\_.error(\textcolor{stringliteral}{'You are using \{0\}, but restoring a file made with \{1\}'}.format(
      self.atom.atomFitsFile, old[\textcolor{stringliteral}{'atomFitsFile'}]),
00056                                 calling=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})
00057             \textcolor{keywordflow}{if} self.atom.collFitsFile != old[\textcolor{stringliteral}{'collFitsFile'}]:
00058                 self.log\_.error(\textcolor{stringliteral}{'You are using \{0\}, but restoring a file made with \{1\}'}.format(
      self.atom.collFitsFile, old[\textcolor{stringliteral}{'collFitsFile'}]),
00059                                 calling=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})
\hypertarget{emis_grid_8py_source_l00060}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{00060}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{tem} = old[\textcolor{stringliteral}{'tem'}]
\hypertarget{emis_grid_8py_source_l00061}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{00061}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{den} = old[\textcolor{stringliteral}{'den'}]
\hypertarget{emis_grid_8py_source_l00062}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a7a86bfc0cd3ed0d14ccaf950fb183696}{00062}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a7a86bfc0cd3ed0d14ccaf950fb183696}{n\_tem} = self.tem.size
\hypertarget{emis_grid_8py_source_l00063}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6e0bddbe2d14b13fe1270a74b5b9ac0c}{00063}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6e0bddbe2d14b13fe1270a74b5b9ac0c}{n\_den} = self.den.size
\hypertarget{emis_grid_8py_source_l00064}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abd8712ac536b051f866429da43f526de}{00064}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abd8712ac536b051f866429da43f526de}{tem\_min} = min(self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{tem})
\hypertarget{emis_grid_8py_source_l00065}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2d0eacad9eb4fa87ef08d1f710cf2317}{00065}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2d0eacad9eb4fa87ef08d1f710cf2317}{tem\_max} = max(self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{tem})
\hypertarget{emis_grid_8py_source_l00066}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a15ba80aa398cebb3178d75c8dd5a7e32}{00066}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a15ba80aa398cebb3178d75c8dd5a7e32}{den\_min} = min(self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{den})
\hypertarget{emis_grid_8py_source_l00067}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abd2b718af1e50d5c640e5fbb881c02f9}{00067}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abd2b718af1e50d5c640e5fbb881c02f9}{den\_max} = max(self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{den})
\hypertarget{emis_grid_8py_source_l00068}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6fd6b209384aaa2cd4ba5051477e4ecb}{00068}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6fd6b209384aaa2cd4ba5051477e4ecb}{emis\_grid} = old[\textcolor{stringliteral}{'emis\_grid'}]
00069         \textcolor{keywordflow}{else}:
00070             \textcolor{keywordflow}{if} atomObj \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00071                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem} = elem
00072                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec} = spec
00073                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2492fc08e2beca6d49dc2f1c2829b5c8}{atom} = Atom(elem, spec, **kwargs)
00074             \textcolor{keywordflow}{else}:
00075                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2492fc08e2beca6d49dc2f1c2829b5c8}{atom} = atomObj
00076                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem} = self.atom.elem
00077                 self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec} = self.atom.spec
00078             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a7a86bfc0cd3ed0d14ccaf950fb183696}{n\_tem} = n\_tem
00079             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6e0bddbe2d14b13fe1270a74b5b9ac0c}{n\_den} = n\_den
00080             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abd8712ac536b051f866429da43f526de}{tem\_min} = tem\_min
00081             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a2d0eacad9eb4fa87ef08d1f710cf2317}{tem\_max} = tem\_max
00082             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a15ba80aa398cebb3178d75c8dd5a7e32}{den\_min} = den\_min
00083             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abd2b718af1e50d5c640e5fbb881c02f9}{den\_max} = den\_max
00084             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{tem} = 10 ** np.linspace(np.log10(tem\_min), np.log10(tem\_max), n\_tem)
00085             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{den} = 10 ** np.linspace(np.log10(den\_min), np.log10(den\_max), n\_den)
\hypertarget{emis_grid_8py_source_l00086}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a5abe442aad7ee62b912ad97ec4d71d6c}{00086}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a5abe442aad7ee62b912ad97ec4d71d6c}{atomFitsFile} = self.atom.atomFitsFile
\hypertarget{emis_grid_8py_source_l00087}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ad9f51a3439ea7455aaf790887fc78b3c}{00087}             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ad9f51a3439ea7455aaf790887fc78b3c}{collFitsFile} = self.atom.collFitsFile
00088             self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6fd6b209384aaa2cd4ba5051477e4ecb}{emis\_grid} = self.atom.getEmissivity(self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{tem}, self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{den})
00089             \textcolor{comment}{#self.emis\_grid = np.empty((self.atom.NLevels, self.atom.NLevels, n\_tem, n\_den))}
00090         
\hypertarget{emis_grid_8py_source_l00091}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ae1904aecb62ca67772b3998cca09fabd}{00091}         self.den2D, self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ae1904aecb62ca67772b3998cca09fabd}{tem2D} = np.meshgrid(self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{den}, self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{tem})
00092         
00093 \textcolor{comment}{#    def computeEmis(self):}
00094 \textcolor{comment}{#        """}
00095 \textcolor{comment}{#        This is where the emissivities are computed, by calling a function from Atom.}
00096 \textcolor{comment}{#        """}
00097 \textcolor{comment}{#        self.emis\_grid = self.atom.getEmissivity(self.tem, self.den)}
00098 
\hypertarget{emis_grid_8py_source_l00099}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a7ce505278e7503e56c2191db54e7d227}{00099}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a7ce505278e7503e56c2191db54e7d227}{save}(self, file\_):
00100         \textcolor{stringliteral}{"""}
00101 \textcolor{stringliteral}{        Save results for a later use.}
00102 \textcolor{stringliteral}{        }
00103 \textcolor{stringliteral}{        Usage:}
00104 \textcolor{stringliteral}{            O3map.save('plot/O3\_30by30.pypic')}
00105 \textcolor{stringliteral}{        }
00106 \textcolor{stringliteral}{        Parameter:}
00107 \textcolor{stringliteral}{            file\_  the name of the file in which the emissivity grids are stored}
00108 \textcolor{stringliteral}{}
00109 \textcolor{stringliteral}{        """}
00110         \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a7ce505278e7503e56c2191db54e7d227}{save}(file\_, emis\_grid=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6fd6b209384aaa2cd4ba5051477e4ecb}{emis\_grid}, tem=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac6e2be63ad3ea6c0d246d1c6d1afc54b}{tem}, den=self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ac393173ea0ffbfdffb4c095fa6acada1}{den}, elem=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem},
00111              spec=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec}, atomFitsFile=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a5abe442aad7ee62b912ad97ec4d71d6c}{atomFitsFile}, collFitsFile=self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ad9f51a3439ea7455aaf790887fc78b3c}{collFitsFile})
00112 
00113 
\hypertarget{emis_grid_8py_source_l00114}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{00114}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(self, lev\_i=None, lev\_j=None, wave= -1, to\_eval=None):
00115         \textcolor{stringliteral}{"""}
00116 \textcolor{stringliteral}{        2D array of a line emissivity for the (Te, Ne) values of a regularly spaced grid.}
00117 \textcolor{stringliteral}{        The line is specified either as the wavelength or the levels. An expression can also be used, }
00118 \textcolor{stringliteral}{        for example to\_eval = 'L(5007)/L(4959)'}
00119 \textcolor{stringliteral}{        }
00120 \textcolor{stringliteral}{        Parameters:}
00121 \textcolor{stringliteral}{            - lev\_i, lev\_j   levels for the emission line}
00122 \textcolor{stringliteral}{            - wave           wavelength}
00123 \textcolor{stringliteral}{            - to\_eval        algebraic expression of the line combination to evaluate}
00124 \textcolor{stringliteral}{        }
00125 \textcolor{stringliteral}{        """}
00126         \textcolor{keywordflow}{if} wave != -1:
00127             lev\_i, lev\_j = self.atom.getTransition(wave)
00128 
00129         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00130             to\_eval = \textcolor{stringliteral}{'I('} + str(lev\_i) + \textcolor{stringliteral}{','} + str(lev\_j) + \textcolor{stringliteral}{')'}
00131             
00132         \textcolor{keyword}{def }I(lev\_i, lev\_j):
00133             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a6fd6b209384aaa2cd4ba5051477e4ecb}{emis\_grid}[lev\_i - 1, lev\_j - 1, :, :]
00134         \textcolor{keyword}{def }L(wave):
00135             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(wave=wave)
00136         \textcolor{keywordflow}{return} eval(to\_eval)
00137     
00138     
00139     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a36dc2ce3b34d51d04c3244b61417a5d1}{plotImage}(self, to\_eval=None, lev\_i1=None, lev\_j1=None, lev\_i2=None, lev\_j2=None,
\hypertarget{emis_grid_8py_source_l00140}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a36dc2ce3b34d51d04c3244b61417a5d1}{00140}                   wave1= -1, wave2= -1, cblabel=\textcolor{stringliteral}{''}, **kwargs):
00141         \textcolor{stringliteral}{"""}
00142 \textcolor{stringliteral}{        Draw a contour plot of a line ratio. The contour is obtained by a horizontal cut in a
       temden-emissivity array.}
00143 \textcolor{stringliteral}{        More elaborated plots can be obtained with the Diagnostic object.}
00144 \textcolor{stringliteral}{        }
00145 \textcolor{stringliteral}{        Usage:}
00146 \textcolor{stringliteral}{            O3map.plotImage('L(4363)/L(5007)')}
00147 \textcolor{stringliteral}{            O3map.plotImage(wave1=4363, wave2=5007)}
00148 \textcolor{stringliteral}{            }
00149 \textcolor{stringliteral}{        Parameters:}
00150 \textcolor{stringliteral}{            - to\_eval                         algebraic expression of the line combination to draw. May
       combine L(lambda) and I(i,j).}
00151 \textcolor{stringliteral}{            - lev\_i1, lev\_i2, lev\_j1, lev\_j2  levels of the a lines in case of simple line ratio plot.}
00152 \textcolor{stringliteral}{            - wave1, wave2                    wavelengths of the two lines in case of simple line ratio
       plot.}
00153 \textcolor{stringliteral}{            - cblabel                         a title for the colorbar}
00154 \textcolor{stringliteral}{            - **kwargs                        any other parameter will be sent to contourf and pcolor}
00155 \textcolor{stringliteral}{}
00156 \textcolor{stringliteral}{        """}
00157         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} config.INSTALLED[\textcolor{stringliteral}{'plt'}]:
00158             log\_.error(\textcolor{stringliteral}{'Matplotlib not available'}, calling=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})
00159             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00160         L = \textcolor{keyword}{lambda} lam: self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(wave=lam)
00161         I = \textcolor{keyword}{lambda} i, j: self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(i, j)
00162         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00163             \textcolor{keywordflow}{if} wave1 != -1:
00164                 lev\_i1, lev\_j1 = self.atom.getTransition(wave1)
00165             \textcolor{keywordflow}{if} wave2 != -1:
00166                 lev\_i2, lev\_j2 = self.atom.getTransition(wave2)
00167             to\_eval = \textcolor{stringliteral}{'I('} + str(lev\_i1) + \textcolor{stringliteral}{','} + str(lev\_j1) + \textcolor{stringliteral}{') / I('} + str(lev\_i2) + \textcolor{stringliteral}{','} + str(lev\_j2) +
       \textcolor{stringliteral}{')'}
00168         X = np.log10(self.den2D)
00169         Y = self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ae1904aecb62ca67772b3998cca09fabd}{tem2D} / 1e4
00170         Z = self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(to\_eval=to\_eval)
00171         plt.contourf(X, Y, Z, **kwargs)
00172         emap = plt.pcolor(X, Y, Z, **kwargs)
00173         cbar = plt.colorbar(emap)
00174         cbar.set\_label(cblabel)
00175         \textcolor{comment}{# plt.clabel(contour, inline=1)}
00176         plt.xlabel(\textcolor{stringliteral}{r'log Electron density (cm$^\{-3\}$)'})
00177         plt.ylabel(\textcolor{stringliteral}{r'Electron temperature ($10^4$K)'})
00178         plt.show()
00179 
00180 
00181     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abea5bd314041cdd4be783a7a1d8f99a2}{plotContours}(self, to\_eval, low\_level=None, high\_level=None, n\_levels=20,
\hypertarget{emis_grid_8py_source_l00182}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_abea5bd314041cdd4be783a7a1d8f99a2}{00182}                       linestyles=\textcolor{stringliteral}{'-'}, clabels=\textcolor{keyword}{True}, log\_levels=\textcolor{keyword}{True}, title=\textcolor{keywordtype}{None}, ax=\textcolor{keywordtype}{None}, **kwargs):
00183         \textcolor{stringliteral}{"""}
00184 \textcolor{stringliteral}{        Plot a contour map of the diagnostic defined by to\_eval.}
00185 \textcolor{stringliteral}{        }
00186 \textcolor{stringliteral}{        Usage:}
00187 \textcolor{stringliteral}{            O3map.plotContours('L(4363)/L(5007)')}
00188 \textcolor{stringliteral}{        }
00189 \textcolor{stringliteral}{        Parameters:}
00190 \textcolor{stringliteral}{            - to\_eval                   algebraic definition of the line ratio to contour-plot}
00191 \textcolor{stringliteral}{            - low\_levels, high\_levels   limit levels for the contour. If not set, the limit of the }
00192 \textcolor{stringliteral}{                                        ratio values are used.}
00193 \textcolor{stringliteral}{            - n\_levels                  number of levels (20 is the default)}
00194 \textcolor{stringliteral}{            - linestyles                used for the contour lines (default: solid line)}
00195 \textcolor{stringliteral}{            - clabels                   Boolean. Controls if line labels are printed (default: True)}
00196 \textcolor{stringliteral}{            - log\_levels                Boolean. If True (default), the log of the line ratio is used.}
00197 \textcolor{stringliteral}{            - title                     plot title}
00198 \textcolor{stringliteral}{            - **kwargs                  sent to plt.contour}
00199 \textcolor{stringliteral}{            }
00200 \textcolor{stringliteral}{        """} 
00201         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} config.INSTALLED[\textcolor{stringliteral}{'plt'}]:
00202             log\_.error(\textcolor{stringliteral}{'Matplotlib not available'}, calling=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})
00203             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00204         X = np.log10(self.den2D)
00205         Y = self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ae1904aecb62ca67772b3998cca09fabd}{tem2D}
00206         L = \textcolor{keyword}{lambda} lam: self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(wave=lam)
00207         I = \textcolor{keyword}{lambda} i, j: self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(i, j)
00208         \textcolor{keywordflow}{try}:
00209             diag\_map = eval(to\_eval)
00210         \textcolor{keywordflow}{except}:
00211             self.log\_.warn(\textcolor{stringliteral}{'diag %s not found'} % to\_eval, calling=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})
00212             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00213         \textcolor{keywordflow}{if} low\_level \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00214             low\_level = np.min(np.log10(diag\_map))
00215         \textcolor{keywordflow}{if} high\_level \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00216             high\_level = np.max(np.log10(diag\_map))
00217         \textcolor{keywordflow}{if} log\_levels:
00218             Z = np.log10(diag\_map)
00219             levels = np.linspace(low\_level, high\_level, n\_levels)
00220             \textcolor{keywordflow}{if} title \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00221                 title = \textcolor{stringliteral}{'[%s%s]: log(%s)'} % (self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem}, \hyperlink{namespacepyneb_1_1utils_1_1misc_a7a4c4b4ba1c884da72e0ea05aa8fb90b}{int\_to\_roman}(int(self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec})), to\_eval)
00222         \textcolor{keywordflow}{else}:
00223             Z = diag\_map
00224             levels = 10. ** (np.linspace(low\_level, high\_level, n\_levels))
00225             \textcolor{keywordflow}{if} title \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00226                 title = \textcolor{stringliteral}{'[%s%s]: %s'} % (self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem}, \hyperlink{namespacepyneb_1_1utils_1_1misc_a7a4c4b4ba1c884da72e0ea05aa8fb90b}{int\_to\_roman}(int(self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec})), to\_eval)
00227         
00228         \textcolor{keywordflow}{if} ax \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00229             f, ax = plt.subplots()
00230         \textcolor{keywordflow}{else}:
00231             f = plt.gcf()
00232         CS = ax.contour(X, Y, Z, levels=levels, linestyles=linestyles, **kwargs)
00233         \textcolor{keywordflow}{if} clabels:
00234             ax.clabel(CS, CS.levels[::3], inline=\textcolor{keyword}{True}, fontsize=12, colors=\textcolor{stringliteral}{'black'})
00235         ax.set\_xlabel(\textcolor{stringliteral}{r'log(n$\_\{\(\backslash\)rm e\}$) [cm$^\{-3\}$]'})
00236         ax.set\_ylabel(\textcolor{stringliteral}{r'T$\_\{\(\backslash\)rm e\}$ [K]'})
00237         ax.set\_title(title)
00238 
00239 
00240     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_afa16129c399f1215de169a6e2e67b882}{plotLineRatio}(self, to\_eval, par=None, par\_low=None, par\_high=None, n\_par=10,
\hypertarget{emis_grid_8py_source_l00241}{}\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_afa16129c399f1215de169a6e2e67b882}{00241}                       linestyles=\textcolor{stringliteral}{'-'}, title=\textcolor{keywordtype}{None}, legend=\textcolor{keyword}{True}, loc=2, **kwargs):
00242         \textcolor{stringliteral}{"""}
00243 \textcolor{stringliteral}{        Plot the diagnostic defined by to\_eval as a function of either Ne or Te, with the other}
00244 \textcolor{stringliteral}{        variable as a parameter.}
00245 \textcolor{stringliteral}{        }
00246 \textcolor{stringliteral}{        Usage:}
00247 \textcolor{stringliteral}{            o3grid.plotLineRatio('L(4363)/L(5007)', par='den')}
00248 \textcolor{stringliteral}{            s2grid.plotLineRatio('I(2,1)/I(3,1)', par='tem', par\_low=5000, par\_high=20000, n\_par=4)}
00249 \textcolor{stringliteral}{        }
00250 \textcolor{stringliteral}{        Parameters:}
00251 \textcolor{stringliteral}{            - to\_eval      algebraic definition of the line ratio to contour-plot}
00252 \textcolor{stringliteral}{            - par          quantity to be used as a parameter (either 'den' or 'tem')}
00253 \textcolor{stringliteral}{            - par\_low      lowest limit of the parameter range}
00254 \textcolor{stringliteral}{            - par\_high     highest limit of the parameter range}
00255 \textcolor{stringliteral}{            - n\_par        number of parameter's values (default: 10)}
00256 \textcolor{stringliteral}{            - linestyles   used for the contour lines (default: solid)}
00257 \textcolor{stringliteral}{            - title        plot title}
00258 \textcolor{stringliteral}{            - legend       Boolean. If True, write legend title (default: True) }
00259 \textcolor{stringliteral}{            - **kwargs     sent to plt.contour}
00260 \textcolor{stringliteral}{            }
00261 \textcolor{stringliteral}{        """} 
00262         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} config.INSTALLED[\textcolor{stringliteral}{'plt'}]:
00263             log\_.error(\textcolor{stringliteral}{'Matplotlib not available'}, calling=self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})
00264             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00265 
00266         L = \textcolor{keyword}{lambda} wav: self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(wave=wav)
00267         I = \textcolor{keyword}{lambda} i, j: self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_af9a9219e5ddfcfd53c52466e2c2deb44}{getGrid}(i, j)
00268         
00269         \textcolor{keywordflow}{if} par == \textcolor{stringliteral}{'tem'}:
00270             X = np.log10(self.den2D)
00271             Z = self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ae1904aecb62ca67772b3998cca09fabd}{tem2D}
00272             leg\_format = \textcolor{stringliteral}{"\{0:.0f\} K"}
00273             leg\_title = \textcolor{stringliteral}{r'Temperature'}
00274             xlabel = \textcolor{stringliteral}{r'Log(N$\_\{\(\backslash\)rm e\}$) [cm$^\{-3\}$]'}
00275         \textcolor{keywordflow}{elif} par == \textcolor{stringliteral}{'den'}:
00276             X = self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_ae1904aecb62ca67772b3998cca09fabd}{tem2D}
00277             Z = np.log10(self.den2D)
00278             leg\_format = \textcolor{stringliteral}{"\{0:.2f\}"}
00279             leg\_title = \textcolor{stringliteral}{r'Log(N$\_\{\(\backslash\)rm e\}$)'}
00280             xlabel = \textcolor{stringliteral}{r'T$\_\{\(\backslash\)rm e\}$ [K]'}
00281         \textcolor{keywordflow}{else}:
00282             self.log\_.error(\textcolor{stringliteral}{'The parameter must be either den or tem (%s given)'} % par, calling=self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})
00283 
00284         \textcolor{keywordflow}{try}:
00285             Y = eval(to\_eval)
00286         \textcolor{keywordflow}{except}:
00287             self.log\_.warn(\textcolor{stringliteral}{'Diagnostic %s not found'} % to\_eval, calling=self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a19820878261ee98513e0b755e688453f}{calling})            
00288             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00289 
00290         \textcolor{keywordflow}{if} par\_low \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00291             par\_low = np.min(Z)
00292         \textcolor{keywordflow}{if} par\_high \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00293             par\_high = np.max(Z)
00294         levels = np.linspace(par\_low, par\_high, n\_par)
00295 
00296         CS = plt.contour(X, Y, Z, levels=levels, linestyles=linestyles, **kwargs)
00297         
00298         \textcolor{keywordflow}{if} legend:
00299             \textcolor{keywordflow}{for} i\_level \textcolor{keywordflow}{in} range(len(levels)):
00300                 CS.collections[i\_level].set\_label(leg\_format.format(levels[i\_level]))
00301                 plt.legend(title=leg\_title, loc=loc)
00302 
00303         \textcolor{keywordflow}{if} title \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00304             title = \textcolor{stringliteral}{'[%s%s]'} % (self.\hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a860a236b0e426b4671071e4bf492dee7}{elem}, \hyperlink{namespacepyneb_1_1utils_1_1misc_a7a4c4b4ba1c884da72e0ea05aa8fb90b}{int\_to\_roman}(int(self.
      \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid_a78618aff86ea296ecefddcc86d98b687}{spec})))
00305 
00306         plt.xlabel(xlabel)
00307         plt.ylabel(to\_eval)
00308         plt.title(title)
00309     
00310         plt.show()
00311         
00312 
00313 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1core_1_1emis_grid_a377d90568cd9c52e35ebae2ac9a3c386}{getEmisGridDict}(elem\_list=None, spec\_list=None, atom\_list=None, restore=True, 
      pypic\_path=None,
00314             n\_tem=100, n\_den=100, tem\_min=5000., tem\_max=20000., den\_min=10., den\_max=1e8, save=\textcolor{keyword}{True},
\hypertarget{emis_grid_8py_source_l00315}{}\hyperlink{namespacepyneb_1_1core_1_1emis_grid_a377d90568cd9c52e35ebae2ac9a3c386}{00315}             atomDict=\textcolor{keywordtype}{None}, createPypicsDir=\textcolor{keyword}{True}, computeIfAbsent=\textcolor{keyword}{True}):
00316     \textcolor{stringliteral}{"""}
00317 \textcolor{stringliteral}{    Return a dictionary of EmisGrid objects referred to by their atom string (e.g. 'O3').}
00318 \textcolor{stringliteral}{    }
00319 \textcolor{stringliteral}{    Usage:}
00320 \textcolor{stringliteral}{        emisgrids = pn.getEmisGridDict(['C', 'N', 'O'], [2, 3], save=True)}
00321 \textcolor{stringliteral}{        emisgrids = pn.getEmisGridDict(atom\_list=['N2', 'O2', 'O3'], pypic\_path='/tmp/pypics/',}
00322 \textcolor{stringliteral}{                        den\_max = 1e6)}
00323 \textcolor{stringliteral}{        emisgrids = pn.getEmisGridDict(atomDict=diags.atomDict)}
00324 \textcolor{stringliteral}{}
00325 \textcolor{stringliteral}{    Parameters:}
00326 \textcolor{stringliteral}{        - elem\_list         list of elements}
00327 \textcolor{stringliteral}{        - spec\_list         list of spectrum values (integers)}
00328 \textcolor{stringliteral}{        - atom\_list         list of atoms (e.g. ['N2', 'O3'])}
00329 \textcolor{stringliteral}{        - restore           Boolean. If True (default), the program will search for a previously computed
       grid.}
00330 \textcolor{stringliteral}{                            If not found, it will compute the EmisGrid (unless computeIfAbsent is set to
       False)}
00331 \textcolor{stringliteral}{        - pypic\_path        directory where to look for the pypic emissivity files. It defaults to
       pn.config.pypic\_path, }
00332 \textcolor{stringliteral}{                            which is defined when the PyNeb session begins and corresponds to $HOME/.pypics
       if}
00333 \textcolor{stringliteral}{                            the ENVIRONMENT variable HOME is accessible or to /tmp/pypics otherwise}
00334 \textcolor{stringliteral}{        - n\_tem, n\_den      number of points in the Te and Ne samples resp. }
00335 \textcolor{stringliteral}{        - tem\_min, tem\_max, den\_min, den\_max    limits for Te and Ne}
00336 \textcolor{stringliteral}{        - save              Boolean. If True (default), the emissivity grid will be saved. It has no effect
       if the }
00337 \textcolor{stringliteral}{                            EmisGrid has just been restored.}
00338 \textcolor{stringliteral}{        - atomDict          dictionary of Atom objects}
00339 \textcolor{stringliteral}{        - computeIfAbsent   If the file to restore is absent and this parameter is True (default), the }
00340 \textcolor{stringliteral}{                            EmisGrid is computed}
00341 \textcolor{stringliteral}{            }
00342 \textcolor{stringliteral}{    """}
00343     \textcolor{keywordflow}{if} pypic\_path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00344         pypic\_path = config.pypic\_path
00345     \textcolor{keywordflow}{else}:
00346         config.pypic\_path = pypic\_path
00347     calling = \textcolor{stringliteral}{'getEmisGridDict'}
00348     \textcolor{keywordflow}{if} pypic\_path \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00349         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00350     emis\_grids = \{\}
00351     atoms = []
00352     \textcolor{keywordflow}{if} atomDict \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00353         atoms = atomDict.keys()
00354     \textcolor{keywordflow}{else}:
00355         \textcolor{keywordflow}{if} atom\_list \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00356             atoms = atom\_list
00357         \textcolor{keywordflow}{else}:
00358 \textcolor{comment}{# VL Removed 13 March 2015 because it made the code ignore the elem keyword             }
00359 \textcolor{comment}{#            atoms = atomicData.getAllAtoms()}
00360             \textcolor{keywordflow}{if} (elem\_list \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (spec\_list \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}):
00361                 atoms = atomicData.getAllAtoms()
00362             \textcolor{keywordflow}{else}:
00363                 \textcolor{keywordflow}{for} elem \textcolor{keywordflow}{in} elem\_list:
00364                     \textcolor{keywordflow}{for} spec \textcolor{keywordflow}{in} spec\_list:
00365                         atoms.append(elem + str(spec)) 
00366     \textcolor{keywordflow}{for} atom \textcolor{keywordflow}{in} atoms:
00367         elem, spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a2bb6f906a75f26a882093e9ce9272507}{parseAtom}(atom)
00368         file\_ = \textcolor{stringliteral}{'\{0\}/emis\_\{1\}\{2\}.pypic'}.format(pypic\_path, elem, spec)
00369         \textcolor{keywordflow}{if} atomDict \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00370             atomObj = atomDict[atom]
00371         \textcolor{keywordflow}{else}:
00372             atomObj = \textcolor{keywordtype}{None}
00373         \textcolor{keywordflow}{if} restore:
00374             \textcolor{keywordflow}{if} os.path.exists(file\_):
00375                 \textcolor{keywordflow}{try}:
00376                     emis\_grids[elem + spec] = \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid}{EmisGrid}(restore\_file=file\_, atomObj=atomObj)
00377                     log\_.message(\textcolor{stringliteral}{'Read %s'} % file\_, calling=calling)
00378                     compute\_this = \textcolor{keyword}{False}
00379                 \textcolor{keywordflow}{except}:
00380                     \textcolor{keywordflow}{if} computeIfAbsent:
00381                         log\_.warn(\textcolor{stringliteral}{'Wrong emission map: \{0\}, creating it'}.format(file\_), calling=calling)
00382                         compute\_this = \textcolor{keyword}{True}
00383                     \textcolor{keywordflow}{else}:
00384                         log\_.error(\textcolor{stringliteral}{'Wrong emission map: \{0\}'}.format(file\_), calling=calling)
00385                         compute\_this = \textcolor{keyword}{False}
00386             \textcolor{keywordflow}{else}:
00387                 log\_.warn(\textcolor{stringliteral}{'Emission map not found: \{0\}'}.format(file\_), calling=calling)
00388                 \textcolor{keywordflow}{if} computeIfAbsent:
00389                     compute\_this = \textcolor{keyword}{True}
00390         \textcolor{keywordflow}{else}:
00391             compute\_this = \textcolor{keyword}{True}
00392         \textcolor{keywordflow}{if} compute\_this:
00393             \textcolor{keywordflow}{try}:
00394                 emis\_grids[atom] = \hyperlink{classpyneb_1_1core_1_1emis_grid_1_1_emis_grid}{EmisGrid}(elem, spec, n\_tem=n\_tem, n\_den=n\_den, tem\_min=tem\_min, 
      tem\_max=tem\_max,
00395                                               den\_min=den\_min, den\_max=den\_max, atomObj=atomObj)
00396                 \textcolor{keywordflow}{if} save:
00397                     emis\_grids[atom].\hyperlink{namespacepyneb_1_1utils_1_1saverestore_a3d897ca7adf9e3ece9ccba7d24d7ec8d}{save}(file\_)
00398                     log\_.message(\textcolor{stringliteral}{'%s saved to %s'} % ((atom), file\_), calling=calling)
00399             \textcolor{keywordflow}{except}:
00400                 log\_.warn(\textcolor{stringliteral}{'No %s EmisGrid'} % (atom), calling=calling)
00401     \textcolor{keywordflow}{return} emis\_grids
\end{DoxyCode}
