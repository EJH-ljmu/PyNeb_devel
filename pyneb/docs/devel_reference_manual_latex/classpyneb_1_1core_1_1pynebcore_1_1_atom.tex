\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom}{}\section{pyneb.\+core.\+pynebcore.\+Atom Class Reference}
\label{classpyneb_1_1core_1_1pynebcore_1_1_atom}\index{pyneb.\+core.\+pynebcore.\+Atom@{pyneb.\+core.\+pynebcore.\+Atom}}


Inherits object.

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{\+\_\+\+\_\+init\+\_\+\+\_\+}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{get\+Omega}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{get\+Coll\+Rates}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{get\+Transition}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a2e6b21ca9b8f63a8da2167bdaf0912f3}{print\+Transition} (self, wave)
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_af603fa94afcc5893bc55a72cafc3fdd5}{print\+Sources} (self)
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9d6390b03ff490938536167fe65d8a87}{get\+Sources} (self)
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{get\+A}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{get\+Populations}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{get\+Low\+Dens\+Ratio}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{get\+High\+Dens\+Ratio}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}{get\+Density\+Range}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{get\+Crit\+Density}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{get\+Emissivity}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{get\+Tem\+Den}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{get\+Ion\+Abundance}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{print\+Ionic}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}{print\+Tem\+Den}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}{plot\+Emiss}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{plot\+Grotrian}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30b539ebf4b4d3bc804bfdf0f8174d9f}{\+\_\+\+\_\+repr\+\_\+\+\_\+} (self)
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{log\+\_\+}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{name}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atom\+File\+Type}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{Atom\+Data}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atom\+File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{atom\+Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{atom\+Fits\+File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{atom\+Fits\+Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\+\_\+\+Ang}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{get\+Stat\+Weight}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{get\+Energy}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atom\+N\+Levels}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{Atom\+Header}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{N\+I\+S\+T}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{line\+List}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{energy\+\_\+\+Ryd}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{energy\+\_\+e\+V}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{coll\+File\+Type}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{Coll\+Data}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{Coll\+Header}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{get\+Omega\+Array}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{get\+Tem\+Array}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{coll\+File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{coll\+Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{coll\+Fits\+File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{coll\+Fits\+Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{coll\+N\+Levels}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{tem\+\_\+units}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{Energy\+N\+Levels}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{N\+Levels}
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\+\_\+\+Transition}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\+\_\+test\+\_\+lev} (self, level)
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\+\_\+get\+Tem\+Den\+\_\+1}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{\+\_\+get\+Tem\+Den\+\_\+\+M\+P}
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\+\_\+\+A}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\+\_\+\+Energy}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\+\_\+\+Stat\+Weight}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\+\_\+crit\+Density}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Define the atom object, fill it with data, explore the data, and 
compute quantities such as level populations and line emissivities.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01133}{1133} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+init\+\_\+\+\_\+@{\+\_\+\+\_\+init\+\_\+\+\_\+}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+\+\_\+init\+\_\+\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+\_\+init\+\_\+\+\_\+ (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{elem = {\ttfamily None}, }
\item[{}]{spec = {\ttfamily None}, }
\item[{}]{atom = {\ttfamily None}, }
\item[{}]{Omega\+Interp = {\ttfamily \textquotesingle{}Linear\textquotesingle{}}, }
\item[{}]{no\+Extrapol = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}
\begin{DoxyVerb}Atom constructor

Parameters:
    - elem          symbol of the selected element
    - spec          ionization stage in spectroscopic notation (I = 1, II = 2, etc.)
    - atom          ion (e.g. 'O3').
    - OmegaInterp   one of ('Cheb', 'Linear'). Default is Linear. "Cheb" works only for fits files. 
    - noExtrapol    if set to False (default), Omega will be extrapolated above and below
            the highest and lowest temperatures where it is defined. If set to True
            a NaN will be return.
    
Usage:
    O3 = pn.Atom('O',3)
    N2 = pn.Atom(atom='N2')
    S2 = pn.Atom(atom='S2', OmegaInterp='Linear')
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01144}{1144} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01144}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{01144}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{\_\_init\_\_}(self, elem=None, spec=None, atom=None, OmegaInterp='Linear', noExtrapol = False):
01145         \textcolor{stringliteral}{"""}
01146 \textcolor{stringliteral}{        Atom constructor}
01147 \textcolor{stringliteral}{        }
01148 \textcolor{stringliteral}{        Parameters:}
01149 \textcolor{stringliteral}{            - elem          symbol of the selected element}
01150 \textcolor{stringliteral}{            - spec          ionization stage in spectroscopic notation (I = 1, II = 2, etc.)}
01151 \textcolor{stringliteral}{            - atom          ion (e.g. 'O3').}
01152 \textcolor{stringliteral}{            - OmegaInterp   one of ('Cheb', 'Linear'). Default is Linear. "Cheb" works only for fits files.
       }
01153 \textcolor{stringliteral}{            - noExtrapol    if set to False (default), Omega will be extrapolated above and below}
01154 \textcolor{stringliteral}{                            the highest and lowest temperatures where it is defined. If set to True}
01155 \textcolor{stringliteral}{                            a NaN will be return.}
01156 \textcolor{stringliteral}{            }
01157 \textcolor{stringliteral}{        Usage:}
01158 \textcolor{stringliteral}{            O3 = pn.Atom('O',3)}
01159 \textcolor{stringliteral}{            N2 = pn.Atom(atom='N2')}
01160 \textcolor{stringliteral}{            S2 = pn.Atom(atom='S2', OmegaInterp='Linear')}
01161 \textcolor{stringliteral}{        """}        
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01162}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{01162}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{log\_} = pn.log\_
01163         \textcolor{keywordflow}{if} atom \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01164}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{01164}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom} = str.capitalize(atom)
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01165}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{01165}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} = \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})[0]
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01166}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{01166}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec} = int(\hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})[1])
01167         \textcolor{keywordflow}{else}:
01168             \textcolor{keywordflow}{if} elem[0].isalpha():
01169                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} = str.capitalize(elem)
01170             \textcolor{keywordflow}{else}:
01171                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} = elem
01172             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec} = int(spec)
01173             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} + str(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01174}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{01174}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{name} = sym2name[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}]
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01175}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{01175}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} = \textcolor{stringliteral}{'Atom '} + self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}
01176         self.log\_.message(\textcolor{stringliteral}{'Making atom object for \{0\} \{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}), calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01177 
01178         dataFile = pn.atomicData.getDataFile(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, data\_type=\textcolor{stringliteral}{'atom'})
01179         \textcolor{keywordflow}{if} dataFile \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01180}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{01180}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} = \textcolor{keywordtype}{None}
01181         \textcolor{keywordflow}{else}:
01182             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} = dataFile.split(\textcolor{stringliteral}{'.'})[-1]
01183         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} == \textcolor{stringliteral}{'fits'}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01184}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{01184}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___atom_data_fits}{\_AtomDataFits}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})
01185         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} == \textcolor{stringliteral}{'dat'}:
01186             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___atom_data_ascii}{\_AtomDataAscii}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})
01187         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} == \textcolor{stringliteral}{'chianti'}:
01188             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1utils_1_1pn__chianti_1_1___atom_chianti}{\_AtomChianti}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})
01189         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01190             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___atom_data_none}{\_AtomDataNone}()
01191         \textcolor{keywordflow}{else}:
01192             pn.log\_.error(\textcolor{stringliteral}{'Atom file extensions must be fits, dat or chianti'})
01193                     
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01194}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{01194}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atomFile} = self.AtomData.atomFile
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01195}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{01195}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{atomPath} = self.AtomData.atomPath
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01196}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{01196}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{atomFitsFile} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atomFile} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01197}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{01197}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{atomFitsPath} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{atomPath} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01198}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{01198}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang} = self.AtomData.wave\_Ang
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01199}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{01199}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight} = self.AtomData.getStatWeight
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01200}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{01200}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy} = self.AtomData.getEnergy
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01201}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{01201}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atomNLevels} = self.AtomData.NLevels
01202         \textcolor{keywordflow}{try}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01203}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{01203}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs} = self.AtomData.gs
01204         \textcolor{keywordflow}{except}:
01205             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs} = \hyperlink{namespacepyneb_1_1utils_1_1physics_affea300d5f6d64b440b7363755a67cef}{gsFromAtom}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})
01206         \textcolor{keywordflow}{try}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01207}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{01207}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{AtomHeader} = self.AtomData.AtomHeader
01208         \textcolor{keywordflow}{except}:
01209             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{AtomHeader} = \textcolor{keywordtype}{None}
01210         \textcolor{keywordflow}{try}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01211}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{01211}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} = self.AtomData.NIST
01212         \textcolor{keywordflow}{except}:
01213             \textcolor{keywordflow}{try}:
01214                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} = \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{getLevelsNIST}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atomNLevels})
01215             \textcolor{keywordflow}{except}:
01216                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} = \textcolor{keywordtype}{None}
01217 
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01218}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{01218}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList} = []
01219         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atomNLevels}):
01220             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} np.arange(i):
01221                 self.lineList.append(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i][j])
01222         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList} = np.array(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01223}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{01223}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{energy\_Ryd} = \hyperlink{namespacepyneb_1_1utils_1_1misc_afa4163f24be7b1472200c24824c72ae1}{quiet\_divide}(pn.CST.RYD\_ANG, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01224}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{01224}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{energy\_eV} = pn.CST.RYD\_EV * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{energy\_Ryd}
01225 
01226         dataFile = pn.atomicData.getDataFile(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, data\_type=\textcolor{stringliteral}{'coll'})
01227         \textcolor{keywordflow}{if} dataFile \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01228}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{01228}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} = \textcolor{keywordtype}{None}
01229         \textcolor{keywordflow}{else}:
01230             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} = dataFile.split(\textcolor{stringliteral}{'.'})[-1]
01231         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} == \textcolor{stringliteral}{'fits'}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01232}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{01232}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___coll_data_fits}{\_CollDataFits}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, 
01233                                          OmegaInterp=OmegaInterp, noExtrapol = noExtrapol)
01234         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} == \textcolor{stringliteral}{'dat'}:
01235             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___coll_data_ascii}{\_CollDataAscii}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, 
01236                                           OmegaInterp=\textcolor{stringliteral}{'Linear'}, noExtrapol = noExtrapol)
01237         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} == \textcolor{stringliteral}{'chianti'}:
01238             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1utils_1_1pn__chianti_1_1___coll_chianti}{\_CollChianti}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})
01239         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01240             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___coll_data_none}{\_CollDataNone}()
01241         \textcolor{keywordflow}{try}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01242}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{01242}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{CollHeader} = self.CollData.CollHeader
01243         \textcolor{keywordflow}{except}:
01244             \textcolor{keywordflow}{pass}
01245         \textcolor{keywordflow}{if} \textcolor{stringliteral}{"comments"} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.CollData.\_\_dict\_\_.keys():
01246             self.CollData.comments = []
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01247}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{01247}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{getOmegaArray} = self.CollData.getOmegaArray
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01248}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{01248}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{getTemArray} = self.CollData.getTemArray
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01249}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{01249}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{collFile} = self.CollData.collFile
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01250}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{01250}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{collPath} = self.CollData.collPath
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01251}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{01251}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{collFitsFile} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{collFile} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01252}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{01252}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{collFitsPath} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{collPath} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01253}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{01253}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels} = self.CollData.NLevels
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01254}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{01254}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{tem\_units} = self.CollData.tem\_units
01255 
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01256}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{01256}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}() \textcolor{comment}{# index = quantum number - 1}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01257}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{01257}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}() \textcolor{comment}{# Angstrom^-1}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01258}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{01258}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\_StatWeight} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}()
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01259}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{01259}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{EnergyNLevels} = len(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01260}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{01260}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels} = np.min((self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atomNLevels}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{EnergyNLevels}))
01261         
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30b539ebf4b4d3bc804bfdf0f8174d9f}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+\+\_\+repr\+\_\+\+\_\+@{\+\_\+\+\_\+repr\+\_\+\+\_\+}}
\index{\+\_\+\+\_\+repr\+\_\+\+\_\+@{\+\_\+\+\_\+repr\+\_\+\+\_\+}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+\+\_\+repr\+\_\+\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+\_\+repr\+\_\+\+\_\+ (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30b539ebf4b4d3bc804bfdf0f8174d9f}


Definition at line \hyperlink{pynebcore_8py_source_l02544}{2544} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00053}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+atom\+File}, \hyperlink{pynebcore_8py_source_l00105}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+atom\+File}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+atom\+File}, \hyperlink{pynebcore_8py_source_l01194}{pyneb.\+core.\+pynebcore.\+Atom.\+atom\+File}, \hyperlink{pynebcore_8py_source_l00069}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+coll\+File}, \hyperlink{pynebcore_8py_source_l00598}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+coll\+File}, \hyperlink{pynebcore_8py_source_l00949}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+coll\+File}, \hyperlink{pynebcore_8py_source_l01249}{pyneb.\+core.\+pynebcore.\+Atom.\+coll\+File}, \hyperlink{emis_grid_8py_source_l00045}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+elem}, \hyperlink{pynebcore_8py_source_l00083}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00304}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l00560}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00910}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l01165}{pyneb.\+core.\+pynebcore.\+Atom.\+elem}, \hyperlink{emis_grid_8py_source_l00046}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+spec}, \hyperlink{pynebcore_8py_source_l00084}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00305}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+spec}, \hyperlink{pynebcore_8py_source_l00561}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00911}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+spec}, and \hyperlink{pynebcore_8py_source_l01166}{pyneb.\+core.\+pynebcore.\+Atom.\+spec}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02544}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30b539ebf4b4d3bc804bfdf0f8174d9f}{02544}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30b539ebf4b4d3bc804bfdf0f8174d9f}{\_\_repr\_\_}(self):
02545         \textcolor{keywordflow}{return} \textcolor{stringliteral}{'Atom \{0\}\{1\} from \{2\} and \{3\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atomFile}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{collFile})
02546 
02547 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+get\+Tem\+Den\+\_\+1@{\+\_\+get\+Tem\+Den\+\_\+1}}
\index{\+\_\+get\+Tem\+Den\+\_\+1@{\+\_\+get\+Tem\+Den\+\_\+1}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+get\+Tem\+Den\+\_\+1}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1 (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\+\_\+ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i2 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\+Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily \textquotesingle{}nsect\+\_\+recur\textquotesingle{}}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{end\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}, }
\item[{}]{n\+Cut = {\ttfamily 30}, }
\item[{}]{max\+Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]manage blends \end{DoxyRefDesc}


Definition at line \hyperlink{pynebcore_8py_source_l01803}{1803} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00093}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l00402}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l01256}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l00094}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l00400}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l01257}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l01980}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P()}, \hyperlink{pynebcore_8py_source_l00171}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00435}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00660}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01026}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01459}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{_fortran_format_8py_source_l00318}{pyneb.\+utils.\+Fortran\+Format.\+f}, \hyperlink{pynebcore_8py_source_l01496}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations()}, \hyperlink{pynebcore_8py_source_l00068}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+get\+Tem\+Array}, \hyperlink{pynebcore_8py_source_l01248}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Array}, \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}, and \hyperlink{misc_8py_source_l00260}{pyneb.\+utils.\+misc.\+quiet\+\_\+divide()}.



Referenced by \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l01980}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, and \hyperlink{pynebcore_8py_source_l02060}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01803}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{01803}                   to\_eval=\textcolor{keywordtype}{None}, nCut=30, maxIter=20):
01804 
01805         \textcolor{comment}{##}
01806         \textcolor{comment}{# @todo manage blends}
01807         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_i1)
01808         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_j1)
01809         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_i2)
01810         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_j2)
01811         tem = np.asarray(tem)
01812         den = np.asarray(den)
01813         \textcolor{keywordflow}{if} np.asarray(int\_ratio).size != 1:
01814             shape = np.asarray(int\_ratio).shape
01815             size = np.asarray(int\_ratio).size
01816             result = np.zeros(size) 
01817             \textcolor{keywordflow}{if} np.asarray(tem).size != 1:
01818                 \textcolor{keywordflow}{if} np.asarray(tem).shape != shape:
01819                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01820                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01821                 tem\_ravel = np.asarray(tem).ravel()
01822                 den\_ravel = np.zeros(size) + den
01823             \textcolor{keywordflow}{elif} np.asarray(den).size != 1:
01824                 \textcolor{keywordflow}{if} np.asarray(den).shape != shape:
01825                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01826                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01827                 den\_ravel = np.asarray(den).ravel()
01828                 tem\_ravel = np.zeros(size) + tem
01829             \textcolor{keywordflow}{else}:
01830                 den\_ravel = np.zeros(size) + den
01831                 tem\_ravel = np.zeros(size) + tem
01832             int\_ratio\_ravel = np.asarray(int\_ratio).ravel()
01833             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(size):
01834                 result[i] = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\_getTemDen\_1}(int\_ratio\_ravel[i], tem=tem\_ravel[i], den=
      den\_ravel[i],
01835                                            lev\_i1=lev\_i1, lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
01836                                            wave1=wave1, wave2=wave2, maxError=maxError, method=method,
01837                                            log=log, start\_x=start\_x, end\_x=end\_x,
01838                                            to\_eval=to\_eval)
01839             \textcolor{keywordflow}{return} result.reshape(shape)
01840             
01841         \textcolor{keywordflow}{if} wave1 != -1:
01842             lev\_i1, lev\_j1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave1)
01843         \textcolor{keywordflow}{if} wave2 != -1:
01844             lev\_i2, lev\_j2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave2)
01845 
01846         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01847             to\_eval = \textcolor{stringliteral}{'I('} + str(lev\_i1) + \textcolor{stringliteral}{','} + str(lev\_j1) + \textcolor{stringliteral}{')/I('} + str(lev\_i2) + \textcolor{stringliteral}{','} + str(lev\_j2) + \textcolor{stringliteral}{'
      )'}
01848 
01849 
01850         \textcolor{keywordflow}{if} tem == -1:
01851             \textcolor{keywordflow}{if} start\_x == -1:
01852                 start\_x = min(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{getTemArray}(keep\_unit=\textcolor{keyword}{False}))
01853                 \textcolor{keywordflow}{if} log:
01854                     start\_x = np.log10(start\_x)
01855             \textcolor{keywordflow}{if} end\_x == -1:
01856                 end\_x = max(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{getTemArray}(keep\_unit=\textcolor{keyword}{False}))
01857                 \textcolor{keywordflow}{if} log:
01858                     end\_x = np.log10(end\_x)
01859             
01860             @profile
01861             \textcolor{keyword}{def }\_func(x):
01862                 \textcolor{stringliteral}{"""}
01863 \textcolor{stringliteral}{                The function for which a root is looked for.}
01864 \textcolor{stringliteral}{                It must return an array if x is an array, if an nsect-like method is used.}
01865 \textcolor{stringliteral}{                The returned value is already normalized to the intensity ratio.}
01866 \textcolor{stringliteral}{}
01867 \textcolor{stringliteral}{                """}
01868                 \textcolor{keywordflow}{if} log:
01869                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(10.**x, den)
01870                 \textcolor{keywordflow}{else}:
01871                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(x, den)
01872                 I = \textcolor{keyword}{lambda} lev\_i, lev\_j: (populations[lev\_i - 1] * 
01873                                           (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[lev\_i - 1, lev\_j - 1] * 
01874                                            (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_i - 1] - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_j - 1])))
01875                 L = \textcolor{keyword}{lambda} wave: (populations[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] * 
01876                                   (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1] * 
01877                                    (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] - 
01878                                     self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1])))
01879                 result = eval(to\_eval)
01880                 \textcolor{keywordflow}{return} \hyperlink{namespacepyneb_1_1utils_1_1misc_afa4163f24be7b1472200c24824c72ae1}{quiet\_divide}((result - int\_ratio), int\_ratio)
01881             
01882         \textcolor{keywordflow}{elif} den == -1:
01883             \textcolor{keywordflow}{if} start\_x == -1:
01884                 start\_x = 1.e0
01885                 \textcolor{keywordflow}{if} log: start\_x = np.log10(start\_x)
01886             \textcolor{keywordflow}{if} end\_x == -1:
01887                 end\_x = 1e8
01888                 \textcolor{keywordflow}{if} log: end\_x = np.log10(end\_x)
01889 
01890             @profile
01891             \textcolor{keyword}{def }\_func(x):
01892                 \textcolor{stringliteral}{"""}
01893 \textcolor{stringliteral}{                The function for which a root is looked for.}
01894 \textcolor{stringliteral}{                It must return an array if x is an array, if an nsect-like method is used.}
01895 \textcolor{stringliteral}{                The returned value is already normalized to the intensity ratio.}
01896 \textcolor{stringliteral}{                }
01897 \textcolor{stringliteral}{                """}
01898                 \textcolor{keywordflow}{if} log:
01899                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, pow(10., x))
01900                 \textcolor{keywordflow}{else}:
01901                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, x)
01902                 I = \textcolor{keyword}{lambda} lev\_i, lev\_j: (populations[lev\_i - 1] * 
01903                                           (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[lev\_i - 1, lev\_j - 1] * 
01904                                            (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_i - 1] - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_j - 1])))
01905                 L = \textcolor{keyword}{lambda} wave: (populations[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] * 
01906                                   (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1] * 
01907                                    (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] - 
01908                                     self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1])))
01909                 result = eval(to\_eval)
01910                 \textcolor{keywordflow}{return} \hyperlink{namespacepyneb_1_1utils_1_1misc_afa4163f24be7b1472200c24824c72ae1}{quiet\_divide}((result - int\_ratio), int\_ratio)
01911         \textcolor{comment}{# improve exception handling (we must include cases where both tem, den = -1) }
01912         \textcolor{keywordflow}{else}:
01913             self.log\_.error(\textcolor{stringliteral}{'ERROR in getTemDen: temperature and density cannot be simultaneously given'},
01914                             calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01915 
01916         \textcolor{keywordflow}{if} method == \textcolor{stringliteral}{'nsect\_recur'}:
01917             \textcolor{stringliteral}{"""}
01918 \textcolor{stringliteral}{            Recursive n-section method for finding a root}
01919 \textcolor{stringliteral}{            It works by looking for the minumum of abs(f) using the fact that f(array) }
01920 \textcolor{stringliteral}{                returns an array}
01921 \textcolor{stringliteral}{}
01922 \textcolor{stringliteral}{            """}
01923             @profile
01924             \textcolor{keyword}{def }nsect\_recur(f, x1, x2, nCut, maxIter, \_iter=0):
01925                 \textcolor{keywordflow}{if} \_iter > maxIter:
01926                     \textcolor{keywordflow}{return} np.nan
01927                 x = np.linspace(x1, x2, nCut)
01928                 y = abs(\hyperlink{namespacepyneb_1_1utils_1_1_fortran_format_af94352584eced016c14d524330879115}{f}(x))
01929                 x\_min = np.argmin(y)
01930                 \textcolor{keywordflow}{if} y[x\_min] < maxError:
01931                     \textcolor{keywordflow}{return} x[x\_min]
01932                 \textcolor{keywordflow}{else}:
01933                     \textcolor{keywordflow}{if} x\_min == 0:
01934                         x\_min = 1
01935                     \textcolor{keywordflow}{if} x\_min == nCut - 1:
01936                         x\_min = nCut - 2
01937                     x1 = x[x\_min - 1]
01938                     x2 = x[x\_min + 1]
01939                     \_iter = \_iter + 1
01940                     \textcolor{keywordflow}{return} nsect\_recur(f, x1, x2, nCut=nCut, maxIter=maxIter, \_iter=\_iter)
01941 
01942             result = nsect\_recur(\_func, start\_x, end\_x, nCut, maxIter)
01943 
01944         \textcolor{keywordflow}{elif} method == \textcolor{stringliteral}{'nsect\_iter'}:
01945             \textcolor{stringliteral}{"""}
01946 \textcolor{stringliteral}{            Iterative n-section method for finding a root (analogous to the bisection method)}
01947 \textcolor{stringliteral}{            It works by looking for the minimum of abs(f) using the fact that f(array) returns an array}
01948 \textcolor{stringliteral}{}
01949 \textcolor{stringliteral}{            """}
01950             
01951             @profile
01952             \textcolor{keyword}{def }nsect\_iter(f, x1, x2, nCut, maxIter):
01953                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(maxIter):
01954                     x = np.linspace(x1, x2, nCut)
01955                     y = abs(\hyperlink{namespacepyneb_1_1utils_1_1_fortran_format_af94352584eced016c14d524330879115}{f}(x))
01956                     x\_min = np.argmin(y)
01957                     \textcolor{keywordflow}{if} y[x\_min] < maxError:
01958                         \textcolor{keywordflow}{return} x[x\_min]
01959                     \textcolor{keywordflow}{else}:
01960                         \textcolor{keywordflow}{if} x\_min == 0: x\_min = 1
01961                         \textcolor{keywordflow}{if} x\_min == nCut - 1: x\_min = nCut - 2
01962                         x1 = x[x\_min - 1]
01963                         x2 = x[x\_min + 1]
01964                 \textcolor{keywordflow}{return} np.nan
01965 
01966             result = nsect\_iter(\_func, start\_x, end\_x, nCut, maxIter)
01967             
01968         \textcolor{keywordflow}{else}:
01969             self.log\_.error(\textcolor{stringliteral}{'ERROR in getTemDen: no valid method given'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01970             result = \textcolor{keywordtype}{None}
01971 
01972         \textcolor{keywordflow}{if} (log \textcolor{keywordflow}{is} \textcolor{keyword}{True}) \textcolor{keywordflow}{and} (result \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}):
01973             \textcolor{keywordflow}{return} pow(10., result)
01974         \textcolor{keywordflow}{else}:
01975             \textcolor{keywordflow}{return} result
01976 
01977 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+get\+Tem\+Den\+\_\+\+M\+P@{\+\_\+get\+Tem\+Den\+\_\+\+M\+P}}
\index{\+\_\+get\+Tem\+Den\+\_\+\+M\+P@{\+\_\+get\+Tem\+Den\+\_\+\+M\+P}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+get\+Tem\+Den\+\_\+\+M\+P}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\+\_\+ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i2 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\+Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily \textquotesingle{}nsect\+\_\+recur\textquotesingle{}}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{end\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}, }
\item[{}]{n\+Cut = {\ttfamily 30}, }
\item[{}]{max\+Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}


Definition at line \hyperlink{pynebcore_8py_source_l01980}{1980} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l00171}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00435}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00660}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01026}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01459}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{emis_grid_8py_source_l00048}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+atom}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00303}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l00559}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00909}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\+core.\+pynebcore.\+Atom.\+atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, and \hyperlink{pynebcore_8py_source_l02060}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Den()}.



Referenced by \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, and \hyperlink{pynebcore_8py_source_l02060}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01980}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{01980}                   to\_eval=\textcolor{keywordtype}{None}, nCut=30, maxIter=20):
01981         
01982         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} pn.config.INSTALLED[\textcolor{stringliteral}{'mp'}]:
01983             pn.log\_.error(\textcolor{stringliteral}{'\_getTemDen\_MP cannot be used in absence of multiprocessing package'},
01984                           calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01985             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01986         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_i1)
01987         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_j1)
01988         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_i2)
01989         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_j2)
01990         tem = np.asarray(tem)
01991         den = np.asarray(den)
01992         \textcolor{keywordflow}{if} np.asarray(int\_ratio).size != 1:
01993             shape = np.asarray(int\_ratio).shape
01994             size = np.asarray(int\_ratio).size
01995             result = np.zeros(size) 
01996             \textcolor{keywordflow}{if} np.asarray(tem).size != 1:
01997                 \textcolor{keywordflow}{if} np.asarray(tem).shape != shape:
01998                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01999                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02000                 tem\_ravel = np.asarray(tem).ravel()
02001                 den\_ravel = np.zeros(size) + den
02002             \textcolor{keywordflow}{elif} np.asarray(den).size != 1:
02003                 \textcolor{keywordflow}{if} np.asarray(den).shape != shape:
02004                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02005                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02006                 den\_ravel = np.asarray(den).ravel()
02007                 tem\_ravel = np.zeros(size) + tem
02008             \textcolor{keywordflow}{else}:
02009                 den\_ravel = np.zeros(size) + den
02010                 tem\_ravel = np.zeros(size) + tem
02011             int\_ratio\_ravel = np.asarray(int\_ratio).ravel()
02012         \textcolor{keywordflow}{else}:
02013             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\_getTemDen\_1}(int\_ratio=int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, 
      lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
02014                   wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, start\_x=start\_x,
02015                   end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)
02016         
02017         Nprocs = pn.config.Nprocs
02018         pn.log\_.message(\textcolor{stringliteral}{'number of CPUs = \{0\}'}.format(Nprocs), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02019         gTDWorkerQ = Queue()
02020         gTDDoneQ = Queue()
02021         pn.log\_.message(\textcolor{stringliteral}{'Queues initialized'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02022         jobid = 0
02023         \textcolor{keywordflow}{for} int\_rat1, tem1, den1 \textcolor{keywordflow}{in} zip(int\_ratio\_ravel, tem\_ravel, den\_ravel):
02024             gTDWorkerQ.put((jobid, int\_rat1, tem1, den1))
02025             jobid += 1
02026         pn.log\_.message(\textcolor{stringliteral}{'put done'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02027         \textcolor{comment}{#gTDWorkerQSize = gTDWorkerQ.qsize() # this crash on OSX}
02028         gTDWorkerQSize = size
02029         pn.log\_.message(\textcolor{stringliteral}{'Queue size \{0\}'}.format(gTDWorkerQSize), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02030 
02031         
02032         gTDProcesses = []
02033         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(Nprocs):
02034             p = Process(target=getTemDen\_helper, args=(gTDWorkerQ, gTDDoneQ, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, lev\_i1, lev\_j1, lev\_i2, lev\_j2,
02035                   wave1, wave2, maxError, method, log, start\_x, end\_x, to\_eval, nCut, maxIter))
02036             p.start()
02037             gTDProcesses.append(p)
02038         pn.log\_.message(\textcolor{stringliteral}{'processes started'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02039 
02040         \textcolor{comment}{#}
02041         result = []
02042         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(gTDWorkerQSize):
02043             result.append(gTDDoneQ.get())
02044         pn.log\_.message(\textcolor{stringliteral}{'Result obtained'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02045 
02046         \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} gTDProcesses:
02047             p.join(timeout=0.1)
02048         pn.log\_.message(\textcolor{stringliteral}{'Joined'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02049 
02050         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(Nprocs):
02051             gTDWorkerQ.put(\textcolor{stringliteral}{'STOP'})
02052         result.sort()
02053         to\_return = np.array(result)[:, 1]
02054         \textcolor{keywordflow}{return} to\_return.reshape(int\_ratio.shape)
02055 
02056     
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+test\+\_\+lev@{\+\_\+test\+\_\+lev}}
\index{\+\_\+test\+\_\+lev@{\+\_\+test\+\_\+lev}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+test\+\_\+lev}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{level}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}
\begin{DoxyVerb}Test whether selected level is legal

Parameters:
    - level        selected atom level\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01459}{1459} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{pynebcore_8py_source_l00062}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00075}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00155}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00404}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00637}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00984}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+N\+Levels}, and \hyperlink{pynebcore_8py_source_l01260}{pyneb.\+core.\+pynebcore.\+Atom.\+N\+Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l01980}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P()}, \hyperlink{pn__chianti_8py_source_l00296}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+get\+A()}, \hyperlink{pynebcore_8py_source_l01693}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Crit\+Density()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pn__chianti_8py_source_l00346}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+get\+Energy()}, \hyperlink{pynebcore_8py_source_l02811}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Energy()}, \hyperlink{pynebcore_8py_source_l02110}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Ion\+Abundance()}, \hyperlink{pn__chianti_8py_source_l00484}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+get\+Omega()}, \hyperlink{pn__chianti_8py_source_l00461}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+get\+Omega\+Array()}, \hyperlink{pn__chianti_8py_source_l00323}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+get\+Stat\+Weight()}, and \hyperlink{pynebcore_8py_source_l02623}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Wave()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01459}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{01459}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(self, level):
01460         \textcolor{stringliteral}{"""}
01461 \textcolor{stringliteral}{        Test whether selected level is legal}
01462 \textcolor{stringliteral}{}
01463 \textcolor{stringliteral}{        Parameters:}
01464 \textcolor{stringliteral}{            - level        selected atom level}
01465 \textcolor{stringliteral}{}
01466 \textcolor{stringliteral}{        """}       
01467         \textcolor{keywordflow}{if} level < -1 \textcolor{keywordflow}{or} level == 0 \textcolor{keywordflow}{or} level > self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}:
01468             self.log\_.error(\textcolor{stringliteral}{'Wrong value for level: \{0\}, maximum = \{1\}'}.format(level, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}),
01469                             calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01470 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+\+Transition@{\+\_\+\+Transition}}
\index{\+\_\+\+Transition@{\+\_\+\+Transition}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+\+Transition}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Transition (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{wave, }
\item[{}]{max\+Error\+A = {\ttfamily 5.e-\/3}, }
\item[{}]{max\+Errorm = {\ttfamily 5.e-\/2}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}
\begin{DoxyVerb}Return an array with computed upper level, computed lower level, computed wavelength, 
    input wavelength

Parameters:
    - wave       wavelength either in Angstrom (a float or a label: e.g., 5007, '5007A') 
            or in micron (a label: '51.5m')
    - maxErrorA: tolerance if the input wavelength is in Angstrom
    - maxErrorm: tolerance if the input wavelength is in micron\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01367}{1367} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{emis_grid_8py_source_l00048}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+atom}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00303}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l00559}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00909}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\+core.\+pynebcore.\+Atom.\+atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{pynebcore_8py_source_l00057}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+wave\+\_\+\+Ang}, \hyperlink{pynebcore_8py_source_l00165}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+wave\+\_\+\+Ang}, \hyperlink{pynebcore_8py_source_l00426}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+wave\+\_\+\+Ang}, and \hyperlink{pynebcore_8py_source_l01198}{pyneb.\+core.\+pynebcore.\+Atom.\+wave\+\_\+\+Ang}.



Referenced by \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}, \hyperlink{pynebcore_8py_source_l02756}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Transition()}, \hyperlink{pynebcore_8py_source_l01425}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Transition()}, and \hyperlink{pynebcore_8py_source_l02775}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+print\+Transition()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01367}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{01367}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\_Transition}(self, wave, maxErrorA = 5.e-3, maxErrorm = 5.e-2):
01368         \textcolor{stringliteral}{"""}
01369 \textcolor{stringliteral}{        Return an array with computed upper level, computed lower level, computed wavelength, }
01370 \textcolor{stringliteral}{            input wavelength}
01371 \textcolor{stringliteral}{        }
01372 \textcolor{stringliteral}{        Parameters:}
01373 \textcolor{stringliteral}{            - wave       wavelength either in Angstrom (a float or a label: e.g., 5007, '5007A') }
01374 \textcolor{stringliteral}{                            or in micron (a label: '51.5m')}
01375 \textcolor{stringliteral}{            - maxErrorA: tolerance if the input wavelength is in Angstrom}
01376 \textcolor{stringliteral}{            - maxErrorm: tolerance if the input wavelength is in micron}
01377 \textcolor{stringliteral}{                            }
01378 \textcolor{stringliteral}{        """}
01379         \textcolor{keywordflow}{if} str(wave)[-1] == \textcolor{stringliteral}{'A'}:
01380             inputWave = float(wave[:-1])
01381             label = \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave)
01382             maxError = maxErrorA
01383         \textcolor{keywordflow}{elif} str(wave)[-1] == \textcolor{stringliteral}{'m'}:
01384             inputWave = float(wave[:-1]) * 1e4
01385             label = \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave)
01386             maxError = maxErrorm
01387         \textcolor{keywordflow}{else}:
01388             inputWave = wave
01389             label = \textcolor{stringliteral}{'\{0\}\_\{1\}A'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, int(wave))
01390             maxError = maxErrorA
01391             
01392         \textcolor{keywordflow}{if} label \textcolor{keywordflow}{in} label2levelDict:
01393             result = [label2levelDict[label][0], label2levelDict[label][1], inputWave, inputWave]
01394             return(result)
01395         
01396         j, i = np.unravel\_index(np.argmin(abs(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang} - inputWave)), self.wave\_Ang.shape)
01397         bestWave = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j]
01398         error = np.abs(bestWave - inputWave) / inputWave
01399         result = [i + 1, j + 1, bestWave, inputWave]
01400         \textcolor{keywordflow}{if} error > maxError:
01401             self.log\_.warn(\textcolor{stringliteral}{'\_Transition: wavelengths differ by more than \{0:.2f\}%: input = \{1:.2f\}, output
       = \{2:.2f\}'}\(\backslash\)
01402                            .format(100 * maxError, inputWave, bestWave), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01403         return(result)
01404 
01405 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+A@{get\+A}}
\index{get\+A@{get\+A}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+A}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+A (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\+\_\+i = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}
\begin{DoxyVerb}Return the transition probability data. 
If no arguments are given, the whole array of A is returned.
A specific A value can be obtained by giving either the upper and lower levels or 
    the wavelength of the transition (keyword wave).
    
Usage:
    A_O3 = O3.getA()          # The whole A array is stored in A_O3
    O3.getA(4, 2)      # A(4, 2) of the O3 atom is printed
    O3.getA(2, 4)      # Returns 0
    O3.getA(wave=4959)      

Parameters:
    - lev_i  upper level of transition (default= -1, returns complete array)
    - lev_j  lower level of transition (default= -1, returns complete array)
    - wave   wavelength of transition. Takes precedence on lev_i and lev_j. Ignored if not set.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01471}{1471} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01653}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+High\+Dens\+Ratio()}, and \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01471}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{01471}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(self, lev\_i= -1, lev\_j= -1, wave= -1):
01472         \textcolor{stringliteral}{"""}
01473 \textcolor{stringliteral}{        Return the transition probability data. }
01474 \textcolor{stringliteral}{        If no arguments are given, the whole array of A is returned.}
01475 \textcolor{stringliteral}{        A specific A value can be obtained by giving either the upper and lower levels or }
01476 \textcolor{stringliteral}{            the wavelength of the transition (keyword wave).}
01477 \textcolor{stringliteral}{            }
01478 \textcolor{stringliteral}{        Usage:}
01479 \textcolor{stringliteral}{            A\_O3 = O3.getA()          # The whole A array is stored in A\_O3}
01480 \textcolor{stringliteral}{            O3.getA(4, 2)      # A(4, 2) of the O3 atom is printed}
01481 \textcolor{stringliteral}{            O3.getA(2, 4)      # Returns 0}
01482 \textcolor{stringliteral}{            O3.getA(wave=4959)      }
01483 \textcolor{stringliteral}{}
01484 \textcolor{stringliteral}{        Parameters:}
01485 \textcolor{stringliteral}{            - lev\_i  upper level of transition (default= -1, returns complete array)}
01486 \textcolor{stringliteral}{            - lev\_j  lower level of transition (default= -1, returns complete array)}
01487 \textcolor{stringliteral}{            - wave   wavelength of transition. Takes precedence on lev\_i and lev\_j. Ignored if not set.}
01488 \textcolor{stringliteral}{            }
01489 \textcolor{stringliteral}{        """}
01490         \textcolor{keywordflow}{if} wave != -1:
01491             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
01492         
01493         \textcolor{keywordflow}{return} self.AtomData.getA(lev\_i= lev\_i, lev\_j= lev\_j)
01494         
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Coll\+Rates@{get\+Coll\+Rates}}
\index{get\+Coll\+Rates@{get\+Coll\+Rates}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Coll\+Rates}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Coll\+Rates (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{N\+Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}
\begin{DoxyVerb}Return (n_levels x n_levels) array of collision rates at given temperature. 

Usage:
    O3.getCollRates(tem=10000)
    O3.getCollRates([8e3, 1e4, 1.2e4])

Parameters:
    - tem     electronic temperature in K. May be an array.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01329}{1329} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00094}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l00400}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l01257}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l00095}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l00401}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l01258}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l00073}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+coll\+N\+Levels}, \hyperlink{pynebcore_8py_source_l01253}{pyneb.\+core.\+pynebcore.\+Atom.\+coll\+N\+Levels}, \hyperlink{pynebcore_8py_source_l01259}{pyneb.\+core.\+pynebcore.\+Atom.\+Energy\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00811}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+get\+Omega()}, \hyperlink{pynebcore_8py_source_l01063}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+get\+Omega()}, and \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}.



Referenced by \hyperlink{pynebcore_8py_source_l01496}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01329}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{01329}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{getCollRates}(self, tem, NLevels=None):
01330         \textcolor{stringliteral}{"""}
01331 \textcolor{stringliteral}{        Return (n\_levels x n\_levels) array of collision rates at given temperature. }
01332 \textcolor{stringliteral}{        }
01333 \textcolor{stringliteral}{        Usage:}
01334 \textcolor{stringliteral}{            O3.getCollRates(tem=10000)}
01335 \textcolor{stringliteral}{            O3.getCollRates([8e3, 1e4, 1.2e4])}
01336 \textcolor{stringliteral}{        }
01337 \textcolor{stringliteral}{        Parameters:}
01338 \textcolor{stringliteral}{            - tem     electronic temperature in K. May be an array.}
01339 \textcolor{stringliteral}{}
01340 \textcolor{stringliteral}{}
01341 \textcolor{stringliteral}{        """}
01342         tem = np.asarray(tem)
01343         \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01344             NLevels = np.min((self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{EnergyNLevels}))
01345         res\_shape = [NLevels, NLevels]
01346         \textcolor{keywordflow}{for} sh \textcolor{keywordflow}{in} tem.shape:
01347             res\_shape.append(sh)
01348         resultArray = np.zeros(res\_shape)
01349         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(NLevels - 1):
01350             lev\_i = i + 1
01351             j = i + 1
01352             energy\_i = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i]
01353             stat\_weight\_i = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\_StatWeight}[i]
01354             \textcolor{keywordflow}{while} (j < NLevels):
01355                 lev\_j = j + 1 
01356                 energy\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]
01357                 stat\_weight\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\_StatWeight}[j]
01358                 resultArray[j][i] = pn.CST.KCOLLRATE / tem ** 0.5 / stat\_weight\_j * self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{getOmega}(tem, lev\_j, lev\_i)
01359                 resultArray[i][j] = ((stat\_weight\_j) / (stat\_weight\_i) * 
01360                                       np.exp((energy\_i - energy\_j) / (pn.CST.BOLTZMANN\_ANGK * tem)) * 
01361                                       resultArray[j][i])
01362                 j += 1
01363         
01364         \textcolor{keywordflow}{return} np.squeeze(resultArray)
01365 
01366     
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Crit\+Density@{get\+Crit\+Density}}
\index{get\+Crit\+Density@{get\+Crit\+Density}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Crit\+Density}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Crit\+Density (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{level = {\ttfamily -\/1}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}
\begin{DoxyVerb}Return the critical density of selected level at given temperature. 
If no transition is selected, return complete array.

Usage:
    O3.getCritDensity(12000)
    O3.getCritDensity(12000, 4)

Parameters:
    - tem    electronic temperature in K. May be an array.
    - level  selected atomic level (default= -1)\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01693}{1693} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01553}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+crit\+Density}, \hyperlink{pynebcore_8py_source_l00171}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00435}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00660}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01026}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01459}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev()}, and \hyperlink{pynebcore_8py_source_l01496}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations()}.



Referenced by \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01693}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{01693}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{getCritDensity}(self, tem, level= -1):
01694         \textcolor{stringliteral}{"""}
01695 \textcolor{stringliteral}{        Return the critical density of selected level at given temperature. }
01696 \textcolor{stringliteral}{        If no transition is selected, return complete array.}
01697 \textcolor{stringliteral}{        }
01698 \textcolor{stringliteral}{        Usage:}
01699 \textcolor{stringliteral}{            O3.getCritDensity(12000)}
01700 \textcolor{stringliteral}{            O3.getCritDensity(12000, 4)}
01701 \textcolor{stringliteral}{        }
01702 \textcolor{stringliteral}{        Parameters:}
01703 \textcolor{stringliteral}{            - tem    electronic temperature in K. May be an array.}
01704 \textcolor{stringliteral}{            - level  selected atomic level (default= -1)}
01705 \textcolor{stringliteral}{}
01706 \textcolor{stringliteral}{        """}
01707         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(level)
01708         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den=100.) \textcolor{comment}{# Any density would do}
01709         \textcolor{keywordflow}{if} level != -1:
01710             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity}[level - 1]
01711         \textcolor{keywordflow}{else}:
01712             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity}
01713         
01714         
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Density\+Range@{get\+Density\+Range}}
\index{get\+Density\+Range@{get\+Density\+Range}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Density\+Range}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Density\+Range (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\+\_\+i1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i2 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}, }
\item[{}]{tol = {\ttfamily 0.1}, }
\item[{}]{tem = {\ttfamily 1e4}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}
\begin{DoxyVerb}Return the range of density where a given line ratio is between 10% and 90% of the low and high density limits
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01676}{1676} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01653}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+High\+Dens\+Ratio()}, \hyperlink{pynebcore_8py_source_l01632}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Low\+Dens\+Ratio()}, and \hyperlink{pynebcore_8py_source_l02060}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Den()}.



Referenced by \hyperlink{pynebcore_8py_source_l01653}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+High\+Dens\+Ratio()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01676}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}{01676}                         to\_eval=\textcolor{keywordtype}{None}, tol=0.1, tem=1e4):
01677         \textcolor{stringliteral}{"""}
01678 \textcolor{stringliteral}{        Return the range of density where a given line ratio is between 10% and 90% of the low and high
       density limits}
01679 \textcolor{stringliteral}{        """}
01680         LowLim = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{getLowDensRatio}(lev\_i1, lev\_i2, wave1, wave2, to\_eval)
01681         HighLim = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{getHighDensRatio}(lev\_i1, lev\_i2, lev\_j1, lev\_j2, wave1, wave2, 
      to\_eval)
01682         
01683         delta = abs(LowLim - HighLim)
01684         minRatio = min((LowLim, HighLim)) + tol * delta
01685         maxRatio = max((LowLim, HighLim)) - tol * delta
01686         dens1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{getTemDen}(minRatio, tem=tem, lev\_i1= lev\_i1, lev\_j1= lev\_j1, lev\_i2= lev\_i2, 
      lev\_j2= lev\_j2,
01687                   wave1= wave1, wave2= wave2, to\_eval=to\_eval)
01688         dens2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{getTemDen}(maxRatio, tem=tem, lev\_i1= lev\_i1, lev\_j1= lev\_j1, lev\_i2= lev\_i2, 
      lev\_j2= lev\_j2,
01689                   wave1= wave1, wave2= wave2, to\_eval=to\_eval)
01690         return(np.sort((dens1, dens2)))
01691                
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Emissivity@{get\+Emissivity}}
\index{get\+Emissivity@{get\+Emissivity}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Emissivity}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{den, }
\item[{}]{lev\+\_\+i = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}, }
\item[{}]{product = {\ttfamily True}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}
\begin{DoxyVerb}Return the line emissivity of selected transition or complete array of emissivities
The transition is selected by the argument wave (if given); 
if wave is not supplied, it is selected by the upper and lower levels (lev_i and lev_j); 
if neither is given, the whole array is computed

Usage:      
    O3.getEmissivity(12000, 100, 4, 2)         # (4, 2) transition
    O3.getEmissivity(10000, 10000, wave=5007)  # (4, 2) transition
    O3.getEmissivity(12000, 100)               # all transitions
    O3.getEmissivity([10000, 12000], [100, 500], 4, 2)
    O3.getEmissivity([10000, 12000], [100, 500])
    
Parameters:
    - tem      electronic temperature in K. May be an array.
    - den      electronic density in cm^-3. May be an array.
    - lev_i    upper level (default= -1)
    - lev_j    lower level (default= -1)
    - wave     wavelength of transition. Takes precedence on lev_i and lev_j if set, 
        ignored otherwise. It can also be a blend label.
    - product  Boolean. If True (default), all the combination of (tem, den) are used. 
         If False, tem and den must have the same size and are joined.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01716}{1716} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00093}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l00402}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l01256}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l00094}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l00400}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l01257}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Energy}, \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l00171}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00435}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00660}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01026}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01459}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{emis_grid_8py_source_l00048}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+atom}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00303}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l00559}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00909}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\+core.\+pynebcore.\+Atom.\+atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l01496}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations()}, \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}, \hyperlink{pynebcore_8py_source_l00062}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00075}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00155}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00404}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00637}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00984}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+N\+Levels}, and \hyperlink{pynebcore_8py_source_l01260}{pyneb.\+core.\+pynebcore.\+Atom.\+N\+Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l02110}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Ion\+Abundance()}, \hyperlink{pynebcore_8py_source_l02961}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Ion\+Abundance()}, \hyperlink{pynebcore_8py_source_l02313}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Emiss()}, \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}, and \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01716}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{01716}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(self, tem, den, lev\_i= -1, lev\_j= -1, wave= -1, product=True):
01717         \textcolor{stringliteral}{"""}
01718 \textcolor{stringliteral}{        Return the line emissivity of selected transition or complete array of emissivities}
01719 \textcolor{stringliteral}{        The transition is selected by the argument wave (if given); }
01720 \textcolor{stringliteral}{        if wave is not supplied, it is selected by the upper and lower levels (lev\_i and lev\_j); }
01721 \textcolor{stringliteral}{        if neither is given, the whole array is computed}
01722 \textcolor{stringliteral}{        }
01723 \textcolor{stringliteral}{        Usage:      }
01724 \textcolor{stringliteral}{            O3.getEmissivity(12000, 100, 4, 2)         # (4, 2) transition}
01725 \textcolor{stringliteral}{            O3.getEmissivity(10000, 10000, wave=5007)  # (4, 2) transition}
01726 \textcolor{stringliteral}{            O3.getEmissivity(12000, 100)               # all transitions}
01727 \textcolor{stringliteral}{            O3.getEmissivity([10000, 12000], [100, 500], 4, 2)}
01728 \textcolor{stringliteral}{            O3.getEmissivity([10000, 12000], [100, 500])}
01729 \textcolor{stringliteral}{            }
01730 \textcolor{stringliteral}{        Parameters:}
01731 \textcolor{stringliteral}{            - tem      electronic temperature in K. May be an array.}
01732 \textcolor{stringliteral}{            - den      electronic density in cm^-3. May be an array.}
01733 \textcolor{stringliteral}{            - lev\_i    upper level (default= -1)}
01734 \textcolor{stringliteral}{            - lev\_j    lower level (default= -1)}
01735 \textcolor{stringliteral}{            - wave     wavelength of transition. Takes precedence on lev\_i and lev\_j if set, }
01736 \textcolor{stringliteral}{                        ignored otherwise. It can also be a blend label.}
01737 \textcolor{stringliteral}{            - product  Boolean. If True (default), all the combination of (tem, den) are used. }
01738 \textcolor{stringliteral}{                         If False, tem and den must have the same size and are joined.}
01739 \textcolor{stringliteral}{}
01740 \textcolor{stringliteral}{        """}
01741         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave) \textcolor{keywordflow}{in} BLEND\_LIST:
01742             L = \textcolor{keyword}{lambda} wave: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, wave=wave, product=product)
01743             I = \textcolor{keyword}{lambda} lev\_i, lev\_j: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, lev\_i=lev\_i, lev\_j=lev\_j, 
      product=product)
01744             \textcolor{keywordflow}{try}:
01745                 res = eval(BLEND\_LIST[\textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave)])
01746             \textcolor{keywordflow}{except}:
01747                 pn.log\_.warn(\textcolor{stringliteral}{'\{0\} is not understood'}.format(wave), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'getEmissivity'})
01748                 res = \textcolor{keywordtype}{None}
01749             \textcolor{keywordflow}{return} res
01750         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_i)
01751         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_j)
01752         tem = np.asarray(tem)
01753         den = np.asarray(den)
01754         \textcolor{keywordflow}{if} wave != -1:
01755             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
01756         NLevels = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}
01757         \textcolor{keywordflow}{if} lev\_i > NLevels \textcolor{keywordflow}{or} lev\_j > NLevels:
01758             pn.log\_.error(\textcolor{stringliteral}{'The number of levels \{\} does not allow getting this emissivity. Consider
       changing the atomic data'}.format(NLevels),
01759                           calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling}) 
01760         \textcolor{keywordflow}{if} product:
01761             n\_tem = tem.size
01762             n\_den = den.size
01763             tem\_ones = np.ones(n\_tem)
01764             populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den, product=\textcolor{keyword}{True})
01765             \textcolor{keywordflow}{if} ((lev\_i == -1) \textcolor{keywordflow}{and} (lev\_j == -1)):
01766                 resultArray = np.zeros((NLevels, NLevels, n\_tem, n\_den))
01767                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(NLevels):
01768                     lev\_i = i + 1
01769                     j = i - 1 
01770                     \textcolor{keywordflow}{while} (j >= 0):
01771                         lev\_j = j + 1
01772                         deltaE = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]) * pn.CST.HPLANCK * 
      pn.CST.CLIGHT * 1.e8 
01773                         resultArray[i][j] = (deltaE * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[i, j] * populations[i].reshape(1, 1, n\_tem,
       n\_den) / 
01774                                              np.outer(tem\_ones, den).reshape(1, 1, n\_tem, n\_den))
01775                         j -= 1
01776                 \textcolor{keywordflow}{return} np.squeeze(resultArray)
01777             \textcolor{keywordflow}{else}:
01778                 \textcolor{keywordflow}{if} (lev\_i <= lev\_j):
01779                     \textcolor{keywordflow}{return} 0.
01780                 \textcolor{keywordflow}{else}:
01781                     i = lev\_i - 1
01782                     j = lev\_j - 1
01783                     deltaE = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]) * pn.CST.HPLANCK * 
      pn.CST.CLIGHT * 1.e8 
01784                     \textcolor{keywordflow}{return} np.squeeze((populations[i] * deltaE * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[i, j]).reshape(1, 1, n\_tem, 
      n\_den) / 
01785                                       np.outer(tem\_ones, den).reshape(1, 1, n\_tem, n\_den))
01786         \textcolor{keywordflow}{else}:
01787             \textcolor{keywordflow}{if} tem.shape != den.shape:
01788                 self.log\_.error(\textcolor{stringliteral}{'tem and den must have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01789                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01790             populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den, product=\textcolor{keyword}{False})
01791             \textcolor{keywordflow}{if} (lev\_i <= lev\_j):
01792                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01793             \textcolor{keywordflow}{else}:
01794                 i = lev\_i - 1
01795                 j = lev\_j - 1
01796                 deltaE = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]) * pn.CST.HPLANCK * pn.CST.CLIGHT
       * 1.e8 
01797                 \textcolor{keywordflow}{return} populations[i] * deltaE * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[i, j] / den
01798 
01799         
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+High\+Dens\+Ratio@{get\+High\+Dens\+Ratio}}
\index{get\+High\+Dens\+Ratio@{get\+High\+Dens\+Ratio}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+High\+Dens\+Ratio}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+High\+Dens\+Ratio (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\+\_\+i1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i2 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}
\begin{DoxyVerb}Return the value of a diagostic ratio at the high density limit
S2.getHighDensRatio(lev_i1 = 3, lev_i2 = 2)
S2.getHighDensRatio(wave1 = 6716, wave2 = 6731)
S2.getHighDensRatio(to_eval = 'L(6716)/L(6731)')
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01653}{1653} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00060}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+A}, \hyperlink{pynebcore_8py_source_l00205}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+get\+A()}, \hyperlink{pynebcore_8py_source_l00475}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+get\+A()}, \hyperlink{pynebcore_8py_source_l01471}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+A()}, \hyperlink{pynebcore_8py_source_l01676}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Density\+Range()}, \hyperlink{pynebcore_8py_source_l00058}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l01199}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Stat\+Weight}, and \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01676}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Density\+Range()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01653}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{01653}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{getHighDensRatio}(self, lev\_i1=-1, lev\_i2=-1, lev\_j1=-1, lev\_j2=-1, wave1=-1, 
      wave2=-1, to\_eval=None):
01654         
01655         \textcolor{stringliteral}{"""}
01656 \textcolor{stringliteral}{        Return the value of a diagostic ratio at the high density limit}
01657 \textcolor{stringliteral}{        S2.getHighDensRatio(lev\_i1 = 3, lev\_i2 = 2)}
01658 \textcolor{stringliteral}{        S2.getHighDensRatio(wave1 = 6716, wave2 = 6731)}
01659 \textcolor{stringliteral}{        S2.getHighDensRatio(to\_eval = 'L(6716)/L(6731)')}
01660 \textcolor{stringliteral}{        """}
01661         
01662         \textcolor{keywordflow}{if} wave1 != -1:
01663             lev\_i1, lev\_j1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave1)
01664         \textcolor{keywordflow}{if} wave2 != -1:
01665             lev\_i2, lev\_j2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave2)
01666             
01667         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
01668             L = \textcolor{keyword}{lambda} wave: (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0]) * 
01669                               self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0], self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1]))
01670             \textcolor{keywordflow}{return} eval(to\_eval)
01671             
01672         \textcolor{keywordflow}{return} (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i1) / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i2) *
01673                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(lev\_i1, lev\_j1) / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(lev\_i2, lev\_j2))
01674            
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Ion\+Abundance@{get\+Ion\+Abundance}}
\index{get\+Ion\+Abundance@{get\+Ion\+Abundance}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Ion\+Abundance}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Ion\+Abundance (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\+\_\+ratio, }
\item[{}]{tem, }
\item[{}]{den, }
\item[{}]{lev\+\_\+i = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}, }
\item[{}]{Hbeta = {\ttfamily 100.}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}
\begin{DoxyVerb}Compute the ionic abundance relative to H+ given the intensity of a line or sum of lines, 
the temperature, and the density. 
The line can be specified as a transition (i.e., giving the two atomic level involved), 
as a wavelength, or as an algebraic expression. In the last case, a sum of lines 
can also be supplied.

Usage:
    O3.getIonAbundance(100, 1.5e4, 100., wave=5007)
    O3.getIonAbundance(130, 1.5e4, 100., to_eval='I(4,3) + I(4,2)')
    O3.getIonAbundance(np.array([100, 150]), np.array([1.5e4, 1.2e4]), np.array([100., 120]), 
wave=5007)
    O2.getIonAbundance(int_ratio=100, tem=1.5e4, den=100., to_eval='L(3726)+L(3729)')

    
Parameters:
    - int_ratio    relative line intensity (default normalization: Hbeta = 100). 
            May be an array.
    - tem          electronic temperature in K. May be an array.
    - den          electronic density in cm^-3. May be an array.
    - lev_i        upper level of transition
    - lev_j        lower level of transition
    - wave         wavelength of transition. Takes precedence on lev_i and lev_j if set, 
            ignored otherwise 
    - to_eval      expression to be evaluated. Takes precedence on wave if set, 
            ignored otherwise.
    - Hbeta        line intensity normalization at Hbeta (default Hbeta = 100)\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02110}{2110} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00171}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00435}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l00660}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01026}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01459}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l03036}{pyneb.\+core.\+pynebcore.\+get\+Rec\+Emissivity()}, and \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02110}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{02110}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{getIonAbundance}(self, int\_ratio, tem, den, lev\_i= -1, lev\_j= -1, wave= -1, 
      to\_eval=None, Hbeta=100.):
02111         \textcolor{stringliteral}{"""}
02112 \textcolor{stringliteral}{        Compute the ionic abundance relative to H+ given the intensity of a line or sum of lines, }
02113 \textcolor{stringliteral}{        the temperature, and the density. }
02114 \textcolor{stringliteral}{        The line can be specified as a transition (i.e., giving the two atomic level involved), }
02115 \textcolor{stringliteral}{        as a wavelength, or as an algebraic expression. In the last case, a sum of lines }
02116 \textcolor{stringliteral}{        can also be supplied.}
02117 \textcolor{stringliteral}{}
02118 \textcolor{stringliteral}{        Usage:}
02119 \textcolor{stringliteral}{            O3.getIonAbundance(100, 1.5e4, 100., wave=5007)}
02120 \textcolor{stringliteral}{            O3.getIonAbundance(130, 1.5e4, 100., to\_eval='I(4,3) + I(4,2)')}
02121 \textcolor{stringliteral}{            O3.getIonAbundance(np.array([100, 150]), np.array([1.5e4, 1.2e4]), np.array([100., 120]), }
02122 \textcolor{stringliteral}{                wave=5007)}
02123 \textcolor{stringliteral}{            O2.getIonAbundance(int\_ratio=100, tem=1.5e4, den=100., to\_eval='L(3726)+L(3729)')}
02124 \textcolor{stringliteral}{}
02125 \textcolor{stringliteral}{            }
02126 \textcolor{stringliteral}{        Parameters:}
02127 \textcolor{stringliteral}{            - int\_ratio    relative line intensity (default normalization: Hbeta = 100). }
02128 \textcolor{stringliteral}{                            May be an array.}
02129 \textcolor{stringliteral}{            - tem          electronic temperature in K. May be an array.}
02130 \textcolor{stringliteral}{            - den          electronic density in cm^-3. May be an array.}
02131 \textcolor{stringliteral}{            - lev\_i        upper level of transition}
02132 \textcolor{stringliteral}{            - lev\_j        lower level of transition}
02133 \textcolor{stringliteral}{            - wave         wavelength of transition. Takes precedence on lev\_i and lev\_j if set, }
02134 \textcolor{stringliteral}{                            ignored otherwise }
02135 \textcolor{stringliteral}{            - to\_eval      expression to be evaluated. Takes precedence on wave if set, }
02136 \textcolor{stringliteral}{                            ignored otherwise.}
02137 \textcolor{stringliteral}{            - Hbeta        line intensity normalization at Hbeta (default Hbeta = 100)}
02138 \textcolor{stringliteral}{        }
02139 \textcolor{stringliteral}{        """}
02140         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_i)
02141         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ade3de73e8bdb814d01d2d9af98eba87f}{\_test\_lev}(lev\_j)
02142         \textcolor{keywordflow}{if} np.ndim(tem) != np.ndim(den):
02143             self.log\_.error(\textcolor{stringliteral}{'ten and den must have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02144             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02145         \textcolor{keywordflow}{if} ((np.squeeze(np.asarray(int\_ratio)).shape != np.squeeze(np.asarray(tem)).shape) | 
02146             (np.squeeze(np.asarray(den)).shape != np.squeeze(np.asarray(tem)).shape)):
02147             self.log\_.warn(\textcolor{stringliteral}{'int\_ratio, tem and den must does not have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02148         \textcolor{keywordflow}{if} (lev\_i == -1) & (lev\_j == -1) & (wave == -1) & (to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}):
02149             self.log\_.error(\textcolor{stringliteral}{'At least one of lev\_i, lev\_j, wave or to\_eval must be supplied'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02150             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02151         \textcolor{keywordflow}{if} to\_eval == \textcolor{keywordtype}{None}:
02152             \textcolor{keywordflow}{if} wave != -1:
02153                 lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)     
02154             to\_eval = \textcolor{stringliteral}{'I('} + str(lev\_i) + \textcolor{stringliteral}{','} + str(lev\_j) + \textcolor{stringliteral}{')'} 
02155         I = \textcolor{keyword}{lambda} lev\_i, lev\_j: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, lev\_i, lev\_j, product=\textcolor{keyword}{False})
02156         L = \textcolor{keyword}{lambda} wave: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, wave=wave, product=\textcolor{keyword}{False})
02157         \textcolor{keywordflow}{try}:
02158             emis = eval(to\_eval)
02159         \textcolor{keywordflow}{except}:
02160             self.log\_.error(\textcolor{stringliteral}{'Unable to eval \{0\}'}.format(to\_eval), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02161             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02162         \textcolor{comment}{#int\_ratio is in units of Hb = Hbeta keyword}
02163         ionAbundance = ((int\_ratio / Hbeta) * (\hyperlink{namespacepyneb_1_1core_1_1pynebcore_aba9d4a5306330dd47f8a51455514c017}{getRecEmissivity}(tem, den, 4, 2, atom=\textcolor{stringliteral}{'H1'}, 
      product=\textcolor{keyword}{False}) / emis))
02164         \textcolor{keywordflow}{return} ionAbundance
02165     
02166 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Low\+Dens\+Ratio@{get\+Low\+Dens\+Ratio}}
\index{get\+Low\+Dens\+Ratio@{get\+Low\+Dens\+Ratio}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Low\+Dens\+Ratio}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Low\+Dens\+Ratio (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\+\_\+i1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}
\begin{DoxyVerb}Return the value of a diagostic ratio at the low density limit
S2.getLowDensRatio(lev_i1 = 3, lev_i2 = 2)
S2.getLowDensRatio(wave1 = 6716, wave2 = 6731)
S2.getLowDensRatio(to_eval = 'L(6716)/L(6731)')
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01632}{1632} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00058}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l01199}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Stat\+Weight}, and \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01676}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Density\+Range()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01632}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{01632}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{getLowDensRatio}(self, lev\_i1=-1, lev\_i2=-1, wave1=-1, wave2=-1, to\_eval=None):
01633         
01634         \textcolor{stringliteral}{"""}
01635 \textcolor{stringliteral}{        Return the value of a diagostic ratio at the low density limit}
01636 \textcolor{stringliteral}{        S2.getLowDensRatio(lev\_i1 = 3, lev\_i2 = 2)}
01637 \textcolor{stringliteral}{        S2.getLowDensRatio(wave1 = 6716, wave2 = 6731)}
01638 \textcolor{stringliteral}{        S2.getLowDensRatio(to\_eval = 'L(6716)/L(6731)')}
01639 \textcolor{stringliteral}{        """}
01640         
01641         \textcolor{keywordflow}{if} wave1 != -1:
01642             lev\_i1, lev\_j1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave1)
01643         \textcolor{keywordflow}{if} wave2 != -1:
01644             lev\_i2, lev\_j2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave2)
01645             
01646         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
01647             L = \textcolor{keyword}{lambda} wave: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0])
01648             \textcolor{keywordflow}{return} eval(to\_eval)
01649             
01650         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i1) / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i2)
01651         
01652         
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Omega@{get\+Omega}}
\index{get\+Omega@{get\+Omega}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Omega}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{lev\+\_\+i = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}
\begin{DoxyVerb}Return interpolated value of the collision strength value at the given temperature 
    for the complete array or a specified transition.
If kappa is not None (non-maxwellian distribution of e-velocities), the collision 
    strength is corrected as in Mendoza & Bautista, 2014 ApJ 785, 91.

Usage:
    O3.getOmega(15000.)
    O3.getOmega([8e3, 1e4, 1.2e4])
    O3.getOmega([8e3, 1e4, 1.2e4], 5, 4)

Parameters:
    - tem    electronic temperature in K. May be an array.
    - lev_i  upper level
    - lev_j  lower level\end{DoxyVerb}
\begin{DoxyVerb}\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01262}{1262} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{pynebcore_8py_source_l00073}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+coll\+N\+Levels}, \hyperlink{pynebcore_8py_source_l01253}{pyneb.\+core.\+pynebcore.\+Atom.\+coll\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00059}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+Energy}, \hyperlink{pynebcore_8py_source_l01200}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Energy}, \hyperlink{pynebcore_8py_source_l00811}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+get\+Omega()}, \hyperlink{pynebcore_8py_source_l01063}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+get\+Omega()}, \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}, \hyperlink{pynebcore_8py_source_l00058}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l01199}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Stat\+Weight}, and \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01329}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Coll\+Rates()}, and \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01262}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{01262}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{getOmega}(self, tem, lev\_i= -1, lev\_j= -1, wave= -1):
01263         \textcolor{stringliteral}{"""}
01264 \textcolor{stringliteral}{        Return interpolated value of the collision strength value at the given temperature }
01265 \textcolor{stringliteral}{            for the complete array or a specified transition.}
01266 \textcolor{stringliteral}{        If kappa is not None (non-maxwellian distribution of e-velocities), the collision }
01267 \textcolor{stringliteral}{            strength is corrected as in Mendoza & Bautista, 2014 ApJ 785, 91.}
01268 \textcolor{stringliteral}{}
01269 \textcolor{stringliteral}{        Usage:}
01270 \textcolor{stringliteral}{            O3.getOmega(15000.)}
01271 \textcolor{stringliteral}{            O3.getOmega([8e3, 1e4, 1.2e4])}
01272 \textcolor{stringliteral}{            O3.getOmega([8e3, 1e4, 1.2e4], 5, 4)}
01273 \textcolor{stringliteral}{        }
01274 \textcolor{stringliteral}{        Parameters:}
01275 \textcolor{stringliteral}{            - tem    electronic temperature in K. May be an array.}
01276 \textcolor{stringliteral}{            - lev\_i  upper level}
01277 \textcolor{stringliteral}{            - lev\_j  lower level}
01278 \textcolor{stringliteral}{}
01279 \textcolor{stringliteral}{        """}
01280         \textcolor{stringliteral}{"""}
01281 \textcolor{stringliteral}{        """}
01282         
01283         \textcolor{keywordflow}{if} wave != -1:
01284             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
01285         kappa = pn.config.kappa 
01286         \textcolor{keywordflow}{if} kappa \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01287             to\_return = self.CollData.getOmega(tem, lev\_i, lev\_j)
01288         \textcolor{keywordflow}{else}:
01289             \textcolor{keywordflow}{if} (lev\_i == -1) \textcolor{keywordflow}{and} (lev\_j == -1):
01290                 tem = np.asarray(tem)
01291                 res\_shape = [self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}]
01292                 \textcolor{keywordflow}{for} sh \textcolor{keywordflow}{in} tem.shape:
01293                     res\_shape.append(sh)
01294                 Omega = np.zeros(res\_shape)
01295         
01296                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels} - 1):
01297                     j = i + 1
01298                     \textcolor{keywordflow}{while} (j < self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}):
01299                         Omega[j][i] = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{getOmega}(tem, j + 1, i + 1)
01300                         j += 1
01301             \textcolor{keywordflow}{else}:
01302                 OmegaMB = self.CollData.getOmega(tem, lev\_i, lev\_j)
01303                 delta\_E = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_i, unit=\textcolor{stringliteral}{'eV'}) - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_j, unit=\textcolor{stringliteral}{'eV'})
01304                 correc = ((kappa - 3./2.)**(-0.5) / kappa * gamma(kappa+1) / gamma(kappa-0.5) * 
01305                           (1 + delta\_E/((kappa-1.5)*pn.CST.BOLTZMANN\_eVK*tem))**(-kappa)) * np.exp(delta\_E/
      pn.CST.BOLTZMANN\_eVK/tem)
01306     
01307                 Omega = correc * OmegaMB
01308                 pn.log\_.message(\textcolor{stringliteral}{'Correcting for Kappa=\{0\} by \{1\}'}.format(kappa, correc), self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01309 
01310             to\_return = np.squeeze(Omega)
01311         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'COEFF'} \textcolor{keywordflow}{in} self.CollData.comments:
01312             to\_return *= float(self.CollData.comments[\textcolor{stringliteral}{'COEFF'}])
01313         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'O\_UNIT'} \textcolor{keywordflow}{in} self.CollData.comments:
01314             \textcolor{keywordflow}{if} self.CollData.comments[\textcolor{stringliteral}{'O\_UNIT'}] == \textcolor{stringliteral}{'DEEX RATE COEFF'}:
01315                 to\_return /= pn.CST.KCOLLRATE / tem ** 0.5 / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i)
01316             \textcolor{keywordflow}{elif} self.CollData.comments[\textcolor{stringliteral}{'O\_UNIT'}] == \textcolor{stringliteral}{'RATE COEFF'}:
01317                 deltaE = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_i, unit=\textcolor{stringliteral}{'erg'}) - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_j, unit=\textcolor{stringliteral}{'erg'})
01318                 to\_return *= (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_j) / self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i) * np.exp(deltaE /(pn.CST.BOLTZMANN * tem))) \textcolor{comment}{#q21}
01319                 to\_return /= pn.CST.KCOLLRATE / tem ** 0.5 / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i)
01320             \textcolor{keywordflow}{elif} self.CollData.comments[\textcolor{stringliteral}{'O\_UNIT'}] == \textcolor{stringliteral}{'COOLING'}:
01321                 deltaE = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_i, unit=\textcolor{stringliteral}{'erg'}) - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_j, unit=\textcolor{stringliteral}{'erg'})
01322                 to\_return /= deltaE \textcolor{comment}{# Loss to q12                }
01323                 to\_return *= (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_j) / self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i) * np.exp(deltaE /(pn.CST.BOLTZMANN * tem))) \textcolor{comment}{#q21}
01324                 to\_return /= (pn.CST.KCOLLRATE / np.sqrt(tem) / self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i)) \textcolor{comment}{# Omega}
01325                 
01326         \textcolor{keywordflow}{return} to\_return
01327     
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Populations@{get\+Populations}}
\index{get\+Populations@{get\+Populations}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Populations}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{den, }
\item[{}]{product = {\ttfamily True}, }
\item[{}]{N\+Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}
\begin{DoxyVerb}Return array of populations at given temperature and density.
The method returns a 1-, 2- or 3-D array containing the population of each level 
    for all temperatures and densities specified in the input vectors tem and den 
    (which can be n-element or 1-element vectors).
If either quantity (tem or den) is a 1-element vector -that is, a single value-, 
    the resulting population array is collapsed along that dimension; 
    as a result, the result population array can be a 1-D, 2-D or 3-D array 
    (the three cases corresponding to situations in which both tem and den are single values; 
    one of them is a single value and the other an n-element vector; or both are multielement 
    vectors, respectively). In the general case, the level index is the first 
    [WARNING! It is not in physical unit, i.e. ground level = 0; to be normalized], 
    followed by the temperature index (if it exists) and the density index. 

Usage:
    O3.getPopulations(1e4, 1e2)
    tem=np.array([10000., 12000., 15000., 20000]) # An array of four temperatures
    den=np.array([600., 800., 1000])      # An array of three densities
    O3.getPopulations(tem, den)           # is a (6, 4, 3) array
    O3.getPopulations(tem, den)[0,2,1]    # Returns the population of level 1 for T = 15000 
                                    and Ne = 800
    tem = 20000                           # tem is no longer an array
    O3.getPopulations(tem, den)[0,2,1]  # Crashes: one index too much
    O3.getPopulations(tem, den)[0,1]    # Returns the population of level 1 for T = 20000 
                                    and Ne = 800 [see warning]
    tem=np.array([10000., 15000., 20000]) # An array of three temperatures
    O3.getPopulations(tem, den, product = False)# is a (6, 3) array, tem and den beeing 
                                            taken 2 by 2.

Parameters:
    - tem       electronic temperature in K
    - den       electronic density in cm^-3
    - product   operate on all possible combinations of temperature and density 
      (product = True, default case) or on those resulting from combining 
      the i-th value of tem with the i-th value of den (product = False).
      If product = False, then tem and den must be the same size.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01496}{1496} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00093}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l00402}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l01256}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+A}, \hyperlink{pynebcore_8py_source_l01329}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Coll\+Rates()}, \hyperlink{pynebcore_8py_source_l00062}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00075}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00155}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00404}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00637}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00984}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+N\+Levels}, and \hyperlink{pynebcore_8py_source_l01260}{pyneb.\+core.\+pynebcore.\+Atom.\+N\+Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l01693}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Crit\+Density()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, and \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01496}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{01496}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(self, tem, den, product=True, NLevels=None):
01497         \textcolor{stringliteral}{"""}
01498 \textcolor{stringliteral}{        Return array of populations at given temperature and density.}
01499 \textcolor{stringliteral}{        The method returns a 1-, 2- or 3-D array containing the population of each level }
01500 \textcolor{stringliteral}{            for all temperatures and densities specified in the input vectors tem and den }
01501 \textcolor{stringliteral}{            (which can be n-element or 1-element vectors).}
01502 \textcolor{stringliteral}{        If either quantity (tem or den) is a 1-element vector -that is, a single value-, }
01503 \textcolor{stringliteral}{            the resulting population array is collapsed along that dimension; }
01504 \textcolor{stringliteral}{            as a result, the result population array can be a 1-D, 2-D or 3-D array }
01505 \textcolor{stringliteral}{            (the three cases corresponding to situations in which both tem and den are single values; }
01506 \textcolor{stringliteral}{            one of them is a single value and the other an n-element vector; or both are multielement }
01507 \textcolor{stringliteral}{            vectors, respectively). In the general case, the level index is the first }
01508 \textcolor{stringliteral}{            [WARNING! It is not in physical unit, i.e. ground level = 0; to be normalized], }
01509 \textcolor{stringliteral}{            followed by the temperature index (if it exists) and the density index. }
01510 \textcolor{stringliteral}{}
01511 \textcolor{stringliteral}{        Usage:}
01512 \textcolor{stringliteral}{            O3.getPopulations(1e4, 1e2)}
01513 \textcolor{stringliteral}{            tem=np.array([10000., 12000., 15000., 20000]) # An array of four temperatures}
01514 \textcolor{stringliteral}{            den=np.array([600., 800., 1000])      # An array of three densities}
01515 \textcolor{stringliteral}{            O3.getPopulations(tem, den)           # is a (6, 4, 3) array}
01516 \textcolor{stringliteral}{            O3.getPopulations(tem, den)[0,2,1]    # Returns the population of level 1 for T = 15000 }
01517 \textcolor{stringliteral}{                                                    and Ne = 800}
01518 \textcolor{stringliteral}{            tem = 20000                           # tem is no longer an array}
01519 \textcolor{stringliteral}{            O3.getPopulations(tem, den)[0,2,1]  # Crashes: one index too much}
01520 \textcolor{stringliteral}{            O3.getPopulations(tem, den)[0,1]    # Returns the population of level 1 for T = 20000 }
01521 \textcolor{stringliteral}{                                                    and Ne = 800 [see warning]}
01522 \textcolor{stringliteral}{            tem=np.array([10000., 15000., 20000]) # An array of three temperatures}
01523 \textcolor{stringliteral}{            O3.getPopulations(tem, den, product = False)# is a (6, 3) array, tem and den beeing }
01524 \textcolor{stringliteral}{                                                            taken 2 by 2.}
01525 \textcolor{stringliteral}{        }
01526 \textcolor{stringliteral}{        Parameters:}
01527 \textcolor{stringliteral}{            - tem       electronic temperature in K}
01528 \textcolor{stringliteral}{            - den       electronic density in cm^-3}
01529 \textcolor{stringliteral}{            - product   operate on all possible combinations of temperature and density }
01530 \textcolor{stringliteral}{                      (product = True, default case) or on those resulting from combining }
01531 \textcolor{stringliteral}{                      the i-th value of tem with the i-th value of den (product = False).}
01532 \textcolor{stringliteral}{                      If product = False, then tem and den must be the same size.}
01533 \textcolor{stringliteral}{}
01534 \textcolor{stringliteral}{        """}
01535         tem = np.asarray(tem)
01536         den = np.asarray(den)
01537         \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01538             n\_level = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}
01539         \textcolor{keywordflow}{else}:
01540             n\_level = NLevels
01541         \textcolor{keywordflow}{if} product:
01542             n\_tem = tem.size
01543             n\_den = den.size
01544             tem\_ones = np.ones(n\_tem)
01545             den\_ones = np.ones(n\_den)
01546             \textcolor{comment}{# q is vector-indexed (q(0, 1) = rate between levels 1 and 2)}
01547             q = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{getCollRates}(tem, n\_level)
01548             Atem = np.outer(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[:n\_level, :n\_level], tem\_ones).reshape(n\_level, n\_level, n\_tem)
01549             pop\_result = np.zeros((n\_level, n\_tem, n\_den))
01550             sum\_q\_up = np.zeros((n\_level, n\_tem))
01551             sum\_q\_down = np.zeros((n\_level, n\_tem))
01552             sum\_A = np.squeeze(Atem.sum(axis=1))
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01553}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{01553}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity} = sum\_A / q.sum(axis=1)
01554             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, n\_level):
01555                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i + 1, n\_level):
01556                     sum\_q\_up[i] = sum\_q\_up[i] + q[i, j]
01557                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(0, i):
01558                     sum\_q\_down[i] = sum\_q\_down[i] + q[i, j]
01559             coeff\_matrix = ((np.outer(np.swapaxes(q, 0, 1), den) + 
01560                              np.outer(np.swapaxes(Atem, 0, 1), den\_ones)).reshape(n\_level, n\_level, n\_tem, 
      n\_den))
01561             coeff\_matrix[0, :] = 1.
01562             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, n\_level):
01563                 coeff\_matrix[i, i] = (-(np.outer((sum\_q\_up[i] + sum\_q\_down[i]), den) + 
01564                                         np.outer(sum\_A[i], den\_ones)).reshape(1, 1, n\_tem, n\_den))
01565             vect = np.zeros(n\_level)
01566             vect[0] = 1.
01567     
01568             \textcolor{keywordflow}{for} i\_tem \textcolor{keywordflow}{in} range(n\_tem):
01569                 \textcolor{keywordflow}{for} i\_den \textcolor{keywordflow}{in} range(n\_den):
01570                     \textcolor{keywordflow}{try}:
01571                         pop\_result[:, i\_tem, i\_den] = np.linalg.solve(np.squeeze(coeff\_matrix[:, :, i\_tem, 
      i\_den]), vect)
01572                     \textcolor{keywordflow}{except} np.linalg.LinAlgError:
01573                         pop\_result[:, i\_tem, i\_den] = np.nan
01574                     \textcolor{keywordflow}{except}:
01575                         self.log\_.error(\textcolor{stringliteral}{'Error solving population matrix'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01576             pop = np.squeeze(pop\_result)
01577         \textcolor{keywordflow}{else}:
01578             \textcolor{keywordflow}{if} tem.shape != den.shape:
01579                 self.log\_.error(\textcolor{stringliteral}{'tem and den must have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01580                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01581             res\_shape1 = [n\_level]
01582             res\_shape\_rav1 = [n\_level, tem.size]
01583             res\_shape\_rav2 = [n\_level, n\_level, tem.size]
01584             \textcolor{keywordflow}{for} sh \textcolor{keywordflow}{in} tem.shape:
01585                 res\_shape1.append(sh)
01586             tem\_rav = tem.ravel()
01587             den\_rav = den.ravel()
01588             q = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{getCollRates}(tem\_rav, n\_level)
01589             A = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[:n\_level, :n\_level]
01590             pop\_result = np.zeros(res\_shape\_rav1)
01591             coeff\_matrix = np.ones(res\_shape\_rav2)
01592             sum\_q\_up = np.zeros(res\_shape\_rav1)
01593             sum\_q\_down = np.zeros(res\_shape\_rav1)
01594             sum\_A = A.sum(axis=1)
01595             n\_tem = tem\_rav.size
01596             \textcolor{comment}{# Following line changed 29/11/2012. It made the code crash when atom\_nlevels diff coll\_nlevels}
01597             \textcolor{comment}{#Atem = np.outer(self.\_A, np.ones(n\_tem)).reshape(n\_level, n\_level, n\_tem)}
01598             Atem = np.outer(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[:n\_level, :n\_level], np.ones(n\_tem)).reshape(n\_level, n\_level, n\_tem)
01599             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity} = Atem.sum(axis=1) / q.sum(axis=1)
01600 
01601             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, n\_level):
01602                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i + 1, n\_level):
01603                     sum\_q\_up[i] = sum\_q\_up[i] + q[i, j]
01604                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(0, i):
01605                     sum\_q\_down[i] = sum\_q\_down[i] + q[i, j]
01606             \textcolor{keywordflow}{for} row \textcolor{keywordflow}{in} range(1, n\_level):
01607                 \textcolor{comment}{# upper right half            }
01608                 \textcolor{keywordflow}{for} col \textcolor{keywordflow}{in} range(row + 1, n\_level):
01609                     coeff\_matrix[row, col] = den\_rav * q[col, row] + A[col, row]
01610                 \textcolor{comment}{# lower left half}
01611                 \textcolor{keywordflow}{for} col \textcolor{keywordflow}{in} range(0, row):
01612                     coeff\_matrix[row, col] = den\_rav * q[col, row]
01613                 \textcolor{comment}{# diagonal}
01614                 coeff\_matrix[row, row] = -(den\_rav * (sum\_q\_up[row] + sum\_q\_down[row]) + sum\_A[row])
01615 
01616             vect = np.zeros(n\_level)
01617             vect[0] = 1.
01618             
01619             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(tem.size):
01620                 \textcolor{keywordflow}{try}:
01621                     pop\_result[:, i] = np.linalg.solve(np.squeeze(coeff\_matrix[:, :, i]), vect)
01622                 \textcolor{keywordflow}{except} np.linalg.LinAlgError:
01623                     pop\_result[:, i] = np.nan
01624                 \textcolor{keywordflow}{except}:
01625                     self.log\_.error(\textcolor{stringliteral}{'Error solving population matrix'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01626             
01627             pop = np.squeeze(pop\_result.reshape(res\_shape1))
01628             
01629         \textcolor{keywordflow}{return} pop
01630 
01631     
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9d6390b03ff490938536167fe65d8a87}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Sources@{get\+Sources}}
\index{get\+Sources@{get\+Sources}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Sources}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Sources (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9d6390b03ff490938536167fe65d8a87}


Definition at line \hyperlink{pynebcore_8py_source_l01450}{1450} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01184}{pyneb.\+core.\+pynebcore.\+Atom.\+Atom\+Data}, and \hyperlink{pynebcore_8py_source_l01232}{pyneb.\+core.\+pynebcore.\+Atom.\+Coll\+Data}.



Referenced by \hyperlink{pn__chianti_8py_source_l00551}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+print\+Sources()}, and \hyperlink{pynebcore_8py_source_l01445}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Sources()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01450}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9d6390b03ff490938536167fe65d8a87}{01450}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9d6390b03ff490938536167fe65d8a87}{getSources}(self):
01451         sources = []
01452         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData}:
01453             sources.extend(self.AtomData.getSources())
01454             sources.extend(self.CollData.getSources())
01455         \textcolor{keywordflow}{else}:
01456             sources.extend(self.AtomData.getSources())
01457         \textcolor{keywordflow}{return} sources
01458     
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Tem\+Den@{get\+Tem\+Den}}
\index{get\+Tem\+Den@{get\+Tem\+Den}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Tem\+Den}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Den (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\+\_\+ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i2 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\+Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily \textquotesingle{}nsect\+\_\+recur\textquotesingle{}}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{end\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}, }
\item[{}]{n\+Cut = {\ttfamily 30}, }
\item[{}]{max\+Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}
\begin{DoxyVerb}Return either the temperature or the density given the other variable for a selected line ratio 
    of known intensity.
The line ratio can involve two or more than two lines. 
In the first case (only two lines), it can be specified giving either two transitions 
    (four atomic levels, i.e. two for each transition), or two wavelengths.
In the general case (any number of lines), it can be specified as an algebraic expression 
    to be evaluated, involving either atomic levels or wavelengths.
An array of values, rather than a single value, can also be given, in which case the result 
    will also be an array.
    
Usage: 
    O3.getTemDen(150., den=100., wave1=5007, wave2=4363, maxError=1.e-2)
    O3.getTemDen(150., den=100., to_eval = '(I(4,3) + I(4,2) + I(4,1)) / I(5,4)')
    N2.getTemDen(150., den=100., to_eval = '(L(6584) + L(6548)) / L(5755)')
    O3.getTemDen([0.02, 0.04], den=[1.e4, 1.1e4], to_eval="I(5, 4) / (I(4, 3) + I(4, 2))")

Parameters:
    - int_ratio    intensity ratio of the selected transition
    - tem          electronic temperature
    - den          electronic density
    - lev_i1       upper level of 1st transition
    - lev_j1       lower level of 1st transition
    - lev_i2       upper level of 2nd transition
    - lev_j2       lower level of 2nd transition
    - wave1        wavelength of 1st transition
    - wave2        wavelength of 2nd transition
    - maxError     tolerance on difference between input and computed ratio 
    - method       numerical method for finding the root (nsect_recur, nsect_iter)
    - log          switch of log (default = True). start_x and end_x are using this parameter.
    - start_x      lower end of the interval to explore. (default: lower end of collision 
            strength temperature array for temperature, 1 if density)
    - end_x        higher end of the interval to explore. (default: higher end of collision 
            strength temperature array for temperature, 1e8 if density)
    - to_eval      expression to be evaluated, using either I (for transitions identified 
            through atomic levels) or L (for transitions identified through wavelengths)
    - nCut        number of sections in which each step is cut. 2 would be dichotomy.
    - maxIter     maximum number of iterations\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02060}{2060} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, and \hyperlink{pynebcore_8py_source_l01980}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P()}.



Referenced by \hyperlink{pynebcore_8py_source_l01980}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P()}, \hyperlink{pynebcore_8py_source_l01676}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Density\+Range()}, and \hyperlink{pynebcore_8py_source_l02253}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Tem\+Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02060}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{02060}                   to\_eval=\textcolor{keywordtype}{None}, nCut=30, maxIter=20):
02061         \textcolor{stringliteral}{"""}
02062 \textcolor{stringliteral}{        Return either the temperature or the density given the other variable for a selected line ratio }
02063 \textcolor{stringliteral}{            of known intensity.}
02064 \textcolor{stringliteral}{        The line ratio can involve two or more than two lines. }
02065 \textcolor{stringliteral}{        In the first case (only two lines), it can be specified giving either two transitions }
02066 \textcolor{stringliteral}{            (four atomic levels, i.e. two for each transition), or two wavelengths.}
02067 \textcolor{stringliteral}{        In the general case (any number of lines), it can be specified as an algebraic expression }
02068 \textcolor{stringliteral}{            to be evaluated, involving either atomic levels or wavelengths.}
02069 \textcolor{stringliteral}{        An array of values, rather than a single value, can also be given, in which case the result }
02070 \textcolor{stringliteral}{            will also be an array.}
02071 \textcolor{stringliteral}{            }
02072 \textcolor{stringliteral}{        Usage: }
02073 \textcolor{stringliteral}{            O3.getTemDen(150., den=100., wave1=5007, wave2=4363, maxError=1.e-2)}
02074 \textcolor{stringliteral}{            O3.getTemDen(150., den=100., to\_eval = '(I(4,3) + I(4,2) + I(4,1)) / I(5,4)')}
02075 \textcolor{stringliteral}{            N2.getTemDen(150., den=100., to\_eval = '(L(6584) + L(6548)) / L(5755)')}
02076 \textcolor{stringliteral}{            O3.getTemDen([0.02, 0.04], den=[1.e4, 1.1e4], to\_eval="I(5, 4) / (I(4, 3) + I(4, 2))")}
02077 \textcolor{stringliteral}{}
02078 \textcolor{stringliteral}{        Parameters:}
02079 \textcolor{stringliteral}{            - int\_ratio    intensity ratio of the selected transition}
02080 \textcolor{stringliteral}{            - tem          electronic temperature}
02081 \textcolor{stringliteral}{            - den          electronic density}
02082 \textcolor{stringliteral}{            - lev\_i1       upper level of 1st transition}
02083 \textcolor{stringliteral}{            - lev\_j1       lower level of 1st transition}
02084 \textcolor{stringliteral}{            - lev\_i2       upper level of 2nd transition}
02085 \textcolor{stringliteral}{            - lev\_j2       lower level of 2nd transition}
02086 \textcolor{stringliteral}{            - wave1        wavelength of 1st transition}
02087 \textcolor{stringliteral}{            - wave2        wavelength of 2nd transition}
02088 \textcolor{stringliteral}{            - maxError     tolerance on difference between input and computed ratio }
02089 \textcolor{stringliteral}{            - method       numerical method for finding the root (nsect\_recur, nsect\_iter)}
02090 \textcolor{stringliteral}{            - log          switch of log (default = True). start\_x and end\_x are using this parameter.}
02091 \textcolor{stringliteral}{            - start\_x      lower end of the interval to explore. (default: lower end of collision }
02092 \textcolor{stringliteral}{                            strength temperature array for temperature, 1 if density)}
02093 \textcolor{stringliteral}{            - end\_x        higher end of the interval to explore. (default: higher end of collision }
02094 \textcolor{stringliteral}{                            strength temperature array for temperature, 1e8 if density)}
02095 \textcolor{stringliteral}{            - to\_eval      expression to be evaluated, using either I (for transitions identified }
02096 \textcolor{stringliteral}{                            through atomic levels) or L (for transitions identified through wavelengths)}
02097 \textcolor{stringliteral}{            - nCut        number of sections in which each step is cut. 2 would be dichotomy.}
02098 \textcolor{stringliteral}{            - maxIter     maximum number of iterations}
02099 \textcolor{stringliteral}{}
02100 \textcolor{stringliteral}{        """}        
02101         \textcolor{keywordflow}{if} pn.config.\_use\_mp:
02102             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{\_getTemDen\_MP}(int\_ratio=int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, 
      lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
02103                   wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, start\_x=start\_x,
02104                   end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)
02105         \textcolor{keywordflow}{else}:
02106             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\_getTemDen\_1}(int\_ratio=int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, 
      lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
02107                   wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, start\_x=start\_x,
02108                   end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)
02109 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Transition@{get\+Transition}}
\index{get\+Transition@{get\+Transition}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Transition}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{wave, }
\item[{}]{max\+Error\+A = {\ttfamily 5.e-\/3}, }
\item[{}]{max\+Errorm = {\ttfamily 5.e-\/2}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}
\begin{DoxyVerb}Return the indexes (upper level, lower level) of a transition for a given atom 
    from the wavelength.

Usage:
    O3.getTransition(4959)
    
Parameters:
    - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') 
or in micron (a label: '51.5m')
    - maxErrorA: tolerance if the input wavelength is in Angstrom
    - maxErrorm: tolerance if the input wavelength is in micron\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01406}{1406} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01367}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l01471}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+A()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l01653}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+High\+Dens\+Ratio()}, \hyperlink{pynebcore_8py_source_l02110}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Ion\+Abundance()}, \hyperlink{pynebcore_8py_source_l01632}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Low\+Dens\+Ratio()}, \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}, and \hyperlink{pynebcore_8py_source_l02313}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Emiss()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01406}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{01406}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(self, wave, maxErrorA = 5.e-3, maxErrorm = 5.e-2):
01407         \textcolor{stringliteral}{"""}
01408 \textcolor{stringliteral}{        Return the indexes (upper level, lower level) of a transition for a given atom }
01409 \textcolor{stringliteral}{            from the wavelength.}
01410 \textcolor{stringliteral}{        }
01411 \textcolor{stringliteral}{        Usage:}
01412 \textcolor{stringliteral}{            O3.getTransition(4959)}
01413 \textcolor{stringliteral}{            }
01414 \textcolor{stringliteral}{        Parameters:}
01415 \textcolor{stringliteral}{            - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') }
01416 \textcolor{stringliteral}{                or in micron (a label: '51.5m')}
01417 \textcolor{stringliteral}{            - maxErrorA: tolerance if the input wavelength is in Angstrom}
01418 \textcolor{stringliteral}{            - maxErrorm: tolerance if the input wavelength is in micron}
01419 \textcolor{stringliteral}{                }
01420 \textcolor{stringliteral}{        """} 
01421         res = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\_Transition}(wave, maxErrorA = maxErrorA, maxErrorm = maxErrorm)
01422         return(res[0], res[1])
01423         
01424 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!plot\+Emiss@{plot\+Emiss}}
\index{plot\+Emiss@{plot\+Emiss}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{plot\+Emiss}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Emiss (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem\+\_\+min = {\ttfamily 1000}, }
\item[{}]{tem\+\_\+max = {\ttfamily 30000}, }
\item[{}]{ionic\+\_\+abund = {\ttfamily 1.0}, }
\item[{}]{den = {\ttfamily 1e3}, }
\item[{}]{style = {\ttfamily \textquotesingle{}-\/\textquotesingle{}}, }
\item[{}]{legend\+\_\+loc = {\ttfamily 4}, }
\item[{}]{tem\+Log = {\ttfamily False}, }
\item[{}]{plot\+\_\+total = {\ttfamily False}, }
\item[{}]{plot\+\_\+only\+\_\+total = {\ttfamily False}, }
\item[{}]{legend = {\ttfamily True}, }
\item[{}]{total\+\_\+color = {\ttfamily \textquotesingle{}black\textquotesingle{}}, }
\item[{}]{total\+\_\+label = {\ttfamily \textquotesingle{}TOTAL\textquotesingle{}}, }
\item[{}]{ax = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}
\begin{DoxyVerb}Plot the emissivity as a function of temperature of all the lines of the selected atom.  

Usage: 
    O3.plotEmiss(tem_min=10000, tem_max=20000)

Parameters:
    - tem_min         minimum value of the temperature range to span (default=1000)
    - tem_max         maximum value of the temperature range to span (default=30000)
    - ionic_abund     relative ionic abundance (default = 1.0)
    - den             electron density
    - style           line style of the plot (default: '-' [solid line])
    - legend_loc      localization of the legend (default: 4 = lower right; see plt.legend 
                for more details)
    - temLog          linear (False) or logarithmic temperature axis (default = False)
    - plot_total      flag to also plot total emissivity (default = False)
    - plot_only_total flag to only plot total emissivity (default = False)
    - legend          flag to place legend (default = True)
    - total_color     color of the total emissivity (default = 'black')
    - total_label     label of the total emissivity (default = 'TOTAL')
    - ax              axis where to send the plot. If None, a new axis is done\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02313}{2313} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l01406}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Transition()}, \hyperlink{pynebcore_8py_source_l01218}{pyneb.\+core.\+pynebcore.\+Atom.\+line\+List}, \hyperlink{pynebcore_8py_source_l00062}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00075}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00155}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00404}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00637}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00984}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+N\+Levels}, and \hyperlink{pynebcore_8py_source_l01260}{pyneb.\+core.\+pynebcore.\+Atom.\+N\+Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l02253}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Tem\+Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02313}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}{02313}                   total\_color=\textcolor{stringliteral}{'black'}, total\_label=\textcolor{stringliteral}{'TOTAL'}, ax=\textcolor{keywordtype}{None}):
02314         \textcolor{stringliteral}{""" }
02315 \textcolor{stringliteral}{        Plot the emissivity as a function of temperature of all the lines of the selected atom.  }
02316 \textcolor{stringliteral}{}
02317 \textcolor{stringliteral}{        Usage: }
02318 \textcolor{stringliteral}{            O3.plotEmiss(tem\_min=10000, tem\_max=20000)}
02319 \textcolor{stringliteral}{        }
02320 \textcolor{stringliteral}{        Parameters:}
02321 \textcolor{stringliteral}{            - tem\_min         minimum value of the temperature range to span (default=1000)}
02322 \textcolor{stringliteral}{            - tem\_max         maximum value of the temperature range to span (default=30000)}
02323 \textcolor{stringliteral}{            - ionic\_abund     relative ionic abundance (default = 1.0)}
02324 \textcolor{stringliteral}{            - den             electron density}
02325 \textcolor{stringliteral}{            - style           line style of the plot (default: '-' [solid line])}
02326 \textcolor{stringliteral}{            - legend\_loc      localization of the legend (default: 4 = lower right; see plt.legend }
02327 \textcolor{stringliteral}{                                for more details)}
02328 \textcolor{stringliteral}{            - temLog          linear (False) or logarithmic temperature axis (default = False)}
02329 \textcolor{stringliteral}{            - plot\_total      flag to also plot total emissivity (default = False)}
02330 \textcolor{stringliteral}{            - plot\_only\_total flag to only plot total emissivity (default = False)}
02331 \textcolor{stringliteral}{            - legend          flag to place legend (default = True)}
02332 \textcolor{stringliteral}{            - total\_color     color of the total emissivity (default = 'black')}
02333 \textcolor{stringliteral}{            - total\_label     label of the total emissivity (default = 'TOTAL')}
02334 \textcolor{stringliteral}{            - ax              axis where to send the plot. If None, a new axis is done}
02335 \textcolor{stringliteral}{}
02336 \textcolor{stringliteral}{        """}
02337         \textcolor{keywordflow}{if} ax \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
02338             f, ax = plt.subplots()
02339         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} pn.config.INSTALLED[\textcolor{stringliteral}{'plt'}]: 
02340             pn.log\_.error(\textcolor{stringliteral}{'Matplotlib not available, no plot'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.plot'})
02341             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02342         tem = np.logspace(np.log10(tem\_min), np.log10(tem\_max), 1000)
02343         total\_emis = np.zeros\_like(tem)
02344         \textcolor{keywordflow}{for} wave \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList}:
02345             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
02346             \textcolor{keywordflow}{if} (lev\_i <= self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}) \textcolor{keywordflow}{and} (lev\_j <= self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}):
02347                 color = ((np.log10(wave) - np.log10(np.min(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList}))) / 
02348                          (np.log10(np.max(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList})) - np.log10(np.min(self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList})))) ** 0.4
02349                 c = cm.jet(color, 1)
02350                 \textcolor{keywordflow}{if} temLog:
02351                     x\_to\_plot = np.log10(tem)
02352                 \textcolor{keywordflow}{else}:
02353                     x\_to\_plot = tem
02354                 y\_to\_plot = ionic\_abund * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, wave=wave)
02355                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} plot\_only\_total:
02356                     \textcolor{keywordflow}{if} (y\_to\_plot[0] > 0.):
02357                         ax.plot(x\_to\_plot, np.log10(y\_to\_plot),
02358                              label=\textcolor{stringliteral}{'\{0:.0f\}'}.format(wave), color=c, linestyle=style)
02359                 total\_emis += y\_to\_plot
02360         \textcolor{keywordflow}{if} plot\_total:
02361             ax.plot(x\_to\_plot, np.log10(total\_emis),
02362                      label=total\_label, color=total\_color, linewidth=3, linestyle=style)
02363         \textcolor{keywordflow}{if} legend:
02364             ax.legend(loc=legend\_loc)
02365         \textcolor{keywordflow}{if} temLog:
02366             ax.set\_xlabel(\textcolor{stringliteral}{'log(T[K])'})
02367         \textcolor{keywordflow}{else}:
02368             ax.set\_xlabel(\textcolor{stringliteral}{'T[K]'})
02369         ax.set\_ylabel(\textcolor{stringliteral}{'log [erg.cm3/s]'})
02370         ax.set\_title(\textcolor{stringliteral}{'Line emissivities'})
02371 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!plot\+Grotrian@{plot\+Grotrian}}
\index{plot\+Grotrian@{plot\+Grotrian}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{plot\+Grotrian}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem = {\ttfamily 1e4}, }
\item[{}]{den = {\ttfamily 1e2}, }
\item[{}]{thresh\+\_\+int = {\ttfamily 1e-\/3}, }
\item[{}]{unit = {\ttfamily \textquotesingle{}eV\textquotesingle{}}, }
\item[{}]{detailed = {\ttfamily False}, }
\item[{}]{ax = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}
\begin{DoxyVerb}Draw a Grotrian plot of the selected atom, labelling only lines above a
pecified intensity threshold (relative to the most intense line). 
For ground state levels, the Russell-Saunders term symbol is also given.

Usage:
    O3.plotGrotrian()

Parameters:
    - tem          temperature at which the intensity threshold is to be computed 
    - den          density at which the intensity threshold is to be computed 
    - thresh_int   intensity threshold (relative to the most intense line, default: 1.e-3)
    - unit         one of 'eV' (default), '1/Ang' or 'Ryd'
    - ax           axis where to plot the result\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02372}{2372} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{emis_grid_8py_source_l00048}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+atom}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00303}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l00559}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+atom}, \hyperlink{pynebcore_8py_source_l00909}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+atom}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\+core.\+pynebcore.\+Atom.\+atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{emis_grid_8py_source_l00045}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+elem}, \hyperlink{pynebcore_8py_source_l00083}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00304}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l00560}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00910}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l01165}{pyneb.\+core.\+pynebcore.\+Atom.\+elem}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l00059}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+Energy}, \hyperlink{pynebcore_8py_source_l01200}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Energy}, \hyperlink{pynebcore_8py_source_l00058}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l01199}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Stat\+Weight}, \hyperlink{pynebcore_8py_source_l00130}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+gs}, \hyperlink{pynebcore_8py_source_l00406}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+gs}, \hyperlink{pynebcore_8py_source_l01203}{pyneb.\+core.\+pynebcore.\+Atom.\+gs}, \hyperlink{misc_8py_source_l00013}{pyneb.\+utils.\+misc.\+int\+\_\+to\+\_\+roman()}, \hyperlink{pynebcore_8py_source_l00385}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+N\+I\+S\+T}, \hyperlink{pynebcore_8py_source_l01211}{pyneb.\+core.\+pynebcore.\+Atom.\+N\+I\+S\+T}, \hyperlink{pynebcore_8py_source_l00062}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00075}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00155}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00404}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00637}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00984}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l01260}{pyneb.\+core.\+pynebcore.\+Atom.\+N\+Levels}, \hyperlink{emis_grid_8py_source_l00046}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+spec}, \hyperlink{pynebcore_8py_source_l00084}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00305}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+spec}, \hyperlink{pynebcore_8py_source_l00561}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00911}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+spec}, \hyperlink{pynebcore_8py_source_l01166}{pyneb.\+core.\+pynebcore.\+Atom.\+spec}, \hyperlink{pynebcore_8py_source_l00057}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+wave\+\_\+\+Ang}, \hyperlink{pynebcore_8py_source_l00165}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+wave\+\_\+\+Ang}, \hyperlink{pynebcore_8py_source_l00426}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+wave\+\_\+\+Ang}, and \hyperlink{pynebcore_8py_source_l01198}{pyneb.\+core.\+pynebcore.\+Atom.\+wave\+\_\+\+Ang}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02372}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{02372}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{plotGrotrian}(self, tem=1e4, den=1e2, thresh\_int=1e-3, unit='eV', detailed=False, 
      ax=None):
02373         \textcolor{stringliteral}{"""}
02374 \textcolor{stringliteral}{        Draw a Grotrian plot of the selected atom, labelling only lines above a}
02375 \textcolor{stringliteral}{        pecified intensity threshold (relative to the most intense line). }
02376 \textcolor{stringliteral}{        For ground state levels, the Russell-Saunders term symbol is also given.}
02377 \textcolor{stringliteral}{        }
02378 \textcolor{stringliteral}{        Usage:}
02379 \textcolor{stringliteral}{            O3.plotGrotrian()}
02380 \textcolor{stringliteral}{        }
02381 \textcolor{stringliteral}{        Parameters:}
02382 \textcolor{stringliteral}{            - tem          temperature at which the intensity threshold is to be computed }
02383 \textcolor{stringliteral}{            - den          density at which the intensity threshold is to be computed }
02384 \textcolor{stringliteral}{            - thresh\_int   intensity threshold (relative to the most intense line, default: 1.e-3)}
02385 \textcolor{stringliteral}{            - unit         one of 'eV' (default), '1/Ang' or 'Ryd'}
02386 \textcolor{stringliteral}{            - ax           axis where to plot the result}
02387 \textcolor{stringliteral}{}
02388 \textcolor{stringliteral}{        """}
02389         \textcolor{keywordflow}{if} ax \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
02390             f, ax = plt.subplots()
02391         \textcolor{keywordflow}{if} unit \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'eV'}, \textcolor{stringliteral}{'Ryd'}, \textcolor{stringliteral}{'1/Ang'}]:
02392             pn.log\_.error(\textcolor{stringliteral}{'Unit \{0\} not available'}.format(unit))
02393             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02394         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} pn.config.INSTALLED[\textcolor{stringliteral}{'plt'}]: 
02395             pn.log\_.error(\textcolor{stringliteral}{'Matplotlib not available, no plot'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.plot'})
02396             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02397         color\_list = [\textcolor{stringliteral}{'b'}, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r', '}y', 'c', 'm', 'g']
02398         energies = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(unit=unit)
02399          
02400         \textcolor{comment}{# VL 16 Jul 2013 - Detect level inversion, just for warning        }
02401         level\_multiplet = [0]
02402         multiplets = []
02403         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
02404             term = []; j = []; en = []
02405             \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST}:
02406                 term.append(item[1])
02407                 j.append(item[2])
02408                 en.append(item[3])
02409             sorted\_indx = np.argsort(en) 
02410             term = np.array(term)[sorted\_indx]
02411             j = np.array(j)[sorted\_indx]
02412             en = np.array(en)[sorted\_indx]
02413             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(1, len(en)):
02414                 \textcolor{keywordflow}{if} (term[i] == term[i-1]):
02415                     level\_multiplet.append(i)
02416                 \textcolor{keywordflow}{else}:
02417                     multiplets.append(level\_multiplet) 
02418                     level\_multiplet = [i]
02419             multiplets.append(level\_multiplet) \textcolor{comment}{# append last multiplet}
02420 \textcolor{comment}{# Mistakenly rounds off fractional J values. Corrected 26/12/2014            }
02421 \textcolor{comment}{#            levelLabels = ['$^\{\{\{0\}\}\}$\{1\}$\_\{\{\{2:.0f\}\}\}$'.format(l['term'][0],l['term'][1],l['J']) for l in
       self.NIST]}
02422             levelLabels = [\textcolor{stringliteral}{'$^\{\{\{0\}\}\}$\{1\}$\_\{\{\{2\}/\{3\}\}\}$'}.format(l[\textcolor{stringliteral}{'term'}][0], l[\textcolor{stringliteral}{'term'}][1], Fraction(l[\textcolor{stringliteral}{'J'}]
      ).numerator, Fraction(l[\textcolor{stringliteral}{'J'}]).denominator) \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST}]
02423         \textcolor{keywordflow}{else}:
02424             delta\_e\_max = 1.e-5  \textcolor{comment}{# Arbitrary limit to define hyperfine structure and identify multiplets }
02425             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(1, len(energies)):
02426                 \textcolor{keywordflow}{if} (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}()[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}()[i - 1] < delta\_e\_max):
02427                     \textcolor{comment}{# if levels close, append level to multiplet}
02428                     level\_multiplet.append(i) 
02429                 \textcolor{keywordflow}{else}:
02430                     \textcolor{comment}{# if levels separated, add current multiplet to array and start a new multiplet}
02431                     multiplets.append(level\_multiplet) 
02432                     level\_multiplet = [i]
02433             multiplets.append(level\_multiplet) \textcolor{comment}{# append last multiplet}
02434             warn\_label = []
02435             levelLabels = gsLevelDict[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs}]
02436             \textcolor{keywordflow}{for} i\_multi \textcolor{keywordflow}{in} np.arange(len(multiplets)):
02437                 stat\_weights = []
02438                 \textcolor{comment}{# check each multiplet for inversion separately}
02439                 \textcolor{keywordflow}{for} i\_level \textcolor{keywordflow}{in} multiplets[i\_multi]:
02440                     latex\_sw = levelLabels[i\_level]
02441                     sw = eval(latex\_sw.split(\textcolor{stringliteral}{'$'})[-2].replace(\textcolor{stringliteral}{'\_'}, \textcolor{stringliteral}{''}).replace(\textcolor{stringliteral}{'\{'}, \textcolor{stringliteral}{''}).replace(\textcolor{stringliteral}{'\}'}, \textcolor{stringliteral}{'.'}) +
       \textcolor{stringliteral}{'*2.+1.'})
02442                     stat\_weights.append(sw)
02443                 \textcolor{keywordflow}{if} (stat\_weights != [self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}()[k] \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} multiplets[i\_multi]]):
02444                     warn\_label.append(i\_multi)
02445                     to\_print = \textcolor{stringliteral}{'\(\backslash\)nLevel inversion in multiplet \{0\} of \{1\}'}\(\backslash\)
02446                              \textcolor{stringliteral}{'\(\backslash\)nThe labels of levels \{2\} are displayed in the wrong order'} + \(\backslash\)
02447                              \textcolor{stringliteral}{'\(\backslash\)nAssumed statistical weights: \{3\}'} + \(\backslash\)
02448                              \textcolor{stringliteral}{'\(\backslash\)nStatistical weights of data: \{4\}\(\backslash\)n'}
02449                     pn.log\_.warn(to\_print.format(i\_multi + 1, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, multiplets[i\_multi], 
02450                                                  stat\_weights, [self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}()[k] \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} multiplets[i\_multi]]), 
02451                                  calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.plot'})
02452 
02453         \textcolor{comment}{# where level starts in the plot}
02454        
02455         x\_span = 0.75
02456         x\_0 = (1 - x\_span) / 4.    
02457         dx = 0.005
02458         max\_en = np.max(energies)
02459         blow = 0.02 * max\_en \textcolor{comment}{# blowup scale for multiplets}
02460         ax.set\_xlim((0, 1.))
02461         ax.set\_ylim((np.max(energies) * -0.05, max\_en * 1.05))
02462         ax.set\_title(\textcolor{stringliteral}{'[\{0\} \{1\}]'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, \hyperlink{namespacepyneb_1_1utils_1_1misc_aec4e973d4cb9299f749ef190ea636a06}{int\_to\_roman}(self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec})))
02463 
02464         \textcolor{comment}{# Blow up of multiplets in the plot}
02465         i\_tot = 0
02466         \textcolor{keywordflow}{for} i\_multi \textcolor{keywordflow}{in} np.arange(len(multiplets)):
02467             shift = (1-len(multiplets[i\_multi])) / 2.
02468             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(len(multiplets[i\_multi])):
02469                 y = energies[multiplets[i\_multi][i]] + shift * blow
02470                 ax.plot([x\_0, 1.5 * x\_0, 1.6 * x\_0, x\_0 + x\_span], 
02471                          [y, y, energies[multiplets[i\_multi][i]], 
02472                           energies[multiplets[i\_multi][i]]], lw = 1.2, 
02473                          color = color\_list[np.mod(multiplets[i\_multi][i], len(color\_list))])
02474                 ax.text(x\_span + x\_0 + dx, y, \textcolor{stringliteral}{'\{0:7.4f\}'}.format(energies[multiplets[i\_multi][i]]), size=\textcolor{stringliteral}{'
      small'}, 
02475                          horizontalalignment=\textcolor{stringliteral}{'left'}, verticalalignment=\textcolor{stringliteral}{'center'})
02476                 \textcolor{keywordflow}{try}:
02477                     \textcolor{keywordflow}{if} (detailed \textcolor{keywordflow}{is} \textcolor{keyword}{False}):
02478                         ax.text(dx, y, levelLabels[i\_tot], size=\textcolor{stringliteral}{'medium'}, verticalalignment=\textcolor{stringliteral}{'center'})
02479                     \textcolor{keywordflow}{else}:
02480                         ax.text(dx, y, str(i\_tot+1) + \textcolor{stringliteral}{": "} + levelLabels[i\_tot] , size=\textcolor{stringliteral}{'medium'}, 
      verticalalignment=\textcolor{stringliteral}{'center'}, color = color\_list[np.mod(multiplets[i\_multi][i], len(color\_list))])
02481                     i\_tot += 1
02482                 \textcolor{keywordflow}{except}:
02483                     \textcolor{keywordflow}{pass}
02484                 shift += 1
02485         ax.text(1 - dx / 2., max(energies) * 0.5, \textcolor{stringliteral}{'E [\{0:s\}] '}.format(unit), horizontalalignment=\textcolor{stringliteral}{'right'}, 
      color=\textcolor{stringliteral}{'blue'})
02486         plt.xlabel(\textcolor{stringliteral}{'Ground-state configuration: \{0\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs}), color=\textcolor{stringliteral}{"#004400"})
02487                
02488         ax.xaxis.set\_ticks\_position(\textcolor{stringliteral}{"none"})
02489         ax.yaxis.set\_ticks\_position(\textcolor{stringliteral}{"none"})
02490         ax.xaxis.set\_ticklabels([])
02491         ax.yaxis.set\_ticklabels([])
02492         
02493         emis\_max = np.max(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den))
02494         N\_lines = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(1e4, 1e3) > (emis\_max * thresh\_int)).sum() \textcolor{comment}{# number of
       lines plotted}
02495         x\_pad = 0.1 * (x\_span - 0.6 * x\_0)     
02496         \textcolor{keywordflow}{if} N\_lines > 1:
02497             delta\_x = (x\_span - 2 * x\_pad) / (N\_lines - 1)
02498             x = 1.6 * x\_0 + 0.5 * x\_pad
02499         \textcolor{keywordflow}{else}:
02500             delta\_x = 0
02501             x = (1.6 * x\_0 + x\_span) / 2.
02502         cc = colors.ColorConverter()
02503         \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} np.arange(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels} - 1) + 2:
02504             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(j - 1) + 1:
02505                 emis = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, j, i)
02506                 \textcolor{keywordflow}{if} emis > (emis\_max * thresh\_int):
02507                     N\_seg = 1000. \textcolor{comment}{#number of segments to draw emission line, to make it look smooth}
02508                     xx = np.ones(N\_seg+1) * x  \textcolor{comment}{# x coord of segmente making up one line}
02509                     yy = np.linspace(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(i, unit=unit), self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(j, unit=unit), N\_seg+1)
02510                     scale = np.linspace(0, 1, N\_seg+1)
02511                     alpha =  np.tanh((2*scale-1)+1)  \textcolor{comment}{# to make alpha vary as a smooth step function}
02512                     points = np.array([xx, yy]).T.reshape(-1, 1, 2) 
02513                     segments = np.concatenate([points[:-1], points[1:]], axis=1) 
02514                     cmap1 = []
02515                     cmap2 = []
02516                     \textcolor{keywordflow}{for} seg \textcolor{keywordflow}{in} segments:
02517                             yy0 = seg.mean(0)[1] 
02518                             alpha0 = np.interp(yy0, yy, alpha)
02519                             rgb1 = cc.to\_rgb(color\_list[np.mod(j-1, len(color\_list))]) 
02520                             rgb2 = cc.to\_rgb(color\_list[np.mod(i-1, len(color\_list))]) 
02521                             cmap1.append([rgb1[0], rgb1[1], rgb1[2], alpha0]) 
02522                             cmap2.append([rgb2[0], rgb2[1], rgb2[2], 1-alpha0])
02523                     lc1 = LineCollection(segments, linewidths=3.5)
02524                     lc1.set\_color(cmap1) 
02525                     lc2 = LineCollection(segments, linewidths=3.5)
02526                     lc2.set\_color(cmap2) 
02527                     ax.add\_collection(lc1) 
02528                     ax.add\_collection(lc2) 
02529                     \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[j - 1, i - 1] > 1e4:
02530                         to\_print = \textcolor{stringliteral}{'\{0:.1f\}m'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[j - 1, i - 1] / 1e4) + \textcolor{stringliteral}{' '}
02531                     \textcolor{keywordflow}{else}:
02532                         to\_print = \textcolor{stringliteral}{'\{0:.1f\}A'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[j - 1, i - 1]) + \textcolor{stringliteral}{' '}
02533                     ax.text(x + 0.05 * delta\_x, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(j, unit=unit)-blow/2., to\_print, 
      size=\textcolor{stringliteral}{'small'}, rotation=90, verticalalignment=\textcolor{stringliteral}{'top'})
02534                     x = x + delta\_x
02535 
02536         \textcolor{comment}{# issue warning on plot if level inversion }
02537         \textcolor{keywordflow}{try}:
02538             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} warn\_label:
02539                 ax.text(0, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(multiplets[i][0]+1, unit=unit), \textcolor{stringliteral}{'Warning '}, ha=\textcolor{stringliteral}{'right'}, 
      color=\textcolor{stringliteral}{'red'})
02540         \textcolor{keywordflow}{except}:
02541             \textcolor{keywordflow}{pass}
02542 
02543     
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!print\+Ionic@{print\+Ionic}}
\index{print\+Ionic@{print\+Ionic}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{print\+Ionic}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem = {\ttfamily None}, }
\item[{}]{den = {\ttfamily None}, }
\item[{}]{print\+A = {\ttfamily False}, }
\item[{}]{print\+Pop = {\ttfamily True}, }
\item[{}]{print\+Crit = {\ttfamily True}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}
\begin{DoxyVerb}Print miscellaneous information (wavelengths, level populations, emissivities, 
    critical densities) for given physical conditions.
If an electron temperature is given, level critical densities can be printed 
    (using printCrit=True)
If an electron density is also given, line emissivities (also for Hbeta) are printed and level 
    populations can be printed (using printPop=True)

Usage:
    O3.printIonic()
    O3.printIonic(printA=True)
    O3.printIonic(tem=10000., printCrit=True)
    O3.printIonic(tem=10000., den=1e3, printA=True, printPop=True, printCrit=True)

Parameters:
    - tem          temperature
    - den          density
    - printA       also print transition probabilities (default=False)
    - printPop     also print level populations (needs tem and den)
    - printCrit    also print critical densities (needs tem)\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02167}{2167} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\+core.\+icf.\+I\+C\+F.\+calling}, \hyperlink{emis_grid_8py_source_l00041}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+calling}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\+core.\+diags.\+Diagnostics.\+calling}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l00568}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+calling}, \hyperlink{pynebcore_8py_source_l00918}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+calling}, \hyperlink{pynebcore_8py_source_l01175}{pyneb.\+core.\+pynebcore.\+Atom.\+calling}, \hyperlink{emis_grid_8py_source_l00045}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+elem}, \hyperlink{pynebcore_8py_source_l00083}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00304}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l00560}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00910}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l01165}{pyneb.\+core.\+pynebcore.\+Atom.\+elem}, \hyperlink{pynebcore_8py_source_l00060}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+get\+A}, \hyperlink{pynebcore_8py_source_l00205}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+get\+A()}, \hyperlink{pynebcore_8py_source_l00475}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+get\+A()}, \hyperlink{pynebcore_8py_source_l01471}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+A()}, \hyperlink{pynebcore_8py_source_l01693}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Crit\+Density()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l01496}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations()}, \hyperlink{pynebcore_8py_source_l00062}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00075}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+None.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00155}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00404}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00637}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l00984}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l01260}{pyneb.\+core.\+pynebcore.\+Atom.\+N\+Levels}, \hyperlink{pynebcore_8py_source_l02253}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Tem\+Den()}, \hyperlink{emis_grid_8py_source_l00046}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+spec}, \hyperlink{pynebcore_8py_source_l00084}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00305}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+spec}, \hyperlink{pynebcore_8py_source_l00561}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00911}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+spec}, \hyperlink{pynebcore_8py_source_l01166}{pyneb.\+core.\+pynebcore.\+Atom.\+spec}, \hyperlink{pynebcore_8py_source_l00057}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+None.\+wave\+\_\+\+Ang}, \hyperlink{pynebcore_8py_source_l00165}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+wave\+\_\+\+Ang}, \hyperlink{pynebcore_8py_source_l00426}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+wave\+\_\+\+Ang}, and \hyperlink{pynebcore_8py_source_l01198}{pyneb.\+core.\+pynebcore.\+Atom.\+wave\+\_\+\+Ang}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02167}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{02167}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{printIonic}(self, tem=None, den=None, printA=False, printPop=True, printCrit=True):
02168         \textcolor{stringliteral}{""" }
02169 \textcolor{stringliteral}{        Print miscellaneous information (wavelengths, level populations, emissivities, }
02170 \textcolor{stringliteral}{            critical densities) for given physical conditions.}
02171 \textcolor{stringliteral}{        If an electron temperature is given, level critical densities can be printed }
02172 \textcolor{stringliteral}{            (using printCrit=True)}
02173 \textcolor{stringliteral}{        If an electron density is also given, line emissivities (also for Hbeta) are printed and level }
02174 \textcolor{stringliteral}{            populations can be printed (using printPop=True)}
02175 \textcolor{stringliteral}{        }
02176 \textcolor{stringliteral}{        Usage:}
02177 \textcolor{stringliteral}{            O3.printIonic()}
02178 \textcolor{stringliteral}{            O3.printIonic(printA=True)}
02179 \textcolor{stringliteral}{            O3.printIonic(tem=10000., printCrit=True)}
02180 \textcolor{stringliteral}{            O3.printIonic(tem=10000., den=1e3, printA=True, printPop=True, printCrit=True)}
02181 \textcolor{stringliteral}{}
02182 \textcolor{stringliteral}{        Parameters:}
02183 \textcolor{stringliteral}{            - tem          temperature}
02184 \textcolor{stringliteral}{            - den          density}
02185 \textcolor{stringliteral}{            - printA       also print transition probabilities (default=False)}
02186 \textcolor{stringliteral}{            - printPop     also print level populations (needs tem and den)}
02187 \textcolor{stringliteral}{            - printCrit    also print critical densities (needs tem)}
02188 \textcolor{stringliteral}{}
02189 \textcolor{stringliteral}{        """}
02190         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'elem = %s'} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}
02191         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'spec = %i'} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}
02192         \textcolor{keywordflow}{if} tem \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
02193             \textcolor{keywordflow}{print} \textcolor{stringliteral}{'temperature = %6.1f K'} % tem
02194         \textcolor{keywordflow}{if} den \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
02195             \textcolor{keywordflow}{print} \textcolor{stringliteral}{'density = %6.1f cm-3'} % den
02196         \textcolor{keywordflow}{print} \textcolor{stringliteral}{""}
02197         \textcolor{keywordflow}{if} printPop \textcolor{keywordflow}{and} ((tem \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{or} (den \textcolor{keywordflow}{is} \textcolor{keywordtype}{None})):
02198             pn.log\_.warn(\textcolor{stringliteral}{'Cannot print populations as tem or den is missing'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02199             printPop = \textcolor{keyword}{False}
02200         \textcolor{keywordflow}{if} printCrit \textcolor{keywordflow}{and} (tem \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}):
02201             pn.log\_.warn(\textcolor{stringliteral}{'Cannot print critical densities as tem is missing'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02202             printCrit = \textcolor{keyword}{False}
02203         to\_print = \textcolor{stringliteral}{''}
02204         \textcolor{keywordflow}{if} printPop:
02205             to\_print += \textcolor{stringliteral}{'Level   Populations  '}
02206         \textcolor{keywordflow}{if} printCrit:
02207             to\_print += \textcolor{stringliteral}{'Critical densities'}
02208         \textcolor{keywordflow}{if} to\_print != \textcolor{stringliteral}{''}:
02209             print(to\_print)
02210         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}):
02211             lev\_i = i + 1
02212             to\_print = \textcolor{stringliteral}{'Level %1i:  '} % (lev\_i)
02213             \textcolor{keywordflow}{if} printPop:
02214                 pop = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den)
02215                 to\_print += \textcolor{stringliteral}{"%.3E  "} % (pop[i])
02216             \textcolor{keywordflow}{if} printCrit:
02217                 to\_print += \textcolor{stringliteral}{"%.3E"} % (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{getCritDensity}(tem, lev\_i))
02218             \textcolor{keywordflow}{if} printPop \textcolor{keywordflow}{or} printCrit:
02219                 print(to\_print)
02220         \textcolor{keywordflow}{if} printPop \textcolor{keywordflow}{or} printCrit:
02221             print(\textcolor{stringliteral}{''})
02222              
02223         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}):
02224             \textcolor{keywordflow}{if} printA:
02225                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02226                     to\_print = \textcolor{stringliteral}{"\{0:.3E\}   "}.format(np.float(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(i + 1, j + 1)))
02227                     \textcolor{keywordflow}{print} to\_print,
02228                 \textcolor{keywordflow}{print} \textcolor{stringliteral}{""}
02229             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02230                 \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j] > 10000.:
02231                     to\_print = \textcolor{stringliteral}{"%10.2fm "} % (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j] / 1e4)
02232                 \textcolor{keywordflow}{else}:
02233                     to\_print = \textcolor{stringliteral}{"%10.2fA "} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j]
02234                 \textcolor{keywordflow}{print} to\_print,
02235             \textcolor{keywordflow}{print} \textcolor{stringliteral}{""}
02236             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02237                 \textcolor{keywordflow}{print} \textcolor{stringliteral}{"    (%1i-->%1i) "} % (i + 1, j + 1),
02238             \textcolor{keywordflow}{print} \textcolor{stringliteral}{""}
02239             \textcolor{keywordflow}{if} (tem \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (den \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}):
02240                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02241                     \textcolor{keywordflow}{print} \textcolor{stringliteral}{"  %.3E "} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, lev\_i=i + 1, lev\_j=j + 1),
02242             \textcolor{keywordflow}{print} \textcolor{stringliteral}{"\(\backslash\)n"}
02243         \textcolor{keywordflow}{if} (tem \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (den \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}):
02244             \textcolor{keywordflow}{try}:
02245                 H1 = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_rec_atom}{RecAtom}(\textcolor{stringliteral}{'H'}, 1)
02246                 \textcolor{keywordflow}{print} \textcolor{stringliteral}{"# H-beta volume emissivity:"}
02247                 \textcolor{keywordflow}{print} \textcolor{stringliteral}{"%.3E N(H+) * N(e-)  (erg/s)"} % H1.getEmissivity(tem, den, 4, 2)
02248             \textcolor{keywordflow}{except}:
02249                 \textcolor{keywordflow}{pass}
02250 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_af603fa94afcc5893bc55a72cafc3fdd5}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!print\+Sources@{print\+Sources}}
\index{print\+Sources@{print\+Sources}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{print\+Sources}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+print\+Sources (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_af603fa94afcc5893bc55a72cafc3fdd5}


Definition at line \hyperlink{pynebcore_8py_source_l01445}{1445} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l00183}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+get\+Sources()}, \hyperlink{pynebcore_8py_source_l00448}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+get\+Sources()}, \hyperlink{pynebcore_8py_source_l00673}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+get\+Sources()}, \hyperlink{pynebcore_8py_source_l01003}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+get\+Sources()}, and \hyperlink{pynebcore_8py_source_l01450}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Sources()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01445}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_af603fa94afcc5893bc55a72cafc3fdd5}{01445}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_af603fa94afcc5893bc55a72cafc3fdd5}{printSources}(self):
01446         
01447         \textcolor{keywordflow}{for} source \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9d6390b03ff490938536167fe65d8a87}{getSources}():
01448             \textcolor{keywordflow}{print} source    
01449     
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!print\+Tem\+Den@{print\+Tem\+Den}}
\index{print\+Tem\+Den@{print\+Tem\+Den}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{print\+Tem\+Den}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+print\+Tem\+Den (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\+\_\+ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j1 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+i2 = {\ttfamily -\/1}, }
\item[{}]{lev\+\_\+j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\+Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily \textquotesingle{}nsect\+\_\+recur\textquotesingle{}}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{end\+\_\+x = {\ttfamily -\/1}, }
\item[{}]{to\+\_\+eval = {\ttfamily None}, }
\item[{}]{n\+Cut = {\ttfamily 30}, }
\item[{}]{max\+Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}
\begin{DoxyVerb}Print result of getTemDen function. See getTemDen for more details.

Usage:
    O3.printTemDen(100, tem=10000, wave1=5007, wave2=4363)

Parameters:
    - int_ratio    intensity ratio of the selected transition
    - tem          electronic temperature
    - den          electronic density
    - lev_i1       upper level of 1st transition
    - lev_j1       lower level of 1st transition
    - lev_i2       upper level of 2nd transition
    - lev_j2       lower level of 2nd transition
    - wave1        wavelength of 1st transition
    - wave2        wavelength of 2nd transition
    - maxError     tolerance on difference between input and computed ratio 
    - method       numerical method for finding the root (nsect_recur, nsect_iter)
    - log          log switch (default = True)
    - start_x      lower end of the interval to explore (default: lower end of collision 
            strength temperature array)
    - end_x        higher end of the interval to explore (default: higher end of collision 
            strength temperature array)
    - to_eval      expression to be evaluated, using either I (for transitions identified through 
            atomic levels) or L (for transitions identified through wavelengths)
    - nCut        number of sections in which each step is cut. 2 would be dichotomy.
    - maxIter     maximum number of iterations\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02253}{2253} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{emis_grid_8py_source_l00045}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+elem}, \hyperlink{pynebcore_8py_source_l00083}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00304}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l00560}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+elem}, \hyperlink{pynebcore_8py_source_l00910}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+elem}, \hyperlink{pynebcore_8py_source_l01165}{pyneb.\+core.\+pynebcore.\+Atom.\+elem}, \hyperlink{pynebcore_8py_source_l02060}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Den()}, \hyperlink{misc_8py_source_l00013}{pyneb.\+utils.\+misc.\+int\+\_\+to\+\_\+roman()}, \hyperlink{pynebcore_8py_source_l02313}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Emiss()}, \hyperlink{emis_grid_8py_source_l00046}{pyneb.\+core.\+emis\+Grid.\+Emis\+Grid.\+spec}, \hyperlink{pynebcore_8py_source_l00084}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00305}{pyneb.\+core.\+pynebcore.\+\_\+\+Atom\+Data\+Ascii.\+spec}, \hyperlink{pynebcore_8py_source_l00561}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+spec}, \hyperlink{pynebcore_8py_source_l00911}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+spec}, and \hyperlink{pynebcore_8py_source_l01166}{pyneb.\+core.\+pynebcore.\+Atom.\+spec}.



Referenced by \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02253}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}{02253}                     nCut=30, maxIter=20):
02254         \textcolor{stringliteral}{""" }
02255 \textcolor{stringliteral}{        Print result of getTemDen function. See getTemDen for more details.}
02256 \textcolor{stringliteral}{        }
02257 \textcolor{stringliteral}{        Usage:}
02258 \textcolor{stringliteral}{            O3.printTemDen(100, tem=10000, wave1=5007, wave2=4363)}
02259 \textcolor{stringliteral}{        }
02260 \textcolor{stringliteral}{        Parameters:}
02261 \textcolor{stringliteral}{            - int\_ratio    intensity ratio of the selected transition}
02262 \textcolor{stringliteral}{            - tem          electronic temperature}
02263 \textcolor{stringliteral}{            - den          electronic density}
02264 \textcolor{stringliteral}{            - lev\_i1       upper level of 1st transition}
02265 \textcolor{stringliteral}{            - lev\_j1       lower level of 1st transition}
02266 \textcolor{stringliteral}{            - lev\_i2       upper level of 2nd transition}
02267 \textcolor{stringliteral}{            - lev\_j2       lower level of 2nd transition}
02268 \textcolor{stringliteral}{            - wave1        wavelength of 1st transition}
02269 \textcolor{stringliteral}{            - wave2        wavelength of 2nd transition}
02270 \textcolor{stringliteral}{            - maxError     tolerance on difference between input and computed ratio }
02271 \textcolor{stringliteral}{            - method       numerical method for finding the root (nsect\_recur, nsect\_iter)}
02272 \textcolor{stringliteral}{            - log          log switch (default = True)}
02273 \textcolor{stringliteral}{            - start\_x      lower end of the interval to explore (default: lower end of collision }
02274 \textcolor{stringliteral}{                            strength temperature array)}
02275 \textcolor{stringliteral}{            - end\_x        higher end of the interval to explore (default: higher end of collision }
02276 \textcolor{stringliteral}{                            strength temperature array)}
02277 \textcolor{stringliteral}{            - to\_eval      expression to be evaluated, using either I (for transitions identified through }
02278 \textcolor{stringliteral}{                            atomic levels) or L (for transitions identified through wavelengths)}
02279 \textcolor{stringliteral}{            - nCut        number of sections in which each step is cut. 2 would be dichotomy.}
02280 \textcolor{stringliteral}{            - maxIter     maximum number of iterations}
02281 \textcolor{stringliteral}{}
02282 \textcolor{stringliteral}{        """}
02283         \textcolor{keywordflow}{if} tem == -1:
02284             option = \textcolor{stringliteral}{'temperature'}
02285             assume = den
02286             assume\_str = \textcolor{stringliteral}{'density'}
02287             assume\_unit = \textcolor{stringliteral}{'cm-3'}
02288             unit = \textcolor{stringliteral}{'K'}
02289         \textcolor{keywordflow}{if} den == -1:
02290             option = \textcolor{stringliteral}{'density'}
02291             assume = tem
02292             assume\_str = \textcolor{stringliteral}{'temperature'}
02293             assume\_unit = \textcolor{stringliteral}{'K'}
02294             unit = \textcolor{stringliteral}{'cm-3'}
02295 
02296         result = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{getTemDen}(int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, lev\_j1=lev\_j1, lev\_i2=
      lev\_i2, lev\_j2=lev\_j2,
02297                                 wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, 
      start\_x=start\_x,
02298                                 end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)
02299         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Ion = %s'} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} + \textcolor{stringliteral}{" "} + \hyperlink{namespacepyneb_1_1utils_1_1misc_aec4e973d4cb9299f749ef190ea636a06}{int\_to\_roman}(self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec})
02300         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Option = %s'} % option
02301         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Assumed %s = %.0f %s'} % (assume\_str, assume, assume\_unit)
02302         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
02303             \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Assumed I(%i)/I(%i) ratio = %.0f'} % (wave1, wave2, int\_ratio)
02304         \textcolor{keywordflow}{else}:
02305             \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Assumed %s = %.0f'} % (to\_eval, int\_ratio)
02306 \textcolor{comment}{#        print 'method = %s' % method}
02307 \textcolor{comment}{#        print 'maxError on ratio %f' % maxError}
02308         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Calculated %s = %.0f %s'} % (option, result, unit)
02309 
02310 
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a2e6b21ca9b8f63a8da2167bdaf0912f3}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!print\+Transition@{print\+Transition}}
\index{print\+Transition@{print\+Transition}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{print\+Transition}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+core.\+pynebcore.\+Atom.\+print\+Transition (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{wave}
\end{DoxyParamCaption}
)}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a2e6b21ca9b8f63a8da2167bdaf0912f3}
\begin{DoxyVerb}Print info on transition associated to input wavelength.

Usage:
    O3.printTransition(4959)
    
Parameters:
    - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') 
or in micron (a label: '51.5m')\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01425}{1425} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



References \hyperlink{pynebcore_8py_source_l01367}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Transition()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01425}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a2e6b21ca9b8f63a8da2167bdaf0912f3}{01425}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a2e6b21ca9b8f63a8da2167bdaf0912f3}{printTransition}(self, wave):
01426         \textcolor{stringliteral}{"""}
01427 \textcolor{stringliteral}{        Print info on transition associated to input wavelength.}
01428 \textcolor{stringliteral}{        }
01429 \textcolor{stringliteral}{        Usage:}
01430 \textcolor{stringliteral}{            O3.printTransition(4959)}
01431 \textcolor{stringliteral}{            }
01432 \textcolor{stringliteral}{        Parameters:}
01433 \textcolor{stringliteral}{            - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') }
01434 \textcolor{stringliteral}{                or in micron (a label: '51.5m')}
01435 \textcolor{stringliteral}{                }
01436 \textcolor{stringliteral}{        """}
01437         closestTransition = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\_Transition}(wave)
01438         relativeError = closestTransition[3] / closestTransition[2] - 1
01439         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Input wave: \{0:.1F\}'}.format(closestTransition[3])
01440         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Closest wave found: \{0:.1F\}'}.format(closestTransition[2])
01441         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Relative error: \{0:.0E\} '}.format(relativeError)
01442         \textcolor{keywordflow}{print} \textcolor{stringliteral}{'Transition: \{0[0]\} -> \{0[1]\}'}.format(closestTransition)
01443         \textcolor{keywordflow}{return}
01444     
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+\+A@{\+\_\+\+A}}
\index{\+\_\+\+A@{\+\_\+\+A}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+\+A}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+A\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}


Definition at line \hyperlink{pynebcore_8py_source_l01256}{1256} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pn__chianti_8py_source_l00296}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+get\+A()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, and \hyperlink{pynebcore_8py_source_l01496}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+crit\+Density@{\+\_\+crit\+Density}}
\index{\+\_\+crit\+Density@{\+\_\+crit\+Density}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+crit\+Density}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+\_\+crit\+Density\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}


Definition at line \hyperlink{pynebcore_8py_source_l01553}{1553} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01693}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Crit\+Density()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+\+Energy@{\+\_\+\+Energy}}
\index{\+\_\+\+Energy@{\+\_\+\+Energy}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+\+Energy}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Energy\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}


Definition at line \hyperlink{pynebcore_8py_source_l01257}{1257} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l01329}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Coll\+Rates()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pn__chianti_8py_source_l00346}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+get\+Energy()}, and \hyperlink{pynebcore_8py_source_l02811}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Energy()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!\+\_\+\+Stat\+Weight@{\+\_\+\+Stat\+Weight}}
\index{\+\_\+\+Stat\+Weight@{\+\_\+\+Stat\+Weight}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{\+\_\+\+Stat\+Weight}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Stat\+Weight\hspace{0.3cm}{\ttfamily [private]}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}


Definition at line \hyperlink{pynebcore_8py_source_l01258}{1258} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01329}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Coll\+Rates()}, and \hyperlink{pn__chianti_8py_source_l00323}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+get\+Stat\+Weight()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!atom@{atom}}
\index{atom@{atom}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{atom}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+atom}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}


Definition at line \hyperlink{pynebcore_8py_source_l01164}{1164} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01980}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P()}, \hyperlink{pynebcore_8py_source_l01367}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Transition()}, \hyperlink{pynebcore_8py_source_l02696}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+\+Transition()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pn__chianti_8py_source_l00484}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+get\+Omega()}, \hyperlink{pynebcore_8py_source_l02735}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Tot\+Recombination()}, \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}, and \hyperlink{pynebcore_8py_source_l02796}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+print\+Sources()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!Atom\+Data@{Atom\+Data}}
\index{Atom\+Data@{Atom\+Data}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{Atom\+Data}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+Atom\+Data}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}


Definition at line \hyperlink{pynebcore_8py_source_l01184}{1184} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01450}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Sources()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!atom\+File@{atom\+File}}
\index{atom\+File@{atom\+File}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{atom\+File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+atom\+File}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}


Definition at line \hyperlink{pynebcore_8py_source_l01194}{1194} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l02544}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+\_\+repr\+\_\+\+\_\+()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!atom\+File\+Type@{atom\+File\+Type}}
\index{atom\+File\+Type@{atom\+File\+Type}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{atom\+File\+Type}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+atom\+File\+Type}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}


Definition at line \hyperlink{pynebcore_8py_source_l01180}{1180} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!atom\+Fits\+File@{atom\+Fits\+File}}
\index{atom\+Fits\+File@{atom\+Fits\+File}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{atom\+Fits\+File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+atom\+Fits\+File}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}


Definition at line \hyperlink{pynebcore_8py_source_l01196}{1196} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!atom\+Fits\+Path@{atom\+Fits\+Path}}
\index{atom\+Fits\+Path@{atom\+Fits\+Path}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{atom\+Fits\+Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+atom\+Fits\+Path}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}


Definition at line \hyperlink{pynebcore_8py_source_l01197}{1197} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!Atom\+Header@{Atom\+Header}}
\index{Atom\+Header@{Atom\+Header}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{Atom\+Header}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+Atom\+Header}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}


Definition at line \hyperlink{pynebcore_8py_source_l01207}{1207} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!atom\+N\+Levels@{atom\+N\+Levels}}
\index{atom\+N\+Levels@{atom\+N\+Levels}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{atom\+N\+Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+atom\+N\+Levels}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}


Definition at line \hyperlink{pynebcore_8py_source_l01201}{1201} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!atom\+Path@{atom\+Path}}
\index{atom\+Path@{atom\+Path}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{atom\+Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+atom\+Path}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}


Definition at line \hyperlink{pynebcore_8py_source_l01195}{1195} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!calling@{calling}}
\index{calling@{calling}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{calling}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+calling}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}


Definition at line \hyperlink{pynebcore_8py_source_l01175}{1175} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l03885}{pyneb.\+core.\+pynebcore.\+Observation.\+\_\+\+\_\+normalize()}, \hyperlink{logging_8py_source_l00059}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+\_\+add2log()}, \hyperlink{red__corr_8py_source_l00658}{pyneb.\+extinction.\+red\+\_\+corr.\+Red\+Corr.\+\_\+\+F99\+\_\+like()}, \hyperlink{_config_8py_source_l00086}{pyneb.\+utils.\+Config.\+\_\+\+Config.\+\_\+get\+\_\+\+Pypic\+Path()}, \hyperlink{pynebcore_8py_source_l02854}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+get\+Label\+Str()}, \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l01980}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+\+M\+P()}, \hyperlink{logging_8py_source_l00051}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+\_\+pprint()}, \hyperlink{red__corr_8py_source_l00176}{pyneb.\+extinction.\+red\+\_\+corr.\+Red\+Corr.\+\_\+set\+\_\+law()}, \hyperlink{pn__chianti_8py_source_l00284}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+\_\+test\+\_\+lev()}, \hyperlink{pn__chianti_8py_source_l00449}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01459}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l02596}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01367}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Transition()}, \hyperlink{pynebcore_8py_source_l02696}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+\+Transition()}, \hyperlink{pynebcore_8py_source_l03436}{pyneb.\+core.\+pynebcore.\+Observation.\+add\+Line()}, \hyperlink{pynebcore_8py_source_l03467}{pyneb.\+core.\+pynebcore.\+Observation.\+add\+Obs()}, \hyperlink{pynebcore_8py_source_l03906}{pyneb.\+core.\+pynebcore.\+Observation.\+correct\+Data()}, \hyperlink{pynebcore_8py_source_l03325}{pyneb.\+core.\+pynebcore.\+Emission\+Line.\+correct\+Intens()}, \hyperlink{pynebcore_8py_source_l03861}{pyneb.\+core.\+pynebcore.\+Observation.\+def\+\_\+\+E\+B\+V()}, \hyperlink{pynebcore_8py_source_l03452}{pyneb.\+core.\+pynebcore.\+Observation.\+fill\+Obs()}, \hyperlink{red__corr_8py_source_l00211}{pyneb.\+extinction.\+red\+\_\+corr.\+Red\+Corr.\+get\+Corr()}, \hyperlink{manage__atomic__data_8py_source_l00297}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+\+Manage\+Atomic\+Data.\+get\+Data\+File()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l02873}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Emissivity()}, \hyperlink{pn__chianti_8py_source_l00346}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+get\+Energy()}, \hyperlink{pynebcore_8py_source_l02811}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Energy()}, \hyperlink{pynebcore_8py_source_l02110}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Ion\+Abundance()}, \hyperlink{pynebcore_8py_source_l02961}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Ion\+Abundance()}, \hyperlink{pynebcore_8py_source_l03543}{pyneb.\+core.\+pynebcore.\+Observation.\+get\+Line()}, \hyperlink{pn__chianti_8py_source_l00484}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+get\+Omega()}, \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}, \hyperlink{pn__chianti_8py_source_l00461}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+get\+Omega\+Array()}, \hyperlink{manage__atomic__data_8py_source_l00034}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+\+Manage\+Atomic\+Data.\+get\+Predefined\+Data\+File\+Dict()}, \hyperlink{pynebcore_8py_source_l03562}{pyneb.\+core.\+pynebcore.\+Observation.\+get\+Sorted\+Lines()}, \hyperlink{pynebcore_8py_source_l02735}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Tot\+Recombination()}, \hyperlink{red__corr_8py_source_l00303}{pyneb.\+extinction.\+red\+\_\+corr.\+Red\+Corr.\+plot()}, \hyperlink{plot_atomic_data_8py_source_l00116}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+A()}, \hyperlink{plot_atomic_data_8py_source_l00188}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+All\+A()}, \hyperlink{pynebcore_8py_source_l02313}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Emiss()}, \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}, \hyperlink{plot_atomic_data_8py_source_l00372}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+Omega()}, \hyperlink{plot_atomic_data_8py_source_l00261}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+Rel\+A()}, \hyperlink{manage__atomic__data_8py_source_l00431}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+\+Manage\+Atomic\+Data.\+print\+All\+Sources()}, \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}, \hyperlink{pynebcore_8py_source_l03589}{pyneb.\+core.\+pynebcore.\+Observation.\+read\+Data()}, \hyperlink{manage__atomic__data_8py_source_l00380}{pyneb.\+utils.\+manage\+\_\+atomic\+\_\+data.\+\_\+\+Manage\+Atomic\+Data.\+set\+Data\+File()}, and \hyperlink{logging_8py_source_l00115}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+timer()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!Coll\+Data@{Coll\+Data}}
\index{Coll\+Data@{Coll\+Data}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{Coll\+Data}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+Coll\+Data}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}


Definition at line \hyperlink{pynebcore_8py_source_l01232}{1232} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01450}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Sources()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!coll\+File@{coll\+File}}
\index{coll\+File@{coll\+File}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{coll\+File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+coll\+File}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}


Definition at line \hyperlink{pynebcore_8py_source_l01249}{1249} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l02544}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+\_\+repr\+\_\+\+\_\+()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!coll\+File\+Type@{coll\+File\+Type}}
\index{coll\+File\+Type@{coll\+File\+Type}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{coll\+File\+Type}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+coll\+File\+Type}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}


Definition at line \hyperlink{pynebcore_8py_source_l01228}{1228} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!coll\+Fits\+File@{coll\+Fits\+File}}
\index{coll\+Fits\+File@{coll\+Fits\+File}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{coll\+Fits\+File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+coll\+Fits\+File}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}


Definition at line \hyperlink{pynebcore_8py_source_l01251}{1251} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!coll\+Fits\+Path@{coll\+Fits\+Path}}
\index{coll\+Fits\+Path@{coll\+Fits\+Path}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{coll\+Fits\+Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+coll\+Fits\+Path}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}


Definition at line \hyperlink{pynebcore_8py_source_l01252}{1252} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!Coll\+Header@{Coll\+Header}}
\index{Coll\+Header@{Coll\+Header}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{Coll\+Header}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+Coll\+Header}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}


Definition at line \hyperlink{pynebcore_8py_source_l01242}{1242} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!coll\+N\+Levels@{coll\+N\+Levels}}
\index{coll\+N\+Levels@{coll\+N\+Levels}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{coll\+N\+Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+coll\+N\+Levels}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}


Definition at line \hyperlink{pynebcore_8py_source_l01253}{1253} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01329}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Coll\+Rates()}, and \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!coll\+Path@{coll\+Path}}
\index{coll\+Path@{coll\+Path}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{coll\+Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+coll\+Path}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}


Definition at line \hyperlink{pynebcore_8py_source_l01250}{1250} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!elem@{elem}}
\index{elem@{elem}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{elem}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+elem}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}


Definition at line \hyperlink{pynebcore_8py_source_l01165}{1165} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l02544}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+\_\+repr\+\_\+\+\_\+()}, \hyperlink{pynebcore_8py_source_l03032}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+\+\_\+repr\+\_\+\+\_\+()}, \hyperlink{plot_atomic_data_8py_source_l00116}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+A()}, \hyperlink{plot_atomic_data_8py_source_l00188}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+All\+A()}, \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}, \hyperlink{plot_atomic_data_8py_source_l00372}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+Omega()}, \hyperlink{plot_atomic_data_8py_source_l00261}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+Rel\+A()}, \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}, and \hyperlink{pynebcore_8py_source_l02253}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Tem\+Den()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!energy\+\_\+e\+V@{energy\+\_\+e\+V}}
\index{energy\+\_\+e\+V@{energy\+\_\+e\+V}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{energy\+\_\+e\+V}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+energy\+\_\+e\+V}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}


Definition at line \hyperlink{pynebcore_8py_source_l01224}{1224} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!energy\+\_\+\+Ryd@{energy\+\_\+\+Ryd}}
\index{energy\+\_\+\+Ryd@{energy\+\_\+\+Ryd}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{energy\+\_\+\+Ryd}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+energy\+\_\+\+Ryd}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}


Definition at line \hyperlink{pynebcore_8py_source_l01223}{1223} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!Energy\+N\+Levels@{Energy\+N\+Levels}}
\index{Energy\+N\+Levels@{Energy\+N\+Levels}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{Energy\+N\+Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+Energy\+N\+Levels}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}


Definition at line \hyperlink{pynebcore_8py_source_l01259}{1259} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01329}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Coll\+Rates()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Energy@{get\+Energy}}
\index{get\+Energy@{get\+Energy}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Energy}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+get\+Energy}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}


Definition at line \hyperlink{pynebcore_8py_source_l01200}{1200} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}, and \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Omega\+Array@{get\+Omega\+Array}}
\index{get\+Omega\+Array@{get\+Omega\+Array}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Omega\+Array}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega\+Array}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}


Definition at line \hyperlink{pynebcore_8py_source_l01247}{1247} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l00734}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+\_\+get\+Cheb\+Coeff\+Array()}, \hyperlink{pynebcore_8py_source_l00811}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+get\+Omega()}, and \hyperlink{pynebcore_8py_source_l01063}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+get\+Omega()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Stat\+Weight@{get\+Stat\+Weight}}
\index{get\+Stat\+Weight@{get\+Stat\+Weight}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Stat\+Weight}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+get\+Stat\+Weight}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}


Definition at line \hyperlink{pynebcore_8py_source_l01199}{1199} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01653}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+High\+Dens\+Ratio()}, \hyperlink{pynebcore_8py_source_l01632}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Low\+Dens\+Ratio()}, \hyperlink{pynebcore_8py_source_l01262}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Omega()}, and \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!get\+Tem\+Array@{get\+Tem\+Array}}
\index{get\+Tem\+Array@{get\+Tem\+Array}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{get\+Tem\+Array}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+get\+Tem\+Array}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}


Definition at line \hyperlink{pynebcore_8py_source_l01248}{1248} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l00734}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+\_\+get\+Cheb\+Coeff\+Array()}, \hyperlink{pynebcore_8py_source_l01803}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+get\+Tem\+Den\+\_\+1()}, \hyperlink{pynebcore_8py_source_l00811}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Fits.\+get\+Omega()}, and \hyperlink{pynebcore_8py_source_l01063}{pyneb.\+core.\+pynebcore.\+\_\+\+Coll\+Data\+Ascii.\+get\+Omega()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!gs@{gs}}
\index{gs@{gs}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{gs}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+gs}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}


Definition at line \hyperlink{pynebcore_8py_source_l01203}{1203} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!line\+List@{line\+List}}
\index{line\+List@{line\+List}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{line\+List}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+line\+List}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}


Definition at line \hyperlink{pynebcore_8py_source_l01218}{1218} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l02313}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Emiss()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!log\+\_\+@{log\+\_\+}}
\index{log\+\_\+@{log\+\_\+}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{log\+\_\+}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+log\+\_\+}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}


Definition at line \hyperlink{pynebcore_8py_source_l01162}{1162} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{logging_8py_source_l00059}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+\_\+add2log()}, \hyperlink{logging_8py_source_l00157}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+print\+\_\+debug()}, \hyperlink{logging_8py_source_l00149}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+print\+\_\+errors()}, \hyperlink{logging_8py_source_l00133}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+print\+\_\+messages()}, \hyperlink{logging_8py_source_l00165}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+print\+\_\+timer()}, \hyperlink{logging_8py_source_l00141}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+print\+\_\+warnings()}, and \hyperlink{logging_8py_source_l00115}{pyneb.\+utils.\+logging.\+my\+\_\+logging.\+timer()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!name@{name}}
\index{name@{name}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{name}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+name}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}


Definition at line \hyperlink{pynebcore_8py_source_l01174}{1174} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!N\+I\+S\+T@{N\+I\+S\+T}}
\index{N\+I\+S\+T@{N\+I\+S\+T}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{N\+I\+S\+T}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+N\+I\+S\+T}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}


Definition at line \hyperlink{pynebcore_8py_source_l01211}{1211} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!N\+Levels@{N\+Levels}}
\index{N\+Levels@{N\+Levels}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{N\+Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+N\+Levels}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}


Definition at line \hyperlink{pynebcore_8py_source_l01260}{1260} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pn__chianti_8py_source_l00284}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Atom\+Chianti.\+\_\+test\+\_\+lev()}, \hyperlink{pn__chianti_8py_source_l00449}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01459}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l02596}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+test\+\_\+lev()}, \hyperlink{pynebcore_8py_source_l01716}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Emissivity()}, \hyperlink{pynebcore_8py_source_l01496}{pyneb.\+core.\+pynebcore.\+Atom.\+get\+Populations()}, \hyperlink{pynebcore_8py_source_l02313}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Emiss()}, \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}, and \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!spec@{spec}}
\index{spec@{spec}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{spec}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+spec}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}


Definition at line \hyperlink{pynebcore_8py_source_l01166}{1166} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l02544}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+\_\+repr\+\_\+\+\_\+()}, \hyperlink{pynebcore_8py_source_l03032}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+\+\_\+repr\+\_\+\+\_\+()}, \hyperlink{plot_atomic_data_8py_source_l00116}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+A()}, \hyperlink{plot_atomic_data_8py_source_l00188}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+All\+A()}, \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}, \hyperlink{plot_atomic_data_8py_source_l00372}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+Omega()}, \hyperlink{plot_atomic_data_8py_source_l00261}{pyneb.\+plot.\+plot\+Atomic\+Data.\+Data\+Plot.\+plot\+Rel\+A()}, \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}, and \hyperlink{pynebcore_8py_source_l02253}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Tem\+Den()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!tem\+\_\+units@{tem\+\_\+units}}
\index{tem\+\_\+units@{tem\+\_\+units}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{tem\+\_\+units}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+tem\+\_\+units}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}


Definition at line \hyperlink{pynebcore_8py_source_l01254}{1254} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pn__chianti_8py_source_l00521}{pyneb.\+utils.\+pn\+\_\+chianti.\+\_\+\+Coll\+Chianti.\+get\+Tem\+Array()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{}\index{pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}!wave\+\_\+\+Ang@{wave\+\_\+\+Ang}}
\index{wave\+\_\+\+Ang@{wave\+\_\+\+Ang}!pyneb\+::core\+::pynebcore\+::\+Atom@{pyneb\+::core\+::pynebcore\+::\+Atom}}
\subsubsection[{wave\+\_\+\+Ang}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+core.\+pynebcore.\+Atom.\+wave\+\_\+\+Ang}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}


Definition at line \hyperlink{pynebcore_8py_source_l01198}{1198} of file \hyperlink{pynebcore_8py_source}{pynebcore.\+py}.



Referenced by \hyperlink{pynebcore_8py_source_l01367}{pyneb.\+core.\+pynebcore.\+Atom.\+\_\+\+Transition()}, \hyperlink{pynebcore_8py_source_l02696}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+\_\+\+Transition()}, \hyperlink{pynebcore_8py_source_l02623}{pyneb.\+core.\+pynebcore.\+Rec\+Atom.\+get\+Wave()}, \hyperlink{pynebcore_8py_source_l02372}{pyneb.\+core.\+pynebcore.\+Atom.\+plot\+Grotrian()}, and \hyperlink{pynebcore_8py_source_l02167}{pyneb.\+core.\+pynebcore.\+Atom.\+print\+Ionic()}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
pyneb/core/\hyperlink{pynebcore_8py}{pynebcore.\+py}\end{DoxyCompactItemize}
