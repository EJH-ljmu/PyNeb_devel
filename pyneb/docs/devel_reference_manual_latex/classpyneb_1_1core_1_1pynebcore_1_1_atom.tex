\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom}{\section{pyneb.\-core.\-pynebcore.\-Atom Class Reference}
\label{classpyneb_1_1core_1_1pynebcore_1_1_atom}\index{pyneb.\-core.\-pynebcore.\-Atom@{pyneb.\-core.\-pynebcore.\-Atom}}
}


Inherits object.

\subsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{\-\_\-\-\_\-init\-\_\-\-\_\-}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{get\-Omega}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{get\-Coll\-Rates}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{get\-Transition}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a32f644fb6c648326e3422984b614b63c}{print\-Transition}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a09c7f821dd9cf7ab09477fc80906e769}{print\-Sources}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a494480eb44909d9a13ed1fb2e808b4a2}{get\-Sources}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{get\-A}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{get\-Populations}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{get\-Low\-Dens\-Ratio}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{get\-High\-Dens\-Ratio}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}{get\-Density\-Range}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{get\-Crit\-Density}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{get\-Emissivity}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{get\-Tem\-Den}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{get\-Ion\-Abundance}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{print\-Ionic}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}{print\-Tem\-Den}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}{plot\-Emiss}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{plot\-Grotrian}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae99ada552ec3065d60877f8c3aa6c6f2}{\-\_\-\-\_\-repr\-\_\-\-\_\-}
\end{DoxyCompactItemize}
\subsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{log\-\_\-}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{name}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{N\-Levels}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atom\-File\-Type}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{Atom\-Data}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atom\-File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{atom\-Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{atom\-Fits\-File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{atom\-Fits\-Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\-\_\-\-Ang}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{get\-Stat\-Weight}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{get\-Energy}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atom\-N\-Levels}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{coll\-File\-Type}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{Coll\-Data}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{Coll\-Header}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{get\-Omega\-Array}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{get\-Tem\-Array}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{coll\-File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{coll\-Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{coll\-Fits\-File}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{coll\-Fits\-Path}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{coll\-N\-Levels}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{tem\-\_\-units}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{Atom\-Header}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{N\-I\-S\-T}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{line\-List}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{energy\-\_\-\-Ryd}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{energy\-\_\-e\-V}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{Energy\-N\-Levels}
\end{DoxyCompactItemize}
\subsection*{Private Member Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\-\_\-\-Transition}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\-\_\-test\-\_\-lev}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\-\_\-get\-Tem\-Den\-\_\-1}
\item 
def \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{\-\_\-get\-Tem\-Den\-\_\-\-M\-P}
\end{DoxyCompactItemize}
\subsection*{Private Attributes}
\begin{DoxyCompactItemize}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\-\_\-\-A}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\-\_\-\-Energy}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\-\_\-\-Stat\-Weight}
\item 
\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\-\_\-crit\-Density}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Define the atom object, fill it with data, explore the data, and 
compute quantities such as level populations and line emissivities.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01187}{1187} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



\subsection{Constructor \& Destructor Documentation}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-\-\_\-init\-\_\-\-\_\-@{\-\_\-\-\_\-init\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-init\-\_\-\-\_\-@{\-\_\-\-\_\-init\-\_\-\-\_\-}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-\-\_\-init\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-\_\-init\-\_\-\-\_\- (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{elem = {\ttfamily None}, }
\item[{}]{spec = {\ttfamily None}, }
\item[{}]{atom = {\ttfamily None}, }
\item[{}]{Omega\-Interp = {\ttfamily 'Linear'}, }
\item[{}]{no\-Extrapol = {\ttfamily False}, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}
\begin{DoxyVerb}Atom constructor

Parameters:
    - elem          symbol of the selected element
    - spec          ionization stage in spectroscopic notation (I = 1, II = 2, etc.)
    - atom          ion (e.g. 'O3').
    - OmegaInterp   one of ('Cheb', 'Linear'). Default is Linear. "Cheb" works only for fits files. 
    - noExtrapol    if set to False (default), Omega will be extrapolated above and below
            the highest and lowest temperatures where it is defined. If set to True
            a NaN will be return.
    
Usage:
    O3 = pn.Atom('O',3)
    N2 = pn.Atom(atom='N2')
    S2 = pn.Atom(atom='S2', OmegaInterp='Linear')
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01198}{1198} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01198}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{01198} 
01199     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad92916e464a9e193eb3e49b84f253a35}{\_\_init\_\_}(self, elem=None, spec=None, atom=None, OmegaInterp='Linear', noExtrapol = False, 
      NLevels=None):
01200         \textcolor{stringliteral}{"""}
01201 \textcolor{stringliteral}{        Atom constructor}
01202 \textcolor{stringliteral}{        }
01203 \textcolor{stringliteral}{        Parameters:}
01204 \textcolor{stringliteral}{            - elem          symbol of the selected element}
01205 \textcolor{stringliteral}{            - spec          ionization stage in spectroscopic notation (I = 1, II = 2, etc.)}
01206 \textcolor{stringliteral}{            - atom          ion (e.g. 'O3').}
01207 \textcolor{stringliteral}{            - OmegaInterp   one of ('Cheb', 'Linear'). Default is Linear. "Cheb" works only for fits files.
       }
01208 \textcolor{stringliteral}{            - noExtrapol    if set to False (default), Omega will be extrapolated above and below}
01209 \textcolor{stringliteral}{                            the highest and lowest temperatures where it is defined. If set to True}
01210 \textcolor{stringliteral}{                            a NaN will be return.}
01211 \textcolor{stringliteral}{            }
01212 \textcolor{stringliteral}{        Usage:}
01213 \textcolor{stringliteral}{            O3 = pn.Atom('O',3)}
01214 \textcolor{stringliteral}{            N2 = pn.Atom(atom='N2')}
01215 \textcolor{stringliteral}{            S2 = pn.Atom(atom='S2', OmegaInterp='Linear')}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01216}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{01216} \textcolor{stringliteral}{        """}        
01217         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{log\_} = log\_
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01218}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{01218}         \textcolor{keywordflow}{if} atom \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01219}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{01219}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom} = str.capitalize(atom)
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01220}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{01220}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} = \hyperlink{namespacepyneb_1_1utils_1_1misc_a2bb6f906a75f26a882093e9ce9272507}{parseAtom}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})[0]
01221             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec} = int(\hyperlink{namespacepyneb_1_1utils_1_1misc_a2bb6f906a75f26a882093e9ce9272507}{parseAtom}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})[1])
01222         \textcolor{keywordflow}{else}:
01223             \textcolor{keywordflow}{if} elem[0].isalpha():
01224                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} = str.capitalize(elem)
01225             \textcolor{keywordflow}{else}:
01226                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} = elem
01227             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec} = int(spec)
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01228}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{01228}             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} + str(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01229}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{01229}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{name} = sym2name[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}]
01230         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} = \textcolor{stringliteral}{'Atom '} + self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01231}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{01231}         self.log\_.message(\textcolor{stringliteral}{'Making atom object for \{0\} \{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}), calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01232         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels} = NLevels
01233         dataFile = atomicData.getDataFile(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, data\_type=\textcolor{stringliteral}{'atom'})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01234}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{01234}         \textcolor{keywordflow}{if} dataFile \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01235             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} = \textcolor{keywordtype}{None}
01236         \textcolor{keywordflow}{else}:
01237             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} = dataFile.split(\textcolor{stringliteral}{'.'})[-1]
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01238}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{01238}         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} == \textcolor{stringliteral}{'fits'}:
01239             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___atom_data_fits}{\_AtomDataFits}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, NLevels=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01240         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} == \textcolor{stringliteral}{'dat'}:
01241             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___atom_data_ascii}{\_AtomDataAscii}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, NLevels=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01242         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} == \textcolor{stringliteral}{'chianti'}:
01243             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \_AtomChianti(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, NLevels=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01244         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} == \textcolor{stringliteral}{'stout'}:
01245             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___atom_data_stout}{\_AtomDataStout}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, NLevels=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01246         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{atomFileType} \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01247             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___atom_data_none}{\_AtomDataNone}()
01248         \textcolor{keywordflow}{else}:
01249             log\_.error(\textcolor{stringliteral}{'Atom file extensions must be fits, dat or chianti'})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01250}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{01250}                     
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01251}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{01251}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atomFile} = self.AtomData.atomFile
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01252}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{01252}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{atomPath} = self.AtomData.atomPath
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01253}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{01253}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{atomFitsFile} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atomFile} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01254}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{01254}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{atomFitsPath} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{atomPath} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01255}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{01255}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang} = self.AtomData.wave\_Ang
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01256}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{01256}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight} = self.AtomData.getStatWeight
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01257}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{01257}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy} = self.AtomData.getEnergy
01258         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atomNLevels} = self.AtomData.NLevels
01259 
01260 
01261         dataFile = atomicData.getDataFile(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, data\_type=\textcolor{stringliteral}{'coll'})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01262}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{01262}         \textcolor{keywordflow}{if} dataFile \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01263             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} = \textcolor{keywordtype}{None}
01264         \textcolor{keywordflow}{else}:
01265             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} = dataFile.split(\textcolor{stringliteral}{'.'})[-1]
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01266}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{01266}         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} == \textcolor{stringliteral}{'fits'}:
01267             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___coll_data_fits}{\_CollDataFits}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, 
01268                                          OmegaInterp=OmegaInterp, noExtrapol = noExtrapol, NLevels=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01269         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} == \textcolor{stringliteral}{'dat'}:
01270             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___coll_data_ascii}{\_CollDataAscii}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, 
01271                                           OmegaInterp=\textcolor{stringliteral}{'Linear'}, noExtrapol = noExtrapol, NLevels=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01272         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} == \textcolor{stringliteral}{'chianti'}:
01273             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \_CollChianti(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, NLevels=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01274         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} == \textcolor{stringliteral}{'stout'}:
01275             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___coll_data_stout}{\_CollDataStout}(elem=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, spec=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, atom=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, NLevels=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})            
01276         \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{collFileType} \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01277             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData} = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1___coll_data_none}{\_CollDataNone}()
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01278}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{01278}         \textcolor{keywordflow}{try}:
01279             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{CollHeader} = self.CollData.CollHeader
01280         \textcolor{keywordflow}{except}:
01281             \textcolor{keywordflow}{pass}
01282         \textcolor{keywordflow}{if} \textcolor{stringliteral}{"comments"} \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.CollData.\_\_dict\_\_.keys():
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01283}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{01283}             self.CollData.comments = []
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01284}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{01284}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{getOmegaArray} = self.CollData.getOmegaArray
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01285}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{01285}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{getTemArray} = self.CollData.getTemArray
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01286}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{01286}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{collFile} = self.CollData.collFile
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01287}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{01287}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{collPath} = self.CollData.collPath
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01288}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{01288}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{collFitsFile} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{collFile} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01289}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{01289}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{collFitsPath} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{collPath} \textcolor{comment}{# Obsolete}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01290}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{01290}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels} = self.CollData.NLevels
01291         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{tem\_units} = self.CollData.tem\_units
01292 
01293         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels} = np.min((self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{atomNLevels}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}))
01294             
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01295}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{01295}         \textcolor{keywordflow}{try}:
01296             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs} = self.AtomData.gs
01297         \textcolor{keywordflow}{except}:
01298             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs} = \hyperlink{namespacepyneb_1_1utils_1_1physics_ad8bb8a1415a2efcc6512044ac8e883f8}{gsFromAtom}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01299}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{01299}         \textcolor{keywordflow}{try}:
01300             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{AtomHeader} = self.AtomData.AtomHeader
01301         \textcolor{keywordflow}{except}:
01302             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{AtomHeader} = \textcolor{keywordtype}{None}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01303}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{01303}         \textcolor{keywordflow}{try}:
01304             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} = self.AtomData.NIST
01305         \textcolor{keywordflow}{except}:
01306             \textcolor{keywordflow}{try}:
01307                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} = \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{getLevelsNIST}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels})
01308             \textcolor{keywordflow}{except}:
01309                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} = \textcolor{keywordtype}{None}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01310}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{01310}         
01311         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList} = []
01312         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}):
01313             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} np.arange(i):
01314                 self.lineList.append(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i][j])
01315         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList} = np.array(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList})
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01316}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{01316}         
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01317}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{01317}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{energy\_Ryd} = \hyperlink{namespacepyneb_1_1utils_1_1misc_a852d66d22ba9e872484b3346dc28249e}{quiet\_divide}(CST.RYD\_ANG, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang})
01318         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{energy\_eV} = CST.RYD\_EV * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{energy\_Ryd}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01319}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{01319}         
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01320}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{01320}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}() \textcolor{comment}{# index = quantum number - 1}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01321}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{01321}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}() \textcolor{comment}{# Angstrom^-1}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01322}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{01322}         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\_StatWeight} = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}()
01323         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{EnergyNLevels} = len(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy})
        
\end{DoxyCode}


\subsection{Member Function Documentation}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae99ada552ec3065d60877f8c3aa6c6f2}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-\-\_\-repr\-\_\-\-\_\-@{\-\_\-\-\_\-repr\-\_\-\-\_\-}}
\index{\-\_\-\-\_\-repr\-\_\-\-\_\-@{\-\_\-\-\_\-repr\-\_\-\-\_\-}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-\-\_\-repr\-\_\-\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-\_\-repr\-\_\-\-\_\- (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae99ada552ec3065d60877f8c3aa6c6f2}


Definition at line \hyperlink{pynebcore_8py_source_l02615}{2615} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00060}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-atom\-File}, \hyperlink{pynebcore_8py_source_l00112}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-atom\-File}, \hyperlink{pynebcore_8py_source_l00325}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-atom\-File}, \hyperlink{pynebcore_8py_source_l01250}{pyneb.\-core.\-pynebcore.\-Atom.\-atom\-File}, \hyperlink{pynebcore_8py_source_l00076}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-coll\-File}, \hyperlink{pynebcore_8py_source_l00615}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-coll\-File}, \hyperlink{pynebcore_8py_source_l00967}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-coll\-File}, \hyperlink{pynebcore_8py_source_l01182}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-coll\-File}, \hyperlink{pynebcore_8py_source_l01285}{pyneb.\-core.\-pynebcore.\-Atom.\-coll\-File}, \hyperlink{emis_grid_8py_source_l00048}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-elem}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l00577}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00927}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l01163}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-elem}, \hyperlink{pynebcore_8py_source_l01219}{pyneb.\-core.\-pynebcore.\-Atom.\-elem}, \hyperlink{emis_grid_8py_source_l00049}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-spec}, \hyperlink{pynebcore_8py_source_l00091}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00312}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l00578}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00928}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-spec}, and \hyperlink{pynebcore_8py_source_l01220}{pyneb.\-core.\-pynebcore.\-Atom.\-spec}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02615}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae99ada552ec3065d60877f8c3aa6c6f2}{02615} 
02616     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae99ada552ec3065d60877f8c3aa6c6f2}{\_\_repr\_\_}(self):
02617         \textcolor{keywordflow}{return} \textcolor{stringliteral}{'Atom \{0\}\{1\} from \{2\} and \{3\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{atomFile}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{collFile})
02618 

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-get\-Tem\-Den\-\_\-1@{\-\_\-get\-Tem\-Den\-\_\-1}}
\index{\-\_\-get\-Tem\-Den\-\_\-1@{\-\_\-get\-Tem\-Den\-\_\-1}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-get\-Tem\-Den\-\_\-1}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1 (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\-\_\-ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i2 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\-Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily 'nsect\-\_\-recur'}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{end\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}, }
\item[{}]{n\-Cut = {\ttfamily 30}, }
\item[{}]{max\-Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}
\begin{DoxyRefDesc}{Todo}
\item[\hyperlink{todo__todo000002}{Todo}]manage blends \end{DoxyRefDesc}


Definition at line \hyperlink{pynebcore_8py_source_l01869}{1869} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00100}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l00415}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l01319}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l00101}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l00413}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l01320}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l02046}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P()}, \hyperlink{pynebcore_8py_source_l00178}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00447}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00677}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01045}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01525}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{_fortran_format_8py_source_l00318}{pyneb.\-utils.\-Fortran\-Format.\-f}, \hyperlink{pynebcore_8py_source_l01562}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations()}, \hyperlink{pynebcore_8py_source_l00075}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-get\-Tem\-Array}, \hyperlink{pynebcore_8py_source_l01284}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Array}, \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}, and \hyperlink{misc_8py_source_l00302}{pyneb.\-utils.\-misc.\-quiet\-\_\-divide()}.



Referenced by \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l02046}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, and \hyperlink{pynebcore_8py_source_l02126}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01869}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{01869} 
01870                   to\_eval=\textcolor{keywordtype}{None}, nCut=30, maxIter=20):
01871 
01872         \textcolor{comment}{##}
01873         \textcolor{comment}{# @todo manage blends}
01874         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_i1)
01875         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_j1)
01876         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_i2)
01877         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_j2)
01878         tem = np.asarray(tem)
01879         den = np.asarray(den)
01880         \textcolor{keywordflow}{if} np.asarray(int\_ratio).size != 1:
01881             shape = np.asarray(int\_ratio).shape
01882             size = np.asarray(int\_ratio).size
01883             result = np.zeros(size) 
01884             \textcolor{keywordflow}{if} np.asarray(tem).size != 1:
01885                 \textcolor{keywordflow}{if} np.asarray(tem).shape != shape:
01886                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01887                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01888                 tem\_ravel = np.asarray(tem).ravel()
01889                 den\_ravel = np.zeros(size) + den
01890             \textcolor{keywordflow}{elif} np.asarray(den).size != 1:
01891                 \textcolor{keywordflow}{if} np.asarray(den).shape != shape:
01892                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01893                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01894                 den\_ravel = np.asarray(den).ravel()
01895                 tem\_ravel = np.zeros(size) + tem
01896             \textcolor{keywordflow}{else}:
01897                 den\_ravel = np.zeros(size) + den
01898                 tem\_ravel = np.zeros(size) + tem
01899             int\_ratio\_ravel = np.asarray(int\_ratio).ravel()
01900             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(size):
01901                 result[i] = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\_getTemDen\_1}(int\_ratio\_ravel[i], tem=tem\_ravel[i], den=
      den\_ravel[i],
01902                                            lev\_i1=lev\_i1, lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
01903                                            wave1=wave1, wave2=wave2, maxError=maxError, method=method,
01904                                            log=log, start\_x=start\_x, end\_x=end\_x,
01905                                            to\_eval=to\_eval)
01906             \textcolor{keywordflow}{return} result.reshape(shape)
01907             
01908         \textcolor{keywordflow}{if} wave1 != -1:
01909             lev\_i1, lev\_j1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave1)
01910         \textcolor{keywordflow}{if} wave2 != -1:
01911             lev\_i2, lev\_j2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave2)
01912 
01913         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01914             to\_eval = \textcolor{stringliteral}{'I('} + str(lev\_i1) + \textcolor{stringliteral}{','} + str(lev\_j1) + \textcolor{stringliteral}{')/I('} + str(lev\_i2) + \textcolor{stringliteral}{','} + str(lev\_j2) + \textcolor{stringliteral}{'
      )'}
01915 
01916 
01917         \textcolor{keywordflow}{if} tem == -1:
01918             \textcolor{keywordflow}{if} start\_x == -1:
01919                 start\_x = min(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{getTemArray}(keep\_unit=\textcolor{keyword}{False}))
01920                 \textcolor{keywordflow}{if} log:
01921                     start\_x = np.log10(start\_x)
01922             \textcolor{keywordflow}{if} end\_x == -1:
01923                 end\_x = max(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{getTemArray}(keep\_unit=\textcolor{keyword}{False}))
01924                 \textcolor{keywordflow}{if} log:
01925                     end\_x = np.log10(end\_x)
01926             
01927             @profile
01928             \textcolor{keyword}{def }\_func(x):
01929                 \textcolor{stringliteral}{"""}
01930 \textcolor{stringliteral}{                The function for which a root is looked for.}
01931 \textcolor{stringliteral}{                It must return an array if x is an array, if an nsect-like method is used.}
01932 \textcolor{stringliteral}{                The returned value is already normalized to the intensity ratio.}
01933 \textcolor{stringliteral}{}
01934 \textcolor{stringliteral}{                """}
01935                 \textcolor{keywordflow}{if} log:
01936                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(10.**x, den)
01937                 \textcolor{keywordflow}{else}:
01938                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(x, den)
01939                 I = \textcolor{keyword}{lambda} lev\_i, lev\_j: (populations[lev\_i - 1] * 
01940                                           (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[lev\_i - 1, lev\_j - 1] * 
01941                                            (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_i - 1] - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_j - 1])))
01942                 L = \textcolor{keyword}{lambda} wave: (populations[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] * 
01943                                   (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1] * 
01944                                    (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] - 
01945                                     self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1])))
01946                 result = eval(to\_eval)
01947                 \textcolor{keywordflow}{return} \hyperlink{namespacepyneb_1_1utils_1_1misc_a852d66d22ba9e872484b3346dc28249e}{quiet\_divide}((result - int\_ratio), int\_ratio)
01948             
01949         \textcolor{keywordflow}{elif} den == -1:
01950             \textcolor{keywordflow}{if} start\_x == -1:
01951                 start\_x = 1.e0
01952                 \textcolor{keywordflow}{if} log: start\_x = np.log10(start\_x)
01953             \textcolor{keywordflow}{if} end\_x == -1:
01954                 end\_x = 1e8
01955                 \textcolor{keywordflow}{if} log: end\_x = np.log10(end\_x)
01956 
01957             @profile
01958             \textcolor{keyword}{def }\_func(x):
01959                 \textcolor{stringliteral}{"""}
01960 \textcolor{stringliteral}{                The function for which a root is looked for.}
01961 \textcolor{stringliteral}{                It must return an array if x is an array, if an nsect-like method is used.}
01962 \textcolor{stringliteral}{                The returned value is already normalized to the intensity ratio.}
01963 \textcolor{stringliteral}{                }
01964 \textcolor{stringliteral}{                """}
01965                 \textcolor{keywordflow}{if} log:
01966                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, pow(10., x))
01967                 \textcolor{keywordflow}{else}:
01968                     populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, x)
01969                 I = \textcolor{keyword}{lambda} lev\_i, lev\_j: (populations[lev\_i - 1] * 
01970                                           (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[lev\_i - 1, lev\_j - 1] * 
01971                                            (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_i - 1] - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[lev\_j - 1])))
01972                 L = \textcolor{keyword}{lambda} wave: (populations[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] * 
01973                                   (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1] * 
01974                                    (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0] - 1] - 
01975                                     self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1] - 1])))
01976                 result = eval(to\_eval)
01977                 \textcolor{keywordflow}{return} \hyperlink{namespacepyneb_1_1utils_1_1misc_a852d66d22ba9e872484b3346dc28249e}{quiet\_divide}((result - int\_ratio), int\_ratio)
01978         \textcolor{comment}{# improve exception handling (we must include cases where both tem, den = -1) }
01979         \textcolor{keywordflow}{else}:
01980             self.log\_.error(\textcolor{stringliteral}{'ERROR in getTemDen: temperature and density cannot be simultaneously given'},
01981                             calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01982 
01983         \textcolor{keywordflow}{if} method == \textcolor{stringliteral}{'nsect\_recur'}:
01984             \textcolor{stringliteral}{"""}
01985 \textcolor{stringliteral}{            Recursive n-section method for finding a root}
01986 \textcolor{stringliteral}{            It works by looking for the minumum of abs(f) using the fact that f(array) }
01987 \textcolor{stringliteral}{                returns an array}
01988 \textcolor{stringliteral}{}
01989 \textcolor{stringliteral}{            """}
01990             @profile
01991             \textcolor{keyword}{def }nsect\_recur(f, x1, x2, nCut, maxIter, \_iter=0):
01992                 \textcolor{keywordflow}{if} \_iter > maxIter:
01993                     \textcolor{keywordflow}{return} np.nan
01994                 x = np.linspace(x1, x2, nCut)
01995                 y = abs(\hyperlink{namespacepyneb_1_1utils_1_1_fortran_format_af94352584eced016c14d524330879115}{f}(x))
01996                 x\_min = np.argmin(y)
01997                 \textcolor{keywordflow}{if} y[x\_min] < maxError:
01998                     \textcolor{keywordflow}{return} x[x\_min]
01999                 \textcolor{keywordflow}{else}:
02000                     \textcolor{keywordflow}{if} x\_min == 0:
02001                         x\_min = 1
02002                     \textcolor{keywordflow}{if} x\_min == nCut - 1:
02003                         x\_min = nCut - 2
02004                     x1 = x[x\_min - 1]
02005                     x2 = x[x\_min + 1]
02006                     \_iter = \_iter + 1
02007                     \textcolor{keywordflow}{return} nsect\_recur(f, x1, x2, nCut=nCut, maxIter=maxIter, \_iter=\_iter)
02008 
02009             result = nsect\_recur(\_func, start\_x, end\_x, nCut, maxIter)
02010 
02011         \textcolor{keywordflow}{elif} method == \textcolor{stringliteral}{'nsect\_iter'}:
02012             \textcolor{stringliteral}{"""}
02013 \textcolor{stringliteral}{            Iterative n-section method for finding a root (analogous to the bisection method)}
02014 \textcolor{stringliteral}{            It works by looking for the minimum of abs(f) using the fact that f(array) returns an array}
02015 \textcolor{stringliteral}{}
02016 \textcolor{stringliteral}{            """}
02017             
02018             @profile
02019             \textcolor{keyword}{def }nsect\_iter(f, x1, x2, nCut, maxIter):
02020                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(maxIter):
02021                     x = np.linspace(x1, x2, nCut)
02022                     y = abs(\hyperlink{namespacepyneb_1_1utils_1_1_fortran_format_af94352584eced016c14d524330879115}{f}(x))
02023                     x\_min = np.argmin(y)
02024                     \textcolor{keywordflow}{if} y[x\_min] < maxError:
02025                         \textcolor{keywordflow}{return} x[x\_min]
02026                     \textcolor{keywordflow}{else}:
02027                         \textcolor{keywordflow}{if} x\_min == 0: x\_min = 1
02028                         \textcolor{keywordflow}{if} x\_min == nCut - 1: x\_min = nCut - 2
02029                         x1 = x[x\_min - 1]
02030                         x2 = x[x\_min + 1]
02031                 \textcolor{keywordflow}{return} np.nan
02032 
02033             result = nsect\_iter(\_func, start\_x, end\_x, nCut, maxIter)
02034             
02035         \textcolor{keywordflow}{else}:
02036             self.log\_.error(\textcolor{stringliteral}{'ERROR in getTemDen: no valid method given'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02037             result = \textcolor{keywordtype}{None}
02038 
02039         \textcolor{keywordflow}{if} (log \textcolor{keywordflow}{is} \textcolor{keyword}{True}) \textcolor{keywordflow}{and} (result \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}):
02040             \textcolor{keywordflow}{return} pow(10., result)
02041         \textcolor{keywordflow}{else}:
02042             \textcolor{keywordflow}{return} result
02043 

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-get\-Tem\-Den\-\_\-\-M\-P@{\-\_\-get\-Tem\-Den\-\_\-\-M\-P}}
\index{\-\_\-get\-Tem\-Den\-\_\-\-M\-P@{\-\_\-get\-Tem\-Den\-\_\-\-M\-P}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-get\-Tem\-Den\-\_\-\-M\-P}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\-\_\-ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i2 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\-Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily 'nsect\-\_\-recur'}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{end\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}, }
\item[{}]{n\-Cut = {\ttfamily 30}, }
\item[{}]{max\-Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}


Definition at line \hyperlink{pynebcore_8py_source_l02046}{2046} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l00178}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00447}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00677}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01045}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01525}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{emis_grid_8py_source_l00051}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-atom}, \hyperlink{pynebcore_8py_source_l00089}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00310}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l00576}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00926}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l01162}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-atom}, \hyperlink{pynebcore_8py_source_l01218}{pyneb.\-core.\-pynebcore.\-Atom.\-atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, and \hyperlink{pynebcore_8py_source_l02126}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Den()}.



Referenced by \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, and \hyperlink{pynebcore_8py_source_l02126}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02046}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{02046} 
02047                   to\_eval=\textcolor{keywordtype}{None}, nCut=30, maxIter=20):
02048         
02049         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} config.INSTALLED[\textcolor{stringliteral}{'mp'}]:
02050             log\_.error(\textcolor{stringliteral}{'\_getTemDen\_MP cannot be used in absence of multiprocessing package'},
02051                           calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02052             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02053         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_i1)
02054         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_j1)
02055         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_i2)
02056         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_j2)
02057         tem = np.asarray(tem)
02058         den = np.asarray(den)
02059         \textcolor{keywordflow}{if} np.asarray(int\_ratio).size != 1:
02060             shape = np.asarray(int\_ratio).shape
02061             size = np.asarray(int\_ratio).size
02062             result = np.zeros(size) 
02063             \textcolor{keywordflow}{if} np.asarray(tem).size != 1:
02064                 \textcolor{keywordflow}{if} np.asarray(tem).shape != shape:
02065                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02066                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02067                 tem\_ravel = np.asarray(tem).ravel()
02068                 den\_ravel = np.zeros(size) + den
02069             \textcolor{keywordflow}{elif} np.asarray(den).size != 1:
02070                 \textcolor{keywordflow}{if} np.asarray(den).shape != shape:
02071                     self.log\_.error(\textcolor{stringliteral}{'getTemDen: int\_ratio and tem/den must have the same size'}, calling=
      self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02072                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02073                 den\_ravel = np.asarray(den).ravel()
02074                 tem\_ravel = np.zeros(size) + tem
02075             \textcolor{keywordflow}{else}:
02076                 den\_ravel = np.zeros(size) + den
02077                 tem\_ravel = np.zeros(size) + tem
02078             int\_ratio\_ravel = np.asarray(int\_ratio).ravel()
02079         \textcolor{keywordflow}{else}:
02080             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\_getTemDen\_1}(int\_ratio=int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, 
      lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
02081                   wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, start\_x=start\_x,
02082                   end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)
02083         
02084         Nprocs = config.Nprocs
02085         log\_.message(\textcolor{stringliteral}{'number of CPUs = \{0\}'}.format(Nprocs), calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02086         gTDWorkerQ = Queue()
02087         gTDDoneQ = Queue()
02088         log\_.message(\textcolor{stringliteral}{'Queues initialized'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02089         jobid = 0
02090         \textcolor{keywordflow}{for} int\_rat1, tem1, den1 \textcolor{keywordflow}{in} zip(int\_ratio\_ravel, tem\_ravel, den\_ravel):
02091             gTDWorkerQ.put((jobid, int\_rat1, tem1, den1))
02092             jobid += 1
02093         log\_.message(\textcolor{stringliteral}{'put done'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02094         \textcolor{comment}{#gTDWorkerQSize = gTDWorkerQ.qsize() # this crash on OSX}
02095         gTDWorkerQSize = size
02096         log\_.message(\textcolor{stringliteral}{'Queue size \{0\}'}.format(gTDWorkerQSize), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02097 
02098         
02099         gTDProcesses = []
02100         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(Nprocs):
02101             p = Process(target=getTemDen\_helper, args=(gTDWorkerQ, gTDDoneQ, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, lev\_i1, lev\_j1, lev\_i2, lev\_j2,
02102                   wave1, wave2, maxError, method, log, start\_x, end\_x, to\_eval, nCut, maxIter))
02103             p.start()
02104             gTDProcesses.append(p)
02105         log\_.message(\textcolor{stringliteral}{'processes started'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02106 
02107         \textcolor{comment}{#}
02108         result = []
02109         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(gTDWorkerQSize):
02110             result.append(gTDDoneQ.get())
02111         log\_.message(\textcolor{stringliteral}{'Result obtained'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02112 
02113         \textcolor{keywordflow}{for} p \textcolor{keywordflow}{in} gTDProcesses:
02114             p.join(timeout=0.1)
02115         log\_.message(\textcolor{stringliteral}{'Joined'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.getTemDenMP'})
02116 
02117         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(Nprocs):
02118             gTDWorkerQ.put(\textcolor{stringliteral}{'STOP'})
02119         result.sort()
02120         to\_return = np.array(result)[:, 1]
02121         \textcolor{keywordflow}{return} to\_return.reshape(int\_ratio.shape)
02122 
    
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-test\-\_\-lev@{\-\_\-test\-\_\-lev}}
\index{\-\_\-test\-\_\-lev@{\-\_\-test\-\_\-lev}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-test\-\_\-lev}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{level}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}
\begin{DoxyVerb}Test whether selected level is legal

Parameters:
    - level        selected atom level\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01525}{1525} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{pynebcore_8py_source_l00069}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00098}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00319}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00586}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00933}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-N\-Levels}, and \hyperlink{pynebcore_8py_source_l01231}{pyneb.\-core.\-pynebcore.\-Atom.\-N\-Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l02046}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P()}, \hyperlink{pn__chianti_8py_source_l00316}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-get\-A()}, \hyperlink{pynebcore_8py_source_l01759}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Crit\-Density()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pn__chianti_8py_source_l00366}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-get\-Energy()}, \hyperlink{pynebcore_8py_source_l02927}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Energy()}, \hyperlink{pynebcore_8py_source_l02176}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Ion\-Abundance()}, \hyperlink{pn__chianti_8py_source_l00507}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega()}, \hyperlink{pn__chianti_8py_source_l00484}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega\-Array()}, \hyperlink{pn__chianti_8py_source_l00343}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-get\-Stat\-Weight()}, and \hyperlink{pynebcore_8py_source_l02699}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Wave()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01525}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{01525} 
01526     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(self, level):
01527         \textcolor{stringliteral}{"""}
01528 \textcolor{stringliteral}{        Test whether selected level is legal}
01529 \textcolor{stringliteral}{}
01530 \textcolor{stringliteral}{        Parameters:}
01531 \textcolor{stringliteral}{            - level        selected atom level}
01532 \textcolor{stringliteral}{}
01533 \textcolor{stringliteral}{        """}       
01534         \textcolor{keywordflow}{if} level < -1 \textcolor{keywordflow}{or} level == 0 \textcolor{keywordflow}{or} level > self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}:
01535             self.log\_.error(\textcolor{stringliteral}{'Wrong value for level: \{0\}, maximum = \{1\}'}.format(level, self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}),
01536                             calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-\-Transition@{\-\_\-\-Transition}}
\index{\-\_\-\-Transition@{\-\_\-\-Transition}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-\-Transition}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Transition (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{wave, }
\item[{}]{max\-Error\-A = {\ttfamily 5.e-\/3}, }
\item[{}]{max\-Errorm = {\ttfamily 5.e-\/2}}
\end{DoxyParamCaption}
)\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}
\begin{DoxyVerb}Return an array with computed upper level, computed lower level, computed wavelength, 
    input wavelength

Parameters:
    - wave       wavelength either in Angstrom (a float or a label: e.g., 5007, '5007A') 
            or in micron (a label: '51.5m')
    - maxErrorA: tolerance if the input wavelength is in Angstrom
    - maxErrorm: tolerance if the input wavelength is in micron\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01433}{1433} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{emis_grid_8py_source_l00051}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-atom}, \hyperlink{pynebcore_8py_source_l00089}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00310}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l00576}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00926}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l01162}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-atom}, \hyperlink{pynebcore_8py_source_l01218}{pyneb.\-core.\-pynebcore.\-Atom.\-atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{pynebcore_8py_source_l00064}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-wave\-\_\-\-Ang}, \hyperlink{pynebcore_8py_source_l00172}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-wave\-\_\-\-Ang}, \hyperlink{pynebcore_8py_source_l00438}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-wave\-\_\-\-Ang}, and \hyperlink{pynebcore_8py_source_l01254}{pyneb.\-core.\-pynebcore.\-Atom.\-wave\-\_\-\-Ang}.



Referenced by \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}, \hyperlink{pynebcore_8py_source_l02872}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Transition()}, \hyperlink{pynebcore_8py_source_l01491}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Transition()}, and \hyperlink{pynebcore_8py_source_l02891}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-print\-Transition()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01433}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{01433} 
01434     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\_Transition}(self, wave, maxErrorA = 5.e-3, maxErrorm = 5.e-2):
01435         \textcolor{stringliteral}{"""}
01436 \textcolor{stringliteral}{        Return an array with computed upper level, computed lower level, computed wavelength, }
01437 \textcolor{stringliteral}{            input wavelength}
01438 \textcolor{stringliteral}{        }
01439 \textcolor{stringliteral}{        Parameters:}
01440 \textcolor{stringliteral}{            - wave       wavelength either in Angstrom (a float or a label: e.g., 5007, '5007A') }
01441 \textcolor{stringliteral}{                            or in micron (a label: '51.5m')}
01442 \textcolor{stringliteral}{            - maxErrorA: tolerance if the input wavelength is in Angstrom}
01443 \textcolor{stringliteral}{            - maxErrorm: tolerance if the input wavelength is in micron}
01444 \textcolor{stringliteral}{                            }
01445 \textcolor{stringliteral}{        """}
01446         \textcolor{keywordflow}{if} str(wave)[-1] == \textcolor{stringliteral}{'A'}:
01447             inputWave = float(wave[:-1])
01448             label = \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave)
01449             maxError = maxErrorA
01450         \textcolor{keywordflow}{elif} str(wave)[-1] == \textcolor{stringliteral}{'m'}:
01451             inputWave = float(wave[:-1]) * 1e4
01452             label = \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave)
01453             maxError = maxErrorm
01454         \textcolor{keywordflow}{else}:
01455             inputWave = wave
01456             label = \textcolor{stringliteral}{'\{0\}\_\{1\}A'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, int(wave))
01457             maxError = maxErrorA
01458             
01459         \textcolor{keywordflow}{if} label \textcolor{keywordflow}{in} label2levelDict:
01460             result = [label2levelDict[label][0], label2levelDict[label][1], inputWave, inputWave]
01461             return(result)
01462         
01463         j, i = np.unravel\_index(np.argmin(abs(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang} - inputWave)), self.wave\_Ang.shape)
01464         bestWave = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j]
01465         error = np.abs(bestWave - inputWave) / inputWave
01466         result = [i + 1, j + 1, bestWave, inputWave]
01467         \textcolor{keywordflow}{if} error > maxError:
01468             self.log\_.warn(\textcolor{stringliteral}{'\_Transition: wavelengths differ by more than \{0:.2f\}%: input = \{1:.2f\}, output
       = \{2:.2f\}'}\(\backslash\)
01469                            .format(100 * maxError, inputWave, bestWave), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01470         return(result)
01471 

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-A@{get\-A}}
\index{get\-A@{get\-A}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-A}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-A (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\-\_\-i = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}
\begin{DoxyVerb}Return the transition probability data. 
If no arguments are given, the whole array of A is returned.
A specific A value can be obtained by giving either the upper and lower levels or 
    the wavelength of the transition (keyword wave).
    
Usage:
    A_O3 = O3.getA()          # The whole A array is stored in A_O3
    O3.getA(4, 2)      # A(4, 2) of the O3 atom is printed
    O3.getA(2, 4)      # Returns 0
    O3.getA(wave=4959)      

Parameters:
    - lev_i  upper level of transition (default= -1, returns complete array)
    - lev_j  lower level of transition (default= -1, returns complete array)
    - wave   wavelength of transition. Takes precedence on lev_i and lev_j. Ignored if not set.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01537}{1537} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01719}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-High\-Dens\-Ratio()}, and \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01537}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{01537} 
01538     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(self, lev\_i= -1, lev\_j= -1, wave= -1):
01539         \textcolor{stringliteral}{"""}
01540 \textcolor{stringliteral}{        Return the transition probability data. }
01541 \textcolor{stringliteral}{        If no arguments are given, the whole array of A is returned.}
01542 \textcolor{stringliteral}{        A specific A value can be obtained by giving either the upper and lower levels or }
01543 \textcolor{stringliteral}{            the wavelength of the transition (keyword wave).}
01544 \textcolor{stringliteral}{            }
01545 \textcolor{stringliteral}{        Usage:}
01546 \textcolor{stringliteral}{            A\_O3 = O3.getA()          # The whole A array is stored in A\_O3}
01547 \textcolor{stringliteral}{            O3.getA(4, 2)      # A(4, 2) of the O3 atom is printed}
01548 \textcolor{stringliteral}{            O3.getA(2, 4)      # Returns 0}
01549 \textcolor{stringliteral}{            O3.getA(wave=4959)      }
01550 \textcolor{stringliteral}{}
01551 \textcolor{stringliteral}{        Parameters:}
01552 \textcolor{stringliteral}{            - lev\_i  upper level of transition (default= -1, returns complete array)}
01553 \textcolor{stringliteral}{            - lev\_j  lower level of transition (default= -1, returns complete array)}
01554 \textcolor{stringliteral}{            - wave   wavelength of transition. Takes precedence on lev\_i and lev\_j. Ignored if not set.}
01555 \textcolor{stringliteral}{            }
01556 \textcolor{stringliteral}{        """}
01557         \textcolor{keywordflow}{if} wave != -1:
01558             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
01559         
01560         \textcolor{keywordflow}{return} self.AtomData.getA(lev\_i= lev\_i, lev\_j= lev\_j)
        
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Coll\-Rates@{get\-Coll\-Rates}}
\index{get\-Coll\-Rates@{get\-Coll\-Rates}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Coll\-Rates}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Coll\-Rates (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}
\begin{DoxyVerb}Return (n_levels x n_levels) array of collision rates at given temperature. 

Usage:
    O3.getCollRates(tem=10000)
    O3.getCollRates([8e3, 1e4, 1.2e4])

Parameters:
    - tem     electronic temperature in K. May be an array.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01394}{1394} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00101}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l00413}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l01320}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l00102}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l00414}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l01321}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l00080}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-coll\-N\-Levels}, \hyperlink{pynebcore_8py_source_l01289}{pyneb.\-core.\-pynebcore.\-Atom.\-coll\-N\-Levels}, \hyperlink{pynebcore_8py_source_l01322}{pyneb.\-core.\-pynebcore.\-Atom.\-Energy\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00828}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-get\-Omega()}, \hyperlink{pynebcore_8py_source_l01082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-get\-Omega()}, and \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}.



Referenced by \hyperlink{pynebcore_8py_source_l01562}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01394}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{01394} 
01395     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{getCollRates}(self, tem, NLevels=None):
01396         \textcolor{stringliteral}{"""}
01397 \textcolor{stringliteral}{        Return (n\_levels x n\_levels) array of collision rates at given temperature. }
01398 \textcolor{stringliteral}{        }
01399 \textcolor{stringliteral}{        Usage:}
01400 \textcolor{stringliteral}{            O3.getCollRates(tem=10000)}
01401 \textcolor{stringliteral}{            O3.getCollRates([8e3, 1e4, 1.2e4])}
01402 \textcolor{stringliteral}{        }
01403 \textcolor{stringliteral}{        Parameters:}
01404 \textcolor{stringliteral}{            - tem     electronic temperature in K. May be an array.}
01405 \textcolor{stringliteral}{}
01406 \textcolor{stringliteral}{}
01407 \textcolor{stringliteral}{        """}
01408         tem = np.asarray(tem)
01409         \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01410             NLevels = np.min((self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{EnergyNLevels}))
01411         res\_shape = [NLevels, NLevels]
01412         \textcolor{keywordflow}{for} sh \textcolor{keywordflow}{in} tem.shape:
01413             res\_shape.append(sh)
01414         resultArray = np.zeros(res\_shape)
01415         Omegas = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{getOmega}(tem)
01416         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(NLevels - 1):
01417             lev\_i = i + 1
01418             j = i + 1
01419             energy\_i = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i]
01420             stat\_weight\_i = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\_StatWeight}[i]
01421             \textcolor{keywordflow}{while} (j < NLevels):
01422                 lev\_j = j + 1 
01423                 energy\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]
01424                 stat\_weight\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\_StatWeight}[j]
01425                 resultArray[j][i] = CST.KCOLLRATE / tem ** 0.5 / stat\_weight\_j * Omegas[lev\_j-1, lev\_i-1]
01426                 resultArray[i][j] = ((stat\_weight\_j) / (stat\_weight\_i) * 
01427                                       np.exp((energy\_i - energy\_j) / (CST.BOLTZMANN\_ANGK * tem)) * 
01428                                       resultArray[j][i])
01429                 j += 1
01430         
01431         \textcolor{keywordflow}{return} np.squeeze(resultArray)
01432 
    
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Crit\-Density@{get\-Crit\-Density}}
\index{get\-Crit\-Density@{get\-Crit\-Density}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Crit\-Density}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Crit\-Density (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{level = {\ttfamily -\/1}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}
\begin{DoxyVerb}Return the critical density of selected level at given temperature. 
If no transition is selected, return complete array.

Usage:
    O3.getCritDensity(12000)
    O3.getCritDensity(12000, 4)

Parameters:
    - tem    electronic temperature in K. May be an array.
    - level  selected atomic level (default= -1)\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01759}{1759} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01619}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-crit\-Density}, \hyperlink{pynebcore_8py_source_l00178}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00447}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00677}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01045}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01525}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev()}, and \hyperlink{pynebcore_8py_source_l01562}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations()}.



Referenced by \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01759}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{01759} 
01760     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{getCritDensity}(self, tem, level= -1):
01761         \textcolor{stringliteral}{"""}
01762 \textcolor{stringliteral}{        Return the critical density of selected level at given temperature. }
01763 \textcolor{stringliteral}{        If no transition is selected, return complete array.}
01764 \textcolor{stringliteral}{        }
01765 \textcolor{stringliteral}{        Usage:}
01766 \textcolor{stringliteral}{            O3.getCritDensity(12000)}
01767 \textcolor{stringliteral}{            O3.getCritDensity(12000, 4)}
01768 \textcolor{stringliteral}{        }
01769 \textcolor{stringliteral}{        Parameters:}
01770 \textcolor{stringliteral}{            - tem    electronic temperature in K. May be an array.}
01771 \textcolor{stringliteral}{            - level  selected atomic level (default= -1)}
01772 \textcolor{stringliteral}{}
01773 \textcolor{stringliteral}{        """}
01774         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(level)
01775         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den=100.) \textcolor{comment}{# Any density would do}
01776         \textcolor{keywordflow}{if} level != -1:
01777             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity}[level - 1]
01778         \textcolor{keywordflow}{else}:
01779             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity}
01780         
        
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Density\-Range@{get\-Density\-Range}}
\index{get\-Density\-Range@{get\-Density\-Range}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Density\-Range}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Density\-Range (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\-\_\-i1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i2 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}, }
\item[{}]{tol = {\ttfamily 0.1}, }
\item[{}]{tem = {\ttfamily 1e4}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}
\begin{DoxyVerb}Return the range of density where a given line ratio is between 10% and 90% of the low and high density limits
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01742}{1742} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01719}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-High\-Dens\-Ratio()}, \hyperlink{pynebcore_8py_source_l01698}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Low\-Dens\-Ratio()}, and \hyperlink{pynebcore_8py_source_l02126}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Den()}.



Referenced by \hyperlink{pynebcore_8py_source_l01719}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-High\-Dens\-Ratio()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01742}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a30ea60641df87c5eaf8af392d31da920}{01742} 
01743                         to\_eval=\textcolor{keywordtype}{None}, tol=0.1, tem=1e4):
01744         \textcolor{stringliteral}{"""}
01745 \textcolor{stringliteral}{        Return the range of density where a given line ratio is between 10% and 90% of the low and high
       density limits}
01746 \textcolor{stringliteral}{        """}
01747         LowLim = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{getLowDensRatio}(lev\_i1, lev\_i2, wave1, wave2, to\_eval)
01748         HighLim = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{getHighDensRatio}(lev\_i1, lev\_i2, lev\_j1, lev\_j2, wave1, wave2, 
      to\_eval)
01749         
01750         delta = abs(LowLim - HighLim)
01751         minRatio = min((LowLim, HighLim)) + tol * delta
01752         maxRatio = max((LowLim, HighLim)) - tol * delta
01753         dens1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{getTemDen}(minRatio, tem=tem, lev\_i1= lev\_i1, lev\_j1= lev\_j1, lev\_i2= lev\_i2, 
      lev\_j2= lev\_j2,
01754                   wave1= wave1, wave2= wave2, to\_eval=to\_eval)
01755         dens2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{getTemDen}(maxRatio, tem=tem, lev\_i1= lev\_i1, lev\_j1= lev\_j1, lev\_i2= lev\_i2, 
      lev\_j2= lev\_j2,
01756                   wave1= wave1, wave2= wave2, to\_eval=to\_eval)
01757         return(np.sort((dens1, dens2)))
               
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Emissivity@{get\-Emissivity}}
\index{get\-Emissivity@{get\-Emissivity}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Emissivity}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{den, }
\item[{}]{lev\-\_\-i = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}, }
\item[{}]{product = {\ttfamily True}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}
\begin{DoxyVerb}Return the line emissivity of selected transition or complete array of emissivities
The transition is selected by the argument wave (if given); 
if wave is not supplied, it is selected by the upper and lower levels (lev_i and lev_j); 
if neither is given, the whole array is computed

Usage:      
    O3.getEmissivity(12000, 100, 4, 2)         # (4, 2) transition
    O3.getEmissivity(10000, 10000, wave=5007)  # (4, 2) transition
    O3.getEmissivity(12000, 100)               # all transitions
    O3.getEmissivity([10000, 12000], [100, 500], 4, 2)
    O3.getEmissivity([10000, 12000], [100, 500])
    
Parameters:
    - tem      electronic temperature in K. May be an array.
    - den      electronic density in cm^-3. May be an array.
    - lev_i    upper level (default= -1)
    - lev_j    lower level (default= -1)
    - wave     wavelength of transition. Takes precedence on lev_i and lev_j if set, 
        ignored otherwise. It can also be a blend label.
    - product  Boolean. If True (default), all the combination of (tem, den) are used. 
         If False, tem and den must have the same size and are joined.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01782}{1782} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00100}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l00415}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l01319}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l00101}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l00413}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l01320}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Energy}, \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l00178}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00447}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00677}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01045}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01525}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{emis_grid_8py_source_l00051}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-atom}, \hyperlink{pynebcore_8py_source_l00089}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00310}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l00576}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00926}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l01162}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-atom}, \hyperlink{pynebcore_8py_source_l01218}{pyneb.\-core.\-pynebcore.\-Atom.\-atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l01562}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations()}, \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}, \hyperlink{pynebcore_8py_source_l00069}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00098}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00319}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00586}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00933}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-N\-Levels}, and \hyperlink{pynebcore_8py_source_l01231}{pyneb.\-core.\-pynebcore.\-Atom.\-N\-Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l02176}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Ion\-Abundance()}, \hyperlink{pynebcore_8py_source_l03083}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Ion\-Abundance()}, \hyperlink{pynebcore_8py_source_l02384}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Emiss()}, \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}, and \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01782}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{01782} 
01783     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(self, tem, den, lev\_i= -1, lev\_j= -1, wave= -1, product=True):
01784         \textcolor{stringliteral}{"""}
01785 \textcolor{stringliteral}{        Return the line emissivity of selected transition or complete array of emissivities}
01786 \textcolor{stringliteral}{        The transition is selected by the argument wave (if given); }
01787 \textcolor{stringliteral}{        if wave is not supplied, it is selected by the upper and lower levels (lev\_i and lev\_j); }
01788 \textcolor{stringliteral}{        if neither is given, the whole array is computed}
01789 \textcolor{stringliteral}{        }
01790 \textcolor{stringliteral}{        Usage:      }
01791 \textcolor{stringliteral}{            O3.getEmissivity(12000, 100, 4, 2)         # (4, 2) transition}
01792 \textcolor{stringliteral}{            O3.getEmissivity(10000, 10000, wave=5007)  # (4, 2) transition}
01793 \textcolor{stringliteral}{            O3.getEmissivity(12000, 100)               # all transitions}
01794 \textcolor{stringliteral}{            O3.getEmissivity([10000, 12000], [100, 500], 4, 2)}
01795 \textcolor{stringliteral}{            O3.getEmissivity([10000, 12000], [100, 500])}
01796 \textcolor{stringliteral}{            }
01797 \textcolor{stringliteral}{        Parameters:}
01798 \textcolor{stringliteral}{            - tem      electronic temperature in K. May be an array.}
01799 \textcolor{stringliteral}{            - den      electronic density in cm^-3. May be an array.}
01800 \textcolor{stringliteral}{            - lev\_i    upper level (default= -1)}
01801 \textcolor{stringliteral}{            - lev\_j    lower level (default= -1)}
01802 \textcolor{stringliteral}{            - wave     wavelength of transition. Takes precedence on lev\_i and lev\_j if set, }
01803 \textcolor{stringliteral}{                        ignored otherwise. It can also be a blend label.}
01804 \textcolor{stringliteral}{            - product  Boolean. If True (default), all the combination of (tem, den) are used. }
01805 \textcolor{stringliteral}{                         If False, tem and den must have the same size and are joined.}
01806 \textcolor{stringliteral}{}
01807 \textcolor{stringliteral}{        """}
01808         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave) \textcolor{keywordflow}{in} BLEND\_LIST:
01809             L = \textcolor{keyword}{lambda} wave: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, wave=wave, product=product)
01810             I = \textcolor{keyword}{lambda} lev\_i, lev\_j: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, lev\_i=lev\_i, lev\_j=lev\_j, 
      product=product)
01811             \textcolor{keywordflow}{try}:
01812                 res = eval(BLEND\_LIST[\textcolor{stringliteral}{'\{0\}\_\{1\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, wave)])
01813             \textcolor{keywordflow}{except}:
01814                 log\_.warn(\textcolor{stringliteral}{'\{0\} is not understood'}.format(wave), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'getEmissivity'})
01815                 res = \textcolor{keywordtype}{None}
01816             \textcolor{keywordflow}{return} res
01817         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_i)
01818         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_j)
01819         tem = np.asarray(tem)
01820         den = np.asarray(den)
01821         \textcolor{keywordflow}{if} wave != -1:
01822             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
01823         NLevels = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}
01824         \textcolor{keywordflow}{if} lev\_i > NLevels \textcolor{keywordflow}{or} lev\_j > NLevels:
01825             log\_.error(\textcolor{stringliteral}{'The number of levels \{\} does not allow getting this emissivity. Consider changing
       the atomic data'}.format(NLevels),
01826                           calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling}) 
01827         \textcolor{keywordflow}{if} product:
01828             n\_tem = tem.size
01829             n\_den = den.size
01830             tem\_ones = np.ones(n\_tem)
01831             populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den, product=\textcolor{keyword}{True})
01832             \textcolor{keywordflow}{if} ((lev\_i == -1) \textcolor{keywordflow}{and} (lev\_j == -1)):
01833                 resultArray = np.zeros((NLevels, NLevels, n\_tem, n\_den))
01834                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(NLevels):
01835                     lev\_i = i + 1
01836                     j = i - 1 
01837                     \textcolor{keywordflow}{while} (j >= 0):
01838                         lev\_j = j + 1
01839                         deltaE = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]) * CST.HPLANCK * 
      CST.CLIGHT * 1.e8 
01840                         resultArray[i][j] = (deltaE * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[i, j] * populations[i].reshape(1, 1, n\_tem,
       n\_den) / 
01841                                              np.outer(tem\_ones, den).reshape(1, 1, n\_tem, n\_den))
01842                         j -= 1
01843                 \textcolor{keywordflow}{return} np.squeeze(resultArray)
01844             \textcolor{keywordflow}{else}:
01845                 \textcolor{keywordflow}{if} (lev\_i <= lev\_j):
01846                     \textcolor{keywordflow}{return} 0.
01847                 \textcolor{keywordflow}{else}:
01848                     i = lev\_i - 1
01849                     j = lev\_j - 1
01850                     deltaE = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]) * CST.HPLANCK * CST.CLIGHT *
       1.e8 
01851                     \textcolor{keywordflow}{return} np.squeeze((populations[i] * deltaE * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[i, j]).reshape(1, 1, n\_tem, 
      n\_den) / 
01852                                       np.outer(tem\_ones, den).reshape(1, 1, n\_tem, n\_den))
01853         \textcolor{keywordflow}{else}:
01854             \textcolor{keywordflow}{if} tem.shape != den.shape:
01855                 self.log\_.error(\textcolor{stringliteral}{'tem and den must have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01856                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01857             populations = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den, product=\textcolor{keyword}{False})
01858             \textcolor{keywordflow}{if} (lev\_i <= lev\_j):
01859                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01860             \textcolor{keywordflow}{else}:
01861                 i = lev\_i - 1
01862                 j = lev\_j - 1
01863                 deltaE = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\_Energy}[j]) * CST.HPLANCK * CST.CLIGHT * 1.
      e8 
01864                 \textcolor{keywordflow}{return} populations[i] * deltaE * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[i, j] / den
01865 
        
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-High\-Dens\-Ratio@{get\-High\-Dens\-Ratio}}
\index{get\-High\-Dens\-Ratio@{get\-High\-Dens\-Ratio}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-High\-Dens\-Ratio}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-High\-Dens\-Ratio (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\-\_\-i1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i2 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}
\begin{DoxyVerb}Return the value of a diagostic ratio at the high density limit
S2.getHighDensRatio(lev_i1 = 3, lev_i2 = 2)
S2.getHighDensRatio(wave1 = 6716, wave2 = 6731)
S2.getHighDensRatio(to_eval = 'L(6716)/L(6731)')
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01719}{1719} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00067}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-A}, \hyperlink{pynebcore_8py_source_l00212}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-get\-A()}, \hyperlink{pynebcore_8py_source_l00487}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-get\-A()}, \hyperlink{pynebcore_8py_source_l01537}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-A()}, \hyperlink{pynebcore_8py_source_l01742}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Density\-Range()}, \hyperlink{pynebcore_8py_source_l00065}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l01255}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Stat\-Weight}, and \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01742}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Density\-Range()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01719}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{01719} 
01720     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ac2e1509a2acc642c00696f3787e95f95}{getHighDensRatio}(self, lev\_i1=-1, lev\_i2=-1, lev\_j1=-1, lev\_j2=-1, wave1=-1, 
      wave2=-1, to\_eval=None):
01721         
01722         \textcolor{stringliteral}{"""}
01723 \textcolor{stringliteral}{        Return the value of a diagostic ratio at the high density limit}
01724 \textcolor{stringliteral}{        S2.getHighDensRatio(lev\_i1 = 3, lev\_i2 = 2)}
01725 \textcolor{stringliteral}{        S2.getHighDensRatio(wave1 = 6716, wave2 = 6731)}
01726 \textcolor{stringliteral}{        S2.getHighDensRatio(to\_eval = 'L(6716)/L(6731)')}
01727 \textcolor{stringliteral}{        """}
01728         
01729         \textcolor{keywordflow}{if} wave1 != -1:
01730             lev\_i1, lev\_j1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave1)
01731         \textcolor{keywordflow}{if} wave2 != -1:
01732             lev\_i2, lev\_j2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave2)
01733             
01734         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
01735             L = \textcolor{keyword}{lambda} wave: (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0]) * 
01736                               self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0], self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[1]))
01737             \textcolor{keywordflow}{return} eval(to\_eval)
01738             
01739         \textcolor{keywordflow}{return} (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i1) / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i2) *
01740                 self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(lev\_i1, lev\_j1) / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(lev\_i2, lev\_j2))
           
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Ion\-Abundance@{get\-Ion\-Abundance}}
\index{get\-Ion\-Abundance@{get\-Ion\-Abundance}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Ion\-Abundance}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Ion\-Abundance (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\-\_\-ratio, }
\item[{}]{tem, }
\item[{}]{den, }
\item[{}]{lev\-\_\-i = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}, }
\item[{}]{Hbeta = {\ttfamily 100.}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}
\begin{DoxyVerb}Compute the ionic abundance relative to H+ given the intensity of a line or sum of lines, 
the temperature, and the density. 
The line can be specified as a transition (i.e., giving the two atomic level involved), 
as a wavelength, or as an algebraic expression. In the last case, a sum of lines 
can also be supplied.

Usage:
    O3.getIonAbundance(100, 1.5e4, 100., wave=5007)
    O3.getIonAbundance(130, 1.5e4, 100., to_eval='I(4,3) + I(4,2)')
    O3.getIonAbundance(np.array([100, 150]), np.array([1.5e4, 1.2e4]), np.array([100., 120]), 
wave=5007)
    O2.getIonAbundance(int_ratio=100, tem=1.5e4, den=100., to_eval='L(3726)+L(3729)')

    
Parameters:
    - int_ratio    relative line intensity (default normalization: Hbeta = 100). 
            May be an array.
    - tem          electronic temperature in K. May be an array.
    - den          electronic density in cm^-3. May be an array.
    - lev_i        upper level of transition
    - lev_j        lower level of transition
    - wave         wavelength of transition. Takes precedence on lev_i and lev_j if set, 
            ignored otherwise 
    - to_eval      expression to be evaluated. Takes precedence on wave if set, 
            ignored otherwise.
    - Hbeta        line intensity normalization at Hbeta (default Hbeta = 100)\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02176}{2176} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00178}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00447}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l00677}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01045}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01525}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l03158}{pyneb.\-core.\-pynebcore.\-get\-Rec\-Emissivity()}, and \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02176}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{02176} 
02177     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a95230eab8816f670306adceffe6f6a48}{getIonAbundance}(self, int\_ratio, tem, den, lev\_i= -1, lev\_j= -1, wave= -1, 
      to\_eval=None, Hbeta=100.):
02178         \textcolor{stringliteral}{"""}
02179 \textcolor{stringliteral}{        Compute the ionic abundance relative to H+ given the intensity of a line or sum of lines, }
02180 \textcolor{stringliteral}{        the temperature, and the density. }
02181 \textcolor{stringliteral}{        The line can be specified as a transition (i.e., giving the two atomic level involved), }
02182 \textcolor{stringliteral}{        as a wavelength, or as an algebraic expression. In the last case, a sum of lines }
02183 \textcolor{stringliteral}{        can also be supplied.}
02184 \textcolor{stringliteral}{}
02185 \textcolor{stringliteral}{        Usage:}
02186 \textcolor{stringliteral}{            O3.getIonAbundance(100, 1.5e4, 100., wave=5007)}
02187 \textcolor{stringliteral}{            O3.getIonAbundance(130, 1.5e4, 100., to\_eval='I(4,3) + I(4,2)')}
02188 \textcolor{stringliteral}{            O3.getIonAbundance(np.array([100, 150]), np.array([1.5e4, 1.2e4]), np.array([100., 120]), }
02189 \textcolor{stringliteral}{                wave=5007)}
02190 \textcolor{stringliteral}{            O2.getIonAbundance(int\_ratio=100, tem=1.5e4, den=100., to\_eval='L(3726)+L(3729)')}
02191 \textcolor{stringliteral}{}
02192 \textcolor{stringliteral}{            }
02193 \textcolor{stringliteral}{        Parameters:}
02194 \textcolor{stringliteral}{            - int\_ratio    relative line intensity (default normalization: Hbeta = 100). }
02195 \textcolor{stringliteral}{                            May be an array.}
02196 \textcolor{stringliteral}{            - tem          electronic temperature in K. May be an array.}
02197 \textcolor{stringliteral}{            - den          electronic density in cm^-3. May be an array.}
02198 \textcolor{stringliteral}{            - lev\_i        upper level of transition}
02199 \textcolor{stringliteral}{            - lev\_j        lower level of transition}
02200 \textcolor{stringliteral}{            - wave         wavelength of transition. Takes precedence on lev\_i and lev\_j if set, }
02201 \textcolor{stringliteral}{                            ignored otherwise }
02202 \textcolor{stringliteral}{            - to\_eval      expression to be evaluated. Takes precedence on wave if set, }
02203 \textcolor{stringliteral}{                            ignored otherwise.}
02204 \textcolor{stringliteral}{            - Hbeta        line intensity normalization at Hbeta (default Hbeta = 100)}
02205 \textcolor{stringliteral}{        }
02206 \textcolor{stringliteral}{        """}
02207         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_i)
02208         self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_afa4b9737dcd5bed31e25e8f0b6dc4730}{\_test\_lev}(lev\_j)
02209         \textcolor{keywordflow}{if} np.ndim(tem) != np.ndim(den):
02210             self.log\_.error(\textcolor{stringliteral}{'ten and den must have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02211             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02212         \textcolor{keywordflow}{if} ((np.squeeze(np.asarray(int\_ratio)).shape != np.squeeze(np.asarray(tem)).shape) | 
02213             (np.squeeze(np.asarray(den)).shape != np.squeeze(np.asarray(tem)).shape)):
02214             self.log\_.warn(\textcolor{stringliteral}{'int\_ratio, tem and den must does not have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02215         \textcolor{keywordflow}{if} (lev\_i == -1) & (lev\_j == -1) & (wave == -1) & (to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}):
02216             self.log\_.error(\textcolor{stringliteral}{'At least one of lev\_i, lev\_j, wave or to\_eval must be supplied'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02217             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02218         \textcolor{keywordflow}{if} to\_eval == \textcolor{keywordtype}{None}:
02219             \textcolor{keywordflow}{if} wave != -1:
02220                 lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)     
02221             to\_eval = \textcolor{stringliteral}{'I('} + str(lev\_i) + \textcolor{stringliteral}{','} + str(lev\_j) + \textcolor{stringliteral}{')'} 
02222         I = \textcolor{keyword}{lambda} lev\_i, lev\_j: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, lev\_i, lev\_j, product=\textcolor{keyword}{False})
02223         L = \textcolor{keyword}{lambda} wave: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, wave=wave, product=\textcolor{keyword}{False})
02224         \textcolor{keywordflow}{try}:
02225             emis = eval(to\_eval)
02226         \textcolor{keywordflow}{except}:
02227             self.log\_.error(\textcolor{stringliteral}{'Unable to eval \{0\}'}.format(to\_eval), calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02228             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02229         \textcolor{comment}{#int\_ratio is in units of Hb = Hbeta keyword}
02230         ionAbundance = ((int\_ratio / Hbeta) * (\hyperlink{namespacepyneb_1_1core_1_1pynebcore_aba9d4a5306330dd47f8a51455514c017}{getRecEmissivity}(tem, den, 4, 2, atom=\textcolor{stringliteral}{'H1'}, 
      product=\textcolor{keyword}{False}) / emis))
02231         \textcolor{keywordflow}{return} ionAbundance
02232     

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Low\-Dens\-Ratio@{get\-Low\-Dens\-Ratio}}
\index{get\-Low\-Dens\-Ratio@{get\-Low\-Dens\-Ratio}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Low\-Dens\-Ratio}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Low\-Dens\-Ratio (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{lev\-\_\-i1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}
\begin{DoxyVerb}Return the value of a diagostic ratio at the low density limit
S2.getLowDensRatio(lev_i1 = 3, lev_i2 = 2)
S2.getLowDensRatio(wave1 = 6716, wave2 = 6731)
S2.getLowDensRatio(to_eval = 'L(6716)/L(6731)')
\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01698}{1698} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00065}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l01255}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Stat\-Weight}, and \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01742}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Density\-Range()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01698}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{01698} 
01699     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6db2a3425e5a35f0bd04f05bcb25ee1}{getLowDensRatio}(self, lev\_i1=-1, lev\_i2=-1, wave1=-1, wave2=-1, to\_eval=None):
01700         
01701         \textcolor{stringliteral}{"""}
01702 \textcolor{stringliteral}{        Return the value of a diagostic ratio at the low density limit}
01703 \textcolor{stringliteral}{        S2.getLowDensRatio(lev\_i1 = 3, lev\_i2 = 2)}
01704 \textcolor{stringliteral}{        S2.getLowDensRatio(wave1 = 6716, wave2 = 6731)}
01705 \textcolor{stringliteral}{        S2.getLowDensRatio(to\_eval = 'L(6716)/L(6731)')}
01706 \textcolor{stringliteral}{        """}
01707         
01708         \textcolor{keywordflow}{if} wave1 != -1:
01709             lev\_i1, lev\_j1 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave1)
01710         \textcolor{keywordflow}{if} wave2 != -1:
01711             lev\_i2, lev\_j2 = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave2)
01712             
01713         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
01714             L = \textcolor{keyword}{lambda} wave: self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)[0])
01715             \textcolor{keywordflow}{return} eval(to\_eval)
01716             
01717         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i1) / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i2)
01718         
        
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Omega@{get\-Omega}}
\index{get\-Omega@{get\-Omega}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Omega}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{lev\-\_\-i = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j = {\ttfamily -\/1}, }
\item[{}]{wave = {\ttfamily -\/1}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}
\begin{DoxyVerb}Return interpolated value of the collision strength value at the given temperature 
    for the complete array or a specified transition.
If kappa is not None (non-maxwellian distribution of e-velocities), the collision 
    strength is corrected as in Mendoza & Bautista, 2014 ApJ 785, 91.

Usage:
    O3.getOmega(15000.)
    O3.getOmega([8e3, 1e4, 1.2e4])
    O3.getOmega([8e3, 1e4, 1.2e4], 5, 4)

Parameters:
    - tem    electronic temperature in K. May be an array.
    - lev_i  upper level
    - lev_j  lower level\end{DoxyVerb}
\begin{DoxyVerb}\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01324}{1324} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{pynebcore_8py_source_l00080}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-coll\-N\-Levels}, \hyperlink{pynebcore_8py_source_l01289}{pyneb.\-core.\-pynebcore.\-Atom.\-coll\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00066}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-Energy}, \hyperlink{pynebcore_8py_source_l01256}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Energy}, \hyperlink{pynebcore_8py_source_l00828}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-get\-Omega()}, \hyperlink{pynebcore_8py_source_l01082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-get\-Omega()}, \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}, \hyperlink{pynebcore_8py_source_l00065}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l01255}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Stat\-Weight}, and \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01394}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Coll\-Rates()}, and \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01324}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{01324} 
01325     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{getOmega}(self, tem, lev\_i= -1, lev\_j= -1, wave= -1):
01326         \textcolor{stringliteral}{"""}
01327 \textcolor{stringliteral}{        Return interpolated value of the collision strength value at the given temperature }
01328 \textcolor{stringliteral}{            for the complete array or a specified transition.}
01329 \textcolor{stringliteral}{        If kappa is not None (non-maxwellian distribution of e-velocities), the collision }
01330 \textcolor{stringliteral}{            strength is corrected as in Mendoza & Bautista, 2014 ApJ 785, 91.}
01331 \textcolor{stringliteral}{}
01332 \textcolor{stringliteral}{        Usage:}
01333 \textcolor{stringliteral}{            O3.getOmega(15000.)}
01334 \textcolor{stringliteral}{            O3.getOmega([8e3, 1e4, 1.2e4])}
01335 \textcolor{stringliteral}{            O3.getOmega([8e3, 1e4, 1.2e4], 5, 4)}
01336 \textcolor{stringliteral}{        }
01337 \textcolor{stringliteral}{        Parameters:}
01338 \textcolor{stringliteral}{            - tem    electronic temperature in K. May be an array.}
01339 \textcolor{stringliteral}{            - lev\_i  upper level}
01340 \textcolor{stringliteral}{            - lev\_j  lower level}
01341 \textcolor{stringliteral}{}
01342 \textcolor{stringliteral}{        """}
01343         \textcolor{stringliteral}{"""}
01344 \textcolor{stringliteral}{        """}
01345         
01346         
01347         
01348         \textcolor{keywordflow}{if} wave != -1:
01349             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
01350         kappa = config.kappa 
01351         \textcolor{keywordflow}{if} kappa \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01352             to\_return = self.CollData.getOmega(tem, lev\_i, lev\_j)
01353         \textcolor{keywordflow}{else}:
01354             \textcolor{comment}{#ToDo The Kappa correction should come AFTER the transformation into CS unit}
01355             \textcolor{keywordflow}{if} (lev\_i == -1) \textcolor{keywordflow}{and} (lev\_j == -1):
01356                 tem = np.asarray(tem)
01357                 res\_shape = [self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}]
01358                 \textcolor{keywordflow}{for} sh \textcolor{keywordflow}{in} tem.shape:
01359                     res\_shape.append(sh)
01360                 Omega = np.zeros(res\_shape)
01361         
01362                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels} - 1):
01363                     j = i + 1
01364                     \textcolor{keywordflow}{while} (j < self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{collNLevels}):
01365                         Omega[j][i] = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae133eed382e284df01f2183da341534b}{getOmega}(tem, j + 1, i + 1)
01366                         j += 1
01367             \textcolor{keywordflow}{else}:
01368                 OmegaMB = self.CollData.getOmega(tem, lev\_i, lev\_j)
01369                 delta\_E = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_i, unit=\textcolor{stringliteral}{'eV'}) - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_j, unit=\textcolor{stringliteral}{'eV'})
01370                 correc = ((kappa - 3./2.)**(-0.5) / kappa * gamma(kappa+1) / gamma(kappa-0.5) * 
01371                           (1 + delta\_E/((kappa-1.5)*CST.BOLTZMANN\_eVK*tem))**(-kappa)) * np.exp(delta\_E/
      CST.BOLTZMANN\_eVK/tem)
01372     
01373                 Omega = correc * OmegaMB
01374                 log\_.message(\textcolor{stringliteral}{'Correcting for Kappa=\{0\} by \{1\}'}.format(kappa, correc), self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01375 
01376             to\_return = np.squeeze(Omega)
01377         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'COEFF'} \textcolor{keywordflow}{in} self.CollData.comments:
01378             to\_return *= float(self.CollData.comments[\textcolor{stringliteral}{'COEFF'}])
01379         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'O\_UNIT'} \textcolor{keywordflow}{in} self.CollData.comments:
01380             \textcolor{keywordflow}{if} self.CollData.comments[\textcolor{stringliteral}{'O\_UNIT'}] == \textcolor{stringliteral}{'DEEX RATE COEFF'}:
01381                 to\_return /= CST.KCOLLRATE / tem ** 0.5 / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i)
01382             \textcolor{keywordflow}{elif} self.CollData.comments[\textcolor{stringliteral}{'O\_UNIT'}] == \textcolor{stringliteral}{'RATE COEFF'}:
01383                 deltaE = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_i, unit=\textcolor{stringliteral}{'erg'}) - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_j, unit=\textcolor{stringliteral}{'erg'})
01384                 to\_return *= (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_j) / self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i) * np.exp(deltaE /(CST.BOLTZMANN * tem))) \textcolor{comment}{#q21}
01385                 to\_return /= CST.KCOLLRATE / tem ** 0.5 / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i)
01386             \textcolor{keywordflow}{elif} self.CollData.comments[\textcolor{stringliteral}{'O\_UNIT'}] == \textcolor{stringliteral}{'COOLING'}:
01387                 deltaE = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_i, unit=\textcolor{stringliteral}{'erg'}) - self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(lev\_j, unit=\textcolor{stringliteral}{'erg'})
01388                 to\_return /= deltaE \textcolor{comment}{# Loss to q12                }
01389                 to\_return *= (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_j) / self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i) * np.exp(deltaE /(CST.BOLTZMANN * tem))) \textcolor{comment}{#q21}
01390                 to\_return /= (CST.KCOLLRATE / np.sqrt(tem) / self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}(lev\_i)) \textcolor{comment}{#
       Omega}
01391                 
01392         \textcolor{keywordflow}{return} to\_return
    
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Populations@{get\-Populations}}
\index{get\-Populations@{get\-Populations}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Populations}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem, }
\item[{}]{den, }
\item[{}]{product = {\ttfamily True}, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}
\begin{DoxyVerb}Return array of populations at given temperature and density.
The method returns a 1-, 2- or 3-D array containing the population of each level 
    for all temperatures and densities specified in the input vectors tem and den 
    (which can be n-element or 1-element vectors).
If either quantity (tem or den) is a 1-element vector -that is, a single value-, 
    the resulting population array is collapsed along that dimension; 
    as a result, the result population array can be a 1-D, 2-D or 3-D array 
    (the three cases corresponding to situations in which both tem and den are single values; 
    one of them is a single value and the other an n-element vector; or both are multielement 
    vectors, respectively). In the general case, the level index is the first 
    [WARNING! It is not in physical unit, i.e. ground level = 0; to be normalized], 
    followed by the temperature index (if it exists) and the density index. 

Usage:
    O3.getPopulations(1e4, 1e2)
    tem=np.array([10000., 12000., 15000., 20000]) # An array of four temperatures
    den=np.array([600., 800., 1000])      # An array of three densities
    O3.getPopulations(tem, den)           # is a (6, 4, 3) array
    O3.getPopulations(tem, den)[0,2,1]    # Returns the population of level 1 for T = 15000 
                                    and Ne = 800
    tem = 20000                           # tem is no longer an array
    O3.getPopulations(tem, den)[0,2,1]  # Crashes: one index too much
    O3.getPopulations(tem, den)[0,1]    # Returns the population of level 1 for T = 20000 
                                    and Ne = 800 [see warning]
    tem=np.array([10000., 15000., 20000]) # An array of three temperatures
    O3.getPopulations(tem, den, product = False)# is a (6, 3) array, tem and den beeing 
                                            taken 2 by 2.

Parameters:
    - tem       electronic temperature in K
    - den       electronic density in cm^-3
    - product   operate on all possible combinations of temperature and density 
      (product = True, default case) or on those resulting from combining 
      the i-th value of tem with the i-th value of den (product = False).
      If product = False, then tem and den must be the same size.\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01562}{1562} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00100}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l00415}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l01319}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-A}, \hyperlink{pynebcore_8py_source_l01394}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Coll\-Rates()}, \hyperlink{pynebcore_8py_source_l00069}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00098}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00319}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00586}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00933}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-N\-Levels}, and \hyperlink{pynebcore_8py_source_l01231}{pyneb.\-core.\-pynebcore.\-Atom.\-N\-Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l01759}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Crit\-Density()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, and \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01562}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{01562} 
01563     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(self, tem, den, product=True, NLevels=None):
01564         \textcolor{stringliteral}{"""}
01565 \textcolor{stringliteral}{        Return array of populations at given temperature and density.}
01566 \textcolor{stringliteral}{        The method returns a 1-, 2- or 3-D array containing the population of each level }
01567 \textcolor{stringliteral}{            for all temperatures and densities specified in the input vectors tem and den }
01568 \textcolor{stringliteral}{            (which can be n-element or 1-element vectors).}
01569 \textcolor{stringliteral}{        If either quantity (tem or den) is a 1-element vector -that is, a single value-, }
01570 \textcolor{stringliteral}{            the resulting population array is collapsed along that dimension; }
01571 \textcolor{stringliteral}{            as a result, the result population array can be a 1-D, 2-D or 3-D array }
01572 \textcolor{stringliteral}{            (the three cases corresponding to situations in which both tem and den are single values; }
01573 \textcolor{stringliteral}{            one of them is a single value and the other an n-element vector; or both are multielement }
01574 \textcolor{stringliteral}{            vectors, respectively). In the general case, the level index is the first }
01575 \textcolor{stringliteral}{            [WARNING! It is not in physical unit, i.e. ground level = 0; to be normalized], }
01576 \textcolor{stringliteral}{            followed by the temperature index (if it exists) and the density index. }
01577 \textcolor{stringliteral}{}
01578 \textcolor{stringliteral}{        Usage:}
01579 \textcolor{stringliteral}{            O3.getPopulations(1e4, 1e2)}
01580 \textcolor{stringliteral}{            tem=np.array([10000., 12000., 15000., 20000]) # An array of four temperatures}
01581 \textcolor{stringliteral}{            den=np.array([600., 800., 1000])      # An array of three densities}
01582 \textcolor{stringliteral}{            O3.getPopulations(tem, den)           # is a (6, 4, 3) array}
01583 \textcolor{stringliteral}{            O3.getPopulations(tem, den)[0,2,1]    # Returns the population of level 1 for T = 15000 }
01584 \textcolor{stringliteral}{                                                    and Ne = 800}
01585 \textcolor{stringliteral}{            tem = 20000                           # tem is no longer an array}
01586 \textcolor{stringliteral}{            O3.getPopulations(tem, den)[0,2,1]  # Crashes: one index too much}
01587 \textcolor{stringliteral}{            O3.getPopulations(tem, den)[0,1]    # Returns the population of level 1 for T = 20000 }
01588 \textcolor{stringliteral}{                                                    and Ne = 800 [see warning]}
01589 \textcolor{stringliteral}{            tem=np.array([10000., 15000., 20000]) # An array of three temperatures}
01590 \textcolor{stringliteral}{            O3.getPopulations(tem, den, product = False)# is a (6, 3) array, tem and den beeing }
01591 \textcolor{stringliteral}{                                                            taken 2 by 2.}
01592 \textcolor{stringliteral}{        }
01593 \textcolor{stringliteral}{        Parameters:}
01594 \textcolor{stringliteral}{            - tem       electronic temperature in K}
01595 \textcolor{stringliteral}{            - den       electronic density in cm^-3}
01596 \textcolor{stringliteral}{            - product   operate on all possible combinations of temperature and density }
01597 \textcolor{stringliteral}{                      (product = True, default case) or on those resulting from combining }
01598 \textcolor{stringliteral}{                      the i-th value of tem with the i-th value of den (product = False).}
01599 \textcolor{stringliteral}{                      If product = False, then tem and den must be the same size.}
01600 \textcolor{stringliteral}{}
01601 \textcolor{stringliteral}{        """}
01602         tem = np.asarray(tem)
01603         den = np.asarray(den)
01604         \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
01605             n\_level = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}
01606         \textcolor{keywordflow}{else}:
01607             n\_level = NLevels
01608         \textcolor{keywordflow}{if} product:
01609             n\_tem = tem.size
01610             n\_den = den.size
01611             tem\_ones = np.ones(n\_tem)
01612             den\_ones = np.ones(n\_den)
01613             \textcolor{comment}{# q is vector-indexed (q(0, 1) = rate between levels 1 and 2)}
01614             q = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{getCollRates}(tem, n\_level)
01615             Atem = np.outer(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[:n\_level, :n\_level], tem\_ones).reshape(n\_level, n\_level, n\_tem)
01616             pop\_result = np.zeros((n\_level, n\_tem, n\_den))
01617             sum\_q\_up = np.zeros((n\_level, n\_tem))
01618             sum\_q\_down = np.zeros((n\_level, n\_tem))
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01619}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{01619}             sum\_A = np.squeeze(Atem.sum(axis=1))
01620             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity} = sum\_A / q.sum(axis=1)
01621             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, n\_level):
01622                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i + 1, n\_level):
01623                     sum\_q\_up[i] = sum\_q\_up[i] + q[i, j]
01624                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(0, i):
01625                     sum\_q\_down[i] = sum\_q\_down[i] + q[i, j]
01626             coeff\_matrix = ((np.outer(np.swapaxes(q, 0, 1), den) + 
01627                              np.outer(np.swapaxes(Atem, 0, 1), den\_ones)).reshape(n\_level, n\_level, n\_tem, 
      n\_den))
01628             coeff\_matrix[0, :] = 1.
01629             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, n\_level):
01630                 coeff\_matrix[i, i] = (-(np.outer((sum\_q\_up[i] + sum\_q\_down[i]), den) + 
01631                                         np.outer(sum\_A[i], den\_ones)).reshape(1, 1, n\_tem, n\_den))
01632             vect = np.zeros(n\_level)
01633             vect[0] = 1.
01634     
01635             \textcolor{keywordflow}{for} i\_tem \textcolor{keywordflow}{in} range(n\_tem):
01636                 \textcolor{keywordflow}{for} i\_den \textcolor{keywordflow}{in} range(n\_den):
01637                     \textcolor{keywordflow}{try}:
01638                         pop\_result[:, i\_tem, i\_den] = \hyperlink{namespacepyneb_1_1utils_1_1misc_aa5d9daf83958e9b6bd123954d495e94c}{solve}(np.squeeze(coeff\_matrix[:, :, i\_tem, i\_den
      ]), vect)
01639                     \textcolor{comment}{#except np.linalg.LinAlgError:}
01640                     \textcolor{comment}{#    pop\_result[:, i\_tem, i\_den] = np.nan}
01641                     \textcolor{keywordflow}{except}:
01642                         self.log\_.error(\textcolor{stringliteral}{'Error solving population matrix'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01643             pop = np.squeeze(pop\_result)
01644         \textcolor{keywordflow}{else}:
01645             \textcolor{keywordflow}{if} tem.shape != den.shape:
01646                 self.log\_.error(\textcolor{stringliteral}{'tem and den must have the same shape'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01647                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
01648             res\_shape1 = [n\_level]
01649             res\_shape\_rav1 = [n\_level, tem.size]
01650             res\_shape\_rav2 = [n\_level, n\_level, tem.size]
01651             \textcolor{keywordflow}{for} sh \textcolor{keywordflow}{in} tem.shape:
01652                 res\_shape1.append(sh)
01653             tem\_rav = tem.ravel()
01654             den\_rav = den.ravel()
01655             q = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a34711ea989baf7bde752a68255d32098}{getCollRates}(tem\_rav, n\_level)
01656             A = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[:n\_level, :n\_level]
01657             pop\_result = np.zeros(res\_shape\_rav1)
01658             coeff\_matrix = np.ones(res\_shape\_rav2)
01659             sum\_q\_up = np.zeros(res\_shape\_rav1)
01660             sum\_q\_down = np.zeros(res\_shape\_rav1)
01661             sum\_A = A.sum(axis=1)
01662             n\_tem = tem\_rav.size
01663             \textcolor{comment}{# Following line changed 29/11/2012. It made the code crash when atom\_nlevels diff coll\_nlevels}
01664             \textcolor{comment}{#Atem = np.outer(self.\_A, np.ones(n\_tem)).reshape(n\_level, n\_level, n\_tem)}
01665             Atem = np.outer(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\_A}[:n\_level, :n\_level], np.ones(n\_tem)).reshape(n\_level, n\_level, n\_tem)
01666             self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\_critDensity} = Atem.sum(axis=1) / q.sum(axis=1)
01667 
01668             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, n\_level):
01669                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i + 1, n\_level):
01670                     sum\_q\_up[i] = sum\_q\_up[i] + q[i, j]
01671                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(0, i):
01672                     sum\_q\_down[i] = sum\_q\_down[i] + q[i, j]
01673             \textcolor{keywordflow}{for} row \textcolor{keywordflow}{in} range(1, n\_level):
01674                 \textcolor{comment}{# upper right half            }
01675                 \textcolor{keywordflow}{for} col \textcolor{keywordflow}{in} range(row + 1, n\_level):
01676                     coeff\_matrix[row, col] = den\_rav * q[col, row] + A[col, row]
01677                 \textcolor{comment}{# lower left half}
01678                 \textcolor{keywordflow}{for} col \textcolor{keywordflow}{in} range(0, row):
01679                     coeff\_matrix[row, col] = den\_rav * q[col, row]
01680                 \textcolor{comment}{# diagonal}
01681                 coeff\_matrix[row, row] = -(den\_rav * (sum\_q\_up[row] + sum\_q\_down[row]) + sum\_A[row])
01682 
01683             vect = np.zeros(n\_level)
01684             vect[0] = 1.
01685             
01686             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(tem.size):
01687                 \textcolor{keywordflow}{try}:
01688                     pop\_result[:, i] = \hyperlink{namespacepyneb_1_1utils_1_1misc_aa5d9daf83958e9b6bd123954d495e94c}{solve}(np.squeeze(coeff\_matrix[:, :, i]), vect)
01689                 \textcolor{keywordflow}{except} np.linalg.LinAlgError:
01690                     pop\_result[:, i] = np.nan
01691                 \textcolor{keywordflow}{except}:
01692                     self.log\_.error(\textcolor{stringliteral}{'Error solving population matrix'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
01693             
01694             pop = np.squeeze(pop\_result.reshape(res\_shape1))
01695             
01696         \textcolor{keywordflow}{return} pop
01697 
    
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a494480eb44909d9a13ed1fb2e808b4a2}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Sources@{get\-Sources}}
\index{get\-Sources@{get\-Sources}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Sources}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Sources (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a494480eb44909d9a13ed1fb2e808b4a2}


Definition at line \hyperlink{pynebcore_8py_source_l01516}{1516} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01238}{pyneb.\-core.\-pynebcore.\-Atom.\-Atom\-Data}, and \hyperlink{pynebcore_8py_source_l01266}{pyneb.\-core.\-pynebcore.\-Atom.\-Coll\-Data}.



Referenced by \hyperlink{pn__chianti_8py_source_l00581}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-print\-Sources()}, and \hyperlink{pynebcore_8py_source_l01511}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Sources()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01516}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a494480eb44909d9a13ed1fb2e808b4a2}{01516} 
01517     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a494480eb44909d9a13ed1fb2e808b4a2}{getSources}(self):
01518         sources = []
01519         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{AtomData} \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{CollData}:
01520             sources.extend(self.AtomData.getSources())
01521             sources.extend(self.CollData.getSources())
01522         \textcolor{keywordflow}{else}:
01523             sources.extend(self.AtomData.getSources())
01524         \textcolor{keywordflow}{return} sources
    
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Tem\-Den@{get\-Tem\-Den}}
\index{get\-Tem\-Den@{get\-Tem\-Den}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Tem\-Den}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Den (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\-\_\-ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i2 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\-Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily 'nsect\-\_\-recur'}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{end\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}, }
\item[{}]{n\-Cut = {\ttfamily 30}, }
\item[{}]{max\-Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}
\begin{DoxyVerb}Return either the temperature or the density given the other variable for a selected line ratio 
    of known intensity.
The line ratio can involve two or more than two lines. 
In the first case (only two lines), it can be specified giving either two transitions 
    (four atomic levels, i.e. two for each transition), or two wavelengths.
In the general case (any number of lines), it can be specified as an algebraic expression 
    to be evaluated, involving either atomic levels or wavelengths.
An array of values, rather than a single value, can also be given, in which case the result 
    will also be an array.
    
Usage: 
    O3.getTemDen(150., den=100., wave1=5007, wave2=4363, maxError=1.e-2)
    O3.getTemDen(150., den=100., to_eval = '(I(4,3) + I(4,2) + I(4,1)) / I(5,4)')
    N2.getTemDen(150., den=100., to_eval = '(L(6584) + L(6548)) / L(5755)')
    O3.getTemDen([0.02, 0.04], den=[1.e4, 1.1e4], to_eval="I(5, 4) / (I(4, 3) + I(4, 2))")

Parameters:
    - int_ratio    intensity ratio of the selected transition
    - tem          electronic temperature
    - den          electronic density
    - lev_i1       upper level of 1st transition
    - lev_j1       lower level of 1st transition
    - lev_i2       upper level of 2nd transition
    - lev_j2       lower level of 2nd transition
    - wave1        wavelength of 1st transition
    - wave2        wavelength of 2nd transition
    - maxError     tolerance on difference between input and computed ratio 
    - method       numerical method for finding the root (nsect_recur, nsect_iter)
    - log          switch of log (default = True). start_x and end_x are using this parameter.
    - start_x      lower end of the interval to explore. (default: lower end of collision 
            strength temperature array for temperature, 1 if density)
    - end_x        higher end of the interval to explore. (default: higher end of collision 
            strength temperature array for temperature, 1e8 if density)
    - to_eval      expression to be evaluated, using either I (for transitions identified 
            through atomic levels) or L (for transitions identified through wavelengths)
    - nCut        number of sections in which each step is cut. 2 would be dichotomy.
    - maxIter     maximum number of iterations\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02126}{2126} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, and \hyperlink{pynebcore_8py_source_l02046}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P()}.



Referenced by \hyperlink{pynebcore_8py_source_l02046}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P()}, \hyperlink{pynebcore_8py_source_l01742}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Density\-Range()}, and \hyperlink{pynebcore_8py_source_l02324}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Tem\-Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02126}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{02126} 
02127                   to\_eval=\textcolor{keywordtype}{None}, nCut=30, maxIter=20):
02128         \textcolor{stringliteral}{"""}
02129 \textcolor{stringliteral}{        Return either the temperature or the density given the other variable for a selected line ratio }
02130 \textcolor{stringliteral}{            of known intensity.}
02131 \textcolor{stringliteral}{        The line ratio can involve two or more than two lines. }
02132 \textcolor{stringliteral}{        In the first case (only two lines), it can be specified giving either two transitions }
02133 \textcolor{stringliteral}{            (four atomic levels, i.e. two for each transition), or two wavelengths.}
02134 \textcolor{stringliteral}{        In the general case (any number of lines), it can be specified as an algebraic expression }
02135 \textcolor{stringliteral}{            to be evaluated, involving either atomic levels or wavelengths.}
02136 \textcolor{stringliteral}{        An array of values, rather than a single value, can also be given, in which case the result }
02137 \textcolor{stringliteral}{            will also be an array.}
02138 \textcolor{stringliteral}{            }
02139 \textcolor{stringliteral}{        Usage: }
02140 \textcolor{stringliteral}{            O3.getTemDen(150., den=100., wave1=5007, wave2=4363, maxError=1.e-2)}
02141 \textcolor{stringliteral}{            O3.getTemDen(150., den=100., to\_eval = '(I(4,3) + I(4,2) + I(4,1)) / I(5,4)')}
02142 \textcolor{stringliteral}{            N2.getTemDen(150., den=100., to\_eval = '(L(6584) + L(6548)) / L(5755)')}
02143 \textcolor{stringliteral}{            O3.getTemDen([0.02, 0.04], den=[1.e4, 1.1e4], to\_eval="I(5, 4) / (I(4, 3) + I(4, 2))")}
02144 \textcolor{stringliteral}{}
02145 \textcolor{stringliteral}{        Parameters:}
02146 \textcolor{stringliteral}{            - int\_ratio    intensity ratio of the selected transition}
02147 \textcolor{stringliteral}{            - tem          electronic temperature}
02148 \textcolor{stringliteral}{            - den          electronic density}
02149 \textcolor{stringliteral}{            - lev\_i1       upper level of 1st transition}
02150 \textcolor{stringliteral}{            - lev\_j1       lower level of 1st transition}
02151 \textcolor{stringliteral}{            - lev\_i2       upper level of 2nd transition}
02152 \textcolor{stringliteral}{            - lev\_j2       lower level of 2nd transition}
02153 \textcolor{stringliteral}{            - wave1        wavelength of 1st transition}
02154 \textcolor{stringliteral}{            - wave2        wavelength of 2nd transition}
02155 \textcolor{stringliteral}{            - maxError     tolerance on difference between input and computed ratio }
02156 \textcolor{stringliteral}{            - method       numerical method for finding the root (nsect\_recur, nsect\_iter)}
02157 \textcolor{stringliteral}{            - log          switch of log (default = True). start\_x and end\_x are using this parameter.}
02158 \textcolor{stringliteral}{            - start\_x      lower end of the interval to explore. (default: lower end of collision }
02159 \textcolor{stringliteral}{                            strength temperature array for temperature, 1 if density)}
02160 \textcolor{stringliteral}{            - end\_x        higher end of the interval to explore. (default: higher end of collision }
02161 \textcolor{stringliteral}{                            strength temperature array for temperature, 1e8 if density)}
02162 \textcolor{stringliteral}{            - to\_eval      expression to be evaluated, using either I (for transitions identified }
02163 \textcolor{stringliteral}{                            through atomic levels) or L (for transitions identified through wavelengths)}
02164 \textcolor{stringliteral}{            - nCut        number of sections in which each step is cut. 2 would be dichotomy.}
02165 \textcolor{stringliteral}{            - maxIter     maximum number of iterations}
02166 \textcolor{stringliteral}{}
02167 \textcolor{stringliteral}{        """}        
02168         \textcolor{keywordflow}{if} config.\_use\_mp:
02169             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3a7c4f43d58a5988d04cbe23ed9593ba}{\_getTemDen\_MP}(int\_ratio=int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, 
      lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
02170                   wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, start\_x=start\_x,
02171                   end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)
02172         \textcolor{keywordflow}{else}:
02173             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad1d75f64b27a6acee079b5738b69dabe}{\_getTemDen\_1}(int\_ratio=int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, 
      lev\_j1=lev\_j1, lev\_i2=lev\_i2, lev\_j2=lev\_j2,
02174                   wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, start\_x=start\_x,
02175                   end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Transition@{get\-Transition}}
\index{get\-Transition@{get\-Transition}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Transition}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{wave, }
\item[{}]{max\-Error\-A = {\ttfamily 5.e-\/3}, }
\item[{}]{max\-Errorm = {\ttfamily 5.e-\/2}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}
\begin{DoxyVerb}Return the indexes (upper level, lower level) of a transition for a given atom 
    from the wavelength.

Usage:
    O3.getTransition(4959)
    
Parameters:
    - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') 
or in micron (a label: '51.5m')
    - maxErrorA: tolerance if the input wavelength is in Angstrom
    - maxErrorm: tolerance if the input wavelength is in micron\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01472}{1472} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01433}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Transition()}.



Referenced by \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l01537}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-A()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l02990}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l01719}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-High\-Dens\-Ratio()}, \hyperlink{pynebcore_8py_source_l02176}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Ion\-Abundance()}, \hyperlink{pynebcore_8py_source_l01698}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Low\-Dens\-Ratio()}, \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}, and \hyperlink{pynebcore_8py_source_l02384}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Emiss()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01472}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{01472} 
01473     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(self, wave, maxErrorA = 5.e-3, maxErrorm = 5.e-2):
01474         \textcolor{stringliteral}{"""}
01475 \textcolor{stringliteral}{        Return the indexes (upper level, lower level) of a transition for a given atom }
01476 \textcolor{stringliteral}{            from the wavelength.}
01477 \textcolor{stringliteral}{        }
01478 \textcolor{stringliteral}{        Usage:}
01479 \textcolor{stringliteral}{            O3.getTransition(4959)}
01480 \textcolor{stringliteral}{            }
01481 \textcolor{stringliteral}{        Parameters:}
01482 \textcolor{stringliteral}{            - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') }
01483 \textcolor{stringliteral}{                or in micron (a label: '51.5m')}
01484 \textcolor{stringliteral}{            - maxErrorA: tolerance if the input wavelength is in Angstrom}
01485 \textcolor{stringliteral}{            - maxErrorm: tolerance if the input wavelength is in micron}
01486 \textcolor{stringliteral}{                }
01487 \textcolor{stringliteral}{        """} 
01488         res = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\_Transition}(wave, maxErrorA = maxErrorA, maxErrorm = maxErrorm)
01489         return(res[0], res[1])
01490         

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!plot\-Emiss@{plot\-Emiss}}
\index{plot\-Emiss@{plot\-Emiss}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{plot\-Emiss}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Emiss (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem\-\_\-min = {\ttfamily 1000}, }
\item[{}]{tem\-\_\-max = {\ttfamily 30000}, }
\item[{}]{ionic\-\_\-abund = {\ttfamily 1.0}, }
\item[{}]{den = {\ttfamily 1e3}, }
\item[{}]{style = {\ttfamily '-\/'}, }
\item[{}]{legend\-\_\-loc = {\ttfamily 4}, }
\item[{}]{tem\-Log = {\ttfamily False}, }
\item[{}]{plot\-\_\-total = {\ttfamily False}, }
\item[{}]{plot\-\_\-only\-\_\-total = {\ttfamily False}, }
\item[{}]{legend = {\ttfamily True}, }
\item[{}]{total\-\_\-color = {\ttfamily 'black'}, }
\item[{}]{total\-\_\-label = {\ttfamily 'TOTAL'}, }
\item[{}]{ax = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}
\begin{DoxyVerb}Plot the emissivity as a function of temperature of all the lines of the selected atom.  

Usage: 
    O3.plotEmiss(tem_min=10000, tem_max=20000)

Parameters:
    - tem_min         minimum value of the temperature range to span (default=1000)
    - tem_max         maximum value of the temperature range to span (default=30000)
    - ionic_abund     relative ionic abundance (default = 1.0)
    - den             electron density
    - style           line style of the plot (default: '-' [solid line])
    - legend_loc      localization of the legend (default: 4 = lower right; see plt.legend 
                for more details)
    - temLog          linear (False) or logarithmic temperature axis (default = False)
    - plot_total      flag to also plot total emissivity (default = False)
    - plot_only_total flag to only plot total emissivity (default = False)
    - legend          flag to place legend (default = True)
    - total_color     color of the total emissivity (default = 'black')
    - total_label     label of the total emissivity (default = 'TOTAL')
    - ax              axis where to send the plot. If None, a new axis is done\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02384}{2384} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l01472}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Transition()}, \hyperlink{pynebcore_8py_source_l01310}{pyneb.\-core.\-pynebcore.\-Atom.\-line\-List}, \hyperlink{pynebcore_8py_source_l00069}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00098}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00319}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00586}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00933}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-N\-Levels}, and \hyperlink{pynebcore_8py_source_l01231}{pyneb.\-core.\-pynebcore.\-Atom.\-N\-Levels}.



Referenced by \hyperlink{pynebcore_8py_source_l02324}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Tem\-Den()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02384}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_adc2de658da17347204f430aff728650b}{02384} 
02385                   total\_color=\textcolor{stringliteral}{'black'}, total\_label=\textcolor{stringliteral}{'TOTAL'}, ax=\textcolor{keywordtype}{None}):
02386         \textcolor{stringliteral}{""" }
02387 \textcolor{stringliteral}{        Plot the emissivity as a function of temperature of all the lines of the selected atom.  }
02388 \textcolor{stringliteral}{}
02389 \textcolor{stringliteral}{        Usage: }
02390 \textcolor{stringliteral}{            O3.plotEmiss(tem\_min=10000, tem\_max=20000)}
02391 \textcolor{stringliteral}{        }
02392 \textcolor{stringliteral}{        Parameters:}
02393 \textcolor{stringliteral}{            - tem\_min         minimum value of the temperature range to span (default=1000)}
02394 \textcolor{stringliteral}{            - tem\_max         maximum value of the temperature range to span (default=30000)}
02395 \textcolor{stringliteral}{            - ionic\_abund     relative ionic abundance (default = 1.0)}
02396 \textcolor{stringliteral}{            - den             electron density}
02397 \textcolor{stringliteral}{            - style           line style of the plot (default: '-' [solid line])}
02398 \textcolor{stringliteral}{            - legend\_loc      localization of the legend (default: 4 = lower right; see plt.legend }
02399 \textcolor{stringliteral}{                                for more details)}
02400 \textcolor{stringliteral}{            - temLog          linear (False) or logarithmic temperature axis (default = False)}
02401 \textcolor{stringliteral}{            - plot\_total      flag to also plot total emissivity (default = False)}
02402 \textcolor{stringliteral}{            - plot\_only\_total flag to only plot total emissivity (default = False)}
02403 \textcolor{stringliteral}{            - legend          flag to place legend (default = True)}
02404 \textcolor{stringliteral}{            - total\_color     color of the total emissivity (default = 'black')}
02405 \textcolor{stringliteral}{            - total\_label     label of the total emissivity (default = 'TOTAL')}
02406 \textcolor{stringliteral}{            - ax              axis where to send the plot. If None, a new axis is done}
02407 \textcolor{stringliteral}{}
02408 \textcolor{stringliteral}{        """}
02409         \textcolor{keywordflow}{if} ax \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
02410             f, ax = plt.subplots()
02411         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} config.INSTALLED[\textcolor{stringliteral}{'plt'}]: 
02412             log\_.error(\textcolor{stringliteral}{'Matplotlib not available, no plot'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.plot'})
02413             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02414         tem = np.logspace(np.log10(tem\_min), np.log10(tem\_max), 1000)
02415         total\_emis = np.zeros\_like(tem)
02416         \textcolor{keywordflow}{for} wave \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList}:
02417             lev\_i, lev\_j = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7c9f17a3d9e841267add92377d9d1ede}{getTransition}(wave)
02418             \textcolor{keywordflow}{if} (lev\_i <= self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}) \textcolor{keywordflow}{and} (lev\_j <= self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}):
02419                 color = ((np.log10(wave) - np.log10(np.min(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList}))) / 
02420                          (np.log10(np.max(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList})) - np.log10(np.min(self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{lineList})))) ** 0.4
02421                 c = cm.jet(color, 1)
02422                 \textcolor{keywordflow}{if} temLog:
02423                     x\_to\_plot = np.log10(tem)
02424                 \textcolor{keywordflow}{else}:
02425                     x\_to\_plot = tem
02426                 y\_to\_plot = ionic\_abund * self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, wave=wave)
02427                 \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} plot\_only\_total:
02428                     \textcolor{keywordflow}{if} (y\_to\_plot[0] > 0.):
02429                         ax.plot(x\_to\_plot, np.log10(y\_to\_plot),
02430                              label=\textcolor{stringliteral}{'\{0:.0f\}'}.format(wave), color=c, linestyle=style)
02431                 total\_emis += y\_to\_plot
02432         \textcolor{keywordflow}{if} plot\_total:
02433             ax.plot(x\_to\_plot, np.log10(total\_emis),
02434                      label=total\_label, color=total\_color, linewidth=3, linestyle=style)
02435         \textcolor{keywordflow}{if} legend:
02436             ax.legend(loc=legend\_loc)
02437         \textcolor{keywordflow}{if} temLog:
02438             ax.set\_xlabel(\textcolor{stringliteral}{'log(T[K])'})
02439         \textcolor{keywordflow}{else}:
02440             ax.set\_xlabel(\textcolor{stringliteral}{'T[K]'})
02441         ax.set\_ylabel(\textcolor{stringliteral}{'log [erg.cm3/s]'})
02442         ax.set\_title(\textcolor{stringliteral}{'Line emissivities'})

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!plot\-Grotrian@{plot\-Grotrian}}
\index{plot\-Grotrian@{plot\-Grotrian}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{plot\-Grotrian}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem = {\ttfamily 1e4}, }
\item[{}]{den = {\ttfamily 1e2}, }
\item[{}]{thresh\-\_\-int = {\ttfamily 1e-\/3}, }
\item[{}]{unit = {\ttfamily 'eV'}, }
\item[{}]{detailed = {\ttfamily False}, }
\item[{}]{ax = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}
\begin{DoxyVerb}Draw a Grotrian plot of the selected atom, labelling only lines above a
pecified intensity threshold (relative to the most intense line). 
For ground state levels, the Russell-Saunders term symbol is also given.

Usage:
    O3.plotGrotrian()

Parameters:
    - tem          temperature at which the intensity threshold is to be computed 
    - den          density at which the intensity threshold is to be computed 
    - thresh_int   intensity threshold (relative to the most intense line, default: 1.e-3)
    - unit         one of 'eV' (default), '1/Ang' or 'Ryd'
    - ax           axis where to plot the result\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02443}{2443} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{emis_grid_8py_source_l00051}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-atom}, \hyperlink{pynebcore_8py_source_l00089}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00310}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l00576}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-atom}, \hyperlink{pynebcore_8py_source_l00926}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-atom}, \hyperlink{pynebcore_8py_source_l01162}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-atom}, \hyperlink{pynebcore_8py_source_l01218}{pyneb.\-core.\-pynebcore.\-Atom.\-atom}, \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{emis_grid_8py_source_l00048}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-elem}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l00577}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00927}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l01163}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-elem}, \hyperlink{pynebcore_8py_source_l01219}{pyneb.\-core.\-pynebcore.\-Atom.\-elem}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l00066}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-Energy}, \hyperlink{pynebcore_8py_source_l01256}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Energy}, \hyperlink{pynebcore_8py_source_l00065}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l01255}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Stat\-Weight}, \hyperlink{pynebcore_8py_source_l00137}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-gs}, \hyperlink{pynebcore_8py_source_l00418}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-gs}, \hyperlink{pynebcore_8py_source_l01295}{pyneb.\-core.\-pynebcore.\-Atom.\-gs}, \hyperlink{misc_8py_source_l00055}{pyneb.\-utils.\-misc.\-int\-\_\-to\-\_\-roman()}, \hyperlink{pynebcore_8py_source_l00398}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-N\-I\-S\-T}, \hyperlink{pynebcore_8py_source_l01303}{pyneb.\-core.\-pynebcore.\-Atom.\-N\-I\-S\-T}, \hyperlink{pynebcore_8py_source_l00069}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00098}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00319}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00586}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00933}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l01231}{pyneb.\-core.\-pynebcore.\-Atom.\-N\-Levels}, \hyperlink{emis_grid_8py_source_l00049}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-spec}, \hyperlink{pynebcore_8py_source_l00091}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00312}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l00578}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00928}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-spec}, \hyperlink{pynebcore_8py_source_l01220}{pyneb.\-core.\-pynebcore.\-Atom.\-spec}, \hyperlink{pynebcore_8py_source_l00064}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-wave\-\_\-\-Ang}, \hyperlink{pynebcore_8py_source_l00172}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-wave\-\_\-\-Ang}, \hyperlink{pynebcore_8py_source_l00438}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-wave\-\_\-\-Ang}, and \hyperlink{pynebcore_8py_source_l01254}{pyneb.\-core.\-pynebcore.\-Atom.\-wave\-\_\-\-Ang}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02443}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{02443} 
02444     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ad18adec8faaf694fbff55656efea719d}{plotGrotrian}(self, tem=1e4, den=1e2, thresh\_int=1e-3, unit='eV', detailed=False, 
      ax=None):
02445         \textcolor{stringliteral}{"""}
02446 \textcolor{stringliteral}{        Draw a Grotrian plot of the selected atom, labelling only lines above a}
02447 \textcolor{stringliteral}{        pecified intensity threshold (relative to the most intense line). }
02448 \textcolor{stringliteral}{        For ground state levels, the Russell-Saunders term symbol is also given.}
02449 \textcolor{stringliteral}{        }
02450 \textcolor{stringliteral}{        Usage:}
02451 \textcolor{stringliteral}{            O3.plotGrotrian()}
02452 \textcolor{stringliteral}{        }
02453 \textcolor{stringliteral}{        Parameters:}
02454 \textcolor{stringliteral}{            - tem          temperature at which the intensity threshold is to be computed }
02455 \textcolor{stringliteral}{            - den          density at which the intensity threshold is to be computed }
02456 \textcolor{stringliteral}{            - thresh\_int   intensity threshold (relative to the most intense line, default: 1.e-3)}
02457 \textcolor{stringliteral}{            - unit         one of 'eV' (default), '1/Ang' or 'Ryd'}
02458 \textcolor{stringliteral}{            - ax           axis where to plot the result}
02459 \textcolor{stringliteral}{}
02460 \textcolor{stringliteral}{        """}
02461         \textcolor{keywordflow}{if} ax \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
02462             f, ax = plt.subplots()
02463         \textcolor{keywordflow}{if} unit \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} [\textcolor{stringliteral}{'eV'}, \textcolor{stringliteral}{'Ryd'}, \textcolor{stringliteral}{'1/Ang'}]:
02464             log\_.error(\textcolor{stringliteral}{'Unit \{0\} not available'}.format(unit))
02465             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02466         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} config.INSTALLED[\textcolor{stringliteral}{'plt'}]: 
02467             log\_.error(\textcolor{stringliteral}{'Matplotlib not available, no plot'}, calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.plot'})
02468             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
02469         color\_list = [\textcolor{stringliteral}{'b'}, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r', '}y', 'c', 'm', 'g']
02470         energies = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(unit=unit)
02471          
02472         \textcolor{comment}{# VL 16 Jul 2013 - Detect level inversion, just for warning        }
02473         level\_multiplet = [0]
02474         multiplets = []
02475         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST} \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
02476             term = []; j = []; en = []
02477             \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST}:
02478                 term.append(item[1])
02479                 j.append(item[2])
02480                 en.append(item[3])
02481             sorted\_indx = np.argsort(en) 
02482             term = np.array(term)[sorted\_indx]
02483             j = np.array(j)[sorted\_indx]
02484             en = np.array(en)[sorted\_indx]
02485             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(1, len(en)):
02486                 \textcolor{keywordflow}{if} (term[i] == term[i-1]):
02487                     level\_multiplet.append(i)
02488                 \textcolor{keywordflow}{else}:
02489                     multiplets.append(level\_multiplet) 
02490                     level\_multiplet = [i]
02491             multiplets.append(level\_multiplet) \textcolor{comment}{# append last multiplet}
02492 \textcolor{comment}{# Mistakenly rounds off fractional J values. Corrected 26/12/2014            }
02493 \textcolor{comment}{#            levelLabels = ['$^\{\{\{0\}\}\}$\{1\}$\_\{\{\{2:.0f\}\}\}$'.format(l['term'][0],l['term'][1],l['J']) for l in
       self.NIST]}
02494             levelLabels = [\textcolor{stringliteral}{'$^\{\{\{0\}\}\}$\{1\}$\_\{\{\{2\}/\{3\}\}\}$'}.format(l[\textcolor{stringliteral}{'term'}][0], l[\textcolor{stringliteral}{'term'}][1], Fraction(l[\textcolor{stringliteral}{'J'}]
      ).numerator, Fraction(l[\textcolor{stringliteral}{'J'}]).denominator) \textcolor{keywordflow}{for} l \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{NIST}]
02495         \textcolor{keywordflow}{else}:
02496             delta\_e\_max = 1.e-5  \textcolor{comment}{# Arbitrary limit to define hyperfine structure and identify multiplets }
02497             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(1, len(energies)):
02498                 \textcolor{keywordflow}{if} (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}()[i] - self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}()[i - 1] < delta\_e\_max):
02499                     \textcolor{comment}{# if levels close, append level to multiplet}
02500                     level\_multiplet.append(i) 
02501                 \textcolor{keywordflow}{else}:
02502                     \textcolor{comment}{# if levels separated, add current multiplet to array and start a new multiplet}
02503                     multiplets.append(level\_multiplet) 
02504                     level\_multiplet = [i]
02505             multiplets.append(level\_multiplet) \textcolor{comment}{# append last multiplet}
02506             warn\_label = []
02507             levelLabels = gsLevelDict[self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs}]
02508             \textcolor{keywordflow}{for} i\_multi \textcolor{keywordflow}{in} np.arange(len(multiplets)):
02509                 stat\_weights = []
02510                 \textcolor{comment}{# check each multiplet for inversion separately}
02511                 \textcolor{keywordflow}{for} i\_level \textcolor{keywordflow}{in} multiplets[i\_multi]:
02512                     latex\_sw = levelLabels[i\_level]
02513                     sw = eval(latex\_sw.split(\textcolor{stringliteral}{'$'})[-2].replace(\textcolor{stringliteral}{'\_'}, \textcolor{stringliteral}{''}).replace(\textcolor{stringliteral}{'\{'}, \textcolor{stringliteral}{''}).replace(\textcolor{stringliteral}{'\}'}, \textcolor{stringliteral}{'.'}) +
       \textcolor{stringliteral}{'*2.+1.'})
02514                     stat\_weights.append(sw)
02515                 \textcolor{keywordflow}{if} (stat\_weights != [self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}()[k] \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} multiplets[i\_multi]]):
02516                     warn\_label.append(i\_multi)
02517                     to\_print = \textcolor{stringliteral}{'\(\backslash\)nLevel inversion in multiplet \{0\} of \{1\}'}\(\backslash\)
02518                              \textcolor{stringliteral}{'\(\backslash\)nThe labels of levels \{2\} are displayed in the wrong order'} + \(\backslash\)
02519                              \textcolor{stringliteral}{'\(\backslash\)nAssumed statistical weights: \{3\}'} + \(\backslash\)
02520                              \textcolor{stringliteral}{'\(\backslash\)nStatistical weights of data: \{4\}\(\backslash\)n'}
02521                     log\_.warn(to\_print.format(i\_multi + 1, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{atom}, multiplets[i\_multi], 
02522                                                  stat\_weights, [self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{getStatWeight}()[k] \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} multiplets[i\_multi]]), 
02523                                  calling=self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling} + \textcolor{stringliteral}{'.plot'})
02524 
02525         \textcolor{comment}{# where level starts in the plot}
02526        
02527         x\_span = 0.75
02528         x\_0 = (1 - x\_span) / 4.    
02529         dx = 0.005
02530         max\_en = np.max(energies)
02531         blow = 0.02 * max\_en \textcolor{comment}{# blowup scale for multiplets}
02532         ax.set\_xlim((0, 1.))
02533         ax.set\_ylim((np.max(energies) * -0.05, max\_en * 1.05))
02534         ax.set\_title(\textcolor{stringliteral}{'[\{0\} \{1\}]'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem}, \hyperlink{namespacepyneb_1_1utils_1_1misc_a7a4c4b4ba1c884da72e0ea05aa8fb90b}{int\_to\_roman}(self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec})))
02535 
02536         \textcolor{comment}{# Blow up of multiplets in the plot}
02537         i\_tot = 0
02538         \textcolor{keywordflow}{for} i\_multi \textcolor{keywordflow}{in} np.arange(len(multiplets)):
02539             shift = (1-len(multiplets[i\_multi])) / 2.
02540             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(len(multiplets[i\_multi])):
02541                 y = energies[multiplets[i\_multi][i]] + shift * blow
02542                 ax.plot([x\_0, 1.5 * x\_0, 1.6 * x\_0, x\_0 + x\_span], 
02543                          [y, y, energies[multiplets[i\_multi][i]], 
02544                           energies[multiplets[i\_multi][i]]], lw = 1.2, 
02545                          color = color\_list[np.mod(multiplets[i\_multi][i], len(color\_list))])
02546                 ax.text(x\_span + x\_0 + dx, y, \textcolor{stringliteral}{'\{0:7.4f\}'}.format(energies[multiplets[i\_multi][i]]), size=\textcolor{stringliteral}{'
      small'}, 
02547                          horizontalalignment=\textcolor{stringliteral}{'left'}, verticalalignment=\textcolor{stringliteral}{'center'})
02548                 \textcolor{keywordflow}{try}:
02549                     \textcolor{keywordflow}{if} (detailed \textcolor{keywordflow}{is} \textcolor{keyword}{False}):
02550                         ax.text(dx, y, levelLabels[i\_tot], size=\textcolor{stringliteral}{'medium'}, verticalalignment=\textcolor{stringliteral}{'center'})
02551                     \textcolor{keywordflow}{else}:
02552                         ax.text(dx, y, str(i\_tot+1) + \textcolor{stringliteral}{": "} + levelLabels[i\_tot] , size=\textcolor{stringliteral}{'medium'}, 
      verticalalignment=\textcolor{stringliteral}{'center'}, color = color\_list[np.mod(multiplets[i\_multi][i], len(color\_list))])
02553                     i\_tot += 1
02554                 \textcolor{keywordflow}{except}:
02555                     \textcolor{keywordflow}{pass}
02556                 shift += 1
02557         ax.text(1 - dx / 2., max(energies) * 0.5, \textcolor{stringliteral}{'E [\{0:s\}] '}.format(unit), horizontalalignment=\textcolor{stringliteral}{'right'}, 
      color=\textcolor{stringliteral}{'blue'})
02558         plt.xlabel(\textcolor{stringliteral}{'Ground-state configuration: \{0\}'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{gs}), color=\textcolor{stringliteral}{"#004400"})
02559                
02560         ax.xaxis.set\_ticks\_position(\textcolor{stringliteral}{"none"})
02561         ax.yaxis.set\_ticks\_position(\textcolor{stringliteral}{"none"})
02562         ax.xaxis.set\_ticklabels([])
02563         ax.yaxis.set\_ticklabels([])
02564         
02565         emis\_max = np.max(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den))
02566         N\_lines = (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(1e4, 1e3) > (emis\_max * thresh\_int)).sum() \textcolor{comment}{# number of
       lines plotted}
02567         x\_pad = 0.1 * (x\_span - 0.6 * x\_0)     
02568         \textcolor{keywordflow}{if} N\_lines > 1:
02569             delta\_x = (x\_span - 2 * x\_pad) / (N\_lines - 1)
02570             x = 1.6 * x\_0 + 0.5 * x\_pad
02571         \textcolor{keywordflow}{else}:
02572             delta\_x = 0
02573             x = (1.6 * x\_0 + x\_span) / 2.
02574         cc = colors.ColorConverter()
02575         \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} np.arange(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels} - 1) + 2:
02576             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(j - 1) + 1:
02577                 emis = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den, j, i)
02578                 \textcolor{keywordflow}{if} emis > (emis\_max * thresh\_int):
02579                     N\_seg = 1000. \textcolor{comment}{#number of segments to draw emission line, to make it look smooth}
02580                     xx = np.ones(N\_seg+1) * x  \textcolor{comment}{# x coord of segmente making up one line}
02581                     yy = np.linspace(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(i, unit=unit), self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(j, unit=unit), N\_seg+1)
02582                     scale = np.linspace(0, 1, N\_seg+1)
02583                     alpha =  np.tanh((2*scale-1)+1)  \textcolor{comment}{# to make alpha vary as a smooth step function}
02584                     points = np.array([xx, yy]).T.reshape(-1, 1, 2) 
02585                     segments = np.concatenate([points[:-1], points[1:]], axis=1) 
02586                     cmap1 = []
02587                     cmap2 = []
02588                     \textcolor{keywordflow}{for} seg \textcolor{keywordflow}{in} segments:
02589                             yy0 = seg.mean(0)[1] 
02590                             alpha0 = np.interp(yy0, yy, alpha)
02591                             rgb1 = cc.to\_rgb(color\_list[np.mod(j-1, len(color\_list))]) 
02592                             rgb2 = cc.to\_rgb(color\_list[np.mod(i-1, len(color\_list))]) 
02593                             cmap1.append([rgb1[0], rgb1[1], rgb1[2], alpha0]) 
02594                             cmap2.append([rgb2[0], rgb2[1], rgb2[2], 1-alpha0])
02595                     lc1 = LineCollection(segments, linewidths=3.5)
02596                     lc1.set\_color(cmap1) 
02597                     lc2 = LineCollection(segments, linewidths=3.5)
02598                     lc2.set\_color(cmap2) 
02599                     ax.add\_collection(lc1) 
02600                     ax.add\_collection(lc2) 
02601                     \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[j - 1, i - 1] > 1e4:
02602                         to\_print = \textcolor{stringliteral}{'\{0:.1f\}m'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[j - 1, i - 1] / 1e4) + \textcolor{stringliteral}{' '}
02603                     \textcolor{keywordflow}{else}:
02604                         to\_print = \textcolor{stringliteral}{'\{0:.1f\}A'}.format(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[j - 1, i - 1]) + \textcolor{stringliteral}{' '}
02605                     ax.text(x + 0.05 * delta\_x, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(j, unit=unit)-blow/2., to\_print, 
      size=\textcolor{stringliteral}{'small'}, rotation=90, verticalalignment=\textcolor{stringliteral}{'top'})
02606                     x = x + delta\_x
02607 
02608         \textcolor{comment}{# issue warning on plot if level inversion }
02609         \textcolor{keywordflow}{try}:
02610             \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} warn\_label:
02611                 ax.text(0, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{getEnergy}(multiplets[i][0]+1, unit=unit), \textcolor{stringliteral}{'Warning '}, ha=\textcolor{stringliteral}{'right'}, 
      color=\textcolor{stringliteral}{'red'})
02612         \textcolor{keywordflow}{except}:
02613             \textcolor{keywordflow}{pass}
02614 
    
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!print\-Ionic@{print\-Ionic}}
\index{print\-Ionic@{print\-Ionic}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{print\-Ionic}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{tem = {\ttfamily None}, }
\item[{}]{den = {\ttfamily None}, }
\item[{}]{print\-A = {\ttfamily False}, }
\item[{}]{print\-Pop = {\ttfamily True}, }
\item[{}]{print\-Crit = {\ttfamily True}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}
\begin{DoxyVerb}Print miscellaneous information (wavelengths, level populations, emissivities, 
    critical densities) for given physical conditions.
If an electron temperature is given, level critical densities can be printed 
    (using printCrit=True)
If an electron density is also given, line emissivities (also for Hbeta) are printed and level 
    populations can be printed (using printPop=True)

Usage:
    O3.printIonic()
    O3.printIonic(printA=True)
    O3.printIonic(tem=10000., printCrit=True)
    O3.printIonic(tem=10000., den=1e3, printA=True, printPop=True, printCrit=True)

Parameters:
    - tem          temperature
    - den          density
    - printA       also print transition probabilities (default=False)
    - printPop     also print level populations (needs tem and den)
    - printCrit    also print critical densities (needs tem)\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02233}{2233} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{icf_8py_source_l00016}{pyneb.\-core.\-icf.\-I\-C\-F.\-calling}, \hyperlink{emis_grid_8py_source_l00044}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-calling}, \hyperlink{pynebcore_8py_source_l00097}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-calling}, \hyperlink{diags_8py_source_l00169}{pyneb.\-core.\-diags.\-Diagnostics.\-calling}, \hyperlink{pynebcore_8py_source_l00318}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l00585}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-calling}, \hyperlink{pynebcore_8py_source_l00936}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-calling}, \hyperlink{pynebcore_8py_source_l01156}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-calling}, \hyperlink{pynebcore_8py_source_l01229}{pyneb.\-core.\-pynebcore.\-Atom.\-calling}, \hyperlink{emis_grid_8py_source_l00048}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-elem}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l00577}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00927}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l01163}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-elem}, \hyperlink{pynebcore_8py_source_l01219}{pyneb.\-core.\-pynebcore.\-Atom.\-elem}, \hyperlink{pynebcore_8py_source_l00067}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-get\-A}, \hyperlink{pynebcore_8py_source_l00212}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-get\-A()}, \hyperlink{pynebcore_8py_source_l00487}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-get\-A()}, \hyperlink{pynebcore_8py_source_l01537}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-A()}, \hyperlink{pynebcore_8py_source_l01759}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Crit\-Density()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l01562}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations()}, \hyperlink{pynebcore_8py_source_l00069}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-None.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00098}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00319}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00586}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l00933}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l01231}{pyneb.\-core.\-pynebcore.\-Atom.\-N\-Levels}, \hyperlink{pynebcore_8py_source_l02324}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Tem\-Den()}, \hyperlink{emis_grid_8py_source_l00049}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-spec}, \hyperlink{pynebcore_8py_source_l00091}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00312}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l00578}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00928}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-spec}, \hyperlink{pynebcore_8py_source_l01220}{pyneb.\-core.\-pynebcore.\-Atom.\-spec}, \hyperlink{pynebcore_8py_source_l00064}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-None.\-wave\-\_\-\-Ang}, \hyperlink{pynebcore_8py_source_l00172}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-wave\-\_\-\-Ang}, \hyperlink{pynebcore_8py_source_l00438}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-wave\-\_\-\-Ang}, and \hyperlink{pynebcore_8py_source_l01254}{pyneb.\-core.\-pynebcore.\-Atom.\-wave\-\_\-\-Ang}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02233}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{02233} 
02234     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4be768ed1460bb448207b470551ef2ed}{printIonic}(self, tem=None, den=None, printA=False, printPop=True, printCrit=True):
02235         \textcolor{stringliteral}{""" }
02236 \textcolor{stringliteral}{        Print miscellaneous information (wavelengths, level populations, emissivities, }
02237 \textcolor{stringliteral}{            critical densities) for given physical conditions.}
02238 \textcolor{stringliteral}{        If an electron temperature is given, level critical densities can be printed }
02239 \textcolor{stringliteral}{            (using printCrit=True)}
02240 \textcolor{stringliteral}{        If an electron density is also given, line emissivities (also for Hbeta) are printed and level }
02241 \textcolor{stringliteral}{            populations can be printed (using printPop=True)}
02242 \textcolor{stringliteral}{        }
02243 \textcolor{stringliteral}{        Usage:}
02244 \textcolor{stringliteral}{            O3.printIonic()}
02245 \textcolor{stringliteral}{            O3.printIonic(printA=True)}
02246 \textcolor{stringliteral}{            O3.printIonic(tem=10000., printCrit=True)}
02247 \textcolor{stringliteral}{            O3.printIonic(tem=10000., den=1e3, printA=True, printPop=True, printCrit=True)}
02248 \textcolor{stringliteral}{}
02249 \textcolor{stringliteral}{        Parameters:}
02250 \textcolor{stringliteral}{            - tem          temperature}
02251 \textcolor{stringliteral}{            - den          density}
02252 \textcolor{stringliteral}{            - printA       also print transition probabilities (default=False)}
02253 \textcolor{stringliteral}{            - printPop     also print level populations (needs tem and den)}
02254 \textcolor{stringliteral}{            - printCrit    also print critical densities (needs tem)}
02255 \textcolor{stringliteral}{}
02256 \textcolor{stringliteral}{        """}
02257         print(\textcolor{stringliteral}{'elem = %s'} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem})
02258         print(\textcolor{stringliteral}{'spec = %i'} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec})
02259         \textcolor{keywordflow}{if} tem \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
02260             print(\textcolor{stringliteral}{'temperature = %6.1f K'} % tem)
02261         \textcolor{keywordflow}{if} den \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
02262             print(\textcolor{stringliteral}{'density = %6.1f cm-3'} % den)
02263         print(\textcolor{stringliteral}{""})
02264         \textcolor{keywordflow}{if} printPop \textcolor{keywordflow}{and} ((tem \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{or} (den \textcolor{keywordflow}{is} \textcolor{keywordtype}{None})):
02265             log\_.warn(\textcolor{stringliteral}{'Cannot print populations as tem or den is missing'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02266             printPop = \textcolor{keyword}{False}
02267         \textcolor{keywordflow}{if} printCrit \textcolor{keywordflow}{and} (tem \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}):
02268             log\_.warn(\textcolor{stringliteral}{'Cannot print critical densities as tem is missing'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{calling})
02269             printCrit = \textcolor{keyword}{False}
02270         to\_print = \textcolor{stringliteral}{''}
02271         \textcolor{keywordflow}{if} printPop:
02272             to\_print += \textcolor{stringliteral}{'Level   Populations  '}
02273         \textcolor{keywordflow}{if} printCrit:
02274             to\_print += \textcolor{stringliteral}{'Critical densities'}
02275         \textcolor{keywordflow}{if} to\_print != \textcolor{stringliteral}{''}:
02276             print(to\_print)
02277         \textcolor{keywordflow}{if} printCrit:
02278             critdens = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aae95b1cb36defadad24cf94459203eb3}{getCritDensity}(tem)
02279         \textcolor{keywordflow}{if} printPop:
02280             pop = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aab7496403c8aaef40ab3b20b5c00e9f0}{getPopulations}(tem, den)
02281         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}):
02282             lev\_i = i + 1
02283             to\_print = \textcolor{stringliteral}{'Level %1i:  '} % (lev\_i)
02284             \textcolor{keywordflow}{if} printPop:
02285                 to\_print += \textcolor{stringliteral}{"%.3E  "} % (pop[i])
02286             \textcolor{keywordflow}{if} printCrit:
02287                 to\_print += \textcolor{stringliteral}{"%.3E"} % critdens[i]
02288             \textcolor{keywordflow}{if} printPop \textcolor{keywordflow}{or} printCrit:
02289                 print(to\_print)
02290         \textcolor{keywordflow}{if} printPop \textcolor{keywordflow}{or} printCrit:
02291             print(\textcolor{stringliteral}{''})
02292             
02293         \textcolor{keywordflow}{if} (tem \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (den \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}):
02294             emis = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_aaf4e84a9d5f835e6284bd9302314f775}{getEmissivity}(tem, den)
02295         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(1, self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{NLevels}):
02296             \textcolor{keywordflow}{if} printA:
02297                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02298                     to\_print = \textcolor{stringliteral}{"\{0:.3E\}   "}.format(np.float(self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4b3ea50d7c77fdf645c2cea97243c17e}{getA}(i + 1, j + 1)))
02299                     print(to\_print, end=\textcolor{stringliteral}{""})
02300                 print(\textcolor{stringliteral}{""})
02301             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02302                 \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j] > 10000.:
02303                     to\_print = \textcolor{stringliteral}{"%10.2fm "} % (self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j] / 1e4)
02304                 \textcolor{keywordflow}{else}:
02305                     to\_print = \textcolor{stringliteral}{"%10.2fA "} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{wave\_Ang}[i, j]
02306                 print(to\_print, end=\textcolor{stringliteral}{""})
02307             print(\textcolor{stringliteral}{""})
02308             \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02309                 print(\textcolor{stringliteral}{"    (%1i-->%1i) "} % (i + 1, j + 1), end=\textcolor{stringliteral}{""})
02310             print(\textcolor{stringliteral}{""})
02311             \textcolor{keywordflow}{if} (tem \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (den \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}):
02312                 \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} range(i):
02313                     print(\textcolor{stringliteral}{"  %.3E "} % emis[i,j], end=\textcolor{stringliteral}{""})
02314             print(\textcolor{stringliteral}{"\(\backslash\)n"})
02315         \textcolor{keywordflow}{if} (tem \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (den \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}):
02316             \textcolor{keywordflow}{try}:
02317                 H1 = \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_rec_atom}{RecAtom}(\textcolor{stringliteral}{'H'}, 1)
02318                 print(\textcolor{stringliteral}{"# H-beta volume emissivity:"})
02319                 print(\textcolor{stringliteral}{"%.3E N(H+) * N(e-)  (erg/s)"} % H1.getEmissivity(tem, den, 4, 2))
02320             \textcolor{keywordflow}{except}:
02321                 \textcolor{keywordflow}{pass}

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a09c7f821dd9cf7ab09477fc80906e769}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!print\-Sources@{print\-Sources}}
\index{print\-Sources@{print\-Sources}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{print\-Sources}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-print\-Sources (
\begin{DoxyParamCaption}
\item[{}]{self}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a09c7f821dd9cf7ab09477fc80906e769}


Definition at line \hyperlink{pynebcore_8py_source_l01511}{1511} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l00190}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-get\-Sources()}, \hyperlink{pynebcore_8py_source_l00460}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-get\-Sources()}, \hyperlink{pynebcore_8py_source_l00690}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-get\-Sources()}, \hyperlink{pynebcore_8py_source_l01022}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-get\-Sources()}, and \hyperlink{pynebcore_8py_source_l01516}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Sources()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01511}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a09c7f821dd9cf7ab09477fc80906e769}{01511} 
01512     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a09c7f821dd9cf7ab09477fc80906e769}{printSources}(self):
01513         
01514         \textcolor{keywordflow}{for} source \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a494480eb44909d9a13ed1fb2e808b4a2}{getSources}():
01515             print(source)    
    
\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!print\-Tem\-Den@{print\-Tem\-Den}}
\index{print\-Tem\-Den@{print\-Tem\-Den}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{print\-Tem\-Den}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-print\-Tem\-Den (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{int\-\_\-ratio, }
\item[{}]{tem = {\ttfamily -\/1}, }
\item[{}]{den = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j1 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-i2 = {\ttfamily -\/1}, }
\item[{}]{lev\-\_\-j2 = {\ttfamily -\/1}, }
\item[{}]{wave1 = {\ttfamily -\/1}, }
\item[{}]{wave2 = {\ttfamily -\/1}, }
\item[{}]{max\-Error = {\ttfamily 1.e-\/3}, }
\item[{}]{method = {\ttfamily 'nsect\-\_\-recur'}, }
\item[{}]{log = {\ttfamily True}, }
\item[{}]{start\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{end\-\_\-x = {\ttfamily -\/1}, }
\item[{}]{to\-\_\-eval = {\ttfamily None}, }
\item[{}]{n\-Cut = {\ttfamily 30}, }
\item[{}]{max\-Iter = {\ttfamily 20}}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}
\begin{DoxyVerb}Print result of getTemDen function. See getTemDen for more details.

Usage:
    O3.printTemDen(100, tem=10000, wave1=5007, wave2=4363)

Parameters:
    - int_ratio    intensity ratio of the selected transition
    - tem          electronic temperature
    - den          electronic density
    - lev_i1       upper level of 1st transition
    - lev_j1       lower level of 1st transition
    - lev_i2       upper level of 2nd transition
    - lev_j2       lower level of 2nd transition
    - wave1        wavelength of 1st transition
    - wave2        wavelength of 2nd transition
    - maxError     tolerance on difference between input and computed ratio 
    - method       numerical method for finding the root (nsect_recur, nsect_iter)
    - log          log switch (default = True)
    - start_x      lower end of the interval to explore (default: lower end of collision 
            strength temperature array)
    - end_x        higher end of the interval to explore (default: higher end of collision 
            strength temperature array)
    - to_eval      expression to be evaluated, using either I (for transitions identified through 
            atomic levels) or L (for transitions identified through wavelengths)
    - nCut        number of sections in which each step is cut. 2 would be dichotomy.
    - maxIter     maximum number of iterations\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l02324}{2324} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{emis_grid_8py_source_l00048}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-elem}, \hyperlink{pynebcore_8py_source_l00090}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00311}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l00577}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-elem}, \hyperlink{pynebcore_8py_source_l00927}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-elem}, \hyperlink{pynebcore_8py_source_l01163}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-elem}, \hyperlink{pynebcore_8py_source_l01219}{pyneb.\-core.\-pynebcore.\-Atom.\-elem}, \hyperlink{pynebcore_8py_source_l02126}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Den()}, \hyperlink{misc_8py_source_l00055}{pyneb.\-utils.\-misc.\-int\-\_\-to\-\_\-roman()}, \hyperlink{pynebcore_8py_source_l02384}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Emiss()}, \hyperlink{emis_grid_8py_source_l00049}{pyneb.\-core.\-emis\-Grid.\-Emis\-Grid.\-spec}, \hyperlink{pynebcore_8py_source_l00091}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00312}{pyneb.\-core.\-pynebcore.\-\_\-\-Atom\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l00578}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-spec}, \hyperlink{pynebcore_8py_source_l00928}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-spec}, \hyperlink{pynebcore_8py_source_l01164}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Stout.\-spec}, and \hyperlink{pynebcore_8py_source_l01220}{pyneb.\-core.\-pynebcore.\-Atom.\-spec}.



Referenced by \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l02324}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0b95239f3b76bbd0e42da220370ff866}{02324} 
02325                     nCut=30, maxIter=20):
02326         \textcolor{stringliteral}{""" }
02327 \textcolor{stringliteral}{        Print result of getTemDen function. See getTemDen for more details.}
02328 \textcolor{stringliteral}{        }
02329 \textcolor{stringliteral}{        Usage:}
02330 \textcolor{stringliteral}{            O3.printTemDen(100, tem=10000, wave1=5007, wave2=4363)}
02331 \textcolor{stringliteral}{        }
02332 \textcolor{stringliteral}{        Parameters:}
02333 \textcolor{stringliteral}{            - int\_ratio    intensity ratio of the selected transition}
02334 \textcolor{stringliteral}{            - tem          electronic temperature}
02335 \textcolor{stringliteral}{            - den          electronic density}
02336 \textcolor{stringliteral}{            - lev\_i1       upper level of 1st transition}
02337 \textcolor{stringliteral}{            - lev\_j1       lower level of 1st transition}
02338 \textcolor{stringliteral}{            - lev\_i2       upper level of 2nd transition}
02339 \textcolor{stringliteral}{            - lev\_j2       lower level of 2nd transition}
02340 \textcolor{stringliteral}{            - wave1        wavelength of 1st transition}
02341 \textcolor{stringliteral}{            - wave2        wavelength of 2nd transition}
02342 \textcolor{stringliteral}{            - maxError     tolerance on difference between input and computed ratio }
02343 \textcolor{stringliteral}{            - method       numerical method for finding the root (nsect\_recur, nsect\_iter)}
02344 \textcolor{stringliteral}{            - log          log switch (default = True)}
02345 \textcolor{stringliteral}{            - start\_x      lower end of the interval to explore (default: lower end of collision }
02346 \textcolor{stringliteral}{                            strength temperature array)}
02347 \textcolor{stringliteral}{            - end\_x        higher end of the interval to explore (default: higher end of collision }
02348 \textcolor{stringliteral}{                            strength temperature array)}
02349 \textcolor{stringliteral}{            - to\_eval      expression to be evaluated, using either I (for transitions identified through }
02350 \textcolor{stringliteral}{                            atomic levels) or L (for transitions identified through wavelengths)}
02351 \textcolor{stringliteral}{            - nCut        number of sections in which each step is cut. 2 would be dichotomy.}
02352 \textcolor{stringliteral}{            - maxIter     maximum number of iterations}
02353 \textcolor{stringliteral}{}
02354 \textcolor{stringliteral}{        """}
02355         \textcolor{keywordflow}{if} tem == -1:
02356             option = \textcolor{stringliteral}{'temperature'}
02357             assume = den
02358             assume\_str = \textcolor{stringliteral}{'density'}
02359             assume\_unit = \textcolor{stringliteral}{'cm-3'}
02360             unit = \textcolor{stringliteral}{'K'}
02361         \textcolor{keywordflow}{if} den == -1:
02362             option = \textcolor{stringliteral}{'density'}
02363             assume = tem
02364             assume\_str = \textcolor{stringliteral}{'temperature'}
02365             assume\_unit = \textcolor{stringliteral}{'K'}
02366             unit = \textcolor{stringliteral}{'cm-3'}
02367 
02368         result = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5e1aa59c92bf62bae8bd756a4405eb25}{getTemDen}(int\_ratio, tem=tem, den=den, lev\_i1=lev\_i1, lev\_j1=lev\_j1, lev\_i2=
      lev\_i2, lev\_j2=lev\_j2,
02369                                 wave1=wave1, wave2=wave2, maxError=maxError, method=method, log=log, 
      start\_x=start\_x,
02370                                 end\_x=end\_x, to\_eval=to\_eval, nCut=nCut, maxIter=maxIter)
02371         print(\textcolor{stringliteral}{'Ion = %s'} % self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{elem} + \textcolor{stringliteral}{" "} + \hyperlink{namespacepyneb_1_1utils_1_1misc_a7a4c4b4ba1c884da72e0ea05aa8fb90b}{int\_to\_roman}(self.
      \hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{spec}))
02372         print(\textcolor{stringliteral}{'Option = %s'} % option)
02373         print(\textcolor{stringliteral}{'Assumed %s = %.0f %s'} % (assume\_str, assume, assume\_unit))
02374         \textcolor{keywordflow}{if} to\_eval \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
02375             print(\textcolor{stringliteral}{'Assumed I(%i)/I(%i) ratio = %.0f'} % (wave1, wave2, int\_ratio))
02376         \textcolor{keywordflow}{else}:
02377             print(\textcolor{stringliteral}{'Assumed %s = %.0f'} % (to\_eval, int\_ratio))
02378 \textcolor{comment}{#        print 'method = %s' % method}
02379 \textcolor{comment}{#        print 'maxError on ratio %f' % maxError}
02380         print(\textcolor{stringliteral}{'Calculated %s = %.0f %s'} % (option, result, unit))
02381 

\end{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a32f644fb6c648326e3422984b614b63c}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!print\-Transition@{print\-Transition}}
\index{print\-Transition@{print\-Transition}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{print\-Transition}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-core.\-pynebcore.\-Atom.\-print\-Transition (
\begin{DoxyParamCaption}
\item[{}]{self, }
\item[{}]{wave}
\end{DoxyParamCaption}
)}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a32f644fb6c648326e3422984b614b63c}
\begin{DoxyVerb}Print info on transition associated to input wavelength.

Usage:
    O3.printTransition(4959)
    
Parameters:
    - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') 
or in micron (a label: '51.5m')\end{DoxyVerb}
 

Definition at line \hyperlink{pynebcore_8py_source_l01491}{1491} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



References \hyperlink{pynebcore_8py_source_l01433}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Transition()}.


\begin{DoxyCode}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_l01491}{}\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a32f644fb6c648326e3422984b614b63c}{01491} 
01492     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a32f644fb6c648326e3422984b614b63c}{printTransition}(self, wave):
01493         \textcolor{stringliteral}{"""}
01494 \textcolor{stringliteral}{        Print info on transition associated to input wavelength.}
01495 \textcolor{stringliteral}{        }
01496 \textcolor{stringliteral}{        Usage:}
01497 \textcolor{stringliteral}{            O3.printTransition(4959)}
01498 \textcolor{stringliteral}{            }
01499 \textcolor{stringliteral}{        Parameters:}
01500 \textcolor{stringliteral}{            - wave      wavelength in Angstrom (a float or a label: e.g., 5007, '5007A') }
01501 \textcolor{stringliteral}{                or in micron (a label: '51.5m')}
01502 \textcolor{stringliteral}{                }
01503 \textcolor{stringliteral}{        """}
01504         closestTransition = self.\hyperlink{classpyneb_1_1core_1_1pynebcore_1_1_atom_a69f29cc10c77910841f9e3ff8ddef250}{\_Transition}(wave)
01505         relativeError = closestTransition[3] / closestTransition[2] - 1
01506         print(\textcolor{stringliteral}{'Input wave: \{0:.1F\}'}.format(closestTransition[3]))
01507         print(\textcolor{stringliteral}{'Closest wave found: \{0:.1F\}'}.format(closestTransition[2]))
01508         print(\textcolor{stringliteral}{'Relative error: \{0:.0E\} '}.format(relativeError))
01509         print(\textcolor{stringliteral}{'Transition: \{0[0]\} -> \{0[1]\}'}.format(closestTransition))
01510         \textcolor{keywordflow}{return}
    
\end{DoxyCode}


\subsection{Member Data Documentation}
\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-\-A@{\-\_\-\-A}}
\index{\-\_\-\-A@{\-\_\-\-A}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-\-A}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-A\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa6416fe661b8deaa008179314727e025}


Definition at line \hyperlink{pynebcore_8py_source_l01319}{1319} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pn__chianti_8py_source_l00316}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-get\-A()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, and \hyperlink{pynebcore_8py_source_l01562}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-crit\-Density@{\-\_\-crit\-Density}}
\index{\-\_\-crit\-Density@{\-\_\-crit\-Density}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-crit\-Density}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-\_\-crit\-Density\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1d0823a36ca030fd149522fe72908631}


Definition at line \hyperlink{pynebcore_8py_source_l01619}{1619} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01759}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Crit\-Density()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-\-Energy@{\-\_\-\-Energy}}
\index{\-\_\-\-Energy@{\-\_\-\-Energy}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-\-Energy}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Energy\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a52e68715246d258bf0a14f4bd06e89e4}


Definition at line \hyperlink{pynebcore_8py_source_l01320}{1320} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l01394}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Coll\-Rates()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pn__chianti_8py_source_l00366}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-get\-Energy()}, and \hyperlink{pynebcore_8py_source_l02927}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Energy()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!\-\_\-\-Stat\-Weight@{\-\_\-\-Stat\-Weight}}
\index{\-\_\-\-Stat\-Weight@{\-\_\-\-Stat\-Weight}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{\-\_\-\-Stat\-Weight}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Stat\-Weight\hspace{0.3cm}{\ttfamily [private]}}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a1e76c66b89eb327aeb4cdb1d8bd46fb5}


Definition at line \hyperlink{pynebcore_8py_source_l01321}{1321} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01394}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Coll\-Rates()}, and \hyperlink{pn__chianti_8py_source_l00343}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-get\-Stat\-Weight()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!atom@{atom}}
\index{atom@{atom}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{atom}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-atom}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a192f3e20446d7fba81d789bc705d6c71}


Definition at line \hyperlink{pynebcore_8py_source_l01218}{1218} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02046}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P()}, \hyperlink{pynebcore_8py_source_l02754}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-load\-Fit()}, \hyperlink{pynebcore_8py_source_l02714}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-load\-H\-D\-F5()}, \hyperlink{pynebcore_8py_source_l01433}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Transition()}, \hyperlink{pynebcore_8py_source_l02812}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-\-Transition()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pn__chianti_8py_source_l00507}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega()}, \hyperlink{pynebcore_8py_source_l02851}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Tot\-Recombination()}, \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}, and \hyperlink{pynebcore_8py_source_l02912}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-print\-Sources()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!Atom\-Data@{Atom\-Data}}
\index{Atom\-Data@{Atom\-Data}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{Atom\-Data}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-Atom\-Data}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7246a8b1ce71eb9d38f580a6ca9fe09e}


Definition at line \hyperlink{pynebcore_8py_source_l01238}{1238} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01516}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Sources()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!atom\-File@{atom\-File}}
\index{atom\-File@{atom\-File}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{atom\-File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-atom\-File}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0d74c41b1e0ac1a9cd5591467769d07f}


Definition at line \hyperlink{pynebcore_8py_source_l01250}{1250} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02615}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-\_\-repr\-\_\-\-\_\-()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!atom\-File\-Type@{atom\-File\-Type}}
\index{atom\-File\-Type@{atom\-File\-Type}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{atom\-File\-Type}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-atom\-File\-Type}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_acb3c11139568e31337ac4c26d6aa57b8}


Definition at line \hyperlink{pynebcore_8py_source_l01234}{1234} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!atom\-Fits\-File@{atom\-Fits\-File}}
\index{atom\-Fits\-File@{atom\-Fits\-File}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{atom\-Fits\-File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-atom\-Fits\-File}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ada464bba6971f03f7fc1a51228b35f5d}


Definition at line \hyperlink{pynebcore_8py_source_l01252}{1252} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!atom\-Fits\-Path@{atom\-Fits\-Path}}
\index{atom\-Fits\-Path@{atom\-Fits\-Path}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{atom\-Fits\-Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-atom\-Fits\-Path}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8919c61156a1cbc2cfac6a6d9ee3b1f7}


Definition at line \hyperlink{pynebcore_8py_source_l01253}{1253} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!Atom\-Header@{Atom\-Header}}
\index{Atom\-Header@{Atom\-Header}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{Atom\-Header}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-Atom\-Header}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a5d9daf69b08c0f60714095f34d0bb0f5}


Definition at line \hyperlink{pynebcore_8py_source_l01299}{1299} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!atom\-N\-Levels@{atom\-N\-Levels}}
\index{atom\-N\-Levels@{atom\-N\-Levels}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{atom\-N\-Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-atom\-N\-Levels}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a16e5ede01345c370f0893b19ffb20c5c}


Definition at line \hyperlink{pynebcore_8py_source_l01257}{1257} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!atom\-Path@{atom\-Path}}
\index{atom\-Path@{atom\-Path}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{atom\-Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-atom\-Path}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8c2ddffd0cd3f7ce2a089e87746e909f}


Definition at line \hyperlink{pynebcore_8py_source_l01251}{1251} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!calling@{calling}}
\index{calling@{calling}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{calling}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-calling}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a373b7735acf4f528b54bddf373ad67a1}


Definition at line \hyperlink{pynebcore_8py_source_l01229}{1229} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l04007}{pyneb.\-core.\-pynebcore.\-Observation.\-\_\-\-\_\-normalize()}, \hyperlink{logging_8py_source_l00059}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-\_\-add2log()}, \hyperlink{red__corr_8py_source_l00658}{pyneb.\-extinction.\-red\-\_\-corr.\-Red\-Corr.\-\_\-\-F99\-\_\-like()}, \hyperlink{_config_8py_source_l00115}{pyneb.\-utils.\-Config.\-\_\-\-Config.\-\_\-get\-\_\-\-Pypic\-Path()}, \hyperlink{pynebcore_8py_source_l02970}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-get\-Label\-Str()}, \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l02046}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-\-M\-P()}, \hyperlink{pynebcore_8py_source_l02754}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-load\-Fit()}, \hyperlink{pynebcore_8py_source_l02714}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-load\-H\-D\-F5()}, \hyperlink{logging_8py_source_l00051}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-\_\-pprint()}, \hyperlink{red__corr_8py_source_l00176}{pyneb.\-extinction.\-red\-\_\-corr.\-Red\-Corr.\-\_\-set\-\_\-law()}, \hyperlink{pn__chianti_8py_source_l00304}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-\_\-test\-\_\-lev()}, \hyperlink{pn__chianti_8py_source_l00472}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01525}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l02672}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01433}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Transition()}, \hyperlink{pynebcore_8py_source_l02812}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-\-Transition()}, \hyperlink{pynebcore_8py_source_l03558}{pyneb.\-core.\-pynebcore.\-Observation.\-add\-Line()}, \hyperlink{pynebcore_8py_source_l03589}{pyneb.\-core.\-pynebcore.\-Observation.\-add\-Obs()}, \hyperlink{pynebcore_8py_source_l04028}{pyneb.\-core.\-pynebcore.\-Observation.\-correct\-Data()}, \hyperlink{pynebcore_8py_source_l03447}{pyneb.\-core.\-pynebcore.\-Emission\-Line.\-correct\-Intens()}, \hyperlink{pynebcore_8py_source_l03983}{pyneb.\-core.\-pynebcore.\-Observation.\-def\-\_\-\-E\-B\-V()}, \hyperlink{pynebcore_8py_source_l03574}{pyneb.\-core.\-pynebcore.\-Observation.\-fill\-Obs()}, \hyperlink{red__corr_8py_source_l00211}{pyneb.\-extinction.\-red\-\_\-corr.\-Red\-Corr.\-get\-Corr()}, \hyperlink{manage__atomic__data_8py_source_l00297}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-\-Manage\-Atomic\-Data.\-get\-Data\-File()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pynebcore_8py_source_l02990}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Emissivity()}, \hyperlink{pn__chianti_8py_source_l00366}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-get\-Energy()}, \hyperlink{pynebcore_8py_source_l02927}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Energy()}, \hyperlink{pynebcore_8py_source_l02176}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Ion\-Abundance()}, \hyperlink{pynebcore_8py_source_l03083}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Ion\-Abundance()}, \hyperlink{pynebcore_8py_source_l03665}{pyneb.\-core.\-pynebcore.\-Observation.\-get\-Line()}, \hyperlink{pn__chianti_8py_source_l00507}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega()}, \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}, \hyperlink{pn__chianti_8py_source_l00484}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega\-Array()}, \hyperlink{manage__atomic__data_8py_source_l00034}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-\-Manage\-Atomic\-Data.\-get\-Predefined\-Data\-File\-Dict()}, \hyperlink{pynebcore_8py_source_l03684}{pyneb.\-core.\-pynebcore.\-Observation.\-get\-Sorted\-Lines()}, \hyperlink{pynebcore_8py_source_l02851}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Tot\-Recombination()}, \hyperlink{red__corr_8py_source_l00303}{pyneb.\-extinction.\-red\-\_\-corr.\-Red\-Corr.\-plot()}, \hyperlink{plot_atomic_data_8py_source_l00117}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-A()}, \hyperlink{plot_atomic_data_8py_source_l00189}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-All\-A()}, \hyperlink{pynebcore_8py_source_l02384}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Emiss()}, \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}, \hyperlink{plot_atomic_data_8py_source_l00373}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-Omega()}, \hyperlink{plot_atomic_data_8py_source_l00262}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-Rel\-A()}, \hyperlink{manage__atomic__data_8py_source_l00431}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-\-Manage\-Atomic\-Data.\-print\-All\-Sources()}, \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}, \hyperlink{pynebcore_8py_source_l03711}{pyneb.\-core.\-pynebcore.\-Observation.\-read\-Data()}, \hyperlink{manage__atomic__data_8py_source_l00380}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-\_\-\-Manage\-Atomic\-Data.\-set\-Data\-File()}, and \hyperlink{logging_8py_source_l00115}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-timer()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!Coll\-Data@{Coll\-Data}}
\index{Coll\-Data@{Coll\-Data}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{Coll\-Data}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-Coll\-Data}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a976816067ec07396b4e27cfccbf15573}


Definition at line \hyperlink{pynebcore_8py_source_l01266}{1266} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01516}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Sources()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!coll\-File@{coll\-File}}
\index{coll\-File@{coll\-File}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{coll\-File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-coll\-File}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a356995bd5cadff6ea70cacb74f5c49e1}


Definition at line \hyperlink{pynebcore_8py_source_l01285}{1285} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02615}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-\_\-repr\-\_\-\-\_\-()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!coll\-File\-Type@{coll\-File\-Type}}
\index{coll\-File\-Type@{coll\-File\-Type}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{coll\-File\-Type}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-coll\-File\-Type}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8b68fc84abe84aa0b498c7dd995117db}


Definition at line \hyperlink{pynebcore_8py_source_l01262}{1262} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!coll\-Fits\-File@{coll\-Fits\-File}}
\index{coll\-Fits\-File@{coll\-Fits\-File}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{coll\-Fits\-File}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-coll\-Fits\-File}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a60a9c79fb04bee36371a0123fb5ae842}


Definition at line \hyperlink{pynebcore_8py_source_l01287}{1287} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!coll\-Fits\-Path@{coll\-Fits\-Path}}
\index{coll\-Fits\-Path@{coll\-Fits\-Path}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{coll\-Fits\-Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-coll\-Fits\-Path}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a386b3ef5e37abd539dbe36eeadfbeca5}


Definition at line \hyperlink{pynebcore_8py_source_l01288}{1288} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!Coll\-Header@{Coll\-Header}}
\index{Coll\-Header@{Coll\-Header}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{Coll\-Header}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-Coll\-Header}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_acc4393c4ba0bba2e8d5b1cb49682d488}


Definition at line \hyperlink{pynebcore_8py_source_l01278}{1278} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!coll\-N\-Levels@{coll\-N\-Levels}}
\index{coll\-N\-Levels@{coll\-N\-Levels}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{coll\-N\-Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-coll\-N\-Levels}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8beaa0244d575054b3e2748a5e00d8db}


Definition at line \hyperlink{pynebcore_8py_source_l01289}{1289} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01394}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Coll\-Rates()}, and \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!coll\-Path@{coll\-Path}}
\index{coll\-Path@{coll\-Path}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{coll\-Path}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-coll\-Path}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a7afd231b8a40f04aff5d61b8cc20c387}


Definition at line \hyperlink{pynebcore_8py_source_l01286}{1286} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!elem@{elem}}
\index{elem@{elem}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{elem}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-elem}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_ae722bd0e35e1c8cdc0018d56c34171cf}


Definition at line \hyperlink{pynebcore_8py_source_l01219}{1219} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02615}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-\_\-repr\-\_\-\-\_\-()}, \hyperlink{pynebcore_8py_source_l03154}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-\-\_\-repr\-\_\-\-\_\-()}, \hyperlink{plot_atomic_data_8py_source_l00117}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-A()}, \hyperlink{plot_atomic_data_8py_source_l00189}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-All\-A()}, \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}, \hyperlink{plot_atomic_data_8py_source_l00373}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-Omega()}, \hyperlink{plot_atomic_data_8py_source_l00262}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-Rel\-A()}, \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}, and \hyperlink{pynebcore_8py_source_l02324}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Tem\-Den()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!energy\-\_\-e\-V@{energy\-\_\-e\-V}}
\index{energy\-\_\-e\-V@{energy\-\_\-e\-V}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{energy\-\_\-e\-V}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-energy\-\_\-e\-V}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a07f2923aa90cd65d395812bf5cfd5fe3}


Definition at line \hyperlink{pynebcore_8py_source_l01317}{1317} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!energy\-\_\-\-Ryd@{energy\-\_\-\-Ryd}}
\index{energy\-\_\-\-Ryd@{energy\-\_\-\-Ryd}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{energy\-\_\-\-Ryd}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-energy\-\_\-\-Ryd}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a4198e6d7ab28c6973dd0f567e285ac3b}


Definition at line \hyperlink{pynebcore_8py_source_l01316}{1316} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!Energy\-N\-Levels@{Energy\-N\-Levels}}
\index{Energy\-N\-Levels@{Energy\-N\-Levels}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{Energy\-N\-Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-Energy\-N\-Levels}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a03277bf57e7056ec2199cc89f2a007aa}


Definition at line \hyperlink{pynebcore_8py_source_l01322}{1322} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01394}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Coll\-Rates()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Energy@{get\-Energy}}
\index{get\-Energy@{get\-Energy}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Energy}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-get\-Energy}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9940acb2999e864edf9761d822e65d7f}


Definition at line \hyperlink{pynebcore_8py_source_l01256}{1256} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}, and \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Omega\-Array@{get\-Omega\-Array}}
\index{get\-Omega\-Array@{get\-Omega\-Array}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Omega\-Array}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega\-Array}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a82067d384b463179a274711b618f03b5}


Definition at line \hyperlink{pynebcore_8py_source_l01283}{1283} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l00751}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-\_\-get\-Cheb\-Coeff\-Array()}, \hyperlink{pynebcore_8py_source_l00828}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-get\-Omega()}, and \hyperlink{pynebcore_8py_source_l01082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-get\-Omega()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Stat\-Weight@{get\-Stat\-Weight}}
\index{get\-Stat\-Weight@{get\-Stat\-Weight}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Stat\-Weight}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-get\-Stat\-Weight}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a0f2483487115f19556586b9e422bd5fb}


Definition at line \hyperlink{pynebcore_8py_source_l01255}{1255} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01719}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-High\-Dens\-Ratio()}, \hyperlink{pynebcore_8py_source_l01698}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Low\-Dens\-Ratio()}, \hyperlink{pynebcore_8py_source_l01324}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Omega()}, and \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!get\-Tem\-Array@{get\-Tem\-Array}}
\index{get\-Tem\-Array@{get\-Tem\-Array}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{get\-Tem\-Array}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-get\-Tem\-Array}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a764cc048a87d3d89204a616774bdaac6}


Definition at line \hyperlink{pynebcore_8py_source_l01284}{1284} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l00751}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-\_\-get\-Cheb\-Coeff\-Array()}, \hyperlink{pynebcore_8py_source_l01869}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-get\-Tem\-Den\-\_\-1()}, \hyperlink{pynebcore_8py_source_l00828}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Fits.\-get\-Omega()}, and \hyperlink{pynebcore_8py_source_l01082}{pyneb.\-core.\-pynebcore.\-\_\-\-Coll\-Data\-Ascii.\-get\-Omega()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!gs@{gs}}
\index{gs@{gs}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{gs}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-gs}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a3e6bcb66f905475145b261ae797096e3}


Definition at line \hyperlink{pynebcore_8py_source_l01295}{1295} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!line\-List@{line\-List}}
\index{line\-List@{line\-List}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{line\-List}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-line\-List}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a8280ef5632977a7cf7e8fe4c63127703}


Definition at line \hyperlink{pynebcore_8py_source_l01310}{1310} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02384}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Emiss()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!log\-\_\-@{log\-\_\-}}
\index{log\-\_\-@{log\-\_\-}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{log\-\_\-}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-log\-\_\-}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a9e2e5b5402bb9cf14c1b08684bccbf6b}


Definition at line \hyperlink{pynebcore_8py_source_l01216}{1216} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{logging_8py_source_l00059}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-\_\-add2log()}, \hyperlink{logging_8py_source_l00157}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-print\-\_\-debug()}, \hyperlink{logging_8py_source_l00149}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-print\-\_\-errors()}, \hyperlink{logging_8py_source_l00133}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-print\-\_\-messages()}, \hyperlink{logging_8py_source_l00165}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-print\-\_\-timer()}, \hyperlink{logging_8py_source_l00141}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-print\-\_\-warnings()}, and \hyperlink{logging_8py_source_l00115}{pyneb.\-utils.\-logging.\-my\-\_\-logging.\-timer()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!name@{name}}
\index{name@{name}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{name}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-name}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_aa8b43e1441b80824954f2f2fac4f2eba}


Definition at line \hyperlink{pynebcore_8py_source_l01228}{1228} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!N\-I\-S\-T@{N\-I\-S\-T}}
\index{N\-I\-S\-T@{N\-I\-S\-T}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{N\-I\-S\-T}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-N\-I\-S\-T}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a65e03e79fb1cde1b00580042f3303538}


Definition at line \hyperlink{pynebcore_8py_source_l01303}{1303} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!N\-Levels@{N\-Levels}}
\index{N\-Levels@{N\-Levels}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{N\-Levels}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-N\-Levels}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a6b43c1e6431a6786c1b4267f704fb4e8}


Definition at line \hyperlink{pynebcore_8py_source_l01231}{1231} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pn__chianti_8py_source_l00304}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Atom\-Chianti.\-\_\-test\-\_\-lev()}, \hyperlink{pn__chianti_8py_source_l00472}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01525}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l02672}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-test\-\_\-lev()}, \hyperlink{pynebcore_8py_source_l01782}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Emissivity()}, \hyperlink{pn__chianti_8py_source_l00507}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega()}, \hyperlink{pynebcore_8py_source_l01562}{pyneb.\-core.\-pynebcore.\-Atom.\-get\-Populations()}, \hyperlink{pynebcore_8py_source_l02384}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Emiss()}, \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}, and \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!spec@{spec}}
\index{spec@{spec}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{spec}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-spec}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a02c0f7146a2f5b8eac765a453c763797}


Definition at line \hyperlink{pynebcore_8py_source_l01220}{1220} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l02615}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-\_\-repr\-\_\-\-\_\-()}, \hyperlink{pynebcore_8py_source_l03154}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-\-\_\-repr\-\_\-\-\_\-()}, \hyperlink{plot_atomic_data_8py_source_l00117}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-A()}, \hyperlink{plot_atomic_data_8py_source_l00189}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-All\-A()}, \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}, \hyperlink{plot_atomic_data_8py_source_l00373}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-Omega()}, \hyperlink{plot_atomic_data_8py_source_l00262}{pyneb.\-plot.\-plot\-Atomic\-Data.\-Data\-Plot.\-plot\-Rel\-A()}, \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}, and \hyperlink{pynebcore_8py_source_l02324}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Tem\-Den()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!tem\-\_\-units@{tem\-\_\-units}}
\index{tem\-\_\-units@{tem\-\_\-units}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{tem\-\_\-units}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-tem\-\_\-units}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a218d09913e06d074a86466946eb221f5}


Definition at line \hyperlink{pynebcore_8py_source_l01290}{1290} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pn__chianti_8py_source_l00551}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Tem\-Array()}.

\hypertarget{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}{\index{pyneb\-::core\-::pynebcore\-::\-Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}!wave\-\_\-\-Ang@{wave\-\_\-\-Ang}}
\index{wave\-\_\-\-Ang@{wave\-\_\-\-Ang}!pyneb::core::pynebcore::Atom@{pyneb\-::core\-::pynebcore\-::\-Atom}}
\subsubsection[{wave\-\_\-\-Ang}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\-core.\-pynebcore.\-Atom.\-wave\-\_\-\-Ang}}\label{classpyneb_1_1core_1_1pynebcore_1_1_atom_a044e1349bb63766a5f3d25fbf04b5c2c}


Definition at line \hyperlink{pynebcore_8py_source_l01254}{1254} of file \hyperlink{pynebcore_8py_source}{pynebcore.\-py}.



Referenced by \hyperlink{pynebcore_8py_source_l01433}{pyneb.\-core.\-pynebcore.\-Atom.\-\_\-\-Transition()}, \hyperlink{pynebcore_8py_source_l02812}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-\_\-\-Transition()}, \hyperlink{pynebcore_8py_source_l02699}{pyneb.\-core.\-pynebcore.\-Rec\-Atom.\-get\-Wave()}, \hyperlink{pynebcore_8py_source_l02443}{pyneb.\-core.\-pynebcore.\-Atom.\-plot\-Grotrian()}, and \hyperlink{pynebcore_8py_source_l02233}{pyneb.\-core.\-pynebcore.\-Atom.\-print\-Ionic()}.



The documentation for this class was generated from the following file\-:\begin{DoxyCompactItemize}
\item 
pyneb/core/\hyperlink{pynebcore_8py}{pynebcore.\-py}\end{DoxyCompactItemize}
