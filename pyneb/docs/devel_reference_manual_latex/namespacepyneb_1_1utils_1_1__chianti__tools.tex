\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools}{}\section{pyneb.\+utils.\+\_\+chianti\+\_\+tools Namespace Reference}
\label{namespacepyneb_1_1utils_1_1__chianti__tools}\index{pyneb.\+utils.\+\_\+chianti\+\_\+tools@{pyneb.\+utils.\+\_\+chianti\+\_\+tools}}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46b8e5a174144ca33b476e2ea883403a}{between} (array, limits)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{ip\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{master\+List\+Info}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a1a4447320a9d614f994bc538890c32cd}{master\+List\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac5c830808b3221d5f11b3e2d83b6140d}{photox\+Read} (ions)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a552566dde90c6b3d2d8e934914d3ae76}{ionrecdat\+Read} (filename)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0e092ff402fc0287bcaaed67171934ea}{z2element} (z)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{zion2filename}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{zion2local\+Filename}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{zion2spectroscopic}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convert\+Name} (name)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{defaults\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename} (ions)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a32ffd2ba65d19385acc6921d77da7976}{el2z} (els)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{abundance\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_af9318412aecf0f6ac826b43796d594db}{qrp} (z, u)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{elvlc\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a279f0911664046ffd65c19571be8a84d}{elvlc\+Write} (info)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{wgfa\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{wgfa\+Write}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{easplom\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a391eb09a09769234e5759d5544d0bcaf}{splom\+Descale} (splom, energy)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{splom\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{splups\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{cireclvl\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5d55ad976e899b30719ac9b053e34ceb}{dilute} (radius)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a1d4803c6e3b7cbb996b9da3f763ab6ee}{di\+Cross}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{di\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{ea\+Cross}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{ea\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a71865c846f3d3b1c9b1371c6779c8f3e}{rr\+Read} (ions)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa29da4afe4adccd8de62c0dd97799dcd}{dr\+Read} (ions)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{ioneq\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_af524b50fae5a347eff4976b7ce895ab1}{gff\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a27deea720e4534912f04b54fe5c17b93}{gffint\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3dc5585b3508d8baf58ba62d0f728f16}{itoh\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa4cdc5fd04cf99d7600e480f0dc95ae4}{klgfb\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a680536bf77d8f8baa8434c1bf84350a4}{list\+Files} (path)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{fblvl\+Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addacad8fe4cf3dff7f457b8b4a58054f}{verner\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae03bdc8f81142c34a58f9567f3359322}{twophoton\+H\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a79401d478ca07c45f4546a82634e6eb9}{twophoton\+He\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4fab6d9973653d9ca82088006f2a12fe}{upsdat\+Read} (upsdat\+File\+Name)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a349618b1b79ca902de8a030592d6d43a}{version\+Read} ()
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a71b9295157832135424ea7dc0138fcd4}{scale\+\_\+bti} (evin, crossin, f, ev1)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}{descale\+\_\+bti} (bte, btx, f, ev1)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad34ed06dfc613c2f1ace88fab4ac4392}{descale\+\_\+bt} (bte, btomega, f, ev1)
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_abdf42d0f9176edb418859e7a12fa4bce}{scale\+\_\+bt} (evin, omega, f, ev1)
\end{DoxyCompactItemize}
\subsection*{Variables}
\begin{DoxyCompactItemize}
\item 
\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae4b82a587c953b2207888a96d3364677}{Splups}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Utility functions, many for reading the CHIANTI database files.

Copyright 2009, 2010 Kenneth P. Dere

This software is distributed under the terms of the GNU General Public License
that is found in the LICENSE file\end{DoxyVerb}
 

\subsection{Function Documentation}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!abundance\+Read@{abundance\+Read}}
\index{abundance\+Read@{abundance\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{abundance\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+abundance\+Read (
\begin{DoxyParamCaption}
\item[{}]{abundancename = {\ttfamily \textquotesingle{}\textquotesingle{}}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}
\begin{DoxyVerb}read an abundanc file and returns the abundance values relative to hydrogen\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00413}{413} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00413}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{00413} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{abundanceRead}(abundancename=''):
00414     \textcolor{stringliteral}{""" read an abundanc file and returns the abundance values relative to hydrogen"""}
00415     \textcolor{keywordflow}{pass}
00416 
00417     \textcolor{comment}{#}
00418     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00419     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a46b8e5a174144ca33b476e2ea883403a}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!between@{between}}
\index{between@{between}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{between}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+between (
\begin{DoxyParamCaption}
\item[{}]{array, }
\item[{}]{limits}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a46b8e5a174144ca33b476e2ea883403a}
\begin{DoxyVerb}returns an index array of elements of array where the values lie
between the limits given as a 2 element list or tuple\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00021}{21} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00021}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46b8e5a174144ca33b476e2ea883403a}{00021} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46b8e5a174144ca33b476e2ea883403a}{between}(array,limits):
00022     \textcolor{stringliteral}{'''returns an index array of elements of array where the values lie}
00023 \textcolor{stringliteral}{    between the limits given as a 2 element list or tuple'''}
00024     array=np.asarray(array)
00025     nlines=len(array)
00026     hi=np.where(array >= limits[0],range(1,nlines+1),0)
00027     lo=np.where(array <= limits[1],range(1,nlines+1),0)
00028     hilo=hi&lo
00029     out=[a -1  \textcolor{keywordflow}{for} a \textcolor{keywordflow}{in} hilo \textcolor{keywordflow}{if} a > 0]
00030     \textcolor{keywordflow}{return} out
00031     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00032     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!cireclvl\+Read@{cireclvl\+Read}}
\index{cireclvl\+Read@{cireclvl\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{cireclvl\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+cireclvl\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}, }
\item[{}]{cilvl = {\ttfamily 0}, }
\item[{}]{reclvl = {\ttfamily 0}, }
\item[{}]{rrlvl = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}
\begin{DoxyVerb}to read Chianti cilvl and reclvl files and return data
must specify type as either cilvl, reclvl or rrlvl
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00985}{985} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00985}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{00985} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{cireclvlRead}(ions, filename=0, cilvl=0, reclvl=0, rrlvl=0):
00986     \textcolor{stringliteral}{'''}
00987 \textcolor{stringliteral}{    to read Chianti cilvl and reclvl files and return data}
00988 \textcolor{stringliteral}{    must specify type as either cilvl, reclvl or rrlvl}
00989 \textcolor{stringliteral}{    '''}
00990     \textcolor{keywordflow}{if} filename:
00991         fname = filename
00992     \textcolor{keywordflow}{else}:
00993         fname = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
00994     \textcolor{keywordflow}{if} cilvl:
00995         paramname=fname+\textcolor{stringliteral}{'.cilvl'}
00996     \textcolor{keywordflow}{elif} reclvl:
00997         paramname = fname + \textcolor{stringliteral}{'.reclvl'}
00998     \textcolor{keywordflow}{elif} rrlvl:
00999         paramname = fname + \textcolor{stringliteral}{'.rrlvl'}
01000     \textcolor{keywordflow}{else}:
01001         print(\textcolor{stringliteral}{'either "cilvl", "reclvl" ir "rrlvl" must be specified'})
01002         \textcolor{keywordflow}{return} \{\}
01003     \textcolor{keywordflow}{if} os.path.exists(paramname):
01004         input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01005 \textcolor{stringliteral}{        lines = input.readlines()}
01006 \textcolor{stringliteral}{        input.close()}
01007 \textcolor{stringliteral}{    }\textcolor{keywordflow}{else}:
01008         print((\textcolor{stringliteral}{'file does not exist:  '}, paramname))
01009         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'error'}:\textcolor{stringliteral}{'file does not exist: '} + paramname\}
01010     \textcolor{comment}{#}
01011     iline = 0
01012     idx = -1
01013     \textcolor{keywordflow}{while} idx < 0:
01014         aline=lines[iline][0:5]
01015         idx=aline.find(\textcolor{stringliteral}{'-1'})
01016         iline += 1
01017     ndata = iline - 1
01018     ntrans = ndata/2
01019     \textcolor{comment}{#}
01020     nref = 0
01021     idx = -1
01022     \textcolor{keywordflow}{while} idx < 0:
01023         aline=lines[iline][0:5]
01024         idx=aline.find(\textcolor{stringliteral}{'-1'})
01025         iline += 1
01026         nref += 1
01027     nref -= 1
01028     \textcolor{comment}{#}
01029     \textcolor{comment}{# need to find the maximum number of temperatures, not all lines are the same}
01030     \textcolor{comment}{#}
01031     ntemp = np.zeros(ntrans, \textcolor{stringliteral}{'int32'})
01032     iline = 0
01033     \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} range(0, ndata, 2):
01034         dummy = lines[jline].replace(os.linesep, \textcolor{stringliteral}{''}).split()
01035         ntemp[iline] = len(dummy[4:])
01036         iline += 1
01037     maxNtemp = ntemp.max()
01038 \textcolor{comment}{#   print ' maxNtemp = ', maxNtemp}
01039     temp = np.zeros((ntrans,maxNtemp), \textcolor{stringliteral}{'float64'})
01040     iline = 0
01041     \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} range(0, ndata, 2):
01042         recdat = lines[jline].replace(os.linesep, \textcolor{stringliteral}{''}).split()
01043         shortT = np.asarray(recdat[4:], \textcolor{stringliteral}{'float64'})
01044         \textcolor{comment}{# the result of the next statement is to continue to replicate t}
01045         t = np.resize(shortT, maxNtemp)
01046         \textcolor{keywordflow}{if} rrlvl:
01047             temp[iline] = t
01048         \textcolor{keywordflow}{else}:
01049             temp[iline] = 10.**t
01050         iline += 1
01051     \textcolor{comment}{#}
01052     lvl1 = np.zeros(ntrans, \textcolor{stringliteral}{'int64'})
01053     lvl2 = np.zeros(ntrans, \textcolor{stringliteral}{'int64'})
01054     ci = np.zeros((ntrans, maxNtemp), \textcolor{stringliteral}{'float64'})
01055     \textcolor{comment}{#}
01056     idat = 0
01057     \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} range(1, ndata, 2):
01058         cidat = lines[jline].replace(os.linesep, \textcolor{stringliteral}{''}).split()
01059         shortCi = np.asarray(cidat[4:], \textcolor{stringliteral}{'float64'})
01060         lvl1[idat] = int(cidat[2])
01061         lvl2[idat] = int(cidat[3])
01062         ci[idat] = np.resize(shortCi, maxNtemp)
01063         idat += 1
01064     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'temperature'}:temp, \textcolor{stringliteral}{'ntemp'}:ntemp,\textcolor{stringliteral}{'lvl1'}:lvl1, \textcolor{stringliteral}{'lvl2'}:lvl2, \textcolor{stringliteral}{'rate'}:ci,\textcolor{stringliteral}{'ref'}:lines[ndata+1:-1], \textcolor{stringliteral}{
      'ionS'}:ions\}
01065     \textcolor{comment}{#}
01066     \textcolor{comment}{# ----------------------------------------------------------}
01067     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!convert\+Name@{convert\+Name}}
\index{convert\+Name@{convert\+Name}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{convert\+Name}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+convert\+Name (
\begin{DoxyParamCaption}
\item[{}]{name}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}
\begin{DoxyVerb}convert ion name string to Z and Ion \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00353}{353} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l01155}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+di\+Read()}, \hyperlink{__chianti__tools_8py_source_l01257}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ea\+Read()}, \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}, \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Info()}, and \hyperlink{__chianti__tools_8py_source_l00185}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+photox\+Read()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00353}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{00353} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convertName}(name):
00354     \textcolor{stringliteral}{""" convert ion name string to Z and Ion """}
00355     s2=name.split(\textcolor{stringliteral}{'\_'})
00356     els=s2[0].strip()
00357     i1=const.El.index(els)+1
00358     ions=s2[1].strip()
00359     d=ions.find(\textcolor{stringliteral}{'d'})
00360     \textcolor{keywordflow}{if} d >0 :
00361         dielectronic=\textcolor{keyword}{True}
00362         ions=ions.replace(\textcolor{stringliteral}{'d'},\textcolor{stringliteral}{''})
00363     \textcolor{keywordflow}{else}: dielectronic=\textcolor{keyword}{False}
00364     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'Z'}:int(i1),\textcolor{stringliteral}{'Ion'}:int(ions),\textcolor{stringliteral}{'Dielectronic'}:dielectronic, \textcolor{stringliteral}{'Element'}:els\}
00365     \textcolor{comment}{#}
00366     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00367     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!defaults\+Read@{defaults\+Read}}
\index{defaults\+Read@{defaults\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{defaults\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+defaults\+Read (
\begin{DoxyParamCaption}
\item[{}]{verbose = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}


Definition at line \hyperlink{__chianti__tools_8py_source_l00368}{368} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00368}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{00368} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{defaultsRead}(verbose=0):
00369     \textcolor{comment}{#}
00370     \textcolor{comment}{#possibleDefaults = \{'wavelength':['angstrom', 'kev', 'nm']\}}
00371     \textcolor{comment}{#symbolDefaults = \{'wavelength':['A', 'keV', 'nm']\}}
00372     initDefaults=\{\textcolor{stringliteral}{'abundfile'}: \textcolor{stringliteral}{'sun\_photospheric\_1998\_grevesse'},\textcolor{stringliteral}{'ioneqfile'}: \textcolor{stringliteral}{'chianti'}, \textcolor{stringliteral}{'wavelength'}: \textcolor{stringliteral}{'
      angstrom'}, \textcolor{stringliteral}{'flux'}: \textcolor{stringliteral}{'energy'},\textcolor{stringliteral}{'gui'}:\textcolor{keyword}{False}\}
00373     rcfile=os.path.join(os.environ[\textcolor{stringliteral}{'HOME'}],\textcolor{stringliteral}{'.chianti/chiantirc'})
00374     \textcolor{keywordflow}{if} os.path.isfile(rcfile):
00375         print((\textcolor{stringliteral}{' reading chiantirc file'}))
00376         config = RawConfigParser(initDefaults)
00377         config.read(rcfile)
00378         defaults = \{\}
00379         \textcolor{keywordflow}{for} anitem \textcolor{keywordflow}{in} config.items(\textcolor{stringliteral}{'chianti'}):
00380             defaults[anitem[0]] = anitem[1]
00381         \textcolor{keywordflow}{if} defaults[\textcolor{stringliteral}{'gui'}].lower() \textcolor{keywordflow}{in} (\textcolor{stringliteral}{'t'}, \textcolor{stringliteral}{'y'}, \textcolor{stringliteral}{'yes'}, \textcolor{stringliteral}{'on'}, \textcolor{stringliteral}{'true'}, \textcolor{stringliteral}{'1'}, 1, \textcolor{keyword}{True}):
00382             defaults[\textcolor{stringliteral}{'gui'}] = \textcolor{keyword}{True}
00383         \textcolor{keywordflow}{elif} defaults[\textcolor{stringliteral}{'gui'}].lower() \textcolor{keywordflow}{in} (\textcolor{stringliteral}{'f'}, \textcolor{stringliteral}{'n'}, \textcolor{stringliteral}{'no'}, \textcolor{stringliteral}{'off'}, \textcolor{stringliteral}{'false'}, \textcolor{stringliteral}{'0'}, 0, \textcolor{keyword}{False}):
00384             defaults[\textcolor{stringliteral}{'gui'}] = \textcolor{keyword}{False}
00385     \textcolor{keywordflow}{else}:
00386         defaults = initDefaults
00387         \textcolor{keywordflow}{if} verbose:
00388             print((\textcolor{stringliteral}{' chiantirc file (/HOME/.chianti/chiantirc) does not exist'}))
00389             print((\textcolor{stringliteral}{' using the following defaults'}))
00390             \textcolor{keywordflow}{for} akey \textcolor{keywordflow}{in} list(defaults.keys()):
00391                 print((\textcolor{stringliteral}{' %s = %s'}%(akey, defaults[akey])))
00392     \textcolor{keywordflow}{return} defaults
00393     \textcolor{comment}{#}
00394     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00395     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ad34ed06dfc613c2f1ace88fab4ac4392}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!descale\+\_\+bt@{descale\+\_\+bt}}
\index{descale\+\_\+bt@{descale\+\_\+bt}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{descale\+\_\+bt}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+descale\+\_\+bt (
\begin{DoxyParamCaption}
\item[{}]{bte, }
\item[{}]{btomega, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ad34ed06dfc613c2f1ace88fab4ac4392}
\begin{DoxyVerb}descale BT excitation scaling
returns [energy,collision strength]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01767}{1767} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01767}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad34ed06dfc613c2f1ace88fab4ac4392}{01767} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad34ed06dfc613c2f1ace88fab4ac4392}{descale\_bt}(bte,btomega,f,ev1):
01768     \textcolor{stringliteral}{"""}
01769 \textcolor{stringliteral}{    descale BT excitation scaling}
01770 \textcolor{stringliteral}{    returns [energy,collision strength]}
01771 \textcolor{stringliteral}{    """}
01772     u=1.-f+np.exp(np.log(f)/(1.-bte))
01773     energy=u*ev1
01774     omega=(np.log(u)-1.+np.exp(1.))*btomega
01775     \textcolor{keywordflow}{return} [energy,omega]
01776     \textcolor{comment}{#}
01777     \textcolor{comment}{#-----------------------------------------------------------}
01778     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!descale\+\_\+bti@{descale\+\_\+bti}}
\index{descale\+\_\+bti@{descale\+\_\+bti}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{descale\+\_\+bti}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+descale\+\_\+bti (
\begin{DoxyParamCaption}
\item[{}]{bte, }
\item[{}]{btx, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}
\begin{DoxyVerb}descale BT ionization scaling
returns [energy,cross-section]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01755}{1755} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l01083}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+di\+Cross()}, and \hyperlink{__chianti__tools_8py_source_l01223}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ea\+Cross()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01755}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}{01755} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}{descale\_bti}(bte,btx,f,ev1):
01756     \textcolor{stringliteral}{"""}
01757 \textcolor{stringliteral}{    descale BT ionization scaling}
01758 \textcolor{stringliteral}{    returns [energy,cross-section]}
01759 \textcolor{stringliteral}{    """}
01760     u=1.-f+np.exp(np.log(f)/(1.-bte))
01761     energy=u*ev1
01762     cross=(np.log(u)+1.)*btx/(u*ev1**2)
01763     \textcolor{keywordflow}{return} [energy,cross]
01764     \textcolor{comment}{#}
01765     \textcolor{comment}{#-----------------------------------------------------------}
01766     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a1d4803c6e3b7cbb996b9da3f763ab6ee}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!di\+Cross@{di\+Cross}}
\index{di\+Cross@{di\+Cross}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{di\+Cross}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+di\+Cross (
\begin{DoxyParamCaption}
\item[{}]{di\+Params, }
\item[{}]{energy = {\ttfamily 0}, }
\item[{}]{verbose = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a1d4803c6e3b7cbb996b9da3f763ab6ee}
\begin{DoxyVerb}Calculate the direct ionization cross section.
diParams obtained by util.diRead with the following keys:
['info', 'ysplom', 'xsplom', 'btf', 'ev1', 'ref', 'eaev']
Given as a function of the incident electron energy in eV
returns a dictionary - {'energy':energy, 'cross':cross}
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01083}{1083} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l01755}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+descale\+\_\+bti()}, and \hyperlink{__chianti__tools_8py_source_l01743}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+scale\+\_\+bti()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01083}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a1d4803c6e3b7cbb996b9da3f763ab6ee}{01083} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a1d4803c6e3b7cbb996b9da3f763ab6ee}{diCross}(diParams, energy=0, verbose=0):
01084     \textcolor{stringliteral}{'''}
01085 \textcolor{stringliteral}{    Calculate the direct ionization cross section.}
01086 \textcolor{stringliteral}{    diParams obtained by util.diRead with the following keys:}
01087 \textcolor{stringliteral}{    ['info', 'ysplom', 'xsplom', 'btf', 'ev1', 'ref', 'eaev']}
01088 \textcolor{stringliteral}{    Given as a function of the incident electron energy in eV}
01089 \textcolor{stringliteral}{    returns a dictionary - \{'energy':energy, 'cross':cross\}}
01090 \textcolor{stringliteral}{    '''}
01091     iso=diParams[\textcolor{stringliteral}{'info'}][\textcolor{stringliteral}{'iz'}] - diParams[\textcolor{stringliteral}{'info'}][\textcolor{stringliteral}{'ion'}] + 1
01092     energy = np.array(energy, \textcolor{stringliteral}{'float64'})
01093     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} energy.any():
01094         btenergy=0.1*np.arange(10)
01095         btenergy[0]=0.01
01096         dum=np.ones(len(btenergy))
01097         [energy, dum] = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}{descale\_bti}(btenergy, dum, 2., diParams[\textcolor{stringliteral}{'ev1'}][0])
01098         energy=np.asarray(energy, \textcolor{stringliteral}{'float64'})
01099     \textcolor{comment}{#}
01100     \textcolor{keywordflow}{if} iso == 1 \textcolor{keywordflow}{and} self.Z >= 6:
01101         \textcolor{comment}{#  hydrogenic sequence}
01102         ryd=27.2113845/2.
01103         u=energy/self.Ip
01104         ev1ryd=self.Ip/ryd
01105         a0=0.5291772108e-8
01106         a\_bohr=const.pi*a0**2   \textcolor{comment}{# area of bohr orbit}
01107         \textcolor{keywordflow}{if} self.Z >= 20:
01108             ff = (140.+(self.Z/20.)**3.2)/141.
01109         \textcolor{keywordflow}{else}:
01110             ff = 1.
01111         qr = util.qrp(self.Z,u)*ff
01112         bb = 1.  \textcolor{comment}{# hydrogenic}
01113         qh = bb*a\_bohr*qr/ev1ryd**2
01114         diCross = \{\textcolor{stringliteral}{'energy'}:energy, \textcolor{stringliteral}{'cross'}:qh\}
01115     \textcolor{keywordflow}{elif} iso == 2 \textcolor{keywordflow}{and} self.Z >= 10:
01116         \textcolor{comment}{#  use}
01117         ryd=27.2113845/2.
01118         u=energy/self.Ip
01119         ev1ryd=self.Ip/ryd
01120         a0=0.5291772108e-8
01121         a\_bohr=const.pi*a0**2   \textcolor{comment}{# area of bohr orbit}
01122         \textcolor{keywordflow}{if} self.Z >= 20:
01123             ff=(140.+(self.Z/20.)**3.2)/141.
01124         \textcolor{keywordflow}{else}:
01125             ff=1.
01126         qr=util.qrp(self.Z,u)*ff
01127         bb=2.  \textcolor{comment}{# helium-like}
01128         qh=bb*a\_bohr*qr/ev1ryd**2
01129         diCross=\{\textcolor{stringliteral}{'energy'}:energy, \textcolor{stringliteral}{'cross'}:qh\}
01130     \textcolor{keywordflow}{else}:
01131         cross=np.zeros(len(energy), \textcolor{stringliteral}{'Float64'})
01132 
01133         \textcolor{keywordflow}{for} ifac \textcolor{keywordflow}{in} range(diParams[\textcolor{stringliteral}{'info'}][\textcolor{stringliteral}{'nfac'}]):
01134             \textcolor{comment}{# prob. better to do this with masked arrays}
01135             goode=energy > diParams[\textcolor{stringliteral}{'ev1'}][ifac]
01136             \textcolor{keywordflow}{if} goode.sum() > 0:
01137                 dum=np.ones(len(energy))
01138                 btenergy, btdum = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a71b9295157832135424ea7dc0138fcd4}{scale\_bti}(energy[goode],dum[goode], diParams[\textcolor{stringliteral}{'btf'}][ifac], 
      diParams[\textcolor{stringliteral}{'ev1'}][ifac])
01139                 \textcolor{comment}{# these interpolations were made with the scipy routine used here}
01140                 y2=interpolate.splrep(diParams[\textcolor{stringliteral}{'xsplom'}][ifac], diParams[\textcolor{stringliteral}{'ysplom'}][ifac], s=0)
01141                 btcross=interpolate.splev(btenergy, y2, der=0)
01142                 energy1, cross1 = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}{descale\_bti}(btenergy, btcross, diParams[\textcolor{stringliteral}{'btf'}][ifac], diParams
      [\textcolor{stringliteral}{'ev1'}][ifac] )
01143                 offset=len(energy)-goode.sum()
01144                 \textcolor{keywordflow}{if} verbose:
01145                     pl.plot(diParams[\textcolor{stringliteral}{'xsplom'}][ifac], diParams[\textcolor{stringliteral}{'ysplom'}][ifac])
01146                     pl.plot(btenergy, btcross)
01147                 \textcolor{keywordflow}{if} offset > 0:
01148                     seq=[np.zeros(offset, \textcolor{stringliteral}{'Float64'}), cross1]
01149                     cross1=np.hstack(seq)
01150                 cross+=cross1*1.e-14
01151         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'energy'}:energy, \textcolor{stringliteral}{'cross'}:cross\}
01152     \textcolor{comment}{#}
01153     \textcolor{comment}{#-----------------------------------------------------------}
01154     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a5d55ad976e899b30719ac9b053e34ceb}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!dilute@{dilute}}
\index{dilute@{dilute}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{dilute}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+dilute (
\begin{DoxyParamCaption}
\item[{}]{radius}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a5d55ad976e899b30719ac9b053e34ceb}
\begin{DoxyVerb}to calculate the dilution factor as a function distance from
the center of a star in units of the stellar radius
a radius of less than 1.0 (incorrect) results in a dilution factor of 0.
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01068}{1068} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01068}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5d55ad976e899b30719ac9b053e34ceb}{01068} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5d55ad976e899b30719ac9b053e34ceb}{dilute}(radius):
01069     \textcolor{stringliteral}{'''}
01070 \textcolor{stringliteral}{    to calculate the dilution factor as a function distance from}
01071 \textcolor{stringliteral}{    the center of a star in units of the stellar radius}
01072 \textcolor{stringliteral}{    a radius of less than 1.0 (incorrect) results in a dilution factor of 0.}
01073 \textcolor{stringliteral}{    '''}
01074     \textcolor{keywordflow}{if} radius >= 1.:
01075         d = 0.5*(1. - np.sqrt(1. - 1./radius**2))
01076     \textcolor{keywordflow}{else}:
01077         d = 0.
01078     \textcolor{keywordflow}{return} d
01079     \textcolor{comment}{#}
01080     \textcolor{comment}{#}
01081     \textcolor{comment}{# ------------------------------------------------------------------------------}
01082     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!di\+Read@{di\+Read}}
\index{di\+Read@{di\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{di\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+di\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}
\begin{DoxyVerb}read chianti direct ionization .params files and return
    {"info":info,"btf":btf,"ev1":ev1,"xsplom":xsplom,"ysplom":ysplom,"ref":hdr}
    info={"iz":iz,"ion":ion,"nspl":nspl,"neaev":neaev}
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01155}{1155} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+convert\+Name()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01155}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{01155} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{diRead}(ions, filename=0):
01156     \textcolor{stringliteral}{"""}
01157 \textcolor{stringliteral}{    read chianti direct ionization .params files and return}
01158 \textcolor{stringliteral}{        \{"info":info,"btf":btf,"ev1":ev1,"xsplom":xsplom,"ysplom":ysplom,"ref":hdr\}}
01159 \textcolor{stringliteral}{        info=\{"iz":iz,"ion":ion,"nspl":nspl,"neaev":neaev\}}
01160 \textcolor{stringliteral}{    """}
01161     \textcolor{comment}{#}
01162     \textcolor{keywordflow}{if} filename:
01163         paramname = filename
01164     \textcolor{keywordflow}{else}:
01165         zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convertName}(ions)
01166         \textcolor{keywordflow}{if} zion[\textcolor{stringliteral}{'Z'}] < zion[\textcolor{stringliteral}{'Ion'}]:
01167             print(\textcolor{stringliteral}{' this is a bare nucleus that has no ionization rate'})
01168             \textcolor{keywordflow}{return}
01169         \textcolor{comment}{#}
01170         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
01171         paramname=fname+\textcolor{stringliteral}{'.diparams'}
01172     \textcolor{comment}{#}
01173     input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01174 \textcolor{stringliteral}{    }\textcolor{comment}{#  need to read first line and see how many elements}
01175     line1=input.readline()
01176     indices=line1.split()
01177     iz=int(indices[0])
01178     ion=int(indices[1])
01179     nspl=indices[2]
01180     nfac=int(indices[3])
01181     neaev=int(indices[4])
01182     nspl=int(nspl)
01183     format=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(str(nspl+1)+\textcolor{stringliteral}{'E10.2'})
01184     \textcolor{comment}{#}
01185     ev1=np.zeros(nfac,\textcolor{stringliteral}{'Float64'})
01186     btf=np.zeros(nfac,\textcolor{stringliteral}{'Float64'})
01187     xsplom=np.zeros([nfac, nspl],\textcolor{stringliteral}{'Float64'})
01188     ysplom=np.zeros([nfac, nspl],\textcolor{stringliteral}{'Float64'})
01189     \textcolor{comment}{#}
01190     \textcolor{keywordflow}{for} ifac \textcolor{keywordflow}{in} range(nfac):
01191         line=input.readline()
01192         paramdat=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(line,format)
01193         btf[ifac]=paramdat[0]
01194         xsplom[ifac]=paramdat[1:]
01195         line=input.readline()
01196         paramdat=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(line,format)
01197         ev1[ifac]=paramdat[0]
01198         ysplom[ifac]=paramdat[1:]
01199     \textcolor{keywordflow}{if} neaev:
01200         line=input.readline()
01201         eacoef=line.split()
01202 \textcolor{comment}{#            print ' eaev = ', type(eacoef), eacoef}
01203         eaev=[float(avalue) \textcolor{keywordflow}{for} avalue \textcolor{keywordflow}{in} eacoef]
01204 \textcolor{comment}{#            print ' eaev = ', type(eaev), eaev}
01205 \textcolor{comment}{#            print ' eaev = ', type(eaev), eaev}
01206 \textcolor{comment}{#            if len(eaev) == 1:}
01207 \textcolor{comment}{#                eaev=float(eaev[0])}
01208 \textcolor{comment}{#                eaev=np.asarray(eaev, 'float32')}
01209 \textcolor{comment}{#            else:}
01210 \textcolor{comment}{#                eaev=np.asarray(eaev, 'float32')}
01211     \textcolor{keywordflow}{else}:
01212         eaev=0.
01213     hdr=input.readlines()
01214     input.close()
01215     info=\{\textcolor{stringliteral}{"iz"}:iz,\textcolor{stringliteral}{"ion"}:ion,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"neaev"}:neaev, \textcolor{stringliteral}{'nfac'}:nfac\}
01216     \textcolor{keywordflow}{if} neaev:
01217         info[\textcolor{stringliteral}{'eaev'}] = eaev
01218     DiParams=\{\textcolor{stringliteral}{"info"}:info,\textcolor{stringliteral}{"btf"}:btf,\textcolor{stringliteral}{"ev1"}:ev1,\textcolor{stringliteral}{"xsplom"}:xsplom,\textcolor{stringliteral}{"ysplom"}:ysplom, \textcolor{stringliteral}{'eaev'}:eaev,\textcolor{stringliteral}{"ref"}:hdr\}
01219     \textcolor{keywordflow}{return} DiParams
01220     \textcolor{comment}{#}
01221     \textcolor{comment}{# -------------------------------------------------------------------------------------}
01222     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aa29da4afe4adccd8de62c0dd97799dcd}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!dr\+Read@{dr\+Read}}
\index{dr\+Read@{dr\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{dr\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+dr\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aa29da4afe4adccd8de62c0dd97799dcd}
\begin{DoxyVerb}read chianti dielectronic recombination .drparams files and return
    {'rrtype','params','ref'}\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01370}{1370} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01370}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa29da4afe4adccd8de62c0dd97799dcd}{01370} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa29da4afe4adccd8de62c0dd97799dcd}{drRead}(ions):
01371     \textcolor{stringliteral}{"""read chianti dielectronic recombination .drparams files and return}
01372 \textcolor{stringliteral}{        \{'rrtype','params','ref'\}"""}
01373     \textcolor{comment}{#}
01374     \textcolor{comment}{#}
01375     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
01376     paramname=fname+\textcolor{stringliteral}{'.drparams'}
01377     \textcolor{keywordflow}{if} os.path.isfile(paramname):
01378         input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01379 \textcolor{stringliteral}{        }\textcolor{comment}{#  need to read first line and see how many elements}
01380         lines=input.readlines()
01381         input.close()
01382         drtype=int(lines[0])
01383         ref=lines[4:-1]
01384         \textcolor{comment}{#}
01385         \textcolor{keywordflow}{if} drtype == 1:
01386             \textcolor{comment}{# a Badnell type}
01387             fmt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'2i5,8e12.4'})
01388             eparams=np.asarray(\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[1],fmt)[2:], \textcolor{stringliteral}{'float64'})
01389             cparams=np.asarray(\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[2],fmt)[2:], \textcolor{stringliteral}{'float64'})
01390             DrParams=\{\textcolor{stringliteral}{'drtype'}:drtype, \textcolor{stringliteral}{'eparams'}:eparams,\textcolor{stringliteral}{'cparams'}:cparams,  \textcolor{stringliteral}{'ref'}:ref\}
01391         \textcolor{keywordflow}{elif} drtype == 2:
01392             \textcolor{comment}{# shull type}
01393             fmt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'2i5,4e12.4'})
01394             params=np.asarray(\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[1],fmt)[2:], \textcolor{stringliteral}{'float64'})
01395             DrParams=\{\textcolor{stringliteral}{'drtype'}:drtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01396         \textcolor{keywordflow}{else}:
01397             DrParams = \textcolor{keywordtype}{None}
01398             print((\textcolor{stringliteral}{' for ion %5s unknown DR type = %5i'} %(ions, drtype)))
01399     \textcolor{keywordflow}{else}:
01400         DrParams=\textcolor{keywordtype}{None}
01401     \textcolor{keywordflow}{return} DrParams
01402     \textcolor{comment}{#}
01403     \textcolor{comment}{# -------------------------------------------------------------------------------------}
01404     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!ea\+Cross@{ea\+Cross}}
\index{ea\+Cross@{ea\+Cross}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{ea\+Cross}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ea\+Cross (
\begin{DoxyParamCaption}
\item[{}]{diparams, }
\item[{}]{easplom, }
\item[{}]{elvlc, }
\item[{}]{energy = {\ttfamily None}, }
\item[{}]{verbose = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}
\begin{DoxyVerb}Provide the excitation-autoionization cross section.

Energy is given in eV.
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01223}{1223} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l01755}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+descale\+\_\+bti()}, and \hyperlink{__chianti__tools_8py_source_l00760}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+splom\+Descale()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01223}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{01223} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{eaCross}(diparams, easplom, elvlc, energy=None, verbose=False):
01224     \textcolor{stringliteral}{'''}
01225 \textcolor{stringliteral}{    Provide the excitation-autoionization cross section.}
01226 \textcolor{stringliteral}{}
01227 \textcolor{stringliteral}{    Energy is given in eV.}
01228 \textcolor{stringliteral}{    '''}
01229     energy = np.asarray(energy, \textcolor{stringliteral}{'float64'})
01230     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} energy.any():
01231         btenergy=0.1*np.arange(10)
01232         btenergy[0]=0.01
01233         dum=np.ones(len(btenergy))
01234         [energy, dum] = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47075ba90f01cbd7a3dbd08115544214}{descale\_bti}(btenergy, dum, 2., min(easplom[\textcolor{stringliteral}{'deryd'}]))
01235         energy=np.asarray(energy, \textcolor{stringliteral}{'float64'})
01236     \textcolor{comment}{#}
01237     omega = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a391eb09a09769234e5759d5544d0bcaf}{splomDescale}(easplom, energy)
01238     \textcolor{comment}{#}
01239     \textcolor{comment}{#  need to replicate neaev}
01240 
01241     \textcolor{keywordflow}{if} diparams[\textcolor{stringliteral}{'info'}][\textcolor{stringliteral}{'neaev'}] > 0:
01242         f1 = np.ones(omega.shape[0])
01243     \textcolor{keywordflow}{else}:
01244         f1 = diparams[\textcolor{stringliteral}{'info'}][\textcolor{stringliteral}{'eaev'}]
01245 
01246     totalCross = np.zeros\_like(energy)
01247     ntrans = omega.shape[0]
01248     \textcolor{keywordflow}{for} itrans \textcolor{keywordflow}{in} range(ntrans):
01249         lvl1 = easplom[\textcolor{stringliteral}{'lvl1'}][itrans]
01250         mult = 2.*elvlc[\textcolor{stringliteral}{'j'}][lvl1 - 1] + 1.
01251         cross = f1[itrans]*const.bohrCross*omega[itrans]/(mult.energy/const.ryd2Ev)
01252         totalCross += cross
01253     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'energy'}:energy, \textcolor{stringliteral}{'cross'}:totalCross\}
01254     \textcolor{comment}{#}
01255     \textcolor{comment}{# -------------------------------------------------------------------------------------}
01256     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!ea\+Read@{ea\+Read}}
\index{ea\+Read@{ea\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{ea\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ea\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}
\begin{DoxyVerb}read a chianti excitation-autoionization file and return the EA ionization rate data
derived from splupsRead
{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref}
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01257}{1257} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+convert\+Name()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01257}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{01257} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{eaRead}(ions, filename=0):
01258     \textcolor{stringliteral}{'''}
01259 \textcolor{stringliteral}{    read a chianti excitation-autoionization file and return the EA ionization rate data}
01260 \textcolor{stringliteral}{    derived from splupsRead}
01261 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref\}}
01262 \textcolor{stringliteral}{    '''}
01263     \textcolor{keywordflow}{if} filename:
01264         splupsname = filename
01265     \textcolor{keywordflow}{else}:
01266         zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convertName}(ions)
01267         \textcolor{keywordflow}{if} zion[\textcolor{stringliteral}{'Z'}] < zion[\textcolor{stringliteral}{'Ion'}]:
01268             print(\textcolor{stringliteral}{' this is a bare nucleus that has no ionization rate'})
01269             \textcolor{keywordflow}{return}
01270         \textcolor{comment}{#}
01271         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
01272         splupsname=fname+\textcolor{stringliteral}{'.easplups'}
01273     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(splupsname):
01274         print((\textcolor{stringliteral}{' could not find file:  '}, splupsname))
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01275}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae4b82a587c953b2207888a96d3364677}{01275}         self.Splups=\{\textcolor{stringliteral}{"lvl1"}:-1\}
01276         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:-1\}
01277     \textcolor{comment}{# there is splups/psplups data}
01278     \textcolor{keywordflow}{else}:
01279         input=open(splupsname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01280 \textcolor{stringliteral}{        s1=input.readlines()}
01281 \textcolor{stringliteral}{        dum=input.close()}
01282 \textcolor{stringliteral}{        nsplups=0}
01283 \textcolor{stringliteral}{        ndata=2}
01284 \textcolor{stringliteral}{        }\textcolor{keywordflow}{while} ndata > 1:
01285             s1a=s1[nsplups][:]
01286             s2=s1a.split()
01287             ndata=len(s2)
01288             nsplups=nsplups+1
01289         nsplups=nsplups-1
01290         lvl1=[0]*nsplups
01291         lvl2=[0]*nsplups
01292         ttype=[0]*nsplups
01293         gf=[0.]*nsplups
01294         de=[0.]*nsplups
01295         cups=[0.]*nsplups
01296         nspl=[0]*nsplups
01297         splups=np.zeros((nsplups,9),\textcolor{stringliteral}{'Float64'})
01298         splupsFormat1=\textcolor{stringliteral}{'(6x,3i3,8e10.0)'}
01299         splupsFormat2=\textcolor{stringliteral}{'(6x,3i3,12e10.0)'}
01300         \textcolor{comment}{#}
01301         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nsplups):
01302             \textcolor{keywordflow}{try}:
01303                 inpt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(s1[i],splupsFormat1)
01304             \textcolor{keywordflow}{except}:
01305                 inpt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(s1[i],splupsFormat2)
01306             lvl1[i]=inpt[0]
01307             lvl2[i]=inpt[1]
01308             ttype[i]=inpt[2]
01309             gf[i]=inpt[3]
01310             de[i]=inpt[4]
01311             cups[i]=inpt[5]
01312             \textcolor{keywordflow}{if} len(inpt)  > 13:
01313                 nspl[i]=9
01314                 splups[i].put(range(9),inpt[6:])
01315             \textcolor{keywordflow}{else}:
01316                 nspl[i]=5
01317                 splups[i].put(range(5),inpt[6:])
01318         \textcolor{comment}{#}
01319         ref=[]
01320         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nsplups+1,len(s1)-1):
01321             s1a=s1[i][:-1]
01322             ref.append(s1a.strip())
01323 \textcolor{comment}{#        self.EaParams=\{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups}
01324 \textcolor{comment}{#                ,"nspl":nspl,"splups":splups,"ref":ref\}}
01325         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"de"}:de,\textcolor{stringliteral}{"cups"}:cups
01326                 ,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"splups"}:splups,\textcolor{stringliteral}{"ref"}:ref\}
01327     \textcolor{comment}{#}
01328     \textcolor{comment}{# -------------------------------------------------------------------------------------}
01329     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!easplom\+Read@{easplom\+Read}}
\index{easplom\+Read@{easplom\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{easplom\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+easplom\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{extension = {\ttfamily \textquotesingle{}.splom\textquotesingle{}}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}
\begin{DoxyVerb}read chianti splom files and returns
{"lvl1":lvl1,"lvl2":lvl2,"deryd":de,"gf":gf,"eryd":eout,"omega":omout}
currently only works for 5 point spline fit files\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00706}{706} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00706}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{00706} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{easplomRead}(ions, extension='.splom'):
00707     \textcolor{stringliteral}{"""read chianti splom files and returns}
00708 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"deryd":de,"gf":gf,"eryd":eout,"omega":omout\}}
00709 \textcolor{stringliteral}{    currently only works for 5 point spline fit files"""}
00710     \textcolor{comment}{#}
00711     \textcolor{comment}{#}
00712     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
00713     omname=fname+extension
00714     input=open(omname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00715 \textcolor{stringliteral}{    lines=input.readlines()}
00716 \textcolor{stringliteral}{    input.close()}
00717 \textcolor{stringliteral}{    format=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(}\textcolor{stringliteral}{'5i3,8e10.3'})
00718     data=5
00719     iline=0
00720     lvl1=[]
00721     lvl2=[]
00722     ttype=[]
00723     gf=[]
00724     de=[]
00725     om=[]
00726     z=1
00727     \textcolor{keywordflow}{while} z > 0:
00728         omdat1=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[iline],format)
00729         z=omdat1[0]
00730         \textcolor{keywordflow}{if} z > 0:
00731             l1=omdat1[2]
00732             l2=omdat1[3]
00733             ttype1=omdat1[4]
00734             gf1=omdat1[5]
00735             de1=omdat1[6]
00736             btf1=omdat1[7]
00737             om1=omdat1[8:]
00738             \textcolor{comment}{#}
00739             lvl1.append(l1)
00740             lvl2.append(l2)
00741             ttype.append(ttype1)
00742             gf.append(gf1)
00743             de.append(de1)
00744             om.append(om1)
00745         iline=iline+1
00746     omout=np.asarray(om,\textcolor{stringliteral}{'Float64'})
00747     ref=lines[iline:-1]
00748 \textcolor{comment}{#        omout=np.transpose(omout)}
00749     \textcolor{keywordflow}{if} extension == \textcolor{stringliteral}{'.omdat'}:
00750         Splom=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{'ttype'}:ttype,\textcolor{stringliteral}{"gf"}:gf, \textcolor{stringliteral}{"deryd"}:de,\textcolor{stringliteral}{"omega"}:omout, \textcolor{stringliteral}{'ref'}:ref\}
00751         \textcolor{keywordflow}{return} Splom
00752     \textcolor{keywordflow}{elif}  extension == \textcolor{stringliteral}{'.easplom'}:
00753         Easplom=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{'ttype'}:ttype,\textcolor{stringliteral}{"gf"}:gf, \textcolor{stringliteral}{"deryd"}:de,\textcolor{stringliteral}{"omega"}:omout, \textcolor{stringliteral}{'ref'}:ref\}
00754         \textcolor{keywordflow}{return} Easplom
00755 
00756     \textcolor{keywordflow}{return}
00757     \textcolor{comment}{#}
00758     \textcolor{comment}{#-----------------------------------------------------------}
00759     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a32ffd2ba65d19385acc6921d77da7976}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!el2z@{el2z}}
\index{el2z@{el2z}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{el2z}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+el2z (
\begin{DoxyParamCaption}
\item[{}]{els}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a32ffd2ba65d19385acc6921d77da7976}
\begin{DoxyVerb}from an the name of the element (1-2 letter) return Z\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00406}{406} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00406}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a32ffd2ba65d19385acc6921d77da7976}{00406} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a32ffd2ba65d19385acc6921d77da7976}{el2z}(els):
00407     \textcolor{stringliteral}{""" from an the name of the element (1-2 letter) return Z"""}
00408     z=const.El.index(els.lower())+1
00409     \textcolor{keywordflow}{return} z
00410     \textcolor{comment}{#}
00411     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00412     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!elvlc\+Read@{elvlc\+Read}}
\index{elvlc\+Read@{elvlc\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{elvlc\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+elvlc\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily None}, }
\item[{}]{verbose = {\ttfamily 0}, }
\item[{}]{use\+Th = {\ttfamily 1}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}
\begin{DoxyVerb}read a chianti energy level file and returns
{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j
,"mult":mult,"ecm":ecm,"eryd":eryd,"ecmth":ecmth,"erydth":erydth,"ref":ref,"pretty":pretty, 'ionS':ions}
if a energy value for ecm or eryd is zero(=unknown), the theoretical values
(ecmth and erydth) are inserted
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00453}{453} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00572}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+wgfa\+Read()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00453}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{00453} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{elvlcRead}(ions, filename = None, verbose=0,  useTh=1):
00454     \textcolor{stringliteral}{"""}
00455 \textcolor{stringliteral}{    read a chianti energy level file and returns}
00456 \textcolor{stringliteral}{    \{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j}
00457 \textcolor{stringliteral}{    ,"mult":mult,"ecm":ecm,"eryd":eryd,"ecmth":ecmth,"erydth":erydth,"ref":ref,"pretty":pretty, 'ionS'
      :ions\}}
00458 \textcolor{stringliteral}{    if a energy value for ecm or eryd is zero(=unknown), the theoretical values}
00459 \textcolor{stringliteral}{    (ecmth and erydth) are inserted}
00460 \textcolor{stringliteral}{    """}
00461     \textcolor{comment}{#}
00462     fstring=\textcolor{stringliteral}{'i3,i6,a15,i3,i3,a3,f4.1,i3,4f15.2'}
00463     elvlcFormat=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(fstring)
00464     \textcolor{comment}{#}
00465     \textcolor{keywordflow}{if} type(filename) == NoneType:
00466         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
00467         elvlname=fname+\textcolor{stringliteral}{'.elvlc'}
00468     \textcolor{keywordflow}{else}:
00469         elvlname = filename
00470         bname = os.path.basename(filename)
00471         ions = bname.split(\textcolor{stringliteral}{'.'})[0]
00472     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.isfile(elvlname):
00473         \textcolor{keywordflow}{print} \textcolor{stringliteral}{' elvlc file does not exist:  '},elvlname
00474         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'status'}:0\}
00475     status = 1
00476     input=open(elvlname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00477 \textcolor{stringliteral}{    s1=input.readlines()}
00478 \textcolor{stringliteral}{    input.close()}
00479 \textcolor{stringliteral}{    nlvls=0}
00480 \textcolor{stringliteral}{    ndata=2}
00481 \textcolor{stringliteral}{    }\textcolor{keywordflow}{while} ndata > 1:
00482         s1a=s1[nlvls][:-1]
00483         s2=s1a.split()
00484         ndata=len(s2)
00485         nlvls=nlvls+1
00486     nlvls-=1
00487     \textcolor{keywordflow}{if} verbose:
00488         \textcolor{keywordflow}{print} \textcolor{stringliteral}{' nlvls = '}, nlvls
00489     lvl=[0]*nlvls
00490     conf=[0]*nlvls
00491     term=[0]*nlvls
00492     spin=[0]*nlvls
00493     l=[0]*nlvls
00494     spd=[0]*nlvls
00495     j=[0]*nlvls
00496     mult=[0]*nlvls
00497     ecm=[0]*nlvls
00498     eryd=[0]*nlvls
00499     ecmth=[0]*nlvls
00500     erydth=[0]*nlvls
00501     pretty=[0]*nlvls
00502     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nlvls):
00503         \textcolor{keywordflow}{if} verbose:
00504             \textcolor{keywordflow}{print} s1[i][0:115]
00505         inpt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(s1[i][0:115],elvlcFormat)
00506         lvl[i]=inpt[0]
00507         conf[i]=inpt[1]
00508         term[i]=inpt[2].strip()
00509         spin[i]=inpt[3]
00510         l[i]=inpt[4]
00511         spd[i]=inpt[5].strip()
00512         j[i]=inpt[6]
00513         mult[i]=inpt[7]
00514         ecm[i]=inpt[8]
00515         eryd[i]=inpt[9]
00516         ecmth[i]=inpt[10]
00517         erydth[i]=inpt[11]
00518         \textcolor{keywordflow}{if} ecm[i] == 0.:
00519             \textcolor{keywordflow}{if} useTh:
00520                 ecm[i] = ecmth[i]
00521                 eryd[i] = erydth[i]
00522         stuff = term[i].strip() + \textcolor{stringliteral}{' %1i%1s%3.1f'}%( spin[i], spd[i], j[i])
00523         pretty[i] = stuff.strip()
00524     ref=[]
00525     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nlvls+1,len(s1)-1):
00526         s1a=s1[i][:-1]
00527         ref.append(s1a.strip())
00528 \textcolor{comment}{#    self.const.Elvlc=\{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j}
00529 \textcolor{comment}{#            ,"mult":mult,"ecm":ecm,"eryd":eryd,"ecmth":ecmth,"erydth":erydth,"ref":ref\}}
00530     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl"}:lvl,\textcolor{stringliteral}{"conf"}:conf,\textcolor{stringliteral}{"term"}:term,\textcolor{stringliteral}{"spin"}:spin,\textcolor{stringliteral}{"l"}:l,\textcolor{stringliteral}{"spd"}:spd,\textcolor{stringliteral}{"j"}:j
00531             ,\textcolor{stringliteral}{"mult"}:mult,\textcolor{stringliteral}{"ecm"}:ecm,\textcolor{stringliteral}{"eryd"}:eryd,\textcolor{stringliteral}{"ecmth"}:ecmth,\textcolor{stringliteral}{"erydth"}:erydth,\textcolor{stringliteral}{"ref"}:ref,\textcolor{stringliteral}{"pretty"}:pretty, \textcolor{stringliteral}{'
      ionS'}:ions, \textcolor{stringliteral}{'status'}:status\}
00532     \textcolor{comment}{#}
00533     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00534     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a279f0911664046ffd65c19571be8a84d}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!elvlc\+Write@{elvlc\+Write}}
\index{elvlc\+Write@{elvlc\+Write}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{elvlc\+Write}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+elvlc\+Write (
\begin{DoxyParamCaption}
\item[{}]{info}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a279f0911664046ffd65c19571be8a84d}
\begin{DoxyVerb}creates a .elvlc in the current directory
info is a dictionary that must contain the following keys
ionS, the Chianti style name of the ion such as c_4
conf, an integer denoting the configuration - not too essential
term, a string showing the configuration
spin, an integer of the spin of the state in LS coupling
l, an integer of the angular momentum quantum number
spd, an string for the alphabetic symbol of the angular momemtum, S, P, D, etc
j, a floating point number, the total angular momentum
ecm, the observed energy in inverse cm, if unknown, the value is 0.
eryd, the observed energy in Rydbergs, if unknown, the value is 0.
ecmth, the calculated energy from the scattering calculation, in inverse cm
erydth, the calculated energy from the scattering calculation in Rydbergs
ref, the references in the literature to the data in the input info\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00535}{535} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00535}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a279f0911664046ffd65c19571be8a84d}{00535} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a279f0911664046ffd65c19571be8a84d}{elvlcWrite}(info):
00536     \textcolor{stringliteral}{''' creates a .elvlc in the current directory}
00537 \textcolor{stringliteral}{    info is a dictionary that must contain the following keys}
00538 \textcolor{stringliteral}{    ionS, the Chianti style name of the ion such as c\_4}
00539 \textcolor{stringliteral}{    conf, an integer denoting the configuration - not too essential}
00540 \textcolor{stringliteral}{    term, a string showing the configuration}
00541 \textcolor{stringliteral}{    spin, an integer of the spin of the state in LS coupling}
00542 \textcolor{stringliteral}{    l, an integer of the angular momentum quantum number}
00543 \textcolor{stringliteral}{    spd, an string for the alphabetic symbol of the angular momemtum, S, P, D, etc}
00544 \textcolor{stringliteral}{    j, a floating point number, the total angular momentum}
00545 \textcolor{stringliteral}{    ecm, the observed energy in inverse cm, if unknown, the value is 0.}
00546 \textcolor{stringliteral}{    eryd, the observed energy in Rydbergs, if unknown, the value is 0.}
00547 \textcolor{stringliteral}{    ecmth, the calculated energy from the scattering calculation, in inverse cm}
00548 \textcolor{stringliteral}{    erydth, the calculated energy from the scattering calculation in Rydbergs}
00549 \textcolor{stringliteral}{    ref, the references in the literature to the data in the input info'''}
00550     gname = info[\textcolor{stringliteral}{'ionS'}]
00551     elvlcname = gname + \textcolor{stringliteral}{'.elvlc'}
00552     \textcolor{keywordflow}{print} \textcolor{stringliteral}{' elvlc file name = '}, elvlcname
00553     out = open(elvlcname, \textcolor{stringliteral}{'w'})
00554     \textcolor{keywordflow}{for} i,  conf \textcolor{keywordflow}{in} enumerate(info[\textcolor{stringliteral}{'conf'}]):
00555         mult = int(2.*info[\textcolor{stringliteral}{'j'}][i]+1.)
00556         pstring = \textcolor{stringliteral}{'%3i%6s%15s%3i%3i%2s%5.1f%3i%15.3f%15.6f%15.3f%15.6f \(\backslash\)n'}%(i+1, conf, info[\textcolor{stringliteral}{'term'}][i], 
      info[\textcolor{stringliteral}{'spin'}][i], info[\textcolor{stringliteral}{'l'}][i], info[\textcolor{stringliteral}{'spd'}][i], info[\textcolor{stringliteral}{'j'}][i], mult, info[\textcolor{stringliteral}{'ecm'}][i], info[\textcolor{stringliteral}{'eryd'}][i], info[\textcolor{stringliteral}{'ecmth
      '}][i], info[\textcolor{stringliteral}{'erydth'}][i])
00557     \textcolor{comment}{#i3,a6,a15,2i3,a2,f5.1,i3,f15.3,f15.6,f15.3,f15.6}
00558         out.write(pstring)
00559     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00560     out.write(\textcolor{stringliteral}{'%filename:  '} + elvlcname + \textcolor{stringliteral}{'\(\backslash\)n'})
00561     info[\textcolor{stringliteral}{'ref'}].append(\textcolor{stringliteral}{' produced as a part of the George Mason University, University of Cambridge,
       University of Michigan \(\backslash\)'CHIANTI\(\backslash\)' atomic database for astrophysical spectroscopy consortium'})
00562     today = date.today()
00563     info[\textcolor{stringliteral}{'ref'}].append(\textcolor{stringliteral}{' K. Dere (GMU) - '} + today.strftime(\textcolor{stringliteral}{'%Y %B %d'}))
00564     \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} info[\textcolor{stringliteral}{'ref'}]:
00565         out.write(one+\textcolor{stringliteral}{'\(\backslash\)n'})
00566     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00567     out.close()
00568     \textcolor{keywordflow}{return}
00569     \textcolor{comment}{#}
00570     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00571     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!fblvl\+Read@{fblvl\+Read}}
\index{fblvl\+Read@{fblvl\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{fblvl\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+fblvl\+Read (
\begin{DoxyParamCaption}
\item[{}]{filename, }
\item[{}]{verbose = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}
\begin{DoxyVerb}read a chianti energy level file and returns
{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j
,"mult":mult,"ecm":ecm,"eryd":eryd,"ref":ref}\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01545}{1545} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01545}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{01545} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{fblvlRead}(filename, verbose=False):
01546     \textcolor{stringliteral}{""" read a chianti energy level file and returns}
01547 \textcolor{stringliteral}{    \{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j}
01548 \textcolor{stringliteral}{    ,"mult":mult,"ecm":ecm,"eryd":eryd,"ref":ref\}"""}
01549 \textcolor{comment}{#        #  ,format='(i5,a20,2i5,a3,i5,2f20.3)'}
01550     fstring=\textcolor{stringliteral}{'i5,a20,2i5,a3,i5,2f20.3'}
01551     elvlcFormat=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(fstring)
01552     \textcolor{comment}{#}
01553     \textcolor{keywordflow}{if} os.path.exists(filename):
01554         input=open(filename,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01555 \textcolor{stringliteral}{        s1=input.readlines()}
01556 \textcolor{stringliteral}{        input.close()}
01557 \textcolor{stringliteral}{        nlvls=0}
01558 \textcolor{stringliteral}{        ndata=2}
01559 \textcolor{stringliteral}{        }\textcolor{keywordflow}{while} ndata > 1:
01560             s1a=s1[nlvls][:-1]
01561             s2=s1a.split()
01562             ndata=len(s2)
01563             nlvls=nlvls+1
01564         nlvls-=1
01565         \textcolor{keywordflow}{if} verbose:
01566             print((\textcolor{stringliteral}{' nlvls = %5i'}%(nlvls)))
01567         lvl=[0]*nlvls
01568         conf=[0]*nlvls
01569         pqn=[0]*nlvls
01570         l=[0]*nlvls
01571         spd=[0]*nlvls
01572         mult=[0]*nlvls
01573         ecm=[0]*nlvls
01574         ecmth=[0]*nlvls
01575         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nlvls):
01576             \textcolor{keywordflow}{if} verbose:
01577                 print((s1[i]))
01578             inpt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(s1[i],elvlcFormat)
01579             lvl[i]=inpt[0]
01580             conf[i]=inpt[1].strip()
01581             pqn[i]=inpt[2]
01582             l[i]=inpt[3]
01583             spd[i]=inpt[4].strip()
01584             mult[i]=inpt[5]
01585             \textcolor{keywordflow}{if} inpt[6] == 0.:
01586                 ecm[i]=inpt[7]
01587             \textcolor{keywordflow}{else}:
01588                 ecm[i]=inpt[6]
01589                 ecmth[i]=inpt[7]
01590         ref=[]
01591         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nlvls+1,len(s1)-1):
01592             s1a=s1[i][:-1]
01593             ref.append(s1a.strip())
01594         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl"}:lvl,\textcolor{stringliteral}{"conf"}:conf,\textcolor{stringliteral}{'pqn'}:pqn,\textcolor{stringliteral}{"l"}:l,\textcolor{stringliteral}{"spd"}:spd,\textcolor{stringliteral}{"mult"}:mult,
01595             \textcolor{stringliteral}{"ecm"}:ecm,\textcolor{stringliteral}{'ecmth'}:ecmth, \textcolor{stringliteral}{'ref'}:ref\}
01596     \textcolor{keywordflow}{else}:
01597         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'errorMessage'}:\textcolor{stringliteral}{' fblvl file does not exist'}\}
01598     \textcolor{comment}{#}
01599     \textcolor{comment}{# -----------------------------------------------------------------}
01600     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a27deea720e4534912f04b54fe5c17b93}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!gffint\+Read@{gffint\+Read}}
\index{gffint\+Read@{gffint\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{gffint\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+gffint\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a27deea720e4534912f04b54fe5c17b93}
\begin{DoxyVerb}to read the integrated free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01453}{1453} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01453}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a27deea720e4534912f04b54fe5c17b93}{01453} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a27deea720e4534912f04b54fe5c17b93}{gffintRead}():
01454     \textcolor{stringliteral}{'''to read the integrated free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.'''}
01455     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01456     fileName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'},\textcolor{stringliteral}{'gffint.dat'} )
01457     input = open(fileName)
01458     lines = input.readlines()
01459     input.close()
01460     \textcolor{comment}{#}
01461     ngamma=41
01462     g2 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01463     gffint = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01464     s1 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01465     s2 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01466     s3 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01467     \textcolor{comment}{#}
01468     ivalue = 0
01469     start = 4
01470     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(start,start+ngamma):
01471         values = lines[iline].split()
01472         g2[ivalue] = float(values[0])
01473         gffint[ivalue] = float(values[1])
01474         s1[ivalue] = float(values[2])
01475         s2[ivalue] = float(values[3])
01476         s3[ivalue] = float(values[4])
01477         ivalue += 1
01478     \textcolor{comment}{#}
01479     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'g2'}:g2, \textcolor{stringliteral}{'gffint'}:gffint, \textcolor{stringliteral}{'s1'}:s1, \textcolor{stringliteral}{'s2'}:s2, \textcolor{stringliteral}{'s3'}:s3\}
01480     \textcolor{comment}{#}
01481     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
01482     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_af524b50fae5a347eff4976b7ce895ab1}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!gff\+Read@{gff\+Read}}
\index{gff\+Read@{gff\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{gff\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+gff\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_af524b50fae5a347eff4976b7ce895ab1}
\begin{DoxyVerb}to read the free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.
this function reads the file and reverses the values of g2 and u\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01415}{1415} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01415}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_af524b50fae5a347eff4976b7ce895ab1}{01415} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_af524b50fae5a347eff4976b7ce895ab1}{gffRead}():
01416     \textcolor{stringliteral}{'''to read the free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.}
01417 \textcolor{stringliteral}{    this function reads the file and reverses the values of g2 and u'''}
01418     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01419     fileName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'},\textcolor{stringliteral}{'gffgu.dat'} )
01420     input = open(fileName)
01421     lines = input.readlines()
01422     input.close()
01423     \textcolor{comment}{#}
01424     \textcolor{comment}{#  the 1d stuff below is to make it easy to use interp2d}
01425     ngamma=41
01426     nu=81
01427     nvalues = ngamma*nu
01428     g2 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01429     g21d = np.zeros(nvalues, \textcolor{stringliteral}{'float64'})
01430     u = np.zeros(nu, \textcolor{stringliteral}{'float64'})
01431     u1d = np.zeros(nvalues, \textcolor{stringliteral}{'float64'})
01432     gff = np.zeros((ngamma, nu), \textcolor{stringliteral}{'float64'})
01433     gff1d = np.zeros(nvalues, \textcolor{stringliteral}{'float64'})
01434     \textcolor{comment}{#}
01435     iline = 5
01436     ivalue = 0
01437     \textcolor{keywordflow}{for} ig2 \textcolor{keywordflow}{in} range(ngamma):
01438         \textcolor{keywordflow}{for} iu \textcolor{keywordflow}{in} range(nu):
01439             values = lines[iline].split()
01440             u[iu] = float(values[1])
01441             u1d[ivalue] = float(values[1])
01442             g2[ig2] = float(values[0])
01443             g21d[ivalue] = float(values[0])
01444             gff[ig2, iu] = float(values[2])
01445             gff1d[ivalue] = float(values[2])
01446             iline+=1
01447             ivalue += 1
01448     \textcolor{comment}{#}
01449     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'g2'}:g2, \textcolor{stringliteral}{'g21d'}:g21d,  \textcolor{stringliteral}{'}\textcolor{stringliteral}{u':u, '}u1d':u1d,  'gff':gff,  'gff1d':gff1d\}
01450     \textcolor{comment}{#}
01451     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
01452     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!ion2filename@{ion2filename}}
\index{ion2filename@{ion2filename}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{ion2filename}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}
\begin{DoxyVerb}convert ion string to generic file name string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00396}{396} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+convert\+Name()}, and \hyperlink{__chianti__tools_8py_source_l00282}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+z2element()}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00985}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+cireclvl\+Read()}, \hyperlink{__chianti__tools_8py_source_l01155}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+di\+Read()}, \hyperlink{__chianti__tools_8py_source_l01370}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+dr\+Read()}, \hyperlink{__chianti__tools_8py_source_l01257}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ea\+Read()}, \hyperlink{__chianti__tools_8py_source_l00706}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+easplom\+Read()}, \hyperlink{__chianti__tools_8py_source_l00453}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+elvlc\+Read()}, \hyperlink{__chianti__tools_8py_source_l00185}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+photox\+Read()}, \hyperlink{__chianti__tools_8py_source_l01330}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+rr\+Read()}, \hyperlink{__chianti__tools_8py_source_l00827}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+splom\+Read()}, \hyperlink{__chianti__tools_8py_source_l00891}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+splups\+Read()}, and \hyperlink{__chianti__tools_8py_source_l00572}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+wgfa\+Read()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00396}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{00396} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions):
00397     \textcolor{stringliteral}{""" convert ion string to generic file name string """}
00398     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00399     zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convertName}(ions)
00400     el=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0e092ff402fc0287bcaaed67171934ea}{z2element}(zion[\textcolor{stringliteral}{'Z'}])
00401     fname=os.path.join(dir,el,ions,ions)
00402     \textcolor{keywordflow}{return} fname
00403     \textcolor{comment}{#}
00404     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00405     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!ioneq\+Read@{ioneq\+Read}}
\index{ioneq\+Read@{ioneq\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{ioneq\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ioneq\+Read (
\begin{DoxyParamCaption}
\item[{}]{ioneqname = {\ttfamily \textquotesingle{}\textquotesingle{}}, }
\item[{}]{verbose = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}
\begin{DoxyVerb}reads an ioneq file and stores temperatures and ionization
equilibrium values in self.IoneqTemperature and self.Ioneq and returns
a dictionary containing these value and the reference to the literature
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01405}{1405} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01405}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{01405} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{ioneqRead}(ioneqname='', verbose=0):
01406     \textcolor{stringliteral}{"""}
01407 \textcolor{stringliteral}{    reads an ioneq file and stores temperatures and ionization}
01408 \textcolor{stringliteral}{    equilibrium values in self.IoneqTemperature and self.Ioneq and returns}
01409 \textcolor{stringliteral}{    a dictionary containing these value and the reference to the literature}
01410 \textcolor{stringliteral}{    """}
01411     \textcolor{keywordflow}{pass}
01412     \textcolor{comment}{#}
01413     \textcolor{comment}{# -------------------------------------------------------------------------------------}
01414     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a552566dde90c6b3d2d8e934914d3ae76}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!ionrecdat\+Read@{ionrecdat\+Read}}
\index{ionrecdat\+Read@{ionrecdat\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{ionrecdat\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ionrecdat\+Read (
\begin{DoxyParamCaption}
\item[{}]{filename}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a552566dde90c6b3d2d8e934914d3ae76}
\begin{DoxyVerb}read chianti ionxdat, ionizdat, recombdat files and return
{"ev":ev,"cross":cross,"crosserr":crosserr,"ref":ref}  not tested \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00237}{237} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00237}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a552566dde90c6b3d2d8e934914d3ae76}{00237} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a552566dde90c6b3d2d8e934914d3ae76}{ionrecdatRead}(filename):
00238     \textcolor{stringliteral}{""" read chianti ionxdat, ionizdat, recombdat files and return}
00239 \textcolor{stringliteral}{    \{"ev":ev,"cross":cross,"crosserr":crosserr,"ref":ref\}  not tested """}
00240     \textcolor{comment}{#}
00241     input=open(filename,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00242 \textcolor{stringliteral}{    ionrec=input.readlines()}
00243 \textcolor{stringliteral}{    dum=input.close()}
00244 \textcolor{stringliteral}{    }\textcolor{comment}{#}
00245     \textcolor{comment}{# first get the number of data lines}
00246     ndata=2
00247     iline=0
00248     \textcolor{keywordflow}{while} ndata > 1:
00249         s2=ionrec[iline].split()
00250         ndata=len(s2)
00251         iline=iline+1
00252     nline=iline-1
00253     \textcolor{comment}{#}
00254     x=np.zeros(nline,\textcolor{stringliteral}{'Float64'})
00255     y=np.zeros(nline,\textcolor{stringliteral}{'Float64'})
00256     yerr=np.zeros(nline,\textcolor{stringliteral}{'Float64'})
00257 \textcolor{comment}{#}
00258     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(0,nline):
00259         ndata=len
00260         s2=ionrec[iline].split()
00261         ndata=len(s2)
00262         \textcolor{keywordflow}{if} ndata == 2:
00263             x[iline]=float(s2[0])
00264             y[iline]=float(s2[1])
00265             yerr[iline]=float(0.)
00266         \textcolor{keywordflow}{else}:
00267             x[iline]=float(s2[0])
00268             y[iline]=float(s2[1])
00269             yerr[iline]=float(s2[2])
00270     \textcolor{comment}{#}
00271     ref=[]
00272     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(nline+1,len(ionrec)-1):
00273         s1a=ionrec[iline][:-1]
00274         ref.append(s1a.strip())
00275 
00276 
00277     ionrecdat=\{\textcolor{stringliteral}{"x"}:x,\textcolor{stringliteral}{"y"}:y,\textcolor{stringliteral}{"yerr"}:yerr,\textcolor{stringliteral}{"ref"}:ref\}
00278     \textcolor{keywordflow}{return} ionrecdat
00279     \textcolor{comment}{#}
00280     \textcolor{comment}{# --------------------------------------------------}
00281     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!ip\+Read@{ip\+Read}}
\index{ip\+Read@{ip\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{ip\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ip\+Read (
\begin{DoxyParamCaption}
\item[{}]{verbose = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}
\begin{DoxyVerb}reads the ionization potential file, returns ip array in eV
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00033}{33} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00033}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{00033} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{ipRead}(verbose=False):
00034     \textcolor{stringliteral}{"""}
00035 \textcolor{stringliteral}{    reads the ionization potential file, returns ip array in eV}
00036 \textcolor{stringliteral}{    """}
00037     topdir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00038     ipname=os.path.join(topdir, \textcolor{stringliteral}{'ip'},\textcolor{stringliteral}{'chianti.ip'})
00039     ipfile=open(ipname)
00040     data=ipfile.readlines()
00041     ipfile.close()
00042     nip=0
00043     ndata=2
00044     maxz=0
00045     \textcolor{keywordflow}{while} ndata > 1:
00046         s1=data[nip]
00047         s2=s1.split()
00048         ndata=len(s2)
00049         nip=nip+1
00050         \textcolor{keywordflow}{if} int(s2[0]) > maxz:
00051             maxz=int(s2[0])
00052     \textcolor{keywordflow}{if} verbose:
00053         print((\textcolor{stringliteral}{' maxz = %5i'}%(maxz)))
00054     nip=nip-1
00055     ip=np.zeros((maxz, maxz), \textcolor{stringliteral}{'Float64'})
00056     \textcolor{keywordflow}{for} aline \textcolor{keywordflow}{in} data[0:nip]:
00057         s2=aline.split()
00058         iz=int(s2[0])
00059         ion=int(s2[1])
00060         ip[iz-1, ion-1]=float(s2[2])
00061     \textcolor{keywordflow}{return} ip*const.invCm2Ev
00062     \textcolor{comment}{#}
00063     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00064     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a3dc5585b3508d8baf58ba62d0f728f16}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!itoh\+Read@{itoh\+Read}}
\index{itoh\+Read@{itoh\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{itoh\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+itoh\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a3dc5585b3508d8baf58ba62d0f728f16}
\begin{DoxyVerb}to read in the free-free gaunt factors of Itoh et al. (ApJS 128, 125, 2000)\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01483}{1483} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01483}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3dc5585b3508d8baf58ba62d0f728f16}{01483} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3dc5585b3508d8baf58ba62d0f728f16}{itohRead}():
01484     \textcolor{stringliteral}{'''to read in the free-free gaunt factors of Itoh et al. (ApJS 128, 125, 2000)'''}
01485     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01486     itohName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'itoh.dat'})
01487     input = open(itohName)
01488     lines = input.readlines()
01489     input.close()
01490     gff = np.zeros((30, 121), \textcolor{stringliteral}{'float64'})
01491     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(30):
01492         gff[iline]= np.asarray(lines[iline].split(), \textcolor{stringliteral}{'float64'})
01493     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'itohCoef'}:gff\}
01494     \textcolor{comment}{#}
01495     \textcolor{comment}{#}
01496     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
01497     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aa4cdc5fd04cf99d7600e480f0dc95ae4}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!klgfb\+Read@{klgfb\+Read}}
\index{klgfb\+Read@{klgfb\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{klgfb\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+klgfb\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aa4cdc5fd04cf99d7600e480f0dc95ae4}
\begin{DoxyVerb}to read CHIANTI files file containing the free-bound gaunt factors for n=1-6 from Karzas and Latter, 1961, ApJSS, 6, 167
returns {pe, klgfb}, the photon energy and the free-bound gaunt factors\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01498}{1498} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01498}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa4cdc5fd04cf99d7600e480f0dc95ae4}{01498} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa4cdc5fd04cf99d7600e480f0dc95ae4}{klgfbRead}():
01499     \textcolor{stringliteral}{'''to read CHIANTI files file containing the free-bound gaunt factors for n=1-6 from Karzas and Latter,
       1961, ApJSS, 6, 167}
01500 \textcolor{stringliteral}{    returns \{pe, klgfb\}, the photon energy and the free-bound gaunt factors'''}
01501     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01502     fname = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'klgfb.dat'})
01503     input = open(fname)
01504     lines = input.readlines()
01505     input.close()
01506     \textcolor{comment}{#}
01507     ngfb = int(lines[0].split()[0])
01508     nume = int(lines[0].split()[1])
01509 
01510     gfb = np.zeros((ngfb, ngfb, nume), \textcolor{stringliteral}{'float64'})
01511     nlines = len(lines)
01512 \textcolor{comment}{#        print 'nlines, nume, ngfb = ', nlines,  nume, ngfb}
01513     pe = np.asarray(lines[1].split(), \textcolor{stringliteral}{'float64'})
01514     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(2, nlines):
01515         data = lines[iline].split()
01516         n = int(data[0])
01517         l = int(data[1])
01518         gfb[n-1, l] = np.array(data[2:], \textcolor{stringliteral}{'float64'})
01519     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'pe'}:pe, \textcolor{stringliteral}{'klgfb'}:gfb\}
01520 \textcolor{comment}{#}
01521 \textcolor{comment}{#  ---------------------------------------------------------}
01522 \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a680536bf77d8f8baa8434c1bf84350a4}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!list\+Files@{list\+Files}}
\index{list\+Files@{list\+Files}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{list\+Files}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+list\+Files (
\begin{DoxyParamCaption}
\item[{}]{path}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a680536bf77d8f8baa8434c1bf84350a4}
\begin{DoxyVerb}walks the path and subdirectories to return a list of files
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01523}{1523} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01523}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a680536bf77d8f8baa8434c1bf84350a4}{01523} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a680536bf77d8f8baa8434c1bf84350a4}{listFiles}(path):
01524     \textcolor{stringliteral}{'''}
01525 \textcolor{stringliteral}{    walks the path and subdirectories to return a list of files}
01526 \textcolor{stringliteral}{    '''}
01527     alist=os.walk(path)
01528     print(\textcolor{stringliteral}{' getting file list'})
01529     listname=[]
01530     \textcolor{keywordflow}{for} (dirpath,dirnames,filenames) \textcolor{keywordflow}{in} alist:
01531         \textcolor{keywordflow}{if} len(dirnames) == 0:
01532             \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} filenames:
01533                 file=os.path.join(dirpath,f)
01534                 \textcolor{keywordflow}{if} os.path.isfile(file):
01535                     listname.append(file)
01536         \textcolor{keywordflow}{else}:
01537             \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} filenames:
01538                 file=os.path.join(dirpath,f)
01539                 \textcolor{keywordflow}{if} os.path.isfile(file):
01540                     listname.append(file)
01541     \textcolor{keywordflow}{return} listname
01542     \textcolor{comment}{#}
01543     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
01544     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!master\+List\+Info@{master\+List\+Info}}
\index{master\+List\+Info@{master\+List\+Info}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{master\+List\+Info}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Info (
\begin{DoxyParamCaption}
\item[{}]{force = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}
\begin{DoxyVerb}returns information about ions in masterlist
the reason for this file is to speed up multi-ion spectral calculations
the information is stored in a pickled file 'masterlist_ions.pkl'
if the file is not found, one will be created and the following information
returned for each ion
wmin, wmax :  the minimum and maximum wavelengths in the wgfa file
tmin, tmax :  the minimum and maximum temperatures for which the ionization balance is nonzero\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00065}{65} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+convert\+Name()}, \hyperlink{__chianti__tools_8py_source_l00368}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+defaults\+Read()}, \hyperlink{__chianti__tools_8py_source_l01405}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ioneq\+Read()}, \hyperlink{__chianti__tools_8py_source_l00169}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Read()}, \hyperlink{__chianti__tools_8py_source_l00572}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+wgfa\+Read()}, and \hyperlink{__chianti__tools_8py_source_l00292}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+zion2name()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00065}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{00065} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{masterListInfo}(force=0):
00066     \textcolor{stringliteral}{""" returns information about ions in masterlist}
00067 \textcolor{stringliteral}{    the reason for this file is to speed up multi-ion spectral calculations}
00068 \textcolor{stringliteral}{    the information is stored in a pickled file 'masterlist\_ions.pkl'}
00069 \textcolor{stringliteral}{    if the file is not found, one will be created and the following information}
00070 \textcolor{stringliteral}{    returned for each ion}
00071 \textcolor{stringliteral}{    wmin, wmax :  the minimum and maximum wavelengths in the wgfa file}
00072 \textcolor{stringliteral}{    tmin, tmax :  the minimum and maximum temperatures for which the ionization balance is nonzero"""}
00073     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00074     infoPath = os.path.join(dir, \textcolor{stringliteral}{'masterlist'})
00075     infoName=os.path.join(dir,\textcolor{stringliteral}{'masterlist'},\textcolor{stringliteral}{'masterlist\_ions.pkl'})
00076     masterName=os.path.join(dir,\textcolor{stringliteral}{'masterlist'},\textcolor{stringliteral}{'masterlist.ions'})
00077     \textcolor{comment}{#}
00078     makeNew = force == 1 \textcolor{keywordflow}{or} \textcolor{keywordflow}{not} os.path.isfile(infoName)
00079 \textcolor{comment}{#    if os.path.isfile(infoName):}
00080     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} makeNew:
00081 \textcolor{comment}{#       print ' file exists - ',  infoName}
00082         pfile = open(infoName, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00083 \textcolor{stringliteral}{        masterListInfo = pickle.load(pfile)}
00084 \textcolor{stringliteral}{        pfile.close}
00085 \textcolor{stringliteral}{    }\textcolor{keywordflow}{elif} os.access(infoPath, os.W\_OK):
00086         \textcolor{comment}{# the file does not exist but we have write access and will create it}
00087         defaults = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{defaultsRead}()
00088         print((\textcolor{stringliteral}{' defaults = %s'}%(str(defaults))))
00089         ioneqName = defaults[\textcolor{stringliteral}{'ioneqfile'}]
00090         ioneq = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{ioneqRead}(ioneqname = ioneqName)
00091         masterList = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a1a4447320a9d614f994bc538890c32cd}{masterListRead}()
00092         masterListInfo = \{\}
00093         haveZ = [0]*31
00094         haveStage = np.zeros((31, 31), \textcolor{stringliteral}{'Int32'})
00095         haveDielectronic = np.zeros((31, 31), \textcolor{stringliteral}{'Int32'})
00096         \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} masterList:
00097             ionInfo = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convertName}(one)
00098             z = ionInfo[\textcolor{stringliteral}{'Z'}]
00099             stage = ionInfo[\textcolor{stringliteral}{'Ion'}]
00100             haveZ[z] = 1
00101             dielectronic = ionInfo[\textcolor{stringliteral}{'Dielectronic'}]
00102             \textcolor{keywordflow}{if} dielectronic:
00103                 haveDielectronic[z, stage] = 1
00104             \textcolor{keywordflow}{else}:
00105                 haveStage[z, stage] = 1
00106             thisIoneq = ioneq[\textcolor{stringliteral}{'ioneqAll'}][z- 1, stage - 1 + dielectronic]
00107             good = thisIoneq > 0.
00108             goodTemp = ioneq[\textcolor{stringliteral}{'ioneqTemperature'}][good]
00109             tmin = goodTemp.min()
00110             tmax = goodTemp.max()
00111             vgood = thisIoneq == thisIoneq.max()
00112             vgoodTemp = ioneq[\textcolor{stringliteral}{'ioneqTemperature'}][vgood][0]
00113             wgfa = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{wgfaRead}(one)
00114             nZeros = wgfa[\textcolor{stringliteral}{'wvl'}].count(0.)
00115             \textcolor{comment}{# two-photon transitions are denoted by a wavelength of zero (0.)}
00116             \textcolor{keywordflow}{while} nZeros > 0:
00117                 wgfa[\textcolor{stringliteral}{'wvl'}].remove(0.)
00118                 nZeros = wgfa[\textcolor{stringliteral}{'wvl'}].count(0.)
00119             \textcolor{comment}{# unobserved lines are denoted with a negative wavelength}
00120             wvl = np.abs(np.asarray(wgfa[\textcolor{stringliteral}{'wvl'}], \textcolor{stringliteral}{'float64'}))
00121             wmin = wvl.min()
00122             wmax = wvl.max()
00123             masterListInfo[one] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:tmin, \textcolor{stringliteral}{'tmax'}:tmax, \textcolor{stringliteral}{'tIoneqMax'}:
      vgoodTemp\}
00124         masterListInfo[\textcolor{stringliteral}{'haveZ'}] = haveZ
00125         masterListInfo[\textcolor{stringliteral}{'haveStage'}] = haveStage
00126         masterListInfo[\textcolor{stringliteral}{'haveDielectronic'}] = haveDielectronic
00127         \textcolor{comment}{#  now do the bare ions from H thru Zn}
00128         \textcolor{comment}{#  these are only involved in the continuum}
00129         \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(1, 31):
00130             ions = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}(iz, iz+1)
00131             thisIoneq = ioneq[\textcolor{stringliteral}{'ioneqAll'}][iz-1, iz]
00132             good = thisIoneq > 0.
00133             goodTemp = ioneq[\textcolor{stringliteral}{'ioneqTemperature'}][good]
00134             tmin = goodTemp.min()
00135             tmax = goodTemp.max()
00136             wmin=0.
00137             wmax = 1.e+30
00138             masterListInfo[ions] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:tmin, \textcolor{stringliteral}{'tmax'}:tmax\}
00139         pfile = open(infoName, \textcolor{stringliteral}{'w'})
00140         pickle.dump(masterListInfo, pfile)
00141         pfile.close
00142     \textcolor{keywordflow}{else}:
00143         \textcolor{comment}{# the file does not exist and we do NOT have write access to creat it}
00144         \textcolor{comment}{# will just make an inefficient, useless version}
00145         masterListInfo = \{\}
00146         \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} masterList:
00147             ionInfo = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convertName}(one)
00148             z = ionInfo[\textcolor{stringliteral}{'Z'}]
00149             stage = ionInfo[\textcolor{stringliteral}{'Ion'}]
00150             dielectronic = ionInfo[\textcolor{stringliteral}{'Dielectronic'}]
00151             wmin=0.
00152             wmax = 1.e+30
00153             masterListInfo[one] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:1.e+4, \textcolor{stringliteral}{'tmax'}:1.e+9\}
00154         \textcolor{comment}{#  now do the bare ions from H thru Zn}
00155         \textcolor{comment}{#  these are only involved in the continuum}
00156         \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(1, 31):
00157             ions = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}(iz, iz+1)
00158             wmin=0.
00159             wmax = 1.e+30
00160             masterListInfo[ions] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:1.e+4, \textcolor{stringliteral}{'tmax'}:1.e+9\}
00161         pfile = open(infoName, \textcolor{stringliteral}{'w'})
00162         pickle.dump(masterListInfo, pfile)
00163         pfile.close
00164         masterListInfo = \{\textcolor{stringliteral}{'noInfo'}:\textcolor{stringliteral}{'none'}\}
00165     \textcolor{keywordflow}{return} masterListInfo
00166     \textcolor{comment}{#}
00167     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00168     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a1a4447320a9d614f994bc538890c32cd}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!master\+List\+Read@{master\+List\+Read}}
\index{master\+List\+Read@{master\+List\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{master\+List\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a1a4447320a9d614f994bc538890c32cd}
\begin{DoxyVerb}read a chianti masterlist file and return a list of files\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00169}{169} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00169}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a1a4447320a9d614f994bc538890c32cd}{00169} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a1a4447320a9d614f994bc538890c32cd}{masterListRead}():
00170     \textcolor{stringliteral}{""" read a chianti masterlist file and return a list of files"""}
00171     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00172     fname=os.path.join(dir,\textcolor{stringliteral}{'masterlist'},\textcolor{stringliteral}{'masterlist.ions'})
00173     input=open(fname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00174 \textcolor{stringliteral}{    s1=input.readlines()}
00175 \textcolor{stringliteral}{    dum=input.close()}
00176 \textcolor{stringliteral}{    masterlist=[]}
00177 \textcolor{stringliteral}{    }\textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,len(s1)):
00178         s1a=s1[i][:-1]
00179         s2=s1a.split(\textcolor{stringliteral}{';'})
00180         masterlist.append(s2[0].strip())
00181     \textcolor{keywordflow}{return} masterlist
00182     \textcolor{comment}{#}
00183     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00184     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ac5c830808b3221d5f11b3e2d83b6140d}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!photox\+Read@{photox\+Read}}
\index{photox\+Read@{photox\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{photox\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+photox\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ac5c830808b3221d5f11b3e2d83b6140d}
\begin{DoxyVerb}read chianti photoionization .photox files and return
    {"energy", "cross"} where energy is in Rydbergs and the
    cross section is in cm^2  \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00185}{185} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+convert\+Name()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00185}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac5c830808b3221d5f11b3e2d83b6140d}{00185} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac5c830808b3221d5f11b3e2d83b6140d}{photoxRead}(ions):
00186     \textcolor{stringliteral}{"""read chianti photoionization .photox files and return}
00187 \textcolor{stringliteral}{        \{"energy", "cross"\} where energy is in Rydbergs and the}
00188 \textcolor{stringliteral}{        cross section is in cm^2  """}
00189     \textcolor{comment}{#}
00190     zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a92cf299ad3407ee8923739e2761ab13f}{convertName}(ions)
00191     \textcolor{keywordflow}{if} zion[\textcolor{stringliteral}{'Z'}] < zion[\textcolor{stringliteral}{'Ion'}]:
00192         print((\textcolor{stringliteral}{' this is a bare nucleus that has no ionization rate'}))
00193         \textcolor{keywordflow}{return}
00194     \textcolor{comment}{#}
00195     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
00196     paramname=fname+\textcolor{stringliteral}{'.photox'}
00197     input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00198 \textcolor{stringliteral}{    lines = input.readlines()}
00199 \textcolor{stringliteral}{    input.close}
00200 \textcolor{stringliteral}{    }\textcolor{comment}{# get number of energies}
00201 \textcolor{comment}{#    neng = int(lines[0][0:6])}
00202     dataEnd = 0
00203     lvl1 = []
00204     lvl2 = []
00205     energy = []
00206     cross = []
00207     icounter = 0
00208     \textcolor{keywordflow}{while} \textcolor{keywordflow}{not} dataEnd:
00209         lvl11 = int(lines[icounter][:8])
00210         lvl21 = int(lines[icounter][8:15])
00211         ener = lines[icounter][15:].split()
00212         energy1 = np.asarray(ener, \textcolor{stringliteral}{'float64'})
00213         \textcolor{comment}{#}
00214         icounter += 1
00215         irsl = int(lines[icounter][:8])
00216         ind0 = int(lines[icounter][8:15])
00217         \textcolor{keywordflow}{if} irsl != lvl11 \textcolor{keywordflow}{or} ind0 != lvl21:
00218             \textcolor{comment}{# this only happens if the file was written incorrectly}
00219             print((\textcolor{stringliteral}{' lvl1, lvl2 = %7i %7i'}%(lvl11, lvl21)))
00220             print((\textcolor{stringliteral}{' irsl, indo = %7i %7i'}%(irsl,  ind0)))
00221             \textcolor{keywordflow}{return}
00222         crs = lines[icounter][15:].split()
00223         cross1 = np.asarray(crs, \textcolor{stringliteral}{'float64'})
00224         lvl1.append(lvl11)
00225         lvl2.append(lvl21)
00226         energy.append(energy1)
00227         cross.append(cross1)
00228         icounter += 1
00229         dataEnd = lines[icounter].count(\textcolor{stringliteral}{'-1'})
00230     ref = lines[icounter+1:-1]
00231     cross = np.asarray(cross, \textcolor{stringliteral}{'float64'})
00232     energy = np.asarray(energy, \textcolor{stringliteral}{'float64'})
00233     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'lvl1'}:lvl1, \textcolor{stringliteral}{'lvl2'}:lvl2,\textcolor{stringliteral}{'energy'}:energy, \textcolor{stringliteral}{'cross'}:cross,  \textcolor{stringliteral}{'ref'}:ref\}
00234     \textcolor{comment}{#}
00235     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00236     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_af9318412aecf0f6ac826b43796d594db}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!qrp@{qrp}}
\index{qrp@{qrp}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{qrp}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+qrp (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{u}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_af9318412aecf0f6ac826b43796d594db}
\begin{DoxyVerb}qrp(Z,u)  u = E/IP
calculate Qr-prime (equ. 2.12) of Fontes, Sampson and Zhang 1999\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00420}{420} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00420}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_af9318412aecf0f6ac826b43796d594db}{00420} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_af9318412aecf0f6ac826b43796d594db}{qrp}(z,u):
00421     \textcolor{stringliteral}{''' qrp(Z,u)  u = E/IP}
00422 \textcolor{stringliteral}{    calculate Qr-prime (equ. 2.12) of Fontes, Sampson and Zhang 1999'''}
00423     \textcolor{comment}{#}
00424     aa=1.13  \textcolor{comment}{# aa stands for A in equ 2.12}
00425     \textcolor{comment}{#}
00426     \textcolor{keywordflow}{if} z >= 16 :
00427         \textcolor{comment}{# use Fontes Z=20, N=1 parameters}
00428         dd=3.70590
00429         c=-0.28394
00430         d=1.95270
00431         cc=0.20594
00432     \textcolor{keywordflow}{else}:
00433     \textcolor{comment}{# use Fontes Z=10, N=2 parameters}
00434         dd=3.82652
00435         c=-0.80414
00436         d=2.32431
00437         cc=0.14424
00438     \textcolor{comment}{#}
00439     \textcolor{keywordflow}{if} z > 20:
00440         cc+=((z-20.)/50.5)**1.11
00441     \textcolor{comment}{#}
00442     bu=u <= 1.
00443     q=np.ma.array(u, \textcolor{stringliteral}{'Float64'}, mask=bu, fill\_value=0.)
00444     \textcolor{comment}{#}
00445     \textcolor{comment}{#}
00446     q=(aa*np.ma.log(u) + dd*(1.-1./u)**2 + cc*u*(1.-1./u)**4 + (c/u+d/u**2)*(1.-1/u))/u
00447     \textcolor{comment}{#}
00448     q.set\_fill\_value(0.)  \textcolor{comment}{# I don't know why this is necessary}
00449     \textcolor{keywordflow}{return} q  \textcolor{comment}{#  .set\_fill\_value(0.)}
00450     \textcolor{comment}{#}
00451     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00452     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a71865c846f3d3b1c9b1371c6779c8f3e}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!rr\+Read@{rr\+Read}}
\index{rr\+Read@{rr\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{rr\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+rr\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a71865c846f3d3b1c9b1371c6779c8f3e}
\begin{DoxyVerb}read chianti radiative recombination .rrparams files and return
    {'rrtype','params','ref'}\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01330}{1330} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01330}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a71865c846f3d3b1c9b1371c6779c8f3e}{01330} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a71865c846f3d3b1c9b1371c6779c8f3e}{rrRead}(ions):
01331     \textcolor{stringliteral}{"""read chianti radiative recombination .rrparams files and return}
01332 \textcolor{stringliteral}{        \{'rrtype','params','ref'\}"""}
01333     \textcolor{comment}{#}
01334     \textcolor{comment}{#}
01335     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
01336     paramname=fname+\textcolor{stringliteral}{'.rrparams'}
01337     \textcolor{keywordflow}{if} os.path.isfile(paramname):
01338         input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01339 \textcolor{stringliteral}{        }\textcolor{comment}{#  need to read first line and see how many elements}
01340         lines=input.readlines()
01341         input.close()
01342         rrtype=int(lines[0])
01343         ref=lines[3:-2]
01344         \textcolor{comment}{#}
01345         \textcolor{keywordflow}{if} rrtype == 1:
01346             \textcolor{comment}{# a Badnell type}
01347             fmt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'3i5,e12.4,f10.5,2e12.4'})
01348             params=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[1],fmt)
01349             RrParams=\{\textcolor{stringliteral}{'rrtype'}:rrtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01350         \textcolor{keywordflow}{elif} rrtype == 2:
01351             \textcolor{comment}{# a Badnell type}
01352             fmt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'3i5,e12.4,f10.5,2e11.4,f10.5,e12.4'})
01353             params=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[1],fmt)
01354             RrParams=\{\textcolor{stringliteral}{'rrtype'}:rrtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01355         \textcolor{keywordflow}{elif} rrtype == 3:
01356             \textcolor{comment}{# a Shull type}
01357             fmt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'2i5,2e12.4'})
01358             params=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[1],fmt)
01359             RrParams=\{\textcolor{stringliteral}{'rrtype'}:rrtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01360         \textcolor{keywordflow}{else}:
01361             RrParams=\textcolor{keywordtype}{None}
01362             print((\textcolor{stringliteral}{' for ion %5s unknown RR type = %5i'} %(ions, rrtype)))
01363         \textcolor{keywordflow}{return} RrParams
01364     \textcolor{keywordflow}{else}:
01365         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'rrtype'}:-1\}
01366 
01367     \textcolor{comment}{#}
01368     \textcolor{comment}{# -------------------------------------------------------------------------------------}
01369     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_abdf42d0f9176edb418859e7a12fa4bce}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!scale\+\_\+bt@{scale\+\_\+bt}}
\index{scale\+\_\+bt@{scale\+\_\+bt}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{scale\+\_\+bt}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+scale\+\_\+bt (
\begin{DoxyParamCaption}
\item[{}]{evin, }
\item[{}]{omega, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_abdf42d0f9176edb418859e7a12fa4bce}
\begin{DoxyVerb}apply BT excitation scaling to (energy, collision strength)
returns [bte,btomega]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01779}{1779} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01779}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_abdf42d0f9176edb418859e7a12fa4bce}{01779} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_abdf42d0f9176edb418859e7a12fa4bce}{scale\_bt}(evin,omega,f,ev1):
01780     \textcolor{stringliteral}{"""}
01781 \textcolor{stringliteral}{    apply BT excitation scaling to (energy, collision strength)}
01782 \textcolor{stringliteral}{    returns [bte,btomega]}
01783 \textcolor{stringliteral}{    """}
01784     u=evin/ev1
01785     bte=1.-np.log(f)/np.log(u-1.+f)
01786     btomega=omega/(np.log(u)-1.+np.exp(1.))
01787     \textcolor{keywordflow}{return} [bte,btomega]
01788 \end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a71b9295157832135424ea7dc0138fcd4}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!scale\+\_\+bti@{scale\+\_\+bti}}
\index{scale\+\_\+bti@{scale\+\_\+bti}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{scale\+\_\+bti}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+scale\+\_\+bti (
\begin{DoxyParamCaption}
\item[{}]{evin, }
\item[{}]{crossin, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a71b9295157832135424ea7dc0138fcd4}
\begin{DoxyVerb}apply BT ionization scaling to (energy, cross-section)
returns [bte,btx]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01743}{1743} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l01083}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+di\+Cross()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01743}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a71b9295157832135424ea7dc0138fcd4}{01743} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a71b9295157832135424ea7dc0138fcd4}{scale\_bti}(evin,crossin,f,ev1):
01744     \textcolor{stringliteral}{"""}
01745 \textcolor{stringliteral}{    apply BT ionization scaling to (energy, cross-section)}
01746 \textcolor{stringliteral}{    returns [bte,btx]}
01747 \textcolor{stringliteral}{    """}
01748     u=evin/ev1
01749     bte=1.-np.log(f)/np.log(u-1.+f)
01750     btx=u*crossin*(ev1**2)/(np.log(u)+1.)
01751     \textcolor{keywordflow}{return} [bte,btx]
01752     \textcolor{comment}{#}
01753     \textcolor{comment}{#-----------------------------------------------------------}
01754     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a391eb09a09769234e5759d5544d0bcaf}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!splom\+Descale@{splom\+Descale}}
\index{splom\+Descale@{splom\+Descale}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{splom\+Descale}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+splom\+Descale (
\begin{DoxyParamCaption}
\item[{}]{splom, }
\item[{}]{energy}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a391eb09a09769234e5759d5544d0bcaf}
\begin{DoxyVerb}Calculates the collision strength
for excitation-autoionization as a function of energy.
energy in eV
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00760}{760} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l01223}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ea\+Cross()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00760}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a391eb09a09769234e5759d5544d0bcaf}{00760} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a391eb09a09769234e5759d5544d0bcaf}{splomDescale}(splom, energy):
00761     \textcolor{stringliteral}{"""}
00762 \textcolor{stringliteral}{    Calculates the collision strength}
00763 \textcolor{stringliteral}{    for excitation-autoionization as a function of energy.}
00764 \textcolor{stringliteral}{    energy in eV}
00765 \textcolor{stringliteral}{    """}
00766     \textcolor{comment}{#}
00767     \textcolor{comment}{#}
00768     nenergy=energy.size
00769     nsplom=len(splom[\textcolor{stringliteral}{'deryd'}])
00770     \textcolor{comment}{# for these files, there are 5 spline points}
00771     nspl = 5
00772     \textcolor{keywordflow}{if} nenergy > 1:
00773         omega = np.zeros((nsplom,nenergy),\textcolor{stringliteral}{"float64"})
00774     \textcolor{keywordflow}{else}:
00775         omega = np.zeros(nsplom,\textcolor{stringliteral}{"float64"})
00776     \textcolor{comment}{#}
00777     dx = 1./(float(nspl)-1.)
00778     sxint = dx*np.arange(nspl)
00779     \textcolor{keywordflow}{for} isplom \textcolor{keywordflow}{in} range(0,nsplom):
00780         \textcolor{comment}{#}
00781         sx1 = energy/(splom[\textcolor{stringliteral}{'deryd'}][isplom]*const.ryd2Ev)
00782         good = sx1 >= 1.
00783         \textcolor{comment}{# make sure there are some valid energies above the threshold}
00784         \textcolor{keywordflow}{if} good.sum():
00785             nbad = nenergy - good.sum()
00786             c\_curr = splom[\textcolor{stringliteral}{'c'}][isplom]
00787             \textcolor{comment}{#}
00788             \textcolor{keywordflow}{if} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 1:
00789                 sx = 1. - np.log(c\_curr)/np.log(sx1[good] - 1. + c\_curr)
00790                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00791                 som = interpolate.splev(sx,y2,der=0)
00792                 omega[isplom, nbad:] = som*np.log(sx -1. + np.exp(1.))
00793             \textcolor{comment}{#}
00794             \textcolor{keywordflow}{elif} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 2:
00795                 sx =(sx1[good] - 1.)/(sx1[good] -1. + c\_curr)
00796                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00797                 som=interpolate.splev(sx,y2,der=0)
00798                 omega[isplom, nbad:] = som
00799             \textcolor{comment}{#}
00800             \textcolor{keywordflow}{elif} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 3:
00801                 sx = (sx1[good] - 1.)/(sx1[good] -1. + c\_curr)
00802                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00803                 som = interpolate.splev(sx,y2,der=0)
00804                 omega[isplom, nbad:] = som/sx1[good]**2
00805             \textcolor{comment}{#}
00806             \textcolor{keywordflow}{elif} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 4:
00807                 sx = 1. - np.log(c\_curr)/np.log(sx1[good] -1. + c\_curr)
00808                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00809                 som=interpolate.splev(sx,y2,der=0)
00810                 omega[isplom, nbad:] = som*np.log(sx1[good] -1. + c\_curr)
00811             \textcolor{comment}{#}
00812             \textcolor{comment}{#}
00813             \textcolor{comment}{#}
00814             \textcolor{keywordflow}{elif} ttype > 4:
00815                 print((\textcolor{stringliteral}{' splom t\_type ne 1,2,3,4 = %4i %4i %4i'}%(ttype,l1,l2)))
00816         \textcolor{keywordflow}{else}:
00817             \textcolor{comment}{# there are no energies above the threshold}
00818             \textcolor{keywordflow}{pass}
00819     \textcolor{comment}{#}
00820     \textcolor{comment}{#}
00821     omega=np.where(omega > 0.,omega,0.)
00822     \textcolor{comment}{#}
00823     \textcolor{keywordflow}{return} omega
00824     \textcolor{comment}{#}
00825     \textcolor{comment}{# --------------------------------------------------}
00826     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!splom\+Read@{splom\+Read}}
\index{splom\+Read@{splom\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{splom\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+splom\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{ea = {\ttfamily 0}, }
\item[{}]{filename = {\ttfamily None}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}
\begin{DoxyVerb}read chianti .splom files and return
{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"deryd":de,"c":c,"splom":splomout,"ref":hdr} not tested
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00827}{827} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00827}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{00827} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{splomRead}(ions, ea=0, filename=None):
00828     \textcolor{stringliteral}{"""}
00829 \textcolor{stringliteral}{    read chianti .splom files and return}
00830 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"deryd":de,"c":c,"splom":splomout,"ref":hdr\} not tested}
00831 \textcolor{stringliteral}{    """}
00832     \textcolor{comment}{#}
00833     \textcolor{keywordflow}{if} type(filename) == NoneType:
00834         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
00835         \textcolor{keywordflow}{if} ea:
00836             splomname=fname+\textcolor{stringliteral}{'.easplom'}
00837         \textcolor{keywordflow}{else}:
00838             splomname=fname+\textcolor{stringliteral}{'.splom'}
00839     \textcolor{keywordflow}{else}:
00840         splomname = filename
00841     input=open(splomname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00842 \textcolor{stringliteral}{    }\textcolor{comment}{#  need to read first line and see how many elements}
00843     line1=input.readline()
00844     indices=line1[0:15]
00845     remainder=line1[16:]
00846     nom=remainder.split(\textcolor{stringliteral}{' '})
00847     format=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'5i3,'}+str(len(nom))+\textcolor{stringliteral}{'E10.2'})
00848     \textcolor{comment}{#  go back to the beginning}
00849     input.seek(0)
00850     lines=input.readlines()
00851     data=5
00852     iline=0
00853     lvl1=[]
00854     lvl2=[]
00855     ttype=[]
00856     gf=[]
00857     de=[]
00858     f=[]
00859     splom=[]
00860     ntrans=0
00861     \textcolor{keywordflow}{while} data > 1:
00862         splomdat=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[iline],format)
00863         l1=splomdat[2]
00864         l2=splomdat[3]
00865         tt1=splomdat[4]
00866         gf1=splomdat[5]
00867         de1=splomdat[6]
00868         f1=splomdat[7]
00869         splom1=splomdat[8:]
00870         lvl1.append(int(l1))
00871         lvl2.append(int(l2))
00872         ttype.append(int(tt1))
00873         gf.append(float(gf1))
00874         de.append(float(de1))
00875         f.append(float(f1))
00876         splom.append(splom1)
00877         iline=iline+1
00878         data=len(lines[iline].split(\textcolor{stringliteral}{' '},2))
00879     hdr=lines[iline+1:-1]
00880     de=np.asarray(de,\textcolor{stringliteral}{'Float64'})
00881     splomout=np.asarray(splom,\textcolor{stringliteral}{'Float64'})
00882     splomout=np.transpose(splomout)
00883     input.close()
00884     \textcolor{comment}{# note:  de is in Rydbergs}
00885     splom=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"deryd"}:de,\textcolor{stringliteral}{"c"}:f
00886         ,\textcolor{stringliteral}{"splom"}:splomout,\textcolor{stringliteral}{"ref"}:hdr\}
00887     \textcolor{keywordflow}{return}  splom
00888     \textcolor{comment}{#}
00889     \textcolor{comment}{# --------------------------------------------------}
00890     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!splups\+Read@{splups\+Read}}
\index{splups\+Read@{splups\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{splups\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+splups\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}, }
\item[{}]{prot = {\ttfamily 0}, }
\item[{}]{ci = {\ttfamily 0}, }
\item[{}]{diel = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}
\begin{DoxyVerb}read a chianti splups file and return
{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref}
if prot >0, then reads the psplups file
if ci > 0, then reads cisplups file
if diel > 0, then reads dielsplups file
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00891}{891} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00891}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{00891} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{splupsRead}(ions, filename=0, prot=0, ci=0,  diel=0):
00892     \textcolor{stringliteral}{"""}
00893 \textcolor{stringliteral}{    read a chianti splups file and return}
00894 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref\}}
00895 \textcolor{stringliteral}{    if prot >0, then reads the psplups file}
00896 \textcolor{stringliteral}{    if ci > 0, then reads cisplups file}
00897 \textcolor{stringliteral}{    if diel > 0, then reads dielsplups file}
00898 \textcolor{stringliteral}{    """}
00899     \textcolor{comment}{#}
00900     \textcolor{keywordflow}{if} filename:
00901         splupsname = filename
00902     \textcolor{keywordflow}{else}:
00903         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
00904         \textcolor{keywordflow}{if} prot:
00905             splupsname=fname+\textcolor{stringliteral}{'.psplups'}
00906         \textcolor{keywordflow}{elif} ci:
00907             splupsname=fname+\textcolor{stringliteral}{'.cisplups'}
00908         \textcolor{keywordflow}{elif} diel:
00909             splupsname=fname+\textcolor{stringliteral}{'.dielsplups'}
00910         \textcolor{keywordflow}{else}:
00911             splupsname=fname+\textcolor{stringliteral}{'.splups'}
00912     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(splupsname):
00913         \textcolor{keywordflow}{if} prot:
00914             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00915         \textcolor{keywordflow}{elif} ci:
00916             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00917         \textcolor{keywordflow}{else}:
00918             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00919     \textcolor{comment}{# there is splups/psplups data}
00920     \textcolor{keywordflow}{else}:
00921         input=open(splupsname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00922 \textcolor{stringliteral}{        s1=input.readlines()}
00923 \textcolor{stringliteral}{        input.close()}
00924 \textcolor{stringliteral}{        nsplups=0}
00925 \textcolor{stringliteral}{        ndata=2}
00926 \textcolor{stringliteral}{        }\textcolor{keywordflow}{while} ndata > 1:
00927             s1a=s1[nsplups][:]
00928             s2=s1a.split()
00929             ndata=len(s2)
00930             nsplups=nsplups+1
00931         nsplups=nsplups-1
00932         lvl1=[0]*nsplups
00933         lvl2=[0]*nsplups
00934         ttype=[0]*nsplups
00935         gf = np.zeros(nsplups, \textcolor{stringliteral}{'float64'})
00936         de= np.zeros(nsplups, \textcolor{stringliteral}{'float64'})
00937         cups= np.zeros(nsplups, \textcolor{stringliteral}{'float64'})
00938         nspl=[0]*nsplups
00939 \textcolor{comment}{#        splups=np.zeros((nsplups,9),'Float64')}
00940         splups = [0.]*nsplups
00941         \textcolor{keywordflow}{if} prot:
00942 \textcolor{comment}{#            splupsFormat1 = FortranFormat('3i3,8e10.3')}
00943             splupsFormat2 = \hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'3i3,3e10.3'})
00944         \textcolor{keywordflow}{else}:
00945 \textcolor{comment}{#            splupsFormat1='(6x,3i3,8e10.3)'}
00946             splupsFormat2 = \hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(\textcolor{stringliteral}{'6x,3i3,3e10.3'})
00947         \textcolor{comment}{#}
00948         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nsplups):
00949             inpt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(s1[i],splupsFormat2)
00950             lvl1[i]=inpt[0]
00951             lvl2[i]=inpt[1]
00952             ttype[i]=inpt[2]
00953             gf[i]=inpt[3]
00954             de[i]=inpt[4]
00955             cups[i]=inpt[5]
00956             \textcolor{keywordflow}{if} prot:
00957                 as1 = s1[i][39:].rstrip()
00958             \textcolor{keywordflow}{else}:
00959                 as1 = s1[i][45:].rstrip()
00960             nspl[i] = len(as1)/10
00961             splupsFormat3 = \hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(str(nspl[i])+\textcolor{stringliteral}{'E10.2'})
00962 \textcolor{comment}{#            splupsFormat3 = '(' + str(nspl[i]) + 'e10.3' + ')'}
00963             inpt = \hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(as1, splupsFormat3)
00964             spl1 = np.asarray(inpt[:], \textcolor{stringliteral}{'float64'})
00965             splups[i] = spl1
00966         \textcolor{comment}{#}
00967         ref=[]
00968         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nsplups+1,len(s1)-1):
00969             s1a=s1[i][:-1]
00970             ref.append(s1a.strip())
00971         \textcolor{keywordflow}{if} prot:
00972 \textcolor{comment}{#            self.Npsplups=nsplups}
00973 \textcolor{comment}{#            self.Psplups=\{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups}
00974 \textcolor{comment}{#                ,"nspl":nspl,"splups":splups,"ref":ref\}}
00975             \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"de"}:de,\textcolor{stringliteral}{"cups"}:cups
00976                 ,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"splups"}:splups,\textcolor{stringliteral}{"ref"}:ref, \textcolor{stringliteral}{'filename'}:splupsname\}
00977         \textcolor{keywordflow}{else}:
00978 \textcolor{comment}{#            self.Splups=\{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups}
00979 \textcolor{comment}{#                ,"nspl":nspl,"splups":splups,"ref":ref\}}
00980             \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"de"}:de,\textcolor{stringliteral}{"cups"}:cups
00981                 ,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"splups"}:splups,\textcolor{stringliteral}{"ref"}:ref, \textcolor{stringliteral}{'filename'}:splupsname\}
00982     \textcolor{comment}{#}
00983     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00984     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a79401d478ca07c45f4546a82634e6eb9}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!twophoton\+He\+Read@{twophoton\+He\+Read}}
\index{twophoton\+He\+Read@{twophoton\+He\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{twophoton\+He\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+twophoton\+He\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a79401d478ca07c45f4546a82634e6eb9}
\begin{DoxyVerb}to read the two-photon A values and distribution function for the He seq\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01669}{1669} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01669}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a79401d478ca07c45f4546a82634e6eb9}{01669} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a79401d478ca07c45f4546a82634e6eb9}{twophotonHeRead}():
01670     \textcolor{stringliteral}{''' to read the two-photon A values and distribution function for the He seq'''}
01671     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01672     fName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'heseq\_2photon.dat'})
01673     dFile = open(fName, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01674 \textcolor{stringliteral}{    a = dFile.readline()}
01675 \textcolor{stringliteral}{    y0 = np.asarray(a.split())}
01676 \textcolor{stringliteral}{    nz = 30}
01677 \textcolor{stringliteral}{    avalue = np.zeros(nz, }\textcolor{stringliteral}{'float64'})
01678     psi0 = np.zeros((nz, 41), \textcolor{stringliteral}{'float64'})
01679     \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(1, nz):
01680         a=dFile.readline().split()
01681         avalue[iz] = float(a[1])
01682         psi = np.asarray(a[2:])
01683         psi0[iz] = psi
01684     dFile.close()
01685     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'y0'}:y0, \textcolor{stringliteral}{'avalue'}:avalue, \textcolor{stringliteral}{'psi0'}:psi0.reshape(30, 41)\}
01686     \textcolor{comment}{#}
01687     \textcolor{comment}{#-----------------------------------------------------------}
01688     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ae03bdc8f81142c34a58f9567f3359322}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!twophoton\+H\+Read@{twophoton\+H\+Read}}
\index{twophoton\+H\+Read@{twophoton\+H\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{twophoton\+H\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+twophoton\+H\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ae03bdc8f81142c34a58f9567f3359322}
\begin{DoxyVerb}to read the two-photon A values and distribution function for the H seq\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01645}{1645} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01645}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae03bdc8f81142c34a58f9567f3359322}{01645} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae03bdc8f81142c34a58f9567f3359322}{twophotonHRead}():
01646     \textcolor{stringliteral}{''' to read the two-photon A values and distribution function for the H seq'''}
01647     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01648     fName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'hseq\_2photon.dat'})
01649     dFile = open(fName, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01650 \textcolor{stringliteral}{    a = dFile.readline()}
01651 \textcolor{stringliteral}{    y0 = np.asarray(a.split())}
01652 \textcolor{stringliteral}{    a = dFile.readline()}
01653 \textcolor{stringliteral}{    z0 = np.asarray(a.split())}
01654 \textcolor{stringliteral}{    nz = 30}
01655 \textcolor{stringliteral}{    avalue = np.zeros(nz, }\textcolor{stringliteral}{'float64'})
01656     asum = np.zeros(nz, \textcolor{stringliteral}{'float64'})
01657     psi0 = np.zeros((nz, 17), \textcolor{stringliteral}{'float64'})
01658     \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(nz):
01659         a=dFile.readline().split()
01660         avalue[iz] = float(a[1])
01661         asum[iz] = float(a[2])
01662         psi = np.asarray(a[3:])
01663         psi0[iz] = psi
01664     dFile.close()
01665     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'y0'}:y0, \textcolor{stringliteral}{'z0'}:z0, \textcolor{stringliteral}{'avalue'}:avalue, \textcolor{stringliteral}{'asum'}:asum, \textcolor{stringliteral}{'psi0'}:psi0.reshape(30, 17)\}
01666     \textcolor{comment}{#}
01667     \textcolor{comment}{#-----------------------------------------------------------}
01668     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a4fab6d9973653d9ca82088006f2a12fe}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!upsdat\+Read@{upsdat\+Read}}
\index{upsdat\+Read@{upsdat\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{upsdat\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+upsdat\+Read (
\begin{DoxyParamCaption}
\item[{}]{upsdat\+File\+Name}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a4fab6d9973653d9ca82088006f2a12fe}
\begin{DoxyVerb}to read the standard Chianti upsdat file
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01689}{1689} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01689}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4fab6d9973653d9ca82088006f2a12fe}{01689} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4fab6d9973653d9ca82088006f2a12fe}{upsdatRead}(upsdatFileName):
01690     \textcolor{stringliteral}{'''}
01691 \textcolor{stringliteral}{    to read the standard Chianti upsdat file}
01692 \textcolor{stringliteral}{    '''}
01693     inpt = open(upsdatFileName)
01694     lines = inpt.readlines()
01695     inpt.close()
01696     nTemp = int(lines[0].strip(\textcolor{stringliteral}{'\(\backslash\)n'}))
01697     minusOne = 0
01698     counter = 1
01699     ll = lines[1].split()
01700     temp = np.asarray(ll[3:], \textcolor{stringliteral}{'float64'})
01701     \textcolor{keywordflow}{while} \textcolor{keywordflow}{not} minusOne:
01702         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'-1'} \textcolor{keywordflow}{in} lines[counter][:4]:
01703             minusOne = 1
01704         \textcolor{keywordflow}{else}:
01705             counter += 1
01706     ntrans = (counter)/2
01707     lvl1 = []
01708     lvl2 = []
01709     de = []
01710     gf = []
01711     upsilon = []
01712     counter = 1
01713     \textcolor{keywordflow}{for} itrans \textcolor{keywordflow}{in} range(ntrans):
01714         ll1 = lines[counter].split()
01715         lvl1.append(int(ll1[0]))
01716         lvl2.append(int(ll1[1]))
01717         de.append(float(ll1[2]))
01718         ll2 = lines[counter+1].split()
01719 \textcolor{comment}{#        print ' ll2 = ', ll2}
01720 \textcolor{comment}{#        print ' gf = ', ll2[2]}
01721         gf.append(float(ll2[2]))
01722         upsilon.append(np.asarray(ll2[3:], \textcolor{stringliteral}{'float64'}))
01723         counter += 2
01724     counter += 1
01725     ref = []
01726     \textcolor{keywordflow}{for} aline \textcolor{keywordflow}{in} lines[counter:-1]:
01727         ref.append(aline.strip(\textcolor{stringliteral}{'\(\backslash\)n'}))
01728     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'lvl1'}:lvl1, \textcolor{stringliteral}{'lvl2'}:lvl2, \textcolor{stringliteral}{'de'}:de, \textcolor{stringliteral}{'gf'}:gf, \textcolor{stringliteral}{'upsilon'}:upsilon, \textcolor{stringliteral}{'temperature'}:temp, \textcolor{stringliteral}{'ref'}:ref\}
01729     \textcolor{comment}{#}
01730     \textcolor{comment}{# -----------------------------------------------------}
01731     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_addacad8fe4cf3dff7f457b8b4a58054f}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!verner\+Read@{verner\+Read}}
\index{verner\+Read@{verner\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{verner\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+verner\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_addacad8fe4cf3dff7f457b8b4a58054f}
\begin{DoxyVerb}Reads the Verner & Yakovlev (A&AS 109, 125, 1995) photoionization cross-section data\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01601}{1601} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01601}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addacad8fe4cf3dff7f457b8b4a58054f}{01601} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addacad8fe4cf3dff7f457b8b4a58054f}{vernerRead}():
01602     \textcolor{stringliteral}{'''Reads the Verner & Yakovlev (A&AS 109, 125, 1995) photoionization cross-section data'''}
01603     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01604     fname = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'verner\_short.txt'})
01605     input = open(fname)
01606     lines = input.readlines()
01607     input.close()
01608     \textcolor{comment}{#}
01609     nlines=465
01610     maxZ = 30+1
01611     maxNel = 30 +1\textcolor{comment}{# also equal max(stage)}
01612     \textcolor{comment}{#}
01613     \textcolor{comment}{#z = np.array(nlines,'int32')}
01614     \textcolor{comment}{#nel = np.array(nlines,'int32')}
01615     pqn = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'int32'})
01616     l = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'int32'})
01617     eth = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01618     e0 = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01619     sig0 = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01620     ya = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01621     p = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01622     yw = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01623     \textcolor{comment}{#}
01624     fstring=\textcolor{stringliteral}{'i2,i3,i2,i2,6f11.3'}
01625     vernerFormat=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_format}{FortranFormat}(fstring)
01626     \textcolor{comment}{#}
01627     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(nlines):
01628         out=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(lines[iline],vernerFormat)
01629         z = out[0]
01630         nel = out[1]
01631         stage = z - nel + 1
01632         pqn[z,stage] = out[2]
01633         l[z,stage] = out[3]
01634         eth[z,stage] = out[4]
01635         e0[z,stage] = out[5]
01636         sig0[z,stage] = out[6]
01637         ya[z,stage] = out[7]
01638         p[z,stage] = out[8]
01639         yw[z,stage] = out[9]
01640     \textcolor{comment}{#}
01641     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'pqn'}:pqn, \textcolor{stringliteral}{'l'}:l, \textcolor{stringliteral}{'eth'}:eth, \textcolor{stringliteral}{'e0'}:e0, \textcolor{stringliteral}{'sig0'}:sig0, \textcolor{stringliteral}{'ya'}:ya, \textcolor{stringliteral}{'p'}:p, \textcolor{stringliteral}{'yw'}:yw\}
01642     \textcolor{comment}{#}
01643     \textcolor{comment}{#-----------------------------------------------------------}
01644     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a349618b1b79ca902de8a030592d6d43a}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!version\+Read@{version\+Read}}
\index{version\+Read@{version\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{version\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+version\+Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a349618b1b79ca902de8a030592d6d43a}
\begin{DoxyVerb}read the version number of the CHIANTI database\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01732}{1732} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01732}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a349618b1b79ca902de8a030592d6d43a}{01732} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a349618b1b79ca902de8a030592d6d43a}{versionRead}():
01733     \textcolor{stringliteral}{""" read the version number of the CHIANTI database"""}
01734     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01735     vFileName = os.path.join(xuvtop, \textcolor{stringliteral}{'VERSION'})
01736     vFile = open(vFileName)
01737     versionStr = vFile.readline()
01738     vFile.close()
01739     \textcolor{keywordflow}{return} versionStr.strip()
01740     \textcolor{comment}{#}
01741     \textcolor{comment}{#-----------------------------------------------------------}
01742     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!wgfa\+Read@{wgfa\+Read}}
\index{wgfa\+Read@{wgfa\+Read}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{wgfa\+Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+wgfa\+Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}, }
\item[{}]{elvlcname = {\ttfamily 0}, }
\item[{}]{total = {\ttfamily 0}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}
\begin{DoxyVerb}reads chianti wgfa file and returns
{"lvl1":lvl1,"lvl2":lvl2,"wvl":wvl,"gf":gf,"avalue":avalue,"ref":ref}
if elvlcname is specified, the lsj term labels are returned as 'pretty1' and 'pretty2'
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00572}{572} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



References \hyperlink{__chianti__tools_8py_source_l00453}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+elvlc\+Read()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00572}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{00572} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{wgfaRead}(ions, filename=0, elvlcname=0, total=0):
00573     \textcolor{stringliteral}{"""}
00574 \textcolor{stringliteral}{    reads chianti wgfa file and returns}
00575 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"wvl":wvl,"gf":gf,"avalue":avalue,"ref":ref\}}
00576 \textcolor{stringliteral}{    if elvlcname is specified, the lsj term labels are returned as 'pretty1' and 'pretty2'}
00577 \textcolor{stringliteral}{    """}
00578     \textcolor{comment}{#}
00579     \textcolor{keywordflow}{if} filename:
00580         wgfaname = filename
00581         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} filename:
00582             elvlcname = os.path.splitext(wgfaname)[0] + \textcolor{stringliteral}{'.elvlc'}
00583     \textcolor{keywordflow}{else}:
00584         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ad4bc7b577fd4c3819ceb00b0a444351b}{ion2filename}(ions)
00585         wgfaname=fname+\textcolor{stringliteral}{'.wgfa'}
00586         elvlcname = fname + \textcolor{stringliteral}{'.elvlc'}
00587     \textcolor{comment}{#}
00588     \textcolor{keywordflow}{if} os.path.isfile(elvlcname):
00589         elvlc = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{elvlcRead}(\textcolor{stringliteral}{''}, elvlcname)
00590     \textcolor{keywordflow}{else}:
00591         elvlc = 0
00592     input=open(wgfaname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00593 \textcolor{stringliteral}{    s1=input.readlines()}
00594 \textcolor{stringliteral}{    dum=input.close()}
00595 \textcolor{stringliteral}{    nwvl=0}
00596 \textcolor{stringliteral}{    ndata=2}
00597 \textcolor{stringliteral}{    }\textcolor{keywordflow}{while} ndata > 1:
00598         s1a=s1[nwvl][:-1]
00599         s2=s1a.split()
00600         ndata=len(s2)
00601         nwvl=nwvl+1
00602     nwvl=nwvl-1
00603     lvl1=[0]*nwvl
00604     lvl2=[0]*nwvl
00605     wvl=[0.]*nwvl
00606     gf=[0.]*nwvl
00607     avalue=[0.]*nwvl
00608     \textcolor{keywordflow}{if} elvlcname:
00609         pretty1 = [\textcolor{stringliteral}{''}]*nwvl
00610         pretty2 = [\textcolor{stringliteral}{''}]*nwvl
00611     \textcolor{comment}{#}
00612     wgfaFormat=\textcolor{stringliteral}{'(2i5,f15.3,2e15.3)'}
00613     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nwvl):
00614         inpt=\hyperlink{classpyneb_1_1utils_1_1_fortran_format_1_1_fortran_line}{FortranLine}(s1[i],wgfaFormat)
00615         lvl1[i]=inpt[0]
00616         lvl2[i]=inpt[1]
00617         wvl[i]=inpt[2]
00618         gf[i]=inpt[3]
00619         avalue[i]=inpt[4]
00620         \textcolor{keywordflow}{if} elvlcname:
00621             pretty1[i] = elvlc[\textcolor{stringliteral}{'pretty'}][inpt[0] - 1]
00622             pretty2[i] = elvlc[\textcolor{stringliteral}{'pretty'}][inpt[1] - 1]
00623 
00624     ref=[]
00625     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nwvl+1,len(s1)-1):
00626         s1a=s1[i][:-1]
00627         ref.append(s1a.strip())
00628     Wgfa=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"wvl"}:wvl,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"avalue"}:avalue,\textcolor{stringliteral}{"ref"}:ref, \textcolor{stringliteral}{'ionS'}:ions, \textcolor{stringliteral}{'filename'}:
      wgfaname\}
00629     \textcolor{keywordflow}{if} total:
00630         avalueLvl = [0.]*max(lvl2)
00631         \textcolor{keywordflow}{for} iwvl \textcolor{keywordflow}{in} range(nwvl):
00632             avalueLvl[lvl2[iwvl] -1] += avalue[iwvl]
00633         Wgfa[\textcolor{stringliteral}{'avalueLvl'}] = avalueLvl
00634 
00635     \textcolor{keywordflow}{if} elvlcname:
00636         Wgfa[\textcolor{stringliteral}{'pretty1'}] = pretty1
00637         Wgfa[\textcolor{stringliteral}{'pretty2'}] = pretty2
00638     \textcolor{keywordflow}{return} Wgfa
00639     \textcolor{comment}{#}
00640     \textcolor{comment}{# --------------------------------------}
00641     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!wgfa\+Write@{wgfa\+Write}}
\index{wgfa\+Write@{wgfa\+Write}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{wgfa\+Write}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+wgfa\+Write (
\begin{DoxyParamCaption}
\item[{}]{info, }
\item[{}]{outfile = {\ttfamily 0}, }
\item[{}]{min\+Branch = {\ttfamily 0.}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}
\begin{DoxyVerb}to write a wgfa file
info is a dictionary the contains the following elements
ionS, the Chianti style name of the ion such as c_4 for C IV
lvl1 - the lower level, the ground level is 1
lvl2 - the upper level
wvl - the wavelength in Angstroms
gf - the weighted oscillator strength
avalue - the A value
pretty1 - descriptive text of the lower level (optional)
pretty2 - descriptive text of the upper level (optiona)
ref - reference text, a list of strings
minBranch:  the transition must have a branching ratio greater than the specified to be written to the file
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00642}{642} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00642}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{00642} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{wgfaWrite}(info, outfile = 0, minBranch = 0.):
00643     \textcolor{stringliteral}{'''}
00644 \textcolor{stringliteral}{    to write a wgfa file}
00645 \textcolor{stringliteral}{    info is a dictionary the contains the following elements}
00646 \textcolor{stringliteral}{    ionS, the Chianti style name of the ion such as c\_4 for C IV}
00647 \textcolor{stringliteral}{    lvl1 - the lower level, the ground level is 1}
00648 \textcolor{stringliteral}{    lvl2 - the upper level}
00649 \textcolor{stringliteral}{    wvl - the wavelength in Angstroms}
00650 \textcolor{stringliteral}{    gf - the weighted oscillator strength}
00651 \textcolor{stringliteral}{    avalue - the A value}
00652 \textcolor{stringliteral}{    pretty1 - descriptive text of the lower level (optional)}
00653 \textcolor{stringliteral}{    pretty2 - descriptive text of the upper level (optiona)}
00654 \textcolor{stringliteral}{    ref - reference text, a list of strings}
00655 \textcolor{stringliteral}{    minBranch:  the transition must have a branching ratio greater than the specified to be written to the
       file}
00656 \textcolor{stringliteral}{    '''}
00657     \textcolor{comment}{#}
00658 \textcolor{comment}{#    gname = info['ionS']}
00659     \textcolor{keywordflow}{if} outfile:
00660         wgfaname = outfile
00661     \textcolor{keywordflow}{else}:
00662         wgfaname = gname + \textcolor{stringliteral}{'.wgfa'}
00663     print((\textcolor{stringliteral}{' wgfa file name = '}, wgfaname))
00664     \textcolor{keywordflow}{if} minBranch > 0.:
00665         info[\textcolor{stringliteral}{'ref'}].append(\textcolor{stringliteral}{' minimum branching ratio = %10.2e'}%(minBranch))
00666     out = open(wgfaname, \textcolor{stringliteral}{'w'})
00667     ntrans = len(info[\textcolor{stringliteral}{'lvl1'}])
00668     nlvl = max(info[\textcolor{stringliteral}{'lvl2'}])
00669     totalAvalue = np.zeros(nlvl, \textcolor{stringliteral}{'float64'})
00670     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'pretty1'} \textcolor{keywordflow}{in} info:
00671         pformat = \textcolor{stringliteral}{'%5i%5i%15.4f%15.3e%15.3e%30s - %30s'}
00672     \textcolor{keywordflow}{else}:
00673         pformat = \textcolor{stringliteral}{'%5i%5i%15.4f%15.3e%15.3e'}
00674     \textcolor{keywordflow}{for} itrans, avalue \textcolor{keywordflow}{in} enumerate(info[\textcolor{stringliteral}{'avalue'}]):
00675         \textcolor{comment}{# for autoionization transitions, lvl1 can be less than zero}
00676         \textcolor{keywordflow}{if} abs(info[\textcolor{stringliteral}{'lvl1'}][itrans]) > 0 \textcolor{keywordflow}{and} info[\textcolor{stringliteral}{'lvl2'}][itrans] > 0:
00677             totalAvalue[info[\textcolor{stringliteral}{'lvl2'}][itrans] -1] += avalue
00678 
00679     \textcolor{keywordflow}{for} itrans, avalue \textcolor{keywordflow}{in} enumerate(info[\textcolor{stringliteral}{'avalue'}]):
00680         \textcolor{keywordflow}{if} avalue > 0.:
00681             branch = avalue/totalAvalue[info[\textcolor{stringliteral}{'lvl2'}][itrans] -1]
00682         \textcolor{keywordflow}{else}:
00683             branch = 0.
00684         \textcolor{keywordflow}{if} branch > minBranch \textcolor{keywordflow}{and} abs(info[\textcolor{stringliteral}{'lvl1'}][itrans]) > 0 \textcolor{keywordflow}{and} info[\textcolor{stringliteral}{'lvl2'}][itrans] > 0:
00685             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'pretty1'} \textcolor{keywordflow}{in} info:
00686                 \textcolor{comment}{# generally only useful with NIST data}
00687                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'transType'} \textcolor{keywordflow}{in} info:
00688                     \textcolor{keywordflow}{if} info[\textcolor{stringliteral}{'transType'}][itrans] != \textcolor{stringliteral}{''}:
00689                         lbl2 = info[\textcolor{stringliteral}{'pretty2'}]+\textcolor{stringliteral}{'  '} + info[\textcolor{stringliteral}{'transType'}][itrans]
00690                 \textcolor{keywordflow}{else}:
00691                     lbl2= info[\textcolor{stringliteral}{'pretty2'}][itrans]
00692                 pstring= pformat%(info[\textcolor{stringliteral}{'lvl1'}][itrans], info[\textcolor{stringliteral}{'lvl2'}][itrans], info[\textcolor{stringliteral}{'wvl'}][itrans], info[\textcolor{stringliteral}{'gf
      '}][itrans], avalue, info[\textcolor{stringliteral}{'pretty1'}][itrans].rjust(30), lbl2.ljust(30))
00693                 out.write(pstring+\textcolor{stringliteral}{'\(\backslash\)n'})
00694             \textcolor{keywordflow}{else}:
00695                 pstring= pformat%(info[\textcolor{stringliteral}{'lvl1'}][itrans], info[\textcolor{stringliteral}{'lvl2'}][itrans], info[\textcolor{stringliteral}{'wvl'}][itrans], info[\textcolor{stringliteral}{'gf
      '}][itrans], avalue)
00696                 out.write(pstring+\textcolor{stringliteral}{'\(\backslash\)n'})
00697     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00698     out.write(\textcolor{stringliteral}{'%filename:  '} + wgfaname + \textcolor{stringliteral}{'\(\backslash\)n'})
00699     \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} info[\textcolor{stringliteral}{'ref'}]:
00700         out.write(one+\textcolor{stringliteral}{'\(\backslash\)n'})
00701     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00702     out.close()
00703     \textcolor{comment}{#}
00704     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00705     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a0e092ff402fc0287bcaaed67171934ea}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!z2element@{z2element}}
\index{z2element@{z2element}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{z2element}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+z2element (
\begin{DoxyParamCaption}
\item[{}]{z}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a0e092ff402fc0287bcaaed67171934ea}
\begin{DoxyVerb}convert Z to element string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00282}{282} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00282}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0e092ff402fc0287bcaaed67171934ea}{00282} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0e092ff402fc0287bcaaed67171934ea}{z2element}(z):
00283     \textcolor{stringliteral}{""" convert Z to element string """}
00284     \textcolor{keywordflow}{if} z-1 < len(const.El):
00285         thisel=const.El[z-1]
00286     \textcolor{keywordflow}{else}:
00287         thisel=\textcolor{stringliteral}{''}
00288     \textcolor{keywordflow}{return} thisel
00289     \textcolor{comment}{#}
00290     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00291     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!zion2filename@{zion2filename}}
\index{zion2filename@{zion2filename}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{zion2filename}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+zion2filename (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}
\begin{DoxyVerb}convert Z to generic file name string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00304}{304} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00304}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{00304} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{zion2filename}(z,ion, dielectronic=False):
00305     \textcolor{stringliteral}{""" convert Z to generic file name string """}
00306     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00307     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00308         thisel=const.El[z-1]
00309     \textcolor{keywordflow}{else}:
00310         thisel=\textcolor{stringliteral}{''}
00311     \textcolor{keywordflow}{if} z-1 < len(const.El):
00312         thisone=const.El[z-1]+\textcolor{stringliteral}{'\_'}+str(ion)
00313         \textcolor{keywordflow}{if} dielectronic:
00314             thisone+=\textcolor{stringliteral}{'d'}
00315     \textcolor{keywordflow}{else}:
00316         thisone=\textcolor{stringliteral}{''}
00317     \textcolor{keywordflow}{if} thisel != \textcolor{stringliteral}{''} :
00318         fname=os.path.join(dir,thisel,thisone,thisone)
00319     \textcolor{keywordflow}{return} fname
00320     \textcolor{comment}{#}
00321     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00322     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!zion2local\+Filename@{zion2local\+Filename}}
\index{zion2local\+Filename@{zion2local\+Filename}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{zion2local\+Filename}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+zion2local\+Filename (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}
\begin{DoxyVerb}convert Z to generic file name string with current directory at top\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00323}{323} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00323}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{00323} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{zion2localFilename}(z,ion, dielectronic=False):
00324     \textcolor{stringliteral}{""" convert Z to generic file name string with current directory at top"""}
00325     dir=\textcolor{stringliteral}{'.'}
00326     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00327         thisel=const.El[z-1]
00328     \textcolor{keywordflow}{else}:
00329         thisel=\textcolor{stringliteral}{''}
00330     \textcolor{keywordflow}{if} z-1 < len(const.El):
00331         thisone=const.El[z-1]+\textcolor{stringliteral}{'\_'}+str(ion)
00332         \textcolor{keywordflow}{if} dielectronic:
00333             thisone+=\textcolor{stringliteral}{'d'}
00334     \textcolor{keywordflow}{else}:
00335         thisone=\textcolor{stringliteral}{''}
00336     \textcolor{keywordflow}{if} thisel != \textcolor{stringliteral}{''} :
00337         fname=os.path.join(dir,thisel,thisone,thisone)
00338     \textcolor{keywordflow}{return} fname
00339     \textcolor{comment}{#}
00340     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00341     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!zion2name@{zion2name}}
\index{zion2name@{zion2name}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{zion2name}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+zion2name (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}
\begin{DoxyVerb}convert Z, ion to generic name  26, 13 -> fe_13 \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00292}{292} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+master\+List\+Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00292}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{00292} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}(z,ion, dielectronic=False):
00293     \textcolor{stringliteral}{""" convert Z, ion to generic name  26, 13 -> fe\_13 """}
00294     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00295         thisone=const.El[z-1]+\textcolor{stringliteral}{'\_'}+str(ion)
00296         \textcolor{keywordflow}{if} dielectronic:
00297             thisone+=\textcolor{stringliteral}{'d'}
00298     \textcolor{keywordflow}{else}:
00299         thisone=\textcolor{stringliteral}{''}
00300     \textcolor{keywordflow}{return} thisone
00301     \textcolor{comment}{#}
00302     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00303     \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!zion2spectroscopic@{zion2spectroscopic}}
\index{zion2spectroscopic@{zion2spectroscopic}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{zion2spectroscopic}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+zion2spectroscopic (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}
\begin{DoxyVerb}convert Z and ion to spectroscopic notation string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00342}{342} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00342}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{00342} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{zion2spectroscopic}(z,ion, dielectronic=False):
00343     \textcolor{stringliteral}{""" convert Z and ion to spectroscopic notation string """}
00344     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00345         spect=const.El[z-1].capitalize()+\textcolor{stringliteral}{' '}+const.Ionstage[ion-1]
00346         \textcolor{keywordflow}{if} dielectronic:
00347             spect+=\textcolor{stringliteral}{' d'}
00348     \textcolor{keywordflow}{else}:  spect = \textcolor{stringliteral}{''}
00349     \textcolor{keywordflow}{return} spect
00350     \textcolor{comment}{#}
00351     \textcolor{comment}{# -------------------------------------------------------------------------------------}
00352     \textcolor{comment}{#}
\end{DoxyCode}


\subsection{Variable Documentation}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ae4b82a587c953b2207888a96d3364677}{}\index{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}!Splups@{Splups}}
\index{Splups@{Splups}!pyneb\+::utils\+::\+\_\+chianti\+\_\+tools@{pyneb\+::utils\+::\+\_\+chianti\+\_\+tools}}
\subsubsection[{Splups}]{\setlength{\rightskip}{0pt plus 5cm}pyneb.\+utils.\+\_\+chianti\+\_\+tools.\+Splups}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ae4b82a587c953b2207888a96d3364677}


Definition at line \hyperlink{__chianti__tools_8py_source_l01275}{1275} of file \hyperlink{__chianti__tools_8py_source}{\+\_\+chianti\+\_\+tools.\+py}.

