\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools}{\section{pyneb.\-utils.\-\_\-chianti\-\_\-tools Namespace Reference}
\label{namespacepyneb_1_1utils_1_1__chianti__tools}\index{pyneb.\-utils.\-\_\-chianti\-\_\-tools@{pyneb.\-utils.\-\_\-chianti\-\_\-tools}}
}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae0d64630471a208f147d1dded0d49e0a}{between}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{ip\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{master\-List\-Info}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab11f940d11d2b1118ffb581a39d7e42a}{master\-List\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25b33696ac2b1d2f01e5789a70a234ec}{photox\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a12d45bcebd107c5fd133830132e8cd5e}{ionrecdat\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a384f39b118999003fd2d0c54974a0aff}{z2element}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{zion2filename}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{zion2local\-Filename}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{zion2spectroscopic}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convert\-Name}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{defaults\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac3ff49dcedbe30c752e9f948e94f29bc}{el2z}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{abundance\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a119759ed9bedb5fc1dd533b8a86e588c}{qrp}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{elvlc\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab6f19b7a8594fc425b55d7037d983641}{elvlc\-Write}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{wgfa\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{wgfa\-Write}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{easplom\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a2cd45e7b512b31d25e92f3adf69b1914}{splom\-Descale}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{splom\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{splups\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{cireclvl\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a2700fbbf2efe3b47f95b26958f6a1c4c}{dilute}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{di\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{ea\-Cross}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{ea\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aaa4f9748029dedf2b12af0c6d8f765c7}{rr\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a14104e790cf31ef6c794dd09cd130797}{dr\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{ioneq\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a109ccb08244e615937df43b7a80a1625}{gff\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a9d97df13906f98a3d0fd3da3cc0cef0c}{gffint\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47e1912c817338c305e475dff092f44f}{itoh\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a41cea295a441ff73fb246119479e373c}{klgfb\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ace360314d9344971bd2ee9ea4f17992d}{list\-Files}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{fblvl\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4777bd65c87b9fbd20a5b02185d9437c}{verner\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a276c30e2ab1692a674ecc1a0e46b0694}{twophoton\-H\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6bc4a22671cc24bfae42d3e24078708a}{twophoton\-He\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae590342dcbbea1f4552a401016c54480}{upsdat\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8e52f3bde54d7fba55664fe4f9efceda}{version\-Read}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa0b66957b05220d53caa594b577edd3b}{scale\-\_\-bti}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a74378c74514f5b6d760d4384780fbf26}{descale\-\_\-bti}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae88317fa471fbac39938c9702d011981}{descale\-\_\-bt}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6f52caaa5d922e5e747839ccea0dcdd3}{scale\-\_\-bt}
\end{DoxyCompactItemize}


\subsection{Detailed Description}
\begin{DoxyVerb}Utility functions, many for reading the CHIANTI database files.

Copyright 2009, 2010 Kenneth P. Dere

This software is distributed under the terms of the GNU General Public License
that is found in the LICENSE file\end{DoxyVerb}
 

\subsection{Function Documentation}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!abundance\-Read@{abundance\-Read}}
\index{abundance\-Read@{abundance\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{abundance\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-abundance\-Read (
\begin{DoxyParamCaption}
\item[{}]{abundancename = {\ttfamily ''}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}
\begin{DoxyVerb}read an abundanc file and returns the abundance values relative to hydrogen\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00413}{413} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00413}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{00413} 
00414 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25c22edea4645bdc590eed4a1c86fea8}{abundanceRead}(abundancename=''):
00415     \textcolor{stringliteral}{""" read an abundanc file and returns the abundance values relative to hydrogen"""}
00416     \textcolor{keywordflow}{pass}
00417 
00418     \textcolor{comment}{#}
00419     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ae0d64630471a208f147d1dded0d49e0a}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!between@{between}}
\index{between@{between}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{between}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-between (
\begin{DoxyParamCaption}
\item[{}]{array, }
\item[{}]{limits}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ae0d64630471a208f147d1dded0d49e0a}
\begin{DoxyVerb}returns an index array of elements of array where the values lie
between the limits given as a 2 element list or tuple\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00021}{21} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00021}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae0d64630471a208f147d1dded0d49e0a}{00021} 
00022 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae0d64630471a208f147d1dded0d49e0a}{between}(array,limits):
00023     \textcolor{stringliteral}{'''returns an index array of elements of array where the values lie}
00024 \textcolor{stringliteral}{    between the limits given as a 2 element list or tuple'''}
00025     array=np.asarray(array)
00026     nlines=len(array)
00027     hi=np.where(array >= limits[0],range(1,nlines+1),0)
00028     lo=np.where(array <= limits[1],range(1,nlines+1),0)
00029     hilo=hi&lo
00030     out=[a -1  \textcolor{keywordflow}{for} a \textcolor{keywordflow}{in} hilo \textcolor{keywordflow}{if} a > 0]
00031     \textcolor{keywordflow}{return} out
00032     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!cireclvl\-Read@{cireclvl\-Read}}
\index{cireclvl\-Read@{cireclvl\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{cireclvl\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-cireclvl\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}, }
\item[{}]{cilvl = {\ttfamily 0}, }
\item[{}]{reclvl = {\ttfamily 0}, }
\item[{}]{rrlvl = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}
\begin{DoxyVerb}to read Chianti cilvl and reclvl files and return data
must specify type as either cilvl, reclvl or rrlvl
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00985}{985} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00985}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{00985} 
00986 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a0811a3ad9efb623a53fd1ebfd8c5c73f}{cireclvlRead}(ions, filename=0, cilvl=0, reclvl=0, rrlvl=0):
00987     \textcolor{stringliteral}{'''}
00988 \textcolor{stringliteral}{    to read Chianti cilvl and reclvl files and return data}
00989 \textcolor{stringliteral}{    must specify type as either cilvl, reclvl or rrlvl}
00990 \textcolor{stringliteral}{    '''}
00991     \textcolor{keywordflow}{if} filename:
00992         fname = filename
00993     \textcolor{keywordflow}{else}:
00994         fname = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
00995     \textcolor{keywordflow}{if} cilvl:
00996         paramname=fname+\textcolor{stringliteral}{'.cilvl'}
00997     \textcolor{keywordflow}{elif} reclvl:
00998         paramname = fname + \textcolor{stringliteral}{'.reclvl'}
00999     \textcolor{keywordflow}{elif} rrlvl:
01000         paramname = fname + \textcolor{stringliteral}{'.rrlvl'}
01001     \textcolor{keywordflow}{else}:
01002         print(\textcolor{stringliteral}{'either "cilvl", "reclvl" ir "rrlvl" must be specified'})
01003         \textcolor{keywordflow}{return} \{\}
01004     \textcolor{keywordflow}{if} os.path.exists(paramname):
01005         input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01006 \textcolor{stringliteral}{        lines = input.readlines()}
01007 \textcolor{stringliteral}{        input.close()}
01008 \textcolor{stringliteral}{    }\textcolor{keywordflow}{else}:
01009         print((\textcolor{stringliteral}{'file does not exist:  '}, paramname))
01010         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'error'}:\textcolor{stringliteral}{'file does not exist: '} + paramname\}
01011     \textcolor{comment}{#}
01012     iline = 0
01013     idx = -1
01014     \textcolor{keywordflow}{while} idx < 0:
01015         aline=lines[iline][0:5]
01016         idx=aline.find(\textcolor{stringliteral}{'-1'})
01017         iline += 1
01018     ndata = iline - 1
01019     ntrans = ndata/2
01020     \textcolor{comment}{#}
01021     nref = 0
01022     idx = -1
01023     \textcolor{keywordflow}{while} idx < 0:
01024         aline=lines[iline][0:5]
01025         idx=aline.find(\textcolor{stringliteral}{'-1'})
01026         iline += 1
01027         nref += 1
01028     nref -= 1
01029     \textcolor{comment}{#}
01030     \textcolor{comment}{# need to find the maximum number of temperatures, not all lines are the same}
01031     \textcolor{comment}{#}
01032     ntemp = np.zeros(ntrans, \textcolor{stringliteral}{'int32'})
01033     iline = 0
01034     \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} range(0, ndata, 2):
01035         dummy = lines[jline].replace(os.linesep, \textcolor{stringliteral}{''}).split()
01036         ntemp[iline] = len(dummy[4:])
01037         iline += 1
01038     maxNtemp = ntemp.max()
01039 \textcolor{comment}{#   print ' maxNtemp = ', maxNtemp}
01040     temp = np.zeros((ntrans,maxNtemp), \textcolor{stringliteral}{'float64'})
01041     iline = 0
01042     \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} range(0, ndata, 2):
01043         recdat = lines[jline].replace(os.linesep, \textcolor{stringliteral}{''}).split()
01044         shortT = np.asarray(recdat[4:], \textcolor{stringliteral}{'float64'})
01045         \textcolor{comment}{# the result of the next statement is to continue to replicate t}
01046         t = np.resize(shortT, maxNtemp)
01047         \textcolor{keywordflow}{if} rrlvl:
01048             temp[iline] = t
01049         \textcolor{keywordflow}{else}:
01050             temp[iline] = 10.**t
01051         iline += 1
01052     \textcolor{comment}{#}
01053     lvl1 = np.zeros(ntrans, \textcolor{stringliteral}{'int64'})
01054     lvl2 = np.zeros(ntrans, \textcolor{stringliteral}{'int64'})
01055     ci = np.zeros((ntrans, maxNtemp), \textcolor{stringliteral}{'float64'})
01056     \textcolor{comment}{#}
01057     idat = 0
01058     \textcolor{keywordflow}{for} jline \textcolor{keywordflow}{in} range(1, ndata, 2):
01059         cidat = lines[jline].replace(os.linesep, \textcolor{stringliteral}{''}).split()
01060         shortCi = np.asarray(cidat[4:], \textcolor{stringliteral}{'float64'})
01061         lvl1[idat] = int(cidat[2])
01062         lvl2[idat] = int(cidat[3])
01063         ci[idat] = np.resize(shortCi, maxNtemp)
01064         idat += 1
01065     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'temperature'}:temp, \textcolor{stringliteral}{'ntemp'}:ntemp,\textcolor{stringliteral}{'lvl1'}:lvl1, \textcolor{stringliteral}{'lvl2'}:lvl2, \textcolor{stringliteral}{'rate'}:ci,\textcolor{stringliteral}{'ref'}:lines[ndata+1:-1], \textcolor{stringliteral}{
      'ionS'}:ions\}
01066     \textcolor{comment}{#}
01067     \textcolor{comment}{# ----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!convert\-Name@{convert\-Name}}
\index{convert\-Name@{convert\-Name}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{convert\-Name}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-convert\-Name (
\begin{DoxyParamCaption}
\item[{}]{name}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}
\begin{DoxyVerb}convert ion name string to Z and Ion \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00353}{353} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l01086}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-di\-Read()}, \hyperlink{__chianti__tools_8py_source_l01188}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ea\-Read()}, \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}, \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Info()}, and \hyperlink{__chianti__tools_8py_source_l00185}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-photox\-Read()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00353}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{00353} 
00354 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convertName}(name):
00355     \textcolor{stringliteral}{""" convert ion name string to Z and Ion """}
00356     s2=name.split(\textcolor{stringliteral}{'\_'})
00357     els=s2[0].strip()
00358     i1=const.El.index(els)+1
00359     ions=s2[1].strip()
00360     d=ions.find(\textcolor{stringliteral}{'d'})
00361     \textcolor{keywordflow}{if} d >0 :
00362         dielectronic=\textcolor{keyword}{True}
00363         ions=ions.replace(\textcolor{stringliteral}{'d'},\textcolor{stringliteral}{''})
00364     \textcolor{keywordflow}{else}: dielectronic=\textcolor{keyword}{False}
00365     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'Z'}:int(i1),\textcolor{stringliteral}{'Ion'}:int(ions),\textcolor{stringliteral}{'Dielectronic'}:dielectronic, \textcolor{stringliteral}{'Element'}:els\}
00366     \textcolor{comment}{#}
00367     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!defaults\-Read@{defaults\-Read}}
\index{defaults\-Read@{defaults\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{defaults\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-defaults\-Read (
\begin{DoxyParamCaption}
\item[{}]{verbose = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}


Definition at line \hyperlink{__chianti__tools_8py_source_l00368}{368} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00368}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{00368} 
00369 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{defaultsRead}(verbose=0):
00370     \textcolor{comment}{#}
00371     \textcolor{comment}{#possibleDefaults = \{'wavelength':['angstrom', 'kev', 'nm']\}}
00372     \textcolor{comment}{#symbolDefaults = \{'wavelength':['A', 'keV', 'nm']\}}
00373     initDefaults=\{\textcolor{stringliteral}{'abundfile'}: \textcolor{stringliteral}{'sun\_photospheric\_1998\_grevesse'},\textcolor{stringliteral}{'ioneqfile'}: \textcolor{stringliteral}{'chianti'}, \textcolor{stringliteral}{'wavelength'}: \textcolor{stringliteral}{'
      angstrom'}, \textcolor{stringliteral}{'flux'}: \textcolor{stringliteral}{'energy'},\textcolor{stringliteral}{'gui'}:\textcolor{keyword}{False}\}
00374     rcfile=os.path.join(os.environ[\textcolor{stringliteral}{'HOME'}],\textcolor{stringliteral}{'.chianti/chiantirc'})
00375     \textcolor{keywordflow}{if} os.path.isfile(rcfile):
00376         print((\textcolor{stringliteral}{' reading chiantirc file'}))
00377         config = RawConfigParser(initDefaults)
00378         config.read(rcfile)
00379         defaults = \{\}
00380         \textcolor{keywordflow}{for} anitem \textcolor{keywordflow}{in} config.items(\textcolor{stringliteral}{'chianti'}):
00381             defaults[anitem[0]] = anitem[1]
00382         \textcolor{keywordflow}{if} defaults[\textcolor{stringliteral}{'gui'}].lower() \textcolor{keywordflow}{in} (\textcolor{stringliteral}{'t'}, \textcolor{stringliteral}{'y'}, \textcolor{stringliteral}{'yes'}, \textcolor{stringliteral}{'on'}, \textcolor{stringliteral}{'true'}, \textcolor{stringliteral}{'1'}, 1, \textcolor{keyword}{True}):
00383             defaults[\textcolor{stringliteral}{'gui'}] = \textcolor{keyword}{True}
00384         \textcolor{keywordflow}{elif} defaults[\textcolor{stringliteral}{'gui'}].lower() \textcolor{keywordflow}{in} (\textcolor{stringliteral}{'f'}, \textcolor{stringliteral}{'n'}, \textcolor{stringliteral}{'no'}, \textcolor{stringliteral}{'off'}, \textcolor{stringliteral}{'false'}, \textcolor{stringliteral}{'0'}, 0, \textcolor{keyword}{False}):
00385             defaults[\textcolor{stringliteral}{'gui'}] = \textcolor{keyword}{False}
00386     \textcolor{keywordflow}{else}:
00387         defaults = initDefaults
00388         \textcolor{keywordflow}{if} verbose:
00389             print((\textcolor{stringliteral}{' chiantirc file (/HOME/.chianti/chiantirc) does not exist'}))
00390             print((\textcolor{stringliteral}{' using the following defaults'}))
00391             \textcolor{keywordflow}{for} akey \textcolor{keywordflow}{in} list(defaults.keys()):
00392                 print((\textcolor{stringliteral}{' %s = %s'}%(akey, defaults[akey])))
00393     \textcolor{keywordflow}{return} defaults
00394     \textcolor{comment}{#}
00395     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ae88317fa471fbac39938c9702d011981}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!descale\-\_\-bt@{descale\-\_\-bt}}
\index{descale\-\_\-bt@{descale\-\_\-bt}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{descale\-\_\-bt}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-descale\-\_\-bt (
\begin{DoxyParamCaption}
\item[{}]{bte, }
\item[{}]{btomega, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ae88317fa471fbac39938c9702d011981}
\begin{DoxyVerb}descale BT excitation scaling
returns [energy,collision strength]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01698}{1698} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01698}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae88317fa471fbac39938c9702d011981}{01698} 
01699 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae88317fa471fbac39938c9702d011981}{descale\_bt}(bte,btomega,f,ev1):
01700     \textcolor{stringliteral}{"""}
01701 \textcolor{stringliteral}{    descale BT excitation scaling}
01702 \textcolor{stringliteral}{    returns [energy,collision strength]}
01703 \textcolor{stringliteral}{    """}
01704     u=1.-f+np.exp(np.log(f)/(1.-bte))
01705     energy=u*ev1
01706     omega=(np.log(u)-1.+np.exp(1.))*btomega
01707     \textcolor{keywordflow}{return} [energy,omega]
01708     \textcolor{comment}{#}
01709     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a74378c74514f5b6d760d4384780fbf26}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!descale\-\_\-bti@{descale\-\_\-bti}}
\index{descale\-\_\-bti@{descale\-\_\-bti}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{descale\-\_\-bti}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-descale\-\_\-bti (
\begin{DoxyParamCaption}
\item[{}]{bte, }
\item[{}]{btx, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a74378c74514f5b6d760d4384780fbf26}
\begin{DoxyVerb}descale BT ionization scaling
returns [energy,cross-section]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01686}{1686} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l01154}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ea\-Cross()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01686}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a74378c74514f5b6d760d4384780fbf26}{01686} 
01687 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a74378c74514f5b6d760d4384780fbf26}{descale\_bti}(bte,btx,f,ev1):
01688     \textcolor{stringliteral}{"""}
01689 \textcolor{stringliteral}{    descale BT ionization scaling}
01690 \textcolor{stringliteral}{    returns [energy,cross-section]}
01691 \textcolor{stringliteral}{    """}
01692     u=1.-f+np.exp(np.log(f)/(1.-bte))
01693     energy=u*ev1
01694     cross=(np.log(u)+1.)*btx/(u*ev1**2)
01695     \textcolor{keywordflow}{return} [energy,cross]
01696     \textcolor{comment}{#}
01697     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a2700fbbf2efe3b47f95b26958f6a1c4c}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!dilute@{dilute}}
\index{dilute@{dilute}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{dilute}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-dilute (
\begin{DoxyParamCaption}
\item[{}]{radius}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a2700fbbf2efe3b47f95b26958f6a1c4c}
\begin{DoxyVerb}to calculate the dilution factor as a function distance from
the center of a star in units of the stellar radius
a radius of less than 1.0 (incorrect) results in a dilution factor of 0.
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01068}{1068} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01068}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a2700fbbf2efe3b47f95b26958f6a1c4c}{01068} 
01069 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a2700fbbf2efe3b47f95b26958f6a1c4c}{dilute}(radius):
01070     \textcolor{stringliteral}{'''}
01071 \textcolor{stringliteral}{    to calculate the dilution factor as a function distance from}
01072 \textcolor{stringliteral}{    the center of a star in units of the stellar radius}
01073 \textcolor{stringliteral}{    a radius of less than 1.0 (incorrect) results in a dilution factor of 0.}
01074 \textcolor{stringliteral}{    '''}
01075     \textcolor{keywordflow}{if} radius >= 1.:
01076         d = 0.5*(1. - np.sqrt(1. - 1./radius**2))
01077     \textcolor{keywordflow}{else}:
01078         d = 0.
01079     \textcolor{keywordflow}{return} d
01080     \textcolor{comment}{#}
01081     \textcolor{comment}{#}
01082     \textcolor{comment}{# ------------------------------------------------------------------------------}
01083     \textcolor{comment}{#}
01084     \textcolor{comment}{#}
01085     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!di\-Read@{di\-Read}}
\index{di\-Read@{di\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{di\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-di\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}
\begin{DoxyVerb}read chianti direct ionization .params files and return
    {"info":info,"btf":btf,"ev1":ev1,"xsplom":xsplom,"ysplom":ysplom,"ref":hdr}
    info={"iz":iz,"ion":ion,"nspl":nspl,"neaev":neaev}
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01086}{1086} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-convert\-Name()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01086}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{01086} 
01087 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a28552b5d18a1b604ed4512c435e648bc}{diRead}(ions, filename=0):
01088     \textcolor{stringliteral}{"""}
01089 \textcolor{stringliteral}{    read chianti direct ionization .params files and return}
01090 \textcolor{stringliteral}{        \{"info":info,"btf":btf,"ev1":ev1,"xsplom":xsplom,"ysplom":ysplom,"ref":hdr\}}
01091 \textcolor{stringliteral}{        info=\{"iz":iz,"ion":ion,"nspl":nspl,"neaev":neaev\}}
01092 \textcolor{stringliteral}{    """}
01093     \textcolor{comment}{#}
01094     \textcolor{keywordflow}{if} filename:
01095         paramname = filename
01096     \textcolor{keywordflow}{else}:
01097         zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convertName}(ions)
01098         \textcolor{keywordflow}{if} zion[\textcolor{stringliteral}{'Z'}] < zion[\textcolor{stringliteral}{'Ion'}]:
01099             print(\textcolor{stringliteral}{' this is a bare nucleus that has no ionization rate'})
01100             \textcolor{keywordflow}{return}
01101         \textcolor{comment}{#}
01102         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
01103         paramname=fname+\textcolor{stringliteral}{'.diparams'}
01104     \textcolor{comment}{#}
01105     input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01106 \textcolor{stringliteral}{    }\textcolor{comment}{#  need to read first line and see how many elements}
01107     line1=input.readline()
01108     indices=line1.split()
01109     iz=int(indices[0])
01110     ion=int(indices[1])
01111     nspl=indices[2]
01112     nfac=int(indices[3])
01113     neaev=int(indices[4])
01114     nspl=int(nspl)
01115     format=FortranFormat(str(nspl+1)+\textcolor{stringliteral}{'E10.2'})
01116     \textcolor{comment}{#}
01117     ev1=np.zeros(nfac,\textcolor{stringliteral}{'Float64'})
01118     btf=np.zeros(nfac,\textcolor{stringliteral}{'Float64'})
01119     xsplom=np.zeros([nfac, nspl],\textcolor{stringliteral}{'Float64'})
01120     ysplom=np.zeros([nfac, nspl],\textcolor{stringliteral}{'Float64'})
01121     \textcolor{comment}{#}
01122     \textcolor{keywordflow}{for} ifac \textcolor{keywordflow}{in} range(nfac):
01123         line=input.readline()
01124         paramdat=FortranLine(line,format)
01125         btf[ifac]=paramdat[0]
01126         xsplom[ifac]=paramdat[1:]
01127         line=input.readline()
01128         paramdat=FortranLine(line,format)
01129         ev1[ifac]=paramdat[0]
01130         ysplom[ifac]=paramdat[1:]
01131     \textcolor{keywordflow}{if} neaev:
01132         line=input.readline()
01133         eacoef=line.split()
01134 \textcolor{comment}{#            print ' eaev = ', type(eacoef), eacoef}
01135         eaev=[float(avalue) \textcolor{keywordflow}{for} avalue \textcolor{keywordflow}{in} eacoef]
01136 \textcolor{comment}{#            print ' eaev = ', type(eaev), eaev}
01137 \textcolor{comment}{#            print ' eaev = ', type(eaev), eaev}
01138 \textcolor{comment}{#            if len(eaev) == 1:}
01139 \textcolor{comment}{#                eaev=float(eaev[0])}
01140 \textcolor{comment}{#                eaev=np.asarray(eaev, 'float32')}
01141 \textcolor{comment}{#            else:}
01142 \textcolor{comment}{#                eaev=np.asarray(eaev, 'float32')}
01143     \textcolor{keywordflow}{else}:
01144         eaev=0.
01145     hdr=input.readlines()
01146     input.close()
01147     info=\{\textcolor{stringliteral}{"iz"}:iz,\textcolor{stringliteral}{"ion"}:ion,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"neaev"}:neaev, \textcolor{stringliteral}{'nfac'}:nfac\}
01148     \textcolor{keywordflow}{if} neaev:
01149         info[\textcolor{stringliteral}{'eaev'}] = eaev
01150     DiParams=\{\textcolor{stringliteral}{"info"}:info,\textcolor{stringliteral}{"btf"}:btf,\textcolor{stringliteral}{"ev1"}:ev1,\textcolor{stringliteral}{"xsplom"}:xsplom,\textcolor{stringliteral}{"ysplom"}:ysplom, \textcolor{stringliteral}{'eaev'}:eaev,\textcolor{stringliteral}{"ref"}:hdr\}
01151     \textcolor{keywordflow}{return} DiParams
01152     \textcolor{comment}{#}
01153     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a14104e790cf31ef6c794dd09cd130797}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!dr\-Read@{dr\-Read}}
\index{dr\-Read@{dr\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{dr\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-dr\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a14104e790cf31ef6c794dd09cd130797}
\begin{DoxyVerb}read chianti dielectronic recombination .drparams files and return
    {'rrtype','params','ref'}\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01301}{1301} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01301}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a14104e790cf31ef6c794dd09cd130797}{01301} 
01302 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a14104e790cf31ef6c794dd09cd130797}{drRead}(ions):
01303     \textcolor{stringliteral}{"""read chianti dielectronic recombination .drparams files and return}
01304 \textcolor{stringliteral}{        \{'rrtype','params','ref'\}"""}
01305     \textcolor{comment}{#}
01306     \textcolor{comment}{#}
01307     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
01308     paramname=fname+\textcolor{stringliteral}{'.drparams'}
01309     \textcolor{keywordflow}{if} os.path.isfile(paramname):
01310         input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01311 \textcolor{stringliteral}{        }\textcolor{comment}{#  need to read first line and see how many elements}
01312         lines=input.readlines()
01313         input.close()
01314         drtype=int(lines[0])
01315         ref=lines[4:-1]
01316         \textcolor{comment}{#}
01317         \textcolor{keywordflow}{if} drtype == 1:
01318             \textcolor{comment}{# a Badnell type}
01319             fmt=FortranFormat(\textcolor{stringliteral}{'2i5,8e12.4'})
01320             eparams=np.asarray(FortranLine(lines[1],fmt)[2:], \textcolor{stringliteral}{'float64'})
01321             cparams=np.asarray(FortranLine(lines[2],fmt)[2:], \textcolor{stringliteral}{'float64'})
01322             DrParams=\{\textcolor{stringliteral}{'drtype'}:drtype, \textcolor{stringliteral}{'eparams'}:eparams,\textcolor{stringliteral}{'cparams'}:cparams,  \textcolor{stringliteral}{'ref'}:ref\}
01323         \textcolor{keywordflow}{elif} drtype == 2:
01324             \textcolor{comment}{# shull type}
01325             fmt=FortranFormat(\textcolor{stringliteral}{'2i5,4e12.4'})
01326             params=np.asarray(FortranLine(lines[1],fmt)[2:], \textcolor{stringliteral}{'float64'})
01327             DrParams=\{\textcolor{stringliteral}{'drtype'}:drtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01328         \textcolor{keywordflow}{else}:
01329             DrParams = \textcolor{keywordtype}{None}
01330             print((\textcolor{stringliteral}{' for ion %5s unknown DR type = %5i'} %(ions, drtype)))
01331     \textcolor{keywordflow}{else}:
01332         DrParams=\textcolor{keywordtype}{None}
01333     \textcolor{keywordflow}{return} DrParams
01334     \textcolor{comment}{#}
01335     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!ea\-Cross@{ea\-Cross}}
\index{ea\-Cross@{ea\-Cross}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{ea\-Cross}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ea\-Cross (
\begin{DoxyParamCaption}
\item[{}]{diparams, }
\item[{}]{easplom, }
\item[{}]{elvlc, }
\item[{}]{energy = {\ttfamily None}, }
\item[{}]{verbose = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}
\begin{DoxyVerb}Provide the excitation-autoionization cross section.

Energy is given in eV.
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01154}{1154} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l01686}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-descale\-\_\-bti()}, and \hyperlink{__chianti__tools_8py_source_l00760}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-splom\-Descale()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01154}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{01154} 
01155 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5c2be70e50273734d319a433bf39ce5b}{eaCross}(diparams, easplom, elvlc, energy=None, verbose=False):
01156     \textcolor{stringliteral}{'''}
01157 \textcolor{stringliteral}{    Provide the excitation-autoionization cross section.}
01158 \textcolor{stringliteral}{}
01159 \textcolor{stringliteral}{    Energy is given in eV.}
01160 \textcolor{stringliteral}{    '''}
01161     energy = np.asarray(energy, \textcolor{stringliteral}{'float64'})
01162     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} energy.any():
01163         btenergy=0.1*np.arange(10)
01164         btenergy[0]=0.01
01165         dum=np.ones(len(btenergy))
01166         [energy, dum] = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a74378c74514f5b6d760d4384780fbf26}{descale\_bti}(btenergy, dum, 2., min(easplom[\textcolor{stringliteral}{'deryd'}]))
01167         energy=np.asarray(energy, \textcolor{stringliteral}{'float64'})
01168     \textcolor{comment}{#}
01169     omega = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a2cd45e7b512b31d25e92f3adf69b1914}{splomDescale}(easplom, energy)
01170     \textcolor{comment}{#}
01171     \textcolor{comment}{#  need to replicate neaev}
01172 
01173     \textcolor{keywordflow}{if} diparams[\textcolor{stringliteral}{'info'}][\textcolor{stringliteral}{'neaev'}] > 0:
01174         f1 = np.ones(omega.shape[0])
01175     \textcolor{keywordflow}{else}:
01176         f1 = diparams[\textcolor{stringliteral}{'info'}][\textcolor{stringliteral}{'eaev'}]
01177 
01178     totalCross = np.zeros\_like(energy)
01179     ntrans = omega.shape[0]
01180     \textcolor{keywordflow}{for} itrans \textcolor{keywordflow}{in} range(ntrans):
01181         lvl1 = easplom[\textcolor{stringliteral}{'lvl1'}][itrans]
01182         mult = 2.*elvlc[\textcolor{stringliteral}{'j'}][lvl1 - 1] + 1.
01183         cross = f1[itrans]*const.bohrCross*omega[itrans]/(mult.energy/const.ryd2Ev)
01184         totalCross += cross
01185     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'energy'}:energy, \textcolor{stringliteral}{'cross'}:totalCross\}
01186     \textcolor{comment}{#}
01187     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!ea\-Read@{ea\-Read}}
\index{ea\-Read@{ea\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{ea\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ea\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}
\begin{DoxyVerb}read a chianti excitation-autoionization file and return the EA ionization rate data
derived from splupsRead
{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref}
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01188}{1188} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-convert\-Name()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01188}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{01188} 
01189 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab4f78a2584a1ddf189af644e961f0f83}{eaRead}(ions, filename=0):
01190     \textcolor{stringliteral}{'''}
01191 \textcolor{stringliteral}{    read a chianti excitation-autoionization file and return the EA ionization rate data}
01192 \textcolor{stringliteral}{    derived from splupsRead}
01193 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref\}}
01194 \textcolor{stringliteral}{    '''}
01195     \textcolor{keywordflow}{if} filename:
01196         splupsname = filename
01197     \textcolor{keywordflow}{else}:
01198         zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convertName}(ions)
01199         \textcolor{keywordflow}{if} zion[\textcolor{stringliteral}{'Z'}] < zion[\textcolor{stringliteral}{'Ion'}]:
01200             print(\textcolor{stringliteral}{' this is a bare nucleus that has no ionization rate'})
01201             \textcolor{keywordflow}{return}
01202         \textcolor{comment}{#}
01203         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
01204         splupsname=fname+\textcolor{stringliteral}{'.easplups'}
01205     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(splupsname):
01206         print((\textcolor{stringliteral}{' could not find file:  '}, splupsname))
01207         Splups=\{\textcolor{stringliteral}{"lvl1"}:-1\}
01208         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:-1\}
01209     \textcolor{comment}{# there is splups/psplups data}
01210     \textcolor{keywordflow}{else}:
01211         input=open(splupsname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01212 \textcolor{stringliteral}{        s1=input.readlines()}
01213 \textcolor{stringliteral}{        dum=input.close()}
01214 \textcolor{stringliteral}{        nsplups=0}
01215 \textcolor{stringliteral}{        ndata=2}
01216 \textcolor{stringliteral}{        }\textcolor{keywordflow}{while} ndata > 1:
01217             s1a=s1[nsplups][:]
01218             s2=s1a.split()
01219             ndata=len(s2)
01220             nsplups=nsplups+1
01221         nsplups=nsplups-1
01222         lvl1=[0]*nsplups
01223         lvl2=[0]*nsplups
01224         ttype=[0]*nsplups
01225         gf=[0.]*nsplups
01226         de=[0.]*nsplups
01227         cups=[0.]*nsplups
01228         nspl=[0]*nsplups
01229         splups=np.zeros((nsplups,9),\textcolor{stringliteral}{'Float64'})
01230         splupsFormat1=\textcolor{stringliteral}{'(6x,3i3,8e10.0)'}
01231         splupsFormat2=\textcolor{stringliteral}{'(6x,3i3,12e10.0)'}
01232         \textcolor{comment}{#}
01233         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nsplups):
01234             \textcolor{keywordflow}{try}:
01235                 inpt=FortranLine(s1[i],splupsFormat1)
01236             \textcolor{keywordflow}{except}:
01237                 inpt=FortranLine(s1[i],splupsFormat2)
01238             lvl1[i]=inpt[0]
01239             lvl2[i]=inpt[1]
01240             ttype[i]=inpt[2]
01241             gf[i]=inpt[3]
01242             de[i]=inpt[4]
01243             cups[i]=inpt[5]
01244             \textcolor{keywordflow}{if} len(inpt)  > 13:
01245                 nspl[i]=9
01246                 splups[i].put(range(9),inpt[6:])
01247             \textcolor{keywordflow}{else}:
01248                 nspl[i]=5
01249                 splups[i].put(range(5),inpt[6:])
01250         \textcolor{comment}{#}
01251         ref=[]
01252         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nsplups+1,len(s1)-1):
01253             s1a=s1[i][:-1]
01254             ref.append(s1a.strip())
01255 \textcolor{comment}{#        self.EaParams=\{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups}
01256 \textcolor{comment}{#                ,"nspl":nspl,"splups":splups,"ref":ref\}}
01257         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"de"}:de,\textcolor{stringliteral}{"cups"}:cups
01258                 ,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"splups"}:splups,\textcolor{stringliteral}{"ref"}:ref\}
01259     \textcolor{comment}{#}
01260     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!easplom\-Read@{easplom\-Read}}
\index{easplom\-Read@{easplom\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{easplom\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-easplom\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{extension = {\ttfamily '.splom'}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}
\begin{DoxyVerb}read chianti splom files and returns
{"lvl1":lvl1,"lvl2":lvl2,"deryd":de,"gf":gf,"eryd":eout,"omega":omout}
currently only works for 5 point spline fit files\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00706}{706} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00706}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{00706} 
00707 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa36b22e4e67bccdea3436dcc05e7ba5b}{easplomRead}(ions, extension='.splom'):
00708     \textcolor{stringliteral}{"""read chianti splom files and returns}
00709 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"deryd":de,"gf":gf,"eryd":eout,"omega":omout\}}
00710 \textcolor{stringliteral}{    currently only works for 5 point spline fit files"""}
00711     \textcolor{comment}{#}
00712     \textcolor{comment}{#}
00713     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
00714     omname=fname+extension
00715     input=open(omname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00716 \textcolor{stringliteral}{    lines=input.readlines()}
00717 \textcolor{stringliteral}{    input.close()}
00718 \textcolor{stringliteral}{    format=FortranFormat(}\textcolor{stringliteral}{'5i3,8e10.3'})
00719     data=5
00720     iline=0
00721     lvl1=[]
00722     lvl2=[]
00723     ttype=[]
00724     gf=[]
00725     de=[]
00726     om=[]
00727     z=1
00728     \textcolor{keywordflow}{while} z > 0:
00729         omdat1=FortranLine(lines[iline],format)
00730         z=omdat1[0]
00731         \textcolor{keywordflow}{if} z > 0:
00732             l1=omdat1[2]
00733             l2=omdat1[3]
00734             ttype1=omdat1[4]
00735             gf1=omdat1[5]
00736             de1=omdat1[6]
00737             btf1=omdat1[7]
00738             om1=omdat1[8:]
00739             \textcolor{comment}{#}
00740             lvl1.append(l1)
00741             lvl2.append(l2)
00742             ttype.append(ttype1)
00743             gf.append(gf1)
00744             de.append(de1)
00745             om.append(om1)
00746         iline=iline+1
00747     omout=np.asarray(om,\textcolor{stringliteral}{'Float64'})
00748     ref=lines[iline:-1]
00749 \textcolor{comment}{#        omout=np.transpose(omout)}
00750     \textcolor{keywordflow}{if} extension == \textcolor{stringliteral}{'.omdat'}:
00751         Splom=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{'ttype'}:ttype,\textcolor{stringliteral}{"gf"}:gf, \textcolor{stringliteral}{"deryd"}:de,\textcolor{stringliteral}{"omega"}:omout, \textcolor{stringliteral}{'ref'}:ref\}
00752         \textcolor{keywordflow}{return} Splom
00753     \textcolor{keywordflow}{elif}  extension == \textcolor{stringliteral}{'.easplom'}:
00754         Easplom=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{'ttype'}:ttype,\textcolor{stringliteral}{"gf"}:gf, \textcolor{stringliteral}{"deryd"}:de,\textcolor{stringliteral}{"omega"}:omout, \textcolor{stringliteral}{'ref'}:ref\}
00755         \textcolor{keywordflow}{return} Easplom
00756 
00757     \textcolor{keywordflow}{return}
00758     \textcolor{comment}{#}
00759     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ac3ff49dcedbe30c752e9f948e94f29bc}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!el2z@{el2z}}
\index{el2z@{el2z}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{el2z}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-el2z (
\begin{DoxyParamCaption}
\item[{}]{els}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ac3ff49dcedbe30c752e9f948e94f29bc}
\begin{DoxyVerb}from an the name of the element (1-2 letter) return Z\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00406}{406} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00406}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac3ff49dcedbe30c752e9f948e94f29bc}{00406} 
00407 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac3ff49dcedbe30c752e9f948e94f29bc}{el2z}(els):
00408     \textcolor{stringliteral}{""" from an the name of the element (1-2 letter) return Z"""}
00409     z=const.El.index(els.lower())+1
00410     \textcolor{keywordflow}{return} z
00411     \textcolor{comment}{#}
00412     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!elvlc\-Read@{elvlc\-Read}}
\index{elvlc\-Read@{elvlc\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{elvlc\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-elvlc\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily None}, }
\item[{}]{verbose = {\ttfamily 0}, }
\item[{}]{use\-Th = {\ttfamily 1}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}
\begin{DoxyVerb}read a chianti energy level file and returns
{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j
,"mult":mult,"ecm":ecm,"eryd":eryd,"ecmth":ecmth,"erydth":erydth,"ref":ref,"pretty":pretty, 'ionS':ions}
if a energy value for ecm or eryd is zero(=unknown), the theoretical values
(ecmth and erydth) are inserted
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00453}{453} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00572}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-wgfa\-Read()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00453}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{00453} 
00454 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{elvlcRead}(ions, filename = None, verbose=0,  useTh=1):
00455     \textcolor{stringliteral}{"""}
00456 \textcolor{stringliteral}{    read a chianti energy level file and returns}
00457 \textcolor{stringliteral}{    \{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j}
00458 \textcolor{stringliteral}{    ,"mult":mult,"ecm":ecm,"eryd":eryd,"ecmth":ecmth,"erydth":erydth,"ref":ref,"pretty":pretty, 'ionS'
      :ions\}}
00459 \textcolor{stringliteral}{    if a energy value for ecm or eryd is zero(=unknown), the theoretical values}
00460 \textcolor{stringliteral}{    (ecmth and erydth) are inserted}
00461 \textcolor{stringliteral}{    """}
00462     \textcolor{comment}{#}
00463     fstring=\textcolor{stringliteral}{'i3,i6,a15,i3,i3,a3,f4.1,i3,4f15.2'}
00464     elvlcFormat=FortranFormat(fstring)
00465     \textcolor{comment}{#}
00466     \textcolor{keywordflow}{if} type(filename) == NoneType:
00467         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
00468         elvlname=fname+\textcolor{stringliteral}{'.elvlc'}
00469     \textcolor{keywordflow}{else}:
00470         elvlname = filename
00471         bname = os.path.basename(filename)
00472         ions = bname.split(\textcolor{stringliteral}{'.'})[0]
00473     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.isfile(elvlname):
00474         print(\textcolor{stringliteral}{' elvlc file does not exist:  '},elvlname)
00475         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'status'}:0\}
00476     status = 1
00477     input=open(elvlname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00478 \textcolor{stringliteral}{    s1=input.readlines()}
00479 \textcolor{stringliteral}{    input.close()}
00480 \textcolor{stringliteral}{    nlvls=0}
00481 \textcolor{stringliteral}{    ndata=2}
00482 \textcolor{stringliteral}{    }\textcolor{keywordflow}{while} ndata > 1:
00483         s1a=s1[nlvls][:-1]
00484         s2=s1a.split()
00485         ndata=len(s2)
00486         nlvls=nlvls+1
00487     nlvls-=1
00488     \textcolor{keywordflow}{if} verbose:
00489         print(\textcolor{stringliteral}{' nlvls = '}, nlvls)
00490     lvl=[0]*nlvls
00491     conf=[0]*nlvls
00492     term=[0]*nlvls
00493     spin=[0]*nlvls
00494     l=[0]*nlvls
00495     spd=[0]*nlvls
00496     j=[0]*nlvls
00497     mult=[0]*nlvls
00498     ecm=[0]*nlvls
00499     eryd=[0]*nlvls
00500     ecmth=[0]*nlvls
00501     erydth=[0]*nlvls
00502     pretty=[0]*nlvls
00503     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nlvls):
00504         \textcolor{keywordflow}{if} verbose:
00505             print(s1[i][0:115])
00506         inpt=FortranLine(s1[i][0:115],elvlcFormat)
00507         lvl[i]=inpt[0]
00508         conf[i]=inpt[1]
00509         term[i]=inpt[2].strip()
00510         spin[i]=inpt[3]
00511         l[i]=inpt[4]
00512         spd[i]=inpt[5].strip()
00513         j[i]=inpt[6]
00514         mult[i]=inpt[7]
00515         ecm[i]=inpt[8]
00516         eryd[i]=inpt[9]
00517         ecmth[i]=inpt[10]
00518         erydth[i]=inpt[11]
00519         \textcolor{keywordflow}{if} ecm[i] == 0.:
00520             \textcolor{keywordflow}{if} useTh:
00521                 ecm[i] = ecmth[i]
00522                 eryd[i] = erydth[i]
00523         stuff = term[i].strip() + \textcolor{stringliteral}{' %1i%1s%3.1f'}%( spin[i], spd[i], j[i])
00524         pretty[i] = stuff.strip()
00525     ref=[]
00526     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nlvls+1,len(s1)-1):
00527         s1a=s1[i][:-1]
00528         ref.append(s1a.strip())
00529 \textcolor{comment}{#    self.const.Elvlc=\{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j}
00530 \textcolor{comment}{#            ,"mult":mult,"ecm":ecm,"eryd":eryd,"ecmth":ecmth,"erydth":erydth,"ref":ref\}}
00531     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl"}:lvl,\textcolor{stringliteral}{"conf"}:conf,\textcolor{stringliteral}{"term"}:term,\textcolor{stringliteral}{"spin"}:spin,\textcolor{stringliteral}{"l"}:l,\textcolor{stringliteral}{"spd"}:spd,\textcolor{stringliteral}{"j"}:j
00532             ,\textcolor{stringliteral}{"mult"}:mult,\textcolor{stringliteral}{"ecm"}:ecm,\textcolor{stringliteral}{"eryd"}:eryd,\textcolor{stringliteral}{"ecmth"}:ecmth,\textcolor{stringliteral}{"erydth"}:erydth,\textcolor{stringliteral}{"ref"}:ref,\textcolor{stringliteral}{"pretty"}:pretty, \textcolor{stringliteral}{'
      ionS'}:ions, \textcolor{stringliteral}{'status'}:status\}
00533     \textcolor{comment}{#}
00534     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ab6f19b7a8594fc425b55d7037d983641}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!elvlc\-Write@{elvlc\-Write}}
\index{elvlc\-Write@{elvlc\-Write}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{elvlc\-Write}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-elvlc\-Write (
\begin{DoxyParamCaption}
\item[{}]{info}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ab6f19b7a8594fc425b55d7037d983641}
\begin{DoxyVerb}creates a .elvlc in the current directory
info is a dictionary that must contain the following keys
ionS, the Chianti style name of the ion such as c_4
conf, an integer denoting the configuration - not too essential
term, a string showing the configuration
spin, an integer of the spin of the state in LS coupling
l, an integer of the angular momentum quantum number
spd, an string for the alphabetic symbol of the angular momemtum, S, P, D, etc
j, a floating point number, the total angular momentum
ecm, the observed energy in inverse cm, if unknown, the value is 0.
eryd, the observed energy in Rydbergs, if unknown, the value is 0.
ecmth, the calculated energy from the scattering calculation, in inverse cm
erydth, the calculated energy from the scattering calculation in Rydbergs
ref, the references in the literature to the data in the input info\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00535}{535} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00535}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab6f19b7a8594fc425b55d7037d983641}{00535} 
00536 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab6f19b7a8594fc425b55d7037d983641}{elvlcWrite}(info):
00537     \textcolor{stringliteral}{''' creates a .elvlc in the current directory}
00538 \textcolor{stringliteral}{    info is a dictionary that must contain the following keys}
00539 \textcolor{stringliteral}{    ionS, the Chianti style name of the ion such as c\_4}
00540 \textcolor{stringliteral}{    conf, an integer denoting the configuration - not too essential}
00541 \textcolor{stringliteral}{    term, a string showing the configuration}
00542 \textcolor{stringliteral}{    spin, an integer of the spin of the state in LS coupling}
00543 \textcolor{stringliteral}{    l, an integer of the angular momentum quantum number}
00544 \textcolor{stringliteral}{    spd, an string for the alphabetic symbol of the angular momemtum, S, P, D, etc}
00545 \textcolor{stringliteral}{    j, a floating point number, the total angular momentum}
00546 \textcolor{stringliteral}{    ecm, the observed energy in inverse cm, if unknown, the value is 0.}
00547 \textcolor{stringliteral}{    eryd, the observed energy in Rydbergs, if unknown, the value is 0.}
00548 \textcolor{stringliteral}{    ecmth, the calculated energy from the scattering calculation, in inverse cm}
00549 \textcolor{stringliteral}{    erydth, the calculated energy from the scattering calculation in Rydbergs}
00550 \textcolor{stringliteral}{    ref, the references in the literature to the data in the input info'''}
00551     gname = info[\textcolor{stringliteral}{'ionS'}]
00552     elvlcname = gname + \textcolor{stringliteral}{'.elvlc'}
00553     print(\textcolor{stringliteral}{' elvlc file name = '}, elvlcname)
00554     out = open(elvlcname, \textcolor{stringliteral}{'w'})
00555     \textcolor{keywordflow}{for} i,  conf \textcolor{keywordflow}{in} enumerate(info[\textcolor{stringliteral}{'conf'}]):
00556         mult = int(2.*info[\textcolor{stringliteral}{'j'}][i]+1.)
00557         pstring = \textcolor{stringliteral}{'%3i%6s%15s%3i%3i%2s%5.1f%3i%15.3f%15.6f%15.3f%15.6f \(\backslash\)n'}%(i+1, conf, info[\textcolor{stringliteral}{'term'}][i], 
      info[\textcolor{stringliteral}{'spin'}][i], info[\textcolor{stringliteral}{'l'}][i], info[\textcolor{stringliteral}{'spd'}][i], info[\textcolor{stringliteral}{'j'}][i], mult, info[\textcolor{stringliteral}{'ecm'}][i], info[\textcolor{stringliteral}{'eryd'}][i], info[\textcolor{stringliteral}{'ecmth
      '}][i], info[\textcolor{stringliteral}{'erydth'}][i])
00558     \textcolor{comment}{#i3,a6,a15,2i3,a2,f5.1,i3,f15.3,f15.6,f15.3,f15.6}
00559         out.write(pstring)
00560     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00561     out.write(\textcolor{stringliteral}{'%filename:  '} + elvlcname + \textcolor{stringliteral}{'\(\backslash\)n'})
00562     info[\textcolor{stringliteral}{'ref'}].append(\textcolor{stringliteral}{' produced as a part of the George Mason University, University of Cambridge,
       University of Michigan \(\backslash\)'CHIANTI\(\backslash\)' atomic database for astrophysical spectroscopy consortium'})
00563     today = date.today()
00564     info[\textcolor{stringliteral}{'ref'}].append(\textcolor{stringliteral}{' K. Dere (GMU) - '} + today.strftime(\textcolor{stringliteral}{'%Y %B %d'}))
00565     \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} info[\textcolor{stringliteral}{'ref'}]:
00566         out.write(one+\textcolor{stringliteral}{'\(\backslash\)n'})
00567     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00568     out.close()
00569     \textcolor{keywordflow}{return}
00570     \textcolor{comment}{#}
00571     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!fblvl\-Read@{fblvl\-Read}}
\index{fblvl\-Read@{fblvl\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{fblvl\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-fblvl\-Read (
\begin{DoxyParamCaption}
\item[{}]{filename, }
\item[{}]{verbose = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}
\begin{DoxyVerb}read a chianti energy level file and returns
{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j
,"mult":mult,"ecm":ecm,"eryd":eryd,"ref":ref}\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01476}{1476} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01476}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{01476} 
01477 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a63235035cef376c49a1f4e81933452a6}{fblvlRead}(filename, verbose=False):
01478     \textcolor{stringliteral}{""" read a chianti energy level file and returns}
01479 \textcolor{stringliteral}{    \{"lvl":lvl,"conf":conf,"term":term,"spin":spin,"l":l,"spd":spd,"j":j}
01480 \textcolor{stringliteral}{    ,"mult":mult,"ecm":ecm,"eryd":eryd,"ref":ref\}"""}
01481 \textcolor{comment}{#        #  ,format='(i5,a20,2i5,a3,i5,2f20.3)'}
01482     fstring=\textcolor{stringliteral}{'i5,a20,2i5,a3,i5,2f20.3'}
01483     elvlcFormat=FortranFormat(fstring)
01484     \textcolor{comment}{#}
01485     \textcolor{keywordflow}{if} os.path.exists(filename):
01486         input=open(filename,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01487 \textcolor{stringliteral}{        s1=input.readlines()}
01488 \textcolor{stringliteral}{        input.close()}
01489 \textcolor{stringliteral}{        nlvls=0}
01490 \textcolor{stringliteral}{        ndata=2}
01491 \textcolor{stringliteral}{        }\textcolor{keywordflow}{while} ndata > 1:
01492             s1a=s1[nlvls][:-1]
01493             s2=s1a.split()
01494             ndata=len(s2)
01495             nlvls=nlvls+1
01496         nlvls-=1
01497         \textcolor{keywordflow}{if} verbose:
01498             print((\textcolor{stringliteral}{' nlvls = %5i'}%(nlvls)))
01499         lvl=[0]*nlvls
01500         conf=[0]*nlvls
01501         pqn=[0]*nlvls
01502         l=[0]*nlvls
01503         spd=[0]*nlvls
01504         mult=[0]*nlvls
01505         ecm=[0]*nlvls
01506         ecmth=[0]*nlvls
01507         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nlvls):
01508             \textcolor{keywordflow}{if} verbose:
01509                 print((s1[i]))
01510             inpt=FortranLine(s1[i],elvlcFormat)
01511             lvl[i]=inpt[0]
01512             conf[i]=inpt[1].strip()
01513             pqn[i]=inpt[2]
01514             l[i]=inpt[3]
01515             spd[i]=inpt[4].strip()
01516             mult[i]=inpt[5]
01517             \textcolor{keywordflow}{if} inpt[6] == 0.:
01518                 ecm[i]=inpt[7]
01519             \textcolor{keywordflow}{else}:
01520                 ecm[i]=inpt[6]
01521                 ecmth[i]=inpt[7]
01522         ref=[]
01523         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nlvls+1,len(s1)-1):
01524             s1a=s1[i][:-1]
01525             ref.append(s1a.strip())
01526         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl"}:lvl,\textcolor{stringliteral}{"conf"}:conf,\textcolor{stringliteral}{'pqn'}:pqn,\textcolor{stringliteral}{"l"}:l,\textcolor{stringliteral}{"spd"}:spd,\textcolor{stringliteral}{"mult"}:mult,
01527             \textcolor{stringliteral}{"ecm"}:ecm,\textcolor{stringliteral}{'ecmth'}:ecmth, \textcolor{stringliteral}{'ref'}:ref\}
01528     \textcolor{keywordflow}{else}:
01529         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'errorMessage'}:\textcolor{stringliteral}{' fblvl file does not exist'}\}
01530     \textcolor{comment}{#}
01531     \textcolor{comment}{# -----------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a9d97df13906f98a3d0fd3da3cc0cef0c}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!gffint\-Read@{gffint\-Read}}
\index{gffint\-Read@{gffint\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{gffint\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-gffint\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a9d97df13906f98a3d0fd3da3cc0cef0c}
\begin{DoxyVerb}to read the integrated free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01384}{1384} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01384}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a9d97df13906f98a3d0fd3da3cc0cef0c}{01384} 
01385 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a9d97df13906f98a3d0fd3da3cc0cef0c}{gffintRead}():
01386     \textcolor{stringliteral}{'''to read the integrated free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.'''}
01387     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01388     fileName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'},\textcolor{stringliteral}{'gffint.dat'} )
01389     input = open(fileName)
01390     lines = input.readlines()
01391     input.close()
01392     \textcolor{comment}{#}
01393     ngamma=41
01394     g2 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01395     gffint = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01396     s1 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01397     s2 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01398     s3 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01399     \textcolor{comment}{#}
01400     ivalue = 0
01401     start = 4
01402     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(start,start+ngamma):
01403         values = lines[iline].split()
01404         g2[ivalue] = float(values[0])
01405         gffint[ivalue] = float(values[1])
01406         s1[ivalue] = float(values[2])
01407         s2[ivalue] = float(values[3])
01408         s3[ivalue] = float(values[4])
01409         ivalue += 1
01410     \textcolor{comment}{#}
01411     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'g2'}:g2, \textcolor{stringliteral}{'gffint'}:gffint, \textcolor{stringliteral}{'s1'}:s1, \textcolor{stringliteral}{'s2'}:s2, \textcolor{stringliteral}{'s3'}:s3\}
01412     \textcolor{comment}{#}
01413     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a109ccb08244e615937df43b7a80a1625}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!gff\-Read@{gff\-Read}}
\index{gff\-Read@{gff\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{gff\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-gff\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a109ccb08244e615937df43b7a80a1625}
\begin{DoxyVerb}to read the free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.
this function reads the file and reverses the values of g2 and u\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01346}{1346} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01346}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a109ccb08244e615937df43b7a80a1625}{01346} 
01347 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a109ccb08244e615937df43b7a80a1625}{gffRead}():
01348     \textcolor{stringliteral}{'''to read the free-free gaunt factors of Sutherland, 1998, MNRAS, 300, 321.}
01349 \textcolor{stringliteral}{    this function reads the file and reverses the values of g2 and u'''}
01350     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01351     fileName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'},\textcolor{stringliteral}{'gffgu.dat'} )
01352     input = open(fileName)
01353     lines = input.readlines()
01354     input.close()
01355     \textcolor{comment}{#}
01356     \textcolor{comment}{#  the 1d stuff below is to make it easy to use interp2d}
01357     ngamma=41
01358     nu=81
01359     nvalues = ngamma*nu
01360     g2 = np.zeros(ngamma, \textcolor{stringliteral}{'float64'})
01361     g21d = np.zeros(nvalues, \textcolor{stringliteral}{'float64'})
01362     u = np.zeros(nu, \textcolor{stringliteral}{'float64'})
01363     u1d = np.zeros(nvalues, \textcolor{stringliteral}{'float64'})
01364     gff = np.zeros((ngamma, nu), \textcolor{stringliteral}{'float64'})
01365     gff1d = np.zeros(nvalues, \textcolor{stringliteral}{'float64'})
01366     \textcolor{comment}{#}
01367     iline = 5
01368     ivalue = 0
01369     \textcolor{keywordflow}{for} ig2 \textcolor{keywordflow}{in} range(ngamma):
01370         \textcolor{keywordflow}{for} iu \textcolor{keywordflow}{in} range(nu):
01371             values = lines[iline].split()
01372             u[iu] = float(values[1])
01373             u1d[ivalue] = float(values[1])
01374             g2[ig2] = float(values[0])
01375             g21d[ivalue] = float(values[0])
01376             gff[ig2, iu] = float(values[2])
01377             gff1d[ivalue] = float(values[2])
01378             iline+=1
01379             ivalue += 1
01380     \textcolor{comment}{#}
01381     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'g2'}:g2, \textcolor{stringliteral}{'g21d'}:g21d,  \textcolor{stringliteral}{'}\textcolor{stringliteral}{u':u, '}u1d':u1d,  'gff':gff,  'gff1d':gff1d\}
01382     \textcolor{comment}{#}
01383     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!ion2filename@{ion2filename}}
\index{ion2filename@{ion2filename}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{ion2filename}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}
\begin{DoxyVerb}convert ion string to generic file name string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00396}{396} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-convert\-Name()}, and \hyperlink{__chianti__tools_8py_source_l00282}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-z2element()}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00985}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-cireclvl\-Read()}, \hyperlink{__chianti__tools_8py_source_l01086}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-di\-Read()}, \hyperlink{__chianti__tools_8py_source_l01301}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-dr\-Read()}, \hyperlink{__chianti__tools_8py_source_l01188}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ea\-Read()}, \hyperlink{__chianti__tools_8py_source_l00706}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-easplom\-Read()}, \hyperlink{__chianti__tools_8py_source_l00453}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-elvlc\-Read()}, \hyperlink{__chianti__tools_8py_source_l00185}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-photox\-Read()}, \hyperlink{__chianti__tools_8py_source_l01261}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-rr\-Read()}, \hyperlink{__chianti__tools_8py_source_l00827}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-splom\-Read()}, \hyperlink{__chianti__tools_8py_source_l00891}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-splups\-Read()}, and \hyperlink{__chianti__tools_8py_source_l00572}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-wgfa\-Read()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00396}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{00396} 
00397 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions):
00398     \textcolor{stringliteral}{""" convert ion string to generic file name string """}
00399     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00400     zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convertName}(ions)
00401     el=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a384f39b118999003fd2d0c54974a0aff}{z2element}(zion[\textcolor{stringliteral}{'Z'}])
00402     fname=os.path.join(dir,el,ions,ions)
00403     \textcolor{keywordflow}{return} fname
00404     \textcolor{comment}{#}
00405     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!ioneq\-Read@{ioneq\-Read}}
\index{ioneq\-Read@{ioneq\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{ioneq\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ioneq\-Read (
\begin{DoxyParamCaption}
\item[{}]{ioneqname = {\ttfamily ''}, }
\item[{}]{verbose = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}
\begin{DoxyVerb}reads an ioneq file and stores temperatures and ionization
equilibrium values in self.IoneqTemperature and self.Ioneq and returns
a dictionary containing these value and the reference to the literature
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01336}{1336} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01336}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{01336} 
01337 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{ioneqRead}(ioneqname='', verbose=0):
01338     \textcolor{stringliteral}{"""}
01339 \textcolor{stringliteral}{    reads an ioneq file and stores temperatures and ionization}
01340 \textcolor{stringliteral}{    equilibrium values in self.IoneqTemperature and self.Ioneq and returns}
01341 \textcolor{stringliteral}{    a dictionary containing these value and the reference to the literature}
01342 \textcolor{stringliteral}{    """}
01343     \textcolor{keywordflow}{pass}
01344     \textcolor{comment}{#}
01345     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a12d45bcebd107c5fd133830132e8cd5e}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!ionrecdat\-Read@{ionrecdat\-Read}}
\index{ionrecdat\-Read@{ionrecdat\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{ionrecdat\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ionrecdat\-Read (
\begin{DoxyParamCaption}
\item[{}]{filename}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a12d45bcebd107c5fd133830132e8cd5e}
\begin{DoxyVerb}read chianti ionxdat, ionizdat, recombdat files and return
{"ev":ev,"cross":cross,"crosserr":crosserr,"ref":ref}  not tested \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00237}{237} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00237}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a12d45bcebd107c5fd133830132e8cd5e}{00237} 
00238 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a12d45bcebd107c5fd133830132e8cd5e}{ionrecdatRead}(filename):
00239     \textcolor{stringliteral}{""" read chianti ionxdat, ionizdat, recombdat files and return}
00240 \textcolor{stringliteral}{    \{"ev":ev,"cross":cross,"crosserr":crosserr,"ref":ref\}  not tested """}
00241     \textcolor{comment}{#}
00242     input=open(filename,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00243 \textcolor{stringliteral}{    ionrec=input.readlines()}
00244 \textcolor{stringliteral}{    dum=input.close()}
00245 \textcolor{stringliteral}{    }\textcolor{comment}{#}
00246     \textcolor{comment}{# first get the number of data lines}
00247     ndata=2
00248     iline=0
00249     \textcolor{keywordflow}{while} ndata > 1:
00250         s2=ionrec[iline].split()
00251         ndata=len(s2)
00252         iline=iline+1
00253     nline=iline-1
00254     \textcolor{comment}{#}
00255     x=np.zeros(nline,\textcolor{stringliteral}{'Float64'})
00256     y=np.zeros(nline,\textcolor{stringliteral}{'Float64'})
00257     yerr=np.zeros(nline,\textcolor{stringliteral}{'Float64'})
00258 \textcolor{comment}{#}
00259     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(0,nline):
00260         ndata=len
00261         s2=ionrec[iline].split()
00262         ndata=len(s2)
00263         \textcolor{keywordflow}{if} ndata == 2:
00264             x[iline]=float(s2[0])
00265             y[iline]=float(s2[1])
00266             yerr[iline]=float(0.)
00267         \textcolor{keywordflow}{else}:
00268             x[iline]=float(s2[0])
00269             y[iline]=float(s2[1])
00270             yerr[iline]=float(s2[2])
00271     \textcolor{comment}{#}
00272     ref=[]
00273     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(nline+1,len(ionrec)-1):
00274         s1a=ionrec[iline][:-1]
00275         ref.append(s1a.strip())
00276 
00277 
00278     ionrecdat=\{\textcolor{stringliteral}{"x"}:x,\textcolor{stringliteral}{"y"}:y,\textcolor{stringliteral}{"yerr"}:yerr,\textcolor{stringliteral}{"ref"}:ref\}
00279     \textcolor{keywordflow}{return} ionrecdat
00280     \textcolor{comment}{#}
00281     \textcolor{comment}{# --------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!ip\-Read@{ip\-Read}}
\index{ip\-Read@{ip\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{ip\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ip\-Read (
\begin{DoxyParamCaption}
\item[{}]{verbose = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}
\begin{DoxyVerb}reads the ionization potential file, returns ip array in eV
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00033}{33} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00033}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{00033} 
00034 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_addc139edf6069387aed0049344002b13}{ipRead}(verbose=False):
00035     \textcolor{stringliteral}{"""}
00036 \textcolor{stringliteral}{    reads the ionization potential file, returns ip array in eV}
00037 \textcolor{stringliteral}{    """}
00038     topdir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00039     ipname=os.path.join(topdir, \textcolor{stringliteral}{'ip'},\textcolor{stringliteral}{'chianti.ip'})
00040     ipfile=open(ipname)
00041     data=ipfile.readlines()
00042     ipfile.close()
00043     nip=0
00044     ndata=2
00045     maxz=0
00046     \textcolor{keywordflow}{while} ndata > 1:
00047         s1=data[nip]
00048         s2=s1.split()
00049         ndata=len(s2)
00050         nip=nip+1
00051         \textcolor{keywordflow}{if} int(s2[0]) > maxz:
00052             maxz=int(s2[0])
00053     \textcolor{keywordflow}{if} verbose:
00054         print((\textcolor{stringliteral}{' maxz = %5i'}%(maxz)))
00055     nip=nip-1
00056     ip=np.zeros((maxz, maxz), \textcolor{stringliteral}{'Float64'})
00057     \textcolor{keywordflow}{for} aline \textcolor{keywordflow}{in} data[0:nip]:
00058         s2=aline.split()
00059         iz=int(s2[0])
00060         ion=int(s2[1])
00061         ip[iz-1, ion-1]=float(s2[2])
00062     \textcolor{keywordflow}{return} ip*const.invCm2Ev
00063     \textcolor{comment}{#}
00064     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a47e1912c817338c305e475dff092f44f}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!itoh\-Read@{itoh\-Read}}
\index{itoh\-Read@{itoh\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{itoh\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-itoh\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a47e1912c817338c305e475dff092f44f}
\begin{DoxyVerb}to read in the free-free gaunt factors of Itoh et al. (ApJS 128, 125, 2000)\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01414}{1414} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01414}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47e1912c817338c305e475dff092f44f}{01414} 
01415 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a47e1912c817338c305e475dff092f44f}{itohRead}():
01416     \textcolor{stringliteral}{'''to read in the free-free gaunt factors of Itoh et al. (ApJS 128, 125, 2000)'''}
01417     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01418     itohName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'itoh.dat'})
01419     input = open(itohName)
01420     lines = input.readlines()
01421     input.close()
01422     gff = np.zeros((30, 121), \textcolor{stringliteral}{'float64'})
01423     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(30):
01424         gff[iline]= np.asarray(lines[iline].split(), \textcolor{stringliteral}{'float64'})
01425     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'itohCoef'}:gff\}
01426     \textcolor{comment}{#}
01427     \textcolor{comment}{#}
01428     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a41cea295a441ff73fb246119479e373c}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!klgfb\-Read@{klgfb\-Read}}
\index{klgfb\-Read@{klgfb\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{klgfb\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-klgfb\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a41cea295a441ff73fb246119479e373c}
\begin{DoxyVerb}to read CHIANTI files file containing the free-bound gaunt factors for n=1-6 from Karzas and Latter, 1961, ApJSS, 6, 167
returns {pe, klgfb}, the photon energy and the free-bound gaunt factors\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01429}{1429} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01429}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a41cea295a441ff73fb246119479e373c}{01429} 
01430 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a41cea295a441ff73fb246119479e373c}{klgfbRead}():
01431     \textcolor{stringliteral}{'''to read CHIANTI files file containing the free-bound gaunt factors for n=1-6 from Karzas and Latter,
       1961, ApJSS, 6, 167}
01432 \textcolor{stringliteral}{    returns \{pe, klgfb\}, the photon energy and the free-bound gaunt factors'''}
01433     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01434     fname = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'klgfb.dat'})
01435     input = open(fname)
01436     lines = input.readlines()
01437     input.close()
01438     \textcolor{comment}{#}
01439     ngfb = int(lines[0].split()[0])
01440     nume = int(lines[0].split()[1])
01441 
01442     gfb = np.zeros((ngfb, ngfb, nume), \textcolor{stringliteral}{'float64'})
01443     nlines = len(lines)
01444 \textcolor{comment}{#        print 'nlines, nume, ngfb = ', nlines,  nume, ngfb}
01445     pe = np.asarray(lines[1].split(), \textcolor{stringliteral}{'float64'})
01446     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(2, nlines):
01447         data = lines[iline].split()
01448         n = int(data[0])
01449         l = int(data[1])
01450         gfb[n-1, l] = np.array(data[2:], \textcolor{stringliteral}{'float64'})
01451     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'pe'}:pe, \textcolor{stringliteral}{'klgfb'}:gfb\}
01452 \textcolor{comment}{#}
01453 \textcolor{comment}{#  ---------------------------------------------------------}
\textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ace360314d9344971bd2ee9ea4f17992d}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!list\-Files@{list\-Files}}
\index{list\-Files@{list\-Files}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{list\-Files}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-list\-Files (
\begin{DoxyParamCaption}
\item[{}]{path}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ace360314d9344971bd2ee9ea4f17992d}
\begin{DoxyVerb}walks the path and subdirectories to return a list of files
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01454}{1454} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01454}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ace360314d9344971bd2ee9ea4f17992d}{01454} 
01455 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ace360314d9344971bd2ee9ea4f17992d}{listFiles}(path):
01456     \textcolor{stringliteral}{'''}
01457 \textcolor{stringliteral}{    walks the path and subdirectories to return a list of files}
01458 \textcolor{stringliteral}{    '''}
01459     alist=os.walk(path)
01460     print(\textcolor{stringliteral}{' getting file list'})
01461     listname=[]
01462     \textcolor{keywordflow}{for} (dirpath,dirnames,filenames) \textcolor{keywordflow}{in} alist:
01463         \textcolor{keywordflow}{if} len(dirnames) == 0:
01464             \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} filenames:
01465                 file=os.path.join(dirpath,f)
01466                 \textcolor{keywordflow}{if} os.path.isfile(file):
01467                     listname.append(file)
01468         \textcolor{keywordflow}{else}:
01469             \textcolor{keywordflow}{for} f \textcolor{keywordflow}{in} filenames:
01470                 file=os.path.join(dirpath,f)
01471                 \textcolor{keywordflow}{if} os.path.isfile(file):
01472                     listname.append(file)
01473     \textcolor{keywordflow}{return} listname
01474     \textcolor{comment}{#}
01475     \textcolor{comment}{# ----------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!master\-List\-Info@{master\-List\-Info}}
\index{master\-List\-Info@{master\-List\-Info}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{master\-List\-Info}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Info (
\begin{DoxyParamCaption}
\item[{}]{force = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}
\begin{DoxyVerb}returns information about ions in masterlist
the reason for this file is to speed up multi-ion spectral calculations
the information is stored in a pickled file 'masterlist_ions.pkl'
if the file is not found, one will be created and the following information
returned for each ion
wmin, wmax :  the minimum and maximum wavelengths in the wgfa file
tmin, tmax :  the minimum and maximum temperatures for which the ionization balance is nonzero\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00065}{65} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-convert\-Name()}, \hyperlink{__chianti__tools_8py_source_l00368}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-defaults\-Read()}, \hyperlink{__chianti__tools_8py_source_l01336}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ioneq\-Read()}, \hyperlink{__chianti__tools_8py_source_l00169}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Read()}, \hyperlink{__chianti__tools_8py_source_l00572}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-wgfa\-Read()}, and \hyperlink{__chianti__tools_8py_source_l00292}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-zion2name()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00065}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{00065} 
00066 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a5677fc0d50bd22a853c14b4b2606b89e}{masterListInfo}(force=0):
00067     \textcolor{stringliteral}{""" returns information about ions in masterlist}
00068 \textcolor{stringliteral}{    the reason for this file is to speed up multi-ion spectral calculations}
00069 \textcolor{stringliteral}{    the information is stored in a pickled file 'masterlist\_ions.pkl'}
00070 \textcolor{stringliteral}{    if the file is not found, one will be created and the following information}
00071 \textcolor{stringliteral}{    returned for each ion}
00072 \textcolor{stringliteral}{    wmin, wmax :  the minimum and maximum wavelengths in the wgfa file}
00073 \textcolor{stringliteral}{    tmin, tmax :  the minimum and maximum temperatures for which the ionization balance is nonzero"""}
00074     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00075     infoPath = os.path.join(dir, \textcolor{stringliteral}{'masterlist'})
00076     infoName=os.path.join(dir,\textcolor{stringliteral}{'masterlist'},\textcolor{stringliteral}{'masterlist\_ions.pkl'})
00077     masterName=os.path.join(dir,\textcolor{stringliteral}{'masterlist'},\textcolor{stringliteral}{'masterlist.ions'})
00078     \textcolor{comment}{#}
00079     makeNew = force == 1 \textcolor{keywordflow}{or} \textcolor{keywordflow}{not} os.path.isfile(infoName)
00080 \textcolor{comment}{#    if os.path.isfile(infoName):}
00081     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} makeNew:
00082 \textcolor{comment}{#       print ' file exists - ',  infoName}
00083         pfile = open(infoName, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00084 \textcolor{stringliteral}{        masterListInfo = pickle.load(pfile)}
00085 \textcolor{stringliteral}{        pfile.close}
00086 \textcolor{stringliteral}{    }\textcolor{keywordflow}{elif} os.access(infoPath, os.W\_OK):
00087         \textcolor{comment}{# the file does not exist but we have write access and will create it}
00088         defaults = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a235ada2c4e384f436dbade0913107585}{defaultsRead}()
00089         print((\textcolor{stringliteral}{' defaults = %s'}%(str(defaults))))
00090         ioneqName = defaults[\textcolor{stringliteral}{'ioneqfile'}]
00091         ioneq = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8b6257cfe133ac906966b20c8721f82a}{ioneqRead}(ioneqname = ioneqName)
00092         masterList = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab11f940d11d2b1118ffb581a39d7e42a}{masterListRead}()
00093         masterListInfo = \{\}
00094         haveZ = [0]*31
00095         haveStage = np.zeros((31, 31), \textcolor{stringliteral}{'Int32'})
00096         haveDielectronic = np.zeros((31, 31), \textcolor{stringliteral}{'Int32'})
00097         \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} masterList:
00098             ionInfo = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convertName}(one)
00099             z = ionInfo[\textcolor{stringliteral}{'Z'}]
00100             stage = ionInfo[\textcolor{stringliteral}{'Ion'}]
00101             haveZ[z] = 1
00102             dielectronic = ionInfo[\textcolor{stringliteral}{'Dielectronic'}]
00103             \textcolor{keywordflow}{if} dielectronic:
00104                 haveDielectronic[z, stage] = 1
00105             \textcolor{keywordflow}{else}:
00106                 haveStage[z, stage] = 1
00107             thisIoneq = ioneq[\textcolor{stringliteral}{'ioneqAll'}][z- 1, stage - 1 + dielectronic]
00108             good = thisIoneq > 0.
00109             goodTemp = ioneq[\textcolor{stringliteral}{'ioneqTemperature'}][good]
00110             tmin = goodTemp.min()
00111             tmax = goodTemp.max()
00112             vgood = thisIoneq == thisIoneq.max()
00113             vgoodTemp = ioneq[\textcolor{stringliteral}{'ioneqTemperature'}][vgood][0]
00114             wgfa = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{wgfaRead}(one)
00115             nZeros = wgfa[\textcolor{stringliteral}{'wvl'}].count(0.)
00116             \textcolor{comment}{# two-photon transitions are denoted by a wavelength of zero (0.)}
00117             \textcolor{keywordflow}{while} nZeros > 0:
00118                 wgfa[\textcolor{stringliteral}{'wvl'}].remove(0.)
00119                 nZeros = wgfa[\textcolor{stringliteral}{'wvl'}].count(0.)
00120             \textcolor{comment}{# unobserved lines are denoted with a negative wavelength}
00121             wvl = np.abs(np.asarray(wgfa[\textcolor{stringliteral}{'wvl'}], \textcolor{stringliteral}{'float64'}))
00122             wmin = wvl.min()
00123             wmax = wvl.max()
00124             masterListInfo[one] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:tmin, \textcolor{stringliteral}{'tmax'}:tmax, \textcolor{stringliteral}{'tIoneqMax'}:
      vgoodTemp\}
00125         masterListInfo[\textcolor{stringliteral}{'haveZ'}] = haveZ
00126         masterListInfo[\textcolor{stringliteral}{'haveStage'}] = haveStage
00127         masterListInfo[\textcolor{stringliteral}{'haveDielectronic'}] = haveDielectronic
00128         \textcolor{comment}{#  now do the bare ions from H thru Zn}
00129         \textcolor{comment}{#  these are only involved in the continuum}
00130         \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(1, 31):
00131             ions = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}(iz, iz+1)
00132             thisIoneq = ioneq[\textcolor{stringliteral}{'ioneqAll'}][iz-1, iz]
00133             good = thisIoneq > 0.
00134             goodTemp = ioneq[\textcolor{stringliteral}{'ioneqTemperature'}][good]
00135             tmin = goodTemp.min()
00136             tmax = goodTemp.max()
00137             wmin=0.
00138             wmax = 1.e+30
00139             masterListInfo[ions] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:tmin, \textcolor{stringliteral}{'tmax'}:tmax\}
00140         pfile = open(infoName, \textcolor{stringliteral}{'w'})
00141         pickle.dump(masterListInfo, pfile)
00142         pfile.close
00143     \textcolor{keywordflow}{else}:
00144         \textcolor{comment}{# the file does not exist and we do NOT have write access to creat it}
00145         \textcolor{comment}{# will just make an inefficient, useless version}
00146         masterListInfo = \{\}
00147         \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} masterList:
00148             ionInfo = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convertName}(one)
00149             z = ionInfo[\textcolor{stringliteral}{'Z'}]
00150             stage = ionInfo[\textcolor{stringliteral}{'Ion'}]
00151             dielectronic = ionInfo[\textcolor{stringliteral}{'Dielectronic'}]
00152             wmin=0.
00153             wmax = 1.e+30
00154             masterListInfo[one] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:1.e+4, \textcolor{stringliteral}{'tmax'}:1.e+9\}
00155         \textcolor{comment}{#  now do the bare ions from H thru Zn}
00156         \textcolor{comment}{#  these are only involved in the continuum}
00157         \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(1, 31):
00158             ions = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}(iz, iz+1)
00159             wmin=0.
00160             wmax = 1.e+30
00161             masterListInfo[ions] = \{\textcolor{stringliteral}{'wmin'}:wmin, \textcolor{stringliteral}{'wmax'}:wmax, \textcolor{stringliteral}{'tmin'}:1.e+4, \textcolor{stringliteral}{'tmax'}:1.e+9\}
00162         pfile = open(infoName, \textcolor{stringliteral}{'w'})
00163         pickle.dump(masterListInfo, pfile)
00164         pfile.close
00165         masterListInfo = \{\textcolor{stringliteral}{'noInfo'}:\textcolor{stringliteral}{'none'}\}
00166     \textcolor{keywordflow}{return} masterListInfo
00167     \textcolor{comment}{#}
00168     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ab11f940d11d2b1118ffb581a39d7e42a}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!master\-List\-Read@{master\-List\-Read}}
\index{master\-List\-Read@{master\-List\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{master\-List\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ab11f940d11d2b1118ffb581a39d7e42a}
\begin{DoxyVerb}read a chianti masterlist file and return a list of files\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00169}{169} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00169}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab11f940d11d2b1118ffb581a39d7e42a}{00169} 
00170 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ab11f940d11d2b1118ffb581a39d7e42a}{masterListRead}():
00171     \textcolor{stringliteral}{""" read a chianti masterlist file and return a list of files"""}
00172     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00173     fname=os.path.join(dir,\textcolor{stringliteral}{'masterlist'},\textcolor{stringliteral}{'masterlist.ions'})
00174     input=open(fname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00175 \textcolor{stringliteral}{    s1=input.readlines()}
00176 \textcolor{stringliteral}{    dum=input.close()}
00177 \textcolor{stringliteral}{    masterlist=[]}
00178 \textcolor{stringliteral}{    }\textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,len(s1)):
00179         s1a=s1[i][:-1]
00180         s2=s1a.split(\textcolor{stringliteral}{';'})
00181         masterlist.append(s2[0].strip())
00182     \textcolor{keywordflow}{return} masterlist
00183     \textcolor{comment}{#}
00184     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a25b33696ac2b1d2f01e5789a70a234ec}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!photox\-Read@{photox\-Read}}
\index{photox\-Read@{photox\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{photox\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-photox\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a25b33696ac2b1d2f01e5789a70a234ec}
\begin{DoxyVerb}read chianti photoionization .photox files and return
    {"energy", "cross"} where energy is in Rydbergs and the
    cross section is in cm^2  \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00185}{185} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00353}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-convert\-Name()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00185}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25b33696ac2b1d2f01e5789a70a234ec}{00185} 
00186 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a25b33696ac2b1d2f01e5789a70a234ec}{photoxRead}(ions):
00187     \textcolor{stringliteral}{"""read chianti photoionization .photox files and return}
00188 \textcolor{stringliteral}{        \{"energy", "cross"\} where energy is in Rydbergs and the}
00189 \textcolor{stringliteral}{        cross section is in cm^2  """}
00190     \textcolor{comment}{#}
00191     zion=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8038874902563556b0a8b536f52d3194}{convertName}(ions)
00192     \textcolor{keywordflow}{if} zion[\textcolor{stringliteral}{'Z'}] < zion[\textcolor{stringliteral}{'Ion'}]:
00193         print((\textcolor{stringliteral}{' this is a bare nucleus that has no ionization rate'}))
00194         \textcolor{keywordflow}{return}
00195     \textcolor{comment}{#}
00196     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
00197     paramname=fname+\textcolor{stringliteral}{'.photox'}
00198     input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00199 \textcolor{stringliteral}{    lines = input.readlines()}
00200 \textcolor{stringliteral}{    input.close}
00201 \textcolor{stringliteral}{    }\textcolor{comment}{# get number of energies}
00202 \textcolor{comment}{#    neng = int(lines[0][0:6])}
00203     dataEnd = 0
00204     lvl1 = []
00205     lvl2 = []
00206     energy = []
00207     cross = []
00208     icounter = 0
00209     \textcolor{keywordflow}{while} \textcolor{keywordflow}{not} dataEnd:
00210         lvl11 = int(lines[icounter][:8])
00211         lvl21 = int(lines[icounter][8:15])
00212         ener = lines[icounter][15:].split()
00213         energy1 = np.asarray(ener, \textcolor{stringliteral}{'float64'})
00214         \textcolor{comment}{#}
00215         icounter += 1
00216         irsl = int(lines[icounter][:8])
00217         ind0 = int(lines[icounter][8:15])
00218         \textcolor{keywordflow}{if} irsl != lvl11 \textcolor{keywordflow}{or} ind0 != lvl21:
00219             \textcolor{comment}{# this only happens if the file was written incorrectly}
00220             print((\textcolor{stringliteral}{' lvl1, lvl2 = %7i %7i'}%(lvl11, lvl21)))
00221             print((\textcolor{stringliteral}{' irsl, indo = %7i %7i'}%(irsl,  ind0)))
00222             \textcolor{keywordflow}{return}
00223         crs = lines[icounter][15:].split()
00224         cross1 = np.asarray(crs, \textcolor{stringliteral}{'float64'})
00225         lvl1.append(lvl11)
00226         lvl2.append(lvl21)
00227         energy.append(energy1)
00228         cross.append(cross1)
00229         icounter += 1
00230         dataEnd = lines[icounter].count(\textcolor{stringliteral}{'-1'})
00231     ref = lines[icounter+1:-1]
00232     cross = np.asarray(cross, \textcolor{stringliteral}{'float64'})
00233     energy = np.asarray(energy, \textcolor{stringliteral}{'float64'})
00234     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'lvl1'}:lvl1, \textcolor{stringliteral}{'lvl2'}:lvl2,\textcolor{stringliteral}{'energy'}:energy, \textcolor{stringliteral}{'cross'}:cross,  \textcolor{stringliteral}{'ref'}:ref\}
00235     \textcolor{comment}{#}
00236     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a119759ed9bedb5fc1dd533b8a86e588c}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!qrp@{qrp}}
\index{qrp@{qrp}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{qrp}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-qrp (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{u}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a119759ed9bedb5fc1dd533b8a86e588c}
\begin{DoxyVerb}qrp(Z,u)  u = E/IP
calculate Qr-prime (equ. 2.12) of Fontes, Sampson and Zhang 1999\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00420}{420} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00420}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a119759ed9bedb5fc1dd533b8a86e588c}{00420} 
00421 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a119759ed9bedb5fc1dd533b8a86e588c}{qrp}(z,u):
00422     \textcolor{stringliteral}{''' qrp(Z,u)  u = E/IP}
00423 \textcolor{stringliteral}{    calculate Qr-prime (equ. 2.12) of Fontes, Sampson and Zhang 1999'''}
00424     \textcolor{comment}{#}
00425     aa=1.13  \textcolor{comment}{# aa stands for A in equ 2.12}
00426     \textcolor{comment}{#}
00427     \textcolor{keywordflow}{if} z >= 16 :
00428         \textcolor{comment}{# use Fontes Z=20, N=1 parameters}
00429         dd=3.70590
00430         c=-0.28394
00431         d=1.95270
00432         cc=0.20594
00433     \textcolor{keywordflow}{else}:
00434     \textcolor{comment}{# use Fontes Z=10, N=2 parameters}
00435         dd=3.82652
00436         c=-0.80414
00437         d=2.32431
00438         cc=0.14424
00439     \textcolor{comment}{#}
00440     \textcolor{keywordflow}{if} z > 20:
00441         cc+=((z-20.)/50.5)**1.11
00442     \textcolor{comment}{#}
00443     bu=u <= 1.
00444     q=np.ma.array(u, \textcolor{stringliteral}{'Float64'}, mask=bu, fill\_value=0.)
00445     \textcolor{comment}{#}
00446     \textcolor{comment}{#}
00447     q=(aa*np.ma.log(u) + dd*(1.-1./u)**2 + cc*u*(1.-1./u)**4 + (c/u+d/u**2)*(1.-1/u))/u
00448     \textcolor{comment}{#}
00449     q.set\_fill\_value(0.)  \textcolor{comment}{# I don't know why this is necessary}
00450     \textcolor{keywordflow}{return} q  \textcolor{comment}{#  .set\_fill\_value(0.)}
00451     \textcolor{comment}{#}
00452     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aaa4f9748029dedf2b12af0c6d8f765c7}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!rr\-Read@{rr\-Read}}
\index{rr\-Read@{rr\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{rr\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-rr\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aaa4f9748029dedf2b12af0c6d8f765c7}
\begin{DoxyVerb}read chianti radiative recombination .rrparams files and return
    {'rrtype','params','ref'}\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01261}{1261} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01261}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aaa4f9748029dedf2b12af0c6d8f765c7}{01261} 
01262 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aaa4f9748029dedf2b12af0c6d8f765c7}{rrRead}(ions):
01263     \textcolor{stringliteral}{"""read chianti radiative recombination .rrparams files and return}
01264 \textcolor{stringliteral}{        \{'rrtype','params','ref'\}"""}
01265     \textcolor{comment}{#}
01266     \textcolor{comment}{#}
01267     fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
01268     paramname=fname+\textcolor{stringliteral}{'.rrparams'}
01269     \textcolor{keywordflow}{if} os.path.isfile(paramname):
01270         input=open(paramname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01271 \textcolor{stringliteral}{        }\textcolor{comment}{#  need to read first line and see how many elements}
01272         lines=input.readlines()
01273         input.close()
01274         rrtype=int(lines[0])
01275         ref=lines[3:-2]
01276         \textcolor{comment}{#}
01277         \textcolor{keywordflow}{if} rrtype == 1:
01278             \textcolor{comment}{# a Badnell type}
01279             fmt=FortranFormat(\textcolor{stringliteral}{'3i5,e12.4,f10.5,2e12.4'})
01280             params=FortranLine(lines[1],fmt)
01281             RrParams=\{\textcolor{stringliteral}{'rrtype'}:rrtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01282         \textcolor{keywordflow}{elif} rrtype == 2:
01283             \textcolor{comment}{# a Badnell type}
01284             fmt=FortranFormat(\textcolor{stringliteral}{'3i5,e12.4,f10.5,2e11.4,f10.5,e12.4'})
01285             params=FortranLine(lines[1],fmt)
01286             RrParams=\{\textcolor{stringliteral}{'rrtype'}:rrtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01287         \textcolor{keywordflow}{elif} rrtype == 3:
01288             \textcolor{comment}{# a Shull type}
01289             fmt=FortranFormat(\textcolor{stringliteral}{'2i5,2e12.4'})
01290             params=FortranLine(lines[1],fmt)
01291             RrParams=\{\textcolor{stringliteral}{'rrtype'}:rrtype, \textcolor{stringliteral}{'params'}:params, \textcolor{stringliteral}{'ref'}:ref\}
01292         \textcolor{keywordflow}{else}:
01293             RrParams=\textcolor{keywordtype}{None}
01294             print((\textcolor{stringliteral}{' for ion %5s unknown RR type = %5i'} %(ions, rrtype)))
01295         \textcolor{keywordflow}{return} RrParams
01296     \textcolor{keywordflow}{else}:
01297         \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'rrtype'}:-1\}
01298 
01299     \textcolor{comment}{#}
01300     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a6f52caaa5d922e5e747839ccea0dcdd3}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!scale\-\_\-bt@{scale\-\_\-bt}}
\index{scale\-\_\-bt@{scale\-\_\-bt}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{scale\-\_\-bt}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-scale\-\_\-bt (
\begin{DoxyParamCaption}
\item[{}]{evin, }
\item[{}]{omega, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a6f52caaa5d922e5e747839ccea0dcdd3}
\begin{DoxyVerb}apply BT excitation scaling to (energy, collision strength)
returns [bte,btomega]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01710}{1710} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01710}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6f52caaa5d922e5e747839ccea0dcdd3}{01710} 
01711 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6f52caaa5d922e5e747839ccea0dcdd3}{scale\_bt}(evin,omega,f,ev1):
01712     \textcolor{stringliteral}{"""}
01713 \textcolor{stringliteral}{    apply BT excitation scaling to (energy, collision strength)}
01714 \textcolor{stringliteral}{    returns [bte,btomega]}
01715 \textcolor{stringliteral}{    """}
01716     u=evin/ev1
01717     bte=1.-np.log(f)/np.log(u-1.+f)
01718     btomega=omega/(np.log(u)-1.+np.exp(1.))
01719     \textcolor{keywordflow}{return} [bte,btomega]
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aa0b66957b05220d53caa594b577edd3b}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!scale\-\_\-bti@{scale\-\_\-bti}}
\index{scale\-\_\-bti@{scale\-\_\-bti}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{scale\-\_\-bti}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-scale\-\_\-bti (
\begin{DoxyParamCaption}
\item[{}]{evin, }
\item[{}]{crossin, }
\item[{}]{f, }
\item[{}]{ev1}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aa0b66957b05220d53caa594b577edd3b}
\begin{DoxyVerb}apply BT ionization scaling to (energy, cross-section)
returns [bte,btx]
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01674}{1674} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01674}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa0b66957b05220d53caa594b577edd3b}{01674} 
01675 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa0b66957b05220d53caa594b577edd3b}{scale\_bti}(evin,crossin,f,ev1):
01676     \textcolor{stringliteral}{"""}
01677 \textcolor{stringliteral}{    apply BT ionization scaling to (energy, cross-section)}
01678 \textcolor{stringliteral}{    returns [bte,btx]}
01679 \textcolor{stringliteral}{    """}
01680     u=evin/ev1
01681     bte=1.-np.log(f)/np.log(u-1.+f)
01682     btx=u*crossin*(ev1**2)/(np.log(u)+1.)
01683     \textcolor{keywordflow}{return} [bte,btx]
01684     \textcolor{comment}{#}
01685     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a2cd45e7b512b31d25e92f3adf69b1914}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!splom\-Descale@{splom\-Descale}}
\index{splom\-Descale@{splom\-Descale}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{splom\-Descale}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-splom\-Descale (
\begin{DoxyParamCaption}
\item[{}]{splom, }
\item[{}]{energy}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a2cd45e7b512b31d25e92f3adf69b1914}
\begin{DoxyVerb}Calculates the collision strength
for excitation-autoionization as a function of energy.
energy in eV
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00760}{760} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l01154}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ea\-Cross()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00760}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a2cd45e7b512b31d25e92f3adf69b1914}{00760} 
00761 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a2cd45e7b512b31d25e92f3adf69b1914}{splomDescale}(splom, energy):
00762     \textcolor{stringliteral}{"""}
00763 \textcolor{stringliteral}{    Calculates the collision strength}
00764 \textcolor{stringliteral}{    for excitation-autoionization as a function of energy.}
00765 \textcolor{stringliteral}{    energy in eV}
00766 \textcolor{stringliteral}{    """}
00767     \textcolor{comment}{#}
00768     \textcolor{comment}{#}
00769     nenergy=energy.size
00770     nsplom=len(splom[\textcolor{stringliteral}{'deryd'}])
00771     \textcolor{comment}{# for these files, there are 5 spline points}
00772     nspl = 5
00773     \textcolor{keywordflow}{if} nenergy > 1:
00774         omega = np.zeros((nsplom,nenergy),\textcolor{stringliteral}{"float64"})
00775     \textcolor{keywordflow}{else}:
00776         omega = np.zeros(nsplom,\textcolor{stringliteral}{"float64"})
00777     \textcolor{comment}{#}
00778     dx = 1./(float(nspl)-1.)
00779     sxint = dx*np.arange(nspl)
00780     \textcolor{keywordflow}{for} isplom \textcolor{keywordflow}{in} range(0,nsplom):
00781         \textcolor{comment}{#}
00782         sx1 = energy/(splom[\textcolor{stringliteral}{'deryd'}][isplom]*const.ryd2Ev)
00783         good = sx1 >= 1.
00784         \textcolor{comment}{# make sure there are some valid energies above the threshold}
00785         \textcolor{keywordflow}{if} good.sum():
00786             nbad = nenergy - good.sum()
00787             c\_curr = splom[\textcolor{stringliteral}{'c'}][isplom]
00788             \textcolor{comment}{#}
00789             \textcolor{keywordflow}{if} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 1:
00790                 sx = 1. - np.log(c\_curr)/np.log(sx1[good] - 1. + c\_curr)
00791                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00792                 som = interpolate.splev(sx,y2,der=0)
00793                 omega[isplom, nbad:] = som*np.log(sx -1. + np.exp(1.))
00794             \textcolor{comment}{#}
00795             \textcolor{keywordflow}{elif} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 2:
00796                 sx =(sx1[good] - 1.)/(sx1[good] -1. + c\_curr)
00797                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00798                 som=interpolate.splev(sx,y2,der=0)
00799                 omega[isplom, nbad:] = som
00800             \textcolor{comment}{#}
00801             \textcolor{keywordflow}{elif} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 3:
00802                 sx = (sx1[good] - 1.)/(sx1[good] -1. + c\_curr)
00803                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00804                 som = interpolate.splev(sx,y2,der=0)
00805                 omega[isplom, nbad:] = som/sx1[good]**2
00806             \textcolor{comment}{#}
00807             \textcolor{keywordflow}{elif} splom[\textcolor{stringliteral}{'ttype'}][isplom] == 4:
00808                 sx = 1. - np.log(c\_curr)/np.log(sx1[good] -1. + c\_curr)
00809                 y2 = interpolate.splrep(sxint,splom[\textcolor{stringliteral}{'splom'}][:, isplom],s=0)  \textcolor{comment}{#allow smoothing,s=0)}
00810                 som=interpolate.splev(sx,y2,der=0)
00811                 omega[isplom, nbad:] = som*np.log(sx1[good] -1. + c\_curr)
00812             \textcolor{comment}{#}
00813             \textcolor{comment}{#}
00814             \textcolor{comment}{#}
00815             \textcolor{keywordflow}{elif} ttype > 4:
00816                 print((\textcolor{stringliteral}{' splom t\_type ne 1,2,3,4 = %4i %4i %4i'}%(ttype,l1,l2)))
00817         \textcolor{keywordflow}{else}:
00818             \textcolor{comment}{# there are no energies above the threshold}
00819             \textcolor{keywordflow}{pass}
00820     \textcolor{comment}{#}
00821     \textcolor{comment}{#}
00822     omega=np.where(omega > 0.,omega,0.)
00823     \textcolor{comment}{#}
00824     \textcolor{keywordflow}{return} omega
00825     \textcolor{comment}{#}
00826     \textcolor{comment}{# --------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!splom\-Read@{splom\-Read}}
\index{splom\-Read@{splom\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{splom\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-splom\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{ea = {\ttfamily 0}, }
\item[{}]{filename = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}
\begin{DoxyVerb}read chianti .splom files and return
{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"deryd":de,"c":c,"splom":splomout,"ref":hdr} not tested
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00827}{827} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00827}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{00827} 
00828 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8013cd9bdbf2f8ec5a5ac06e25b0e3a4}{splomRead}(ions, ea=0, filename=None):
00829     \textcolor{stringliteral}{"""}
00830 \textcolor{stringliteral}{    read chianti .splom files and return}
00831 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"deryd":de,"c":c,"splom":splomout,"ref":hdr\} not tested}
00832 \textcolor{stringliteral}{    """}
00833     \textcolor{comment}{#}
00834     \textcolor{keywordflow}{if} type(filename) == NoneType:
00835         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
00836         \textcolor{keywordflow}{if} ea:
00837             splomname=fname+\textcolor{stringliteral}{'.easplom'}
00838         \textcolor{keywordflow}{else}:
00839             splomname=fname+\textcolor{stringliteral}{'.splom'}
00840     \textcolor{keywordflow}{else}:
00841         splomname = filename
00842     input=open(splomname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00843 \textcolor{stringliteral}{    }\textcolor{comment}{#  need to read first line and see how many elements}
00844     line1=input.readline()
00845     indices=line1[0:15]
00846     remainder=line1[16:]
00847     nom=remainder.split(\textcolor{stringliteral}{' '})
00848     format=FortranFormat(\textcolor{stringliteral}{'5i3,'}+str(len(nom))+\textcolor{stringliteral}{'E10.2'})
00849     \textcolor{comment}{#  go back to the beginning}
00850     input.seek(0)
00851     lines=input.readlines()
00852     data=5
00853     iline=0
00854     lvl1=[]
00855     lvl2=[]
00856     ttype=[]
00857     gf=[]
00858     de=[]
00859     f=[]
00860     splom=[]
00861     ntrans=0
00862     \textcolor{keywordflow}{while} data > 1:
00863         splomdat=FortranLine(lines[iline],format)
00864         l1=splomdat[2]
00865         l2=splomdat[3]
00866         tt1=splomdat[4]
00867         gf1=splomdat[5]
00868         de1=splomdat[6]
00869         f1=splomdat[7]
00870         splom1=splomdat[8:]
00871         lvl1.append(int(l1))
00872         lvl2.append(int(l2))
00873         ttype.append(int(tt1))
00874         gf.append(float(gf1))
00875         de.append(float(de1))
00876         f.append(float(f1))
00877         splom.append(splom1)
00878         iline=iline+1
00879         data=len(lines[iline].split(\textcolor{stringliteral}{' '},2))
00880     hdr=lines[iline+1:-1]
00881     de=np.asarray(de,\textcolor{stringliteral}{'Float64'})
00882     splomout=np.asarray(splom,\textcolor{stringliteral}{'Float64'})
00883     splomout=np.transpose(splomout)
00884     input.close()
00885     \textcolor{comment}{# note:  de is in Rydbergs}
00886     splom=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"deryd"}:de,\textcolor{stringliteral}{"c"}:f
00887         ,\textcolor{stringliteral}{"splom"}:splomout,\textcolor{stringliteral}{"ref"}:hdr\}
00888     \textcolor{keywordflow}{return}  splom
00889     \textcolor{comment}{#}
00890     \textcolor{comment}{# --------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!splups\-Read@{splups\-Read}}
\index{splups\-Read@{splups\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{splups\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-splups\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}, }
\item[{}]{prot = {\ttfamily 0}, }
\item[{}]{ci = {\ttfamily 0}, }
\item[{}]{diel = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}
\begin{DoxyVerb}read a chianti splups file and return
{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref}
if prot >0, then reads the psplups file
if ci > 0, then reads cisplups file
if diel > 0, then reads dielsplups file
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00891}{891} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00891}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{00891} 
00892 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6e5e0d51ad5dd162d51353c6d2e49d3b}{splupsRead}(ions, filename=0, prot=0, ci=0,  diel=0):
00893     \textcolor{stringliteral}{"""}
00894 \textcolor{stringliteral}{    read a chianti splups file and return}
00895 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups,"bsplups":bsplups,"ref":ref\}}
00896 \textcolor{stringliteral}{    if prot >0, then reads the psplups file}
00897 \textcolor{stringliteral}{    if ci > 0, then reads cisplups file}
00898 \textcolor{stringliteral}{    if diel > 0, then reads dielsplups file}
00899 \textcolor{stringliteral}{    """}
00900     \textcolor{comment}{#}
00901     \textcolor{keywordflow}{if} filename:
00902         splupsname = filename
00903     \textcolor{keywordflow}{else}:
00904         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
00905         \textcolor{keywordflow}{if} prot:
00906             splupsname=fname+\textcolor{stringliteral}{'.psplups'}
00907         \textcolor{keywordflow}{elif} ci:
00908             splupsname=fname+\textcolor{stringliteral}{'.cisplups'}
00909         \textcolor{keywordflow}{elif} diel:
00910             splupsname=fname+\textcolor{stringliteral}{'.dielsplups'}
00911         \textcolor{keywordflow}{else}:
00912             splupsname=fname+\textcolor{stringliteral}{'.splups'}
00913     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(splupsname):
00914         \textcolor{keywordflow}{if} prot:
00915             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00916         \textcolor{keywordflow}{elif} ci:
00917             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00918         \textcolor{keywordflow}{else}:
00919             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00920     \textcolor{comment}{# there is splups/psplups data}
00921     \textcolor{keywordflow}{else}:
00922         input=open(splupsname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00923 \textcolor{stringliteral}{        s1=input.readlines()}
00924 \textcolor{stringliteral}{        input.close()}
00925 \textcolor{stringliteral}{        nsplups=0}
00926 \textcolor{stringliteral}{        ndata=2}
00927 \textcolor{stringliteral}{        }\textcolor{keywordflow}{while} ndata > 1:
00928             s1a=s1[nsplups][:]
00929             s2=s1a.split()
00930             ndata=len(s2)
00931             nsplups=nsplups+1
00932         nsplups=nsplups-1
00933         lvl1=[0]*nsplups
00934         lvl2=[0]*nsplups
00935         ttype=[0]*nsplups
00936         gf = np.zeros(nsplups, \textcolor{stringliteral}{'float64'})
00937         de= np.zeros(nsplups, \textcolor{stringliteral}{'float64'})
00938         cups= np.zeros(nsplups, \textcolor{stringliteral}{'float64'})
00939         nspl=[0]*nsplups
00940 \textcolor{comment}{#        splups=np.zeros((nsplups,9),'Float64')}
00941         splups = [0.]*nsplups
00942         \textcolor{keywordflow}{if} prot:
00943 \textcolor{comment}{#            splupsFormat1 = FortranFormat('3i3,8e10.3')}
00944             splupsFormat2 = FortranFormat(\textcolor{stringliteral}{'3i3,3e10.3'})
00945         \textcolor{keywordflow}{else}:
00946 \textcolor{comment}{#            splupsFormat1='(6x,3i3,8e10.3)'}
00947             splupsFormat2 = FortranFormat(\textcolor{stringliteral}{'6x,3i3,3e10.3'})
00948         \textcolor{comment}{#}
00949         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(0,nsplups):
00950             inpt=FortranLine(s1[i],splupsFormat2)
00951             lvl1[i]=inpt[0]
00952             lvl2[i]=inpt[1]
00953             ttype[i]=inpt[2]
00954             gf[i]=inpt[3]
00955             de[i]=inpt[4]
00956             cups[i]=inpt[5]
00957             \textcolor{keywordflow}{if} prot:
00958                 as1 = s1[i][39:].rstrip()
00959             \textcolor{keywordflow}{else}:
00960                 as1 = s1[i][45:].rstrip()
00961             nspl[i] = len(as1)/10
00962             splupsFormat3 = FortranFormat(str(nspl[i])+\textcolor{stringliteral}{'E10.2'})
00963 \textcolor{comment}{#            splupsFormat3 = '(' + str(nspl[i]) + 'e10.3' + ')'}
00964             inpt = FortranLine(as1, splupsFormat3)
00965             spl1 = np.asarray(inpt[:], \textcolor{stringliteral}{'float64'})
00966             splups[i] = spl1
00967         \textcolor{comment}{#}
00968         ref=[]
00969         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nsplups+1,len(s1)-1):
00970             s1a=s1[i][:-1]
00971             ref.append(s1a.strip())
00972         \textcolor{keywordflow}{if} prot:
00973 \textcolor{comment}{#            self.Npsplups=nsplups}
00974 \textcolor{comment}{#            self.Psplups=\{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups}
00975 \textcolor{comment}{#                ,"nspl":nspl,"splups":splups,"ref":ref\}}
00976             \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"de"}:de,\textcolor{stringliteral}{"cups"}:cups
00977                 ,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"splups"}:splups,\textcolor{stringliteral}{"ref"}:ref, \textcolor{stringliteral}{'filename'}:splupsname\}
00978         \textcolor{keywordflow}{else}:
00979 \textcolor{comment}{#            self.Splups=\{"lvl1":lvl1,"lvl2":lvl2,"ttype":ttype,"gf":gf,"de":de,"cups":cups}
00980 \textcolor{comment}{#                ,"nspl":nspl,"splups":splups,"ref":ref\}}
00981             \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"ttype"}:ttype,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"de"}:de,\textcolor{stringliteral}{"cups"}:cups
00982                 ,\textcolor{stringliteral}{"nspl"}:nspl,\textcolor{stringliteral}{"splups"}:splups,\textcolor{stringliteral}{"ref"}:ref, \textcolor{stringliteral}{'filename'}:splupsname\}
00983     \textcolor{comment}{#}
00984     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a6bc4a22671cc24bfae42d3e24078708a}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!twophoton\-He\-Read@{twophoton\-He\-Read}}
\index{twophoton\-He\-Read@{twophoton\-He\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{twophoton\-He\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-twophoton\-He\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a6bc4a22671cc24bfae42d3e24078708a}
\begin{DoxyVerb}to read the two-photon A values and distribution function for the He seq\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01600}{1600} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01600}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6bc4a22671cc24bfae42d3e24078708a}{01600} 
01601 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a6bc4a22671cc24bfae42d3e24078708a}{twophotonHeRead}():
01602     \textcolor{stringliteral}{''' to read the two-photon A values and distribution function for the He seq'''}
01603     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01604     fName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'heseq\_2photon.dat'})
01605     dFile = open(fName, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01606 \textcolor{stringliteral}{    a = dFile.readline()}
01607 \textcolor{stringliteral}{    y0 = np.asarray(a.split())}
01608 \textcolor{stringliteral}{    nz = 30}
01609 \textcolor{stringliteral}{    avalue = np.zeros(nz, }\textcolor{stringliteral}{'float64'})
01610     psi0 = np.zeros((nz, 41), \textcolor{stringliteral}{'float64'})
01611     \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(1, nz):
01612         a=dFile.readline().split()
01613         avalue[iz] = float(a[1])
01614         psi = np.asarray(a[2:])
01615         psi0[iz] = psi
01616     dFile.close()
01617     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'y0'}:y0, \textcolor{stringliteral}{'avalue'}:avalue, \textcolor{stringliteral}{'psi0'}:psi0.reshape(30, 41)\}
01618     \textcolor{comment}{#}
01619     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a276c30e2ab1692a674ecc1a0e46b0694}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!twophoton\-H\-Read@{twophoton\-H\-Read}}
\index{twophoton\-H\-Read@{twophoton\-H\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{twophoton\-H\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-twophoton\-H\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a276c30e2ab1692a674ecc1a0e46b0694}
\begin{DoxyVerb}to read the two-photon A values and distribution function for the H seq\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01576}{1576} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01576}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a276c30e2ab1692a674ecc1a0e46b0694}{01576} 
01577 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a276c30e2ab1692a674ecc1a0e46b0694}{twophotonHRead}():
01578     \textcolor{stringliteral}{''' to read the two-photon A values and distribution function for the H seq'''}
01579     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01580     fName = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'hseq\_2photon.dat'})
01581     dFile = open(fName, \textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
01582 \textcolor{stringliteral}{    a = dFile.readline()}
01583 \textcolor{stringliteral}{    y0 = np.asarray(a.split())}
01584 \textcolor{stringliteral}{    a = dFile.readline()}
01585 \textcolor{stringliteral}{    z0 = np.asarray(a.split())}
01586 \textcolor{stringliteral}{    nz = 30}
01587 \textcolor{stringliteral}{    avalue = np.zeros(nz, }\textcolor{stringliteral}{'float64'})
01588     asum = np.zeros(nz, \textcolor{stringliteral}{'float64'})
01589     psi0 = np.zeros((nz, 17), \textcolor{stringliteral}{'float64'})
01590     \textcolor{keywordflow}{for} iz \textcolor{keywordflow}{in} range(nz):
01591         a=dFile.readline().split()
01592         avalue[iz] = float(a[1])
01593         asum[iz] = float(a[2])
01594         psi = np.asarray(a[3:])
01595         psi0[iz] = psi
01596     dFile.close()
01597     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'y0'}:y0, \textcolor{stringliteral}{'z0'}:z0, \textcolor{stringliteral}{'avalue'}:avalue, \textcolor{stringliteral}{'asum'}:asum, \textcolor{stringliteral}{'psi0'}:psi0.reshape(30, 17)\}
01598     \textcolor{comment}{#}
01599     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_ae590342dcbbea1f4552a401016c54480}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!upsdat\-Read@{upsdat\-Read}}
\index{upsdat\-Read@{upsdat\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{upsdat\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-upsdat\-Read (
\begin{DoxyParamCaption}
\item[{}]{upsdat\-File\-Name}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_ae590342dcbbea1f4552a401016c54480}
\begin{DoxyVerb}to read the standard Chianti upsdat file
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01620}{1620} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01620}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae590342dcbbea1f4552a401016c54480}{01620} 
01621 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ae590342dcbbea1f4552a401016c54480}{upsdatRead}(upsdatFileName):
01622     \textcolor{stringliteral}{'''}
01623 \textcolor{stringliteral}{    to read the standard Chianti upsdat file}
01624 \textcolor{stringliteral}{    '''}
01625     inpt = open(upsdatFileName)
01626     lines = inpt.readlines()
01627     inpt.close()
01628     nTemp = int(lines[0].strip(\textcolor{stringliteral}{'\(\backslash\)n'}))
01629     minusOne = 0
01630     counter = 1
01631     ll = lines[1].split()
01632     temp = np.asarray(ll[3:], \textcolor{stringliteral}{'float64'})
01633     \textcolor{keywordflow}{while} \textcolor{keywordflow}{not} minusOne:
01634         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'-1'} \textcolor{keywordflow}{in} lines[counter][:4]:
01635             minusOne = 1
01636         \textcolor{keywordflow}{else}:
01637             counter += 1
01638     ntrans = (counter)/2
01639     lvl1 = []
01640     lvl2 = []
01641     de = []
01642     gf = []
01643     upsilon = []
01644     counter = 1
01645     \textcolor{keywordflow}{for} itrans \textcolor{keywordflow}{in} range(ntrans):
01646         ll1 = lines[counter].split()
01647         lvl1.append(int(ll1[0]))
01648         lvl2.append(int(ll1[1]))
01649         de.append(float(ll1[2]))
01650         ll2 = lines[counter+1].split()
01651 \textcolor{comment}{#        print ' ll2 = ', ll2}
01652 \textcolor{comment}{#        print ' gf = ', ll2[2]}
01653         gf.append(float(ll2[2]))
01654         upsilon.append(np.asarray(ll2[3:], \textcolor{stringliteral}{'float64'}))
01655         counter += 2
01656     counter += 1
01657     ref = []
01658     \textcolor{keywordflow}{for} aline \textcolor{keywordflow}{in} lines[counter:-1]:
01659         ref.append(aline.strip(\textcolor{stringliteral}{'\(\backslash\)n'}))
01660     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'lvl1'}:lvl1, \textcolor{stringliteral}{'lvl2'}:lvl2, \textcolor{stringliteral}{'de'}:de, \textcolor{stringliteral}{'gf'}:gf, \textcolor{stringliteral}{'upsilon'}:upsilon, \textcolor{stringliteral}{'temperature'}:temp, \textcolor{stringliteral}{'ref'}:ref\}
01661     \textcolor{comment}{#}
01662     \textcolor{comment}{# -----------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a4777bd65c87b9fbd20a5b02185d9437c}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!verner\-Read@{verner\-Read}}
\index{verner\-Read@{verner\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{verner\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-verner\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a4777bd65c87b9fbd20a5b02185d9437c}
\begin{DoxyVerb}Reads the Verner & Yakovlev (A&AS 109, 125, 1995) photoionization cross-section data\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01532}{1532} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01532}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4777bd65c87b9fbd20a5b02185d9437c}{01532} 
01533 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4777bd65c87b9fbd20a5b02185d9437c}{vernerRead}():
01534     \textcolor{stringliteral}{'''Reads the Verner & Yakovlev (A&AS 109, 125, 1995) photoionization cross-section data'''}
01535     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01536     fname = os.path.join(xuvtop, \textcolor{stringliteral}{'continuum'}, \textcolor{stringliteral}{'verner\_short.txt'})
01537     input = open(fname)
01538     lines = input.readlines()
01539     input.close()
01540     \textcolor{comment}{#}
01541     nlines=465
01542     maxZ = 30+1
01543     maxNel = 30 +1\textcolor{comment}{# also equal max(stage)}
01544     \textcolor{comment}{#}
01545     \textcolor{comment}{#z = np.array(nlines,'int32')}
01546     \textcolor{comment}{#nel = np.array(nlines,'int32')}
01547     pqn = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'int32'})
01548     l = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'int32'})
01549     eth = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01550     e0 = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01551     sig0 = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01552     ya = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01553     p = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01554     yw = np.zeros((maxZ,maxNel),\textcolor{stringliteral}{'float64'})
01555     \textcolor{comment}{#}
01556     fstring=\textcolor{stringliteral}{'i2,i3,i2,i2,6f11.3'}
01557     vernerFormat=FortranFormat(fstring)
01558     \textcolor{comment}{#}
01559     \textcolor{keywordflow}{for} iline \textcolor{keywordflow}{in} range(nlines):
01560         out=FortranLine(lines[iline],vernerFormat)
01561         z = out[0]
01562         nel = out[1]
01563         stage = z - nel + 1
01564         pqn[z,stage] = out[2]
01565         l[z,stage] = out[3]
01566         eth[z,stage] = out[4]
01567         e0[z,stage] = out[5]
01568         sig0[z,stage] = out[6]
01569         ya[z,stage] = out[7]
01570         p[z,stage] = out[8]
01571         yw[z,stage] = out[9]
01572     \textcolor{comment}{#}
01573     \textcolor{keywordflow}{return} \{\textcolor{stringliteral}{'pqn'}:pqn, \textcolor{stringliteral}{'l'}:l, \textcolor{stringliteral}{'eth'}:eth, \textcolor{stringliteral}{'e0'}:e0, \textcolor{stringliteral}{'sig0'}:sig0, \textcolor{stringliteral}{'ya'}:ya, \textcolor{stringliteral}{'p'}:p, \textcolor{stringliteral}{'yw'}:yw\}
01574     \textcolor{comment}{#}
01575     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a8e52f3bde54d7fba55664fe4f9efceda}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!version\-Read@{version\-Read}}
\index{version\-Read@{version\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{version\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-version\-Read (
\begin{DoxyParamCaption}
{}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a8e52f3bde54d7fba55664fe4f9efceda}
\begin{DoxyVerb}read the version number of the CHIANTI database\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l01663}{1663} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l01663}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8e52f3bde54d7fba55664fe4f9efceda}{01663} 
01664 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a8e52f3bde54d7fba55664fe4f9efceda}{versionRead}():
01665     \textcolor{stringliteral}{""" read the version number of the CHIANTI database"""}
01666     xuvtop = os.environ[\textcolor{stringliteral}{'XUVTOP'}]
01667     vFileName = os.path.join(xuvtop, \textcolor{stringliteral}{'VERSION'})
01668     vFile = open(vFileName)
01669     versionStr = vFile.readline()
01670     vFile.close()
01671     \textcolor{keywordflow}{return} versionStr.strip()
01672     \textcolor{comment}{#}
01673     \textcolor{comment}{#-----------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!wgfa\-Read@{wgfa\-Read}}
\index{wgfa\-Read@{wgfa\-Read}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{wgfa\-Read}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-wgfa\-Read (
\begin{DoxyParamCaption}
\item[{}]{ions, }
\item[{}]{filename = {\ttfamily 0}, }
\item[{}]{elvlcname = {\ttfamily 0}, }
\item[{}]{total = {\ttfamily 0}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}
\begin{DoxyVerb}reads chianti wgfa file and returns
{"lvl1":lvl1,"lvl2":lvl2,"wvl":wvl,"gf":gf,"avalue":avalue,"ref":ref}
if elvlcname is specified, the lsj term labels are returned as 'pretty1' and 'pretty2'
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00572}{572} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



References \hyperlink{__chianti__tools_8py_source_l00453}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-elvlc\-Read()}, and \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00572}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{00572} 
00573 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a3ef36a1d0a4df4cab94a392d2a3da980}{wgfaRead}(ions, filename=0, elvlcname=0, total=0):
00574     \textcolor{stringliteral}{"""}
00575 \textcolor{stringliteral}{    reads chianti wgfa file and returns}
00576 \textcolor{stringliteral}{    \{"lvl1":lvl1,"lvl2":lvl2,"wvl":wvl,"gf":gf,"avalue":avalue,"ref":ref\}}
00577 \textcolor{stringliteral}{    if elvlcname is specified, the lsj term labels are returned as 'pretty1' and 'pretty2'}
00578 \textcolor{stringliteral}{    """}
00579     \textcolor{comment}{#}
00580     \textcolor{keywordflow}{if} filename:
00581         wgfaname = filename
00582         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} filename:
00583             elvlcname = os.path.splitext(wgfaname)[0] + \textcolor{stringliteral}{'.elvlc'}
00584     \textcolor{keywordflow}{else}:
00585         fname=\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7748521ca99103785680d691667ce851}{ion2filename}(ions)
00586         wgfaname=fname+\textcolor{stringliteral}{'.wgfa'}
00587         elvlcname = fname + \textcolor{stringliteral}{'.elvlc'}
00588     \textcolor{comment}{#}
00589     \textcolor{keywordflow}{if} os.path.isfile(elvlcname):
00590         elvlc = \hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_ac848d0b5ea14bf4adf6e8cd5d46fb639}{elvlcRead}(\textcolor{stringliteral}{''}, elvlcname)
00591     \textcolor{keywordflow}{else}:
00592         elvlc = 0
00593     input=open(wgfaname,\textcolor{stringliteral}{'}\textcolor{stringliteral}{r')}
00594 \textcolor{stringliteral}{    s1=input.readlines()}
00595 \textcolor{stringliteral}{    dum=input.close()}
00596 \textcolor{stringliteral}{    nwvl=0}
00597 \textcolor{stringliteral}{    ndata=2}
00598 \textcolor{stringliteral}{    }\textcolor{keywordflow}{while} ndata > 1:
00599         s1a=s1[nwvl][:-1]
00600         s2=s1a.split()
00601         ndata=len(s2)
00602         nwvl=nwvl+1
00603     nwvl=nwvl-1
00604     lvl1=[0]*nwvl
00605     lvl2=[0]*nwvl
00606     wvl=[0.]*nwvl
00607     gf=[0.]*nwvl
00608     avalue=[0.]*nwvl
00609     \textcolor{keywordflow}{if} elvlcname:
00610         pretty1 = [\textcolor{stringliteral}{''}]*nwvl
00611         pretty2 = [\textcolor{stringliteral}{''}]*nwvl
00612     \textcolor{comment}{#}
00613     wgfaFormat=\textcolor{stringliteral}{'(2i5,f15.3,2e15.3)'}
00614     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nwvl):
00615         inpt=FortranLine(s1[i],wgfaFormat)
00616         lvl1[i]=inpt[0]
00617         lvl2[i]=inpt[1]
00618         wvl[i]=inpt[2]
00619         gf[i]=inpt[3]
00620         avalue[i]=inpt[4]
00621         \textcolor{keywordflow}{if} elvlcname:
00622             pretty1[i] = elvlc[\textcolor{stringliteral}{'pretty'}][inpt[0] - 1]
00623             pretty2[i] = elvlc[\textcolor{stringliteral}{'pretty'}][inpt[1] - 1]
00624 
00625     ref=[]
00626     \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(nwvl+1,len(s1)-1):
00627         s1a=s1[i][:-1]
00628         ref.append(s1a.strip())
00629     Wgfa=\{\textcolor{stringliteral}{"lvl1"}:lvl1,\textcolor{stringliteral}{"lvl2"}:lvl2,\textcolor{stringliteral}{"wvl"}:wvl,\textcolor{stringliteral}{"gf"}:gf,\textcolor{stringliteral}{"avalue"}:avalue,\textcolor{stringliteral}{"ref"}:ref, \textcolor{stringliteral}{'ionS'}:ions, \textcolor{stringliteral}{'filename'}:
      wgfaname\}
00630     \textcolor{keywordflow}{if} total:
00631         avalueLvl = [0.]*max(lvl2)
00632         \textcolor{keywordflow}{for} iwvl \textcolor{keywordflow}{in} range(nwvl):
00633             avalueLvl[lvl2[iwvl] -1] += avalue[iwvl]
00634         Wgfa[\textcolor{stringliteral}{'avalueLvl'}] = avalueLvl
00635 
00636     \textcolor{keywordflow}{if} elvlcname:
00637         Wgfa[\textcolor{stringliteral}{'pretty1'}] = pretty1
00638         Wgfa[\textcolor{stringliteral}{'pretty2'}] = pretty2
00639     \textcolor{keywordflow}{return} Wgfa
00640     \textcolor{comment}{#}
00641     \textcolor{comment}{# --------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!wgfa\-Write@{wgfa\-Write}}
\index{wgfa\-Write@{wgfa\-Write}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{wgfa\-Write}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-wgfa\-Write (
\begin{DoxyParamCaption}
\item[{}]{info, }
\item[{}]{outfile = {\ttfamily 0}, }
\item[{}]{min\-Branch = {\ttfamily 0.}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}
\begin{DoxyVerb}to write a wgfa file
info is a dictionary the contains the following elements
ionS, the Chianti style name of the ion such as c_4 for C IV
lvl1 - the lower level, the ground level is 1
lvl2 - the upper level
wvl - the wavelength in Angstroms
gf - the weighted oscillator strength
avalue - the A value
pretty1 - descriptive text of the lower level (optional)
pretty2 - descriptive text of the upper level (optiona)
ref - reference text, a list of strings
minBranch:  the transition must have a branching ratio greater than the specified to be written to the file
\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00642}{642} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00642}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{00642} 
00643 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a300c13ee6815450bc20d25a2c6dcb8a8}{wgfaWrite}(info, outfile = 0, minBranch = 0.):
00644     \textcolor{stringliteral}{'''}
00645 \textcolor{stringliteral}{    to write a wgfa file}
00646 \textcolor{stringliteral}{    info is a dictionary the contains the following elements}
00647 \textcolor{stringliteral}{    ionS, the Chianti style name of the ion such as c\_4 for C IV}
00648 \textcolor{stringliteral}{    lvl1 - the lower level, the ground level is 1}
00649 \textcolor{stringliteral}{    lvl2 - the upper level}
00650 \textcolor{stringliteral}{    wvl - the wavelength in Angstroms}
00651 \textcolor{stringliteral}{    gf - the weighted oscillator strength}
00652 \textcolor{stringliteral}{    avalue - the A value}
00653 \textcolor{stringliteral}{    pretty1 - descriptive text of the lower level (optional)}
00654 \textcolor{stringliteral}{    pretty2 - descriptive text of the upper level (optiona)}
00655 \textcolor{stringliteral}{    ref - reference text, a list of strings}
00656 \textcolor{stringliteral}{    minBranch:  the transition must have a branching ratio greater than the specified to be written to the
       file}
00657 \textcolor{stringliteral}{    '''}
00658     \textcolor{comment}{#}
00659 \textcolor{comment}{#    gname = info['ionS']}
00660     \textcolor{keywordflow}{if} outfile:
00661         wgfaname = outfile
00662     \textcolor{keywordflow}{else}:
00663         wgfaname = gname + \textcolor{stringliteral}{'.wgfa'}
00664     print((\textcolor{stringliteral}{' wgfa file name = '}, wgfaname))
00665     \textcolor{keywordflow}{if} minBranch > 0.:
00666         info[\textcolor{stringliteral}{'ref'}].append(\textcolor{stringliteral}{' minimum branching ratio = %10.2e'}%(minBranch))
00667     out = open(wgfaname, \textcolor{stringliteral}{'w'})
00668     ntrans = len(info[\textcolor{stringliteral}{'lvl1'}])
00669     nlvl = max(info[\textcolor{stringliteral}{'lvl2'}])
00670     totalAvalue = np.zeros(nlvl, \textcolor{stringliteral}{'float64'})
00671     \textcolor{keywordflow}{if} \textcolor{stringliteral}{'pretty1'} \textcolor{keywordflow}{in} info:
00672         pformat = \textcolor{stringliteral}{'%5i%5i%15.4f%15.3e%15.3e%30s - %30s'}
00673     \textcolor{keywordflow}{else}:
00674         pformat = \textcolor{stringliteral}{'%5i%5i%15.4f%15.3e%15.3e'}
00675     \textcolor{keywordflow}{for} itrans, avalue \textcolor{keywordflow}{in} enumerate(info[\textcolor{stringliteral}{'avalue'}]):
00676         \textcolor{comment}{# for autoionization transitions, lvl1 can be less than zero}
00677         \textcolor{keywordflow}{if} abs(info[\textcolor{stringliteral}{'lvl1'}][itrans]) > 0 \textcolor{keywordflow}{and} info[\textcolor{stringliteral}{'lvl2'}][itrans] > 0:
00678             totalAvalue[info[\textcolor{stringliteral}{'lvl2'}][itrans] -1] += avalue
00679 
00680     \textcolor{keywordflow}{for} itrans, avalue \textcolor{keywordflow}{in} enumerate(info[\textcolor{stringliteral}{'avalue'}]):
00681         \textcolor{keywordflow}{if} avalue > 0.:
00682             branch = avalue/totalAvalue[info[\textcolor{stringliteral}{'lvl2'}][itrans] -1]
00683         \textcolor{keywordflow}{else}:
00684             branch = 0.
00685         \textcolor{keywordflow}{if} branch > minBranch \textcolor{keywordflow}{and} abs(info[\textcolor{stringliteral}{'lvl1'}][itrans]) > 0 \textcolor{keywordflow}{and} info[\textcolor{stringliteral}{'lvl2'}][itrans] > 0:
00686             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'pretty1'} \textcolor{keywordflow}{in} info:
00687                 \textcolor{comment}{# generally only useful with NIST data}
00688                 \textcolor{keywordflow}{if} \textcolor{stringliteral}{'transType'} \textcolor{keywordflow}{in} info:
00689                     \textcolor{keywordflow}{if} info[\textcolor{stringliteral}{'transType'}][itrans] != \textcolor{stringliteral}{''}:
00690                         lbl2 = info[\textcolor{stringliteral}{'pretty2'}]+\textcolor{stringliteral}{'  '} + info[\textcolor{stringliteral}{'transType'}][itrans]
00691                 \textcolor{keywordflow}{else}:
00692                     lbl2= info[\textcolor{stringliteral}{'pretty2'}][itrans]
00693                 pstring= pformat%(info[\textcolor{stringliteral}{'lvl1'}][itrans], info[\textcolor{stringliteral}{'lvl2'}][itrans], info[\textcolor{stringliteral}{'wvl'}][itrans], info[\textcolor{stringliteral}{'gf
      '}][itrans], avalue, info[\textcolor{stringliteral}{'pretty1'}][itrans].rjust(30), lbl2.ljust(30))
00694                 out.write(pstring+\textcolor{stringliteral}{'\(\backslash\)n'})
00695             \textcolor{keywordflow}{else}:
00696                 pstring= pformat%(info[\textcolor{stringliteral}{'lvl1'}][itrans], info[\textcolor{stringliteral}{'lvl2'}][itrans], info[\textcolor{stringliteral}{'wvl'}][itrans], info[\textcolor{stringliteral}{'gf
      '}][itrans], avalue)
00697                 out.write(pstring+\textcolor{stringliteral}{'\(\backslash\)n'})
00698     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00699     out.write(\textcolor{stringliteral}{'%filename:  '} + wgfaname + \textcolor{stringliteral}{'\(\backslash\)n'})
00700     \textcolor{keywordflow}{for} one \textcolor{keywordflow}{in} info[\textcolor{stringliteral}{'ref'}]:
00701         out.write(one+\textcolor{stringliteral}{'\(\backslash\)n'})
00702     out.write(\textcolor{stringliteral}{' -1\(\backslash\)n'})
00703     out.close()
00704     \textcolor{comment}{#}
00705     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a384f39b118999003fd2d0c54974a0aff}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!z2element@{z2element}}
\index{z2element@{z2element}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{z2element}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-z2element (
\begin{DoxyParamCaption}
\item[{}]{z}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a384f39b118999003fd2d0c54974a0aff}
\begin{DoxyVerb}convert Z to element string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00282}{282} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00396}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-ion2filename()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00282}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a384f39b118999003fd2d0c54974a0aff}{00282} 
00283 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a384f39b118999003fd2d0c54974a0aff}{z2element}(z):
00284     \textcolor{stringliteral}{""" convert Z to element string """}
00285     \textcolor{keywordflow}{if} z-1 < len(const.El):
00286         thisel=const.El[z-1]
00287     \textcolor{keywordflow}{else}:
00288         thisel=\textcolor{stringliteral}{''}
00289     \textcolor{keywordflow}{return} thisel
00290     \textcolor{comment}{#}
00291     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!zion2filename@{zion2filename}}
\index{zion2filename@{zion2filename}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{zion2filename}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-zion2filename (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}
\begin{DoxyVerb}convert Z to generic file name string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00304}{304} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00304}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{00304} 
00305 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a46370e972711f8737755fa9c8fb57ed8}{zion2filename}(z,ion, dielectronic=False):
00306     \textcolor{stringliteral}{""" convert Z to generic file name string """}
00307     dir=os.environ[\textcolor{stringliteral}{"XUVTOP"}]
00308     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00309         thisel=const.El[z-1]
00310     \textcolor{keywordflow}{else}:
00311         thisel=\textcolor{stringliteral}{''}
00312     \textcolor{keywordflow}{if} z-1 < len(const.El):
00313         thisone=const.El[z-1]+\textcolor{stringliteral}{'\_'}+str(ion)
00314         \textcolor{keywordflow}{if} dielectronic:
00315             thisone+=\textcolor{stringliteral}{'d'}
00316     \textcolor{keywordflow}{else}:
00317         thisone=\textcolor{stringliteral}{''}
00318     \textcolor{keywordflow}{if} thisel != \textcolor{stringliteral}{''} :
00319         fname=os.path.join(dir,thisel,thisone,thisone)
00320     \textcolor{keywordflow}{return} fname
00321     \textcolor{comment}{#}
00322     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!zion2local\-Filename@{zion2local\-Filename}}
\index{zion2local\-Filename@{zion2local\-Filename}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{zion2local\-Filename}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-zion2local\-Filename (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}
\begin{DoxyVerb}convert Z to generic file name string with current directory at top\end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00323}{323} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00323}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{00323} 
00324 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_aa1c272dcccda8670d22cf866cd0e9b5f}{zion2localFilename}(z,ion, dielectronic=False):
00325     \textcolor{stringliteral}{""" convert Z to generic file name string with current directory at top"""}
00326     dir=\textcolor{stringliteral}{'.'}
00327     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00328         thisel=const.El[z-1]
00329     \textcolor{keywordflow}{else}:
00330         thisel=\textcolor{stringliteral}{''}
00331     \textcolor{keywordflow}{if} z-1 < len(const.El):
00332         thisone=const.El[z-1]+\textcolor{stringliteral}{'\_'}+str(ion)
00333         \textcolor{keywordflow}{if} dielectronic:
00334             thisone+=\textcolor{stringliteral}{'d'}
00335     \textcolor{keywordflow}{else}:
00336         thisone=\textcolor{stringliteral}{''}
00337     \textcolor{keywordflow}{if} thisel != \textcolor{stringliteral}{''} :
00338         fname=os.path.join(dir,thisel,thisone,thisone)
00339     \textcolor{keywordflow}{return} fname
00340     \textcolor{comment}{#}
00341     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!zion2name@{zion2name}}
\index{zion2name@{zion2name}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{zion2name}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-zion2name (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}
\begin{DoxyVerb}convert Z, ion to generic name  26, 13 -> fe_13 \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00292}{292} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.



Referenced by \hyperlink{__chianti__tools_8py_source_l00065}{pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-master\-List\-Info()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00292}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{00292} 
00293 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a7d6debb5f68b52f64c311ca1fe99945c}{zion2name}(z,ion, dielectronic=False):
00294     \textcolor{stringliteral}{""" convert Z, ion to generic name  26, 13 -> fe\_13 """}
00295     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00296         thisone=const.El[z-1]+\textcolor{stringliteral}{'\_'}+str(ion)
00297         \textcolor{keywordflow}{if} dielectronic:
00298             thisone+=\textcolor{stringliteral}{'d'}
00299     \textcolor{keywordflow}{else}:
00300         thisone=\textcolor{stringliteral}{''}
00301     \textcolor{keywordflow}{return} thisone
00302     \textcolor{comment}{#}
00303     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{\index{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}!zion2spectroscopic@{zion2spectroscopic}}
\index{zion2spectroscopic@{zion2spectroscopic}!pyneb::utils::_chianti_tools@{pyneb\-::utils\-::\-\_\-chianti\-\_\-tools}}
\subsubsection[{zion2spectroscopic}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-\_\-chianti\-\_\-tools.\-zion2spectroscopic (
\begin{DoxyParamCaption}
\item[{}]{z, }
\item[{}]{ion, }
\item[{}]{dielectronic = {\ttfamily False}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}
\begin{DoxyVerb}convert Z and ion to spectroscopic notation string \end{DoxyVerb}
 

Definition at line \hyperlink{__chianti__tools_8py_source_l00342}{342} of file \hyperlink{__chianti__tools_8py_source}{\-\_\-chianti\-\_\-tools.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1__chianti__tools_l00342}{}\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{00342} 
00343 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1__chianti__tools_a4c5a7ace6a222c4cfad8f00cf2b68554}{zion2spectroscopic}(z,ion, dielectronic=False):
00344     \textcolor{stringliteral}{""" convert Z and ion to spectroscopic notation string """}
00345     \textcolor{keywordflow}{if} (z-1 < len(const.El)) \textcolor{keywordflow}{and} (ion <= z+1):
00346         spect=const.El[z-1].capitalize()+\textcolor{stringliteral}{' '}+const.Ionstage[ion-1]
00347         \textcolor{keywordflow}{if} dielectronic:
00348             spect+=\textcolor{stringliteral}{' d'}
00349     \textcolor{keywordflow}{else}:  spect = \textcolor{stringliteral}{''}
00350     \textcolor{keywordflow}{return} spect
00351     \textcolor{comment}{#}
00352     \textcolor{comment}{# -------------------------------------------------------------------------------------}
    \textcolor{comment}{#}
\end{DoxyCode}
