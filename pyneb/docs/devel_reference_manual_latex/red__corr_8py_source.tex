\hypertarget{red__corr_8py}{\section{red\-\_\-corr.\-py}
\label{red__corr_8py}\index{pyneb/extinction/red\-\_\-corr.\-py@{pyneb/extinction/red\-\_\-corr.\-py}}
}

\begin{DoxyCode}
\hypertarget{red__corr_8py_source_l00001}{}\hyperlink{namespacepyneb_1_1extinction_1_1red__corr}{00001} \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np
00002 \textcolor{keyword}{import} pyneb \textcolor{keyword}{as} pn
00003 
00004 \textcolor{keywordflow}{if} pn.config.INSTALLED[\textcolor{stringliteral}{'plt'}]:
00005     \textcolor{keyword}{import} matplotlib.pyplot \textcolor{keyword}{as} plt
00006 \textcolor{keywordflow}{if} pn.config.INSTALLED[\textcolor{stringliteral}{'scipy'}]:
00007     \textcolor{keyword}{from} scipy \textcolor{keyword}{import} interpolate
00008 \textcolor{keyword}{from} \hyperlink{namespacepyneb_1_1utils_1_1misc}{pyneb.utils.misc} \textcolor{keyword}{import} execution\_path
00009 
\hypertarget{red__corr_8py_source_l00010}{}\hyperlink{namespacepyneb_1_1extinction_1_1red__corr_a5bee333b0bb8fb9ad4567e8b2de832ed}{00010} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1extinction_1_1red__corr_a5bee333b0bb8fb9ad4567e8b2de832ed}{my\_X2}(wave, params=[5000., 1., 2., 3.]):
00011     \textcolor{keywordflow}{return} params[1] * (wave / params[0]) + params[2] * (wave / params[0]) ** -1 + params[3] * (wave / 
      params[0]) ** -2
00012 
\hypertarget{red__corr_8py_source_l00013}{}\hyperlink{namespacepyneb_1_1extinction_1_1red__corr_ae587819f2a81c5dfbd7b7ce819c497ca}{00013} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1extinction_1_1red__corr_ae587819f2a81c5dfbd7b7ce819c497ca}{poly}(x, coeffs):
00014     res = 0
00015     \textcolor{keywordflow}{for} i, coeff \textcolor{keywordflow}{in} enumerate(coeffs):
00016         res += coeff * x ** i
00017     \textcolor{keywordflow}{return} res
00018 
\hypertarget{red__corr_8py_source_l00019}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr}{00019} \textcolor{keyword}{class }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr}{RedCorr}(object):
00020     \textcolor{stringliteral}{"""}
00021 \textcolor{stringliteral}{    Reddening correction}
00022 \textcolor{stringliteral}{    RC = RedCorr()}
00023 \textcolor{stringliteral}{    }
00024 \textcolor{stringliteral}{    """}
00025     \textcolor{comment}{##}
00026     \textcolor{comment}{# @todo Manage error in extinction}
00027     \textcolor{comment}{# @todo print extinction laws with references}
00028     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a27b836e3bd87558f6156a8bf94fbf658}{\_\_init\_\_}(self, E\_BV=0., R\_V=3.1, law='No correction', cHbeta=None,
\hypertarget{red__corr_8py_source_l00029}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a27b836e3bd87558f6156a8bf94fbf658}{00029}                  UserFunction=\textcolor{keywordtype}{None}):
00030         \textcolor{stringliteral}{"""}
00031 \textcolor{stringliteral}{        Reddening correction tool.}
00032 \textcolor{stringliteral}{}
00033 \textcolor{stringliteral}{        Usage:}
00034 \textcolor{stringliteral}{            RC = RedCorr(E\_BV = 1.)}
00035 \textcolor{stringliteral}{            RC.plot(laws = 'all')}
00036 \textcolor{stringliteral}{}
00037 \textcolor{stringliteral}{            def my\_X(wave, params = [5000., 1., 2., 3.]):}
00038 \textcolor{stringliteral}{                \(\backslash\)"""}
00039 \textcolor{stringliteral}{                Description of the user defined law}
00040 \textcolor{stringliteral}{                \(\backslash\)"""}
00041 \textcolor{stringliteral}{                return params[1] * (wave/params[0]) + params[2] * (wave/params[0])**-1 + params[3] *
       (wave/params[0])**-2}
00042 \textcolor{stringliteral}{}
00043 \textcolor{stringliteral}{            RC.UserFunction = my\_X}
00044 \textcolor{stringliteral}{            RC.UserParams = [6000., 0., 0., 1.]}
00045 \textcolor{stringliteral}{            RC.getCorr(5007)}
00046 \textcolor{stringliteral}{        }
00047 \textcolor{stringliteral}{        Parameters:}
00048 \textcolor{stringliteral}{            - E\_BV [float]: differential extinction between bands B and V}
00049 \textcolor{stringliteral}{            - R\_V = AV/E\_BV. Default value is 3.1}
00050 \textcolor{stringliteral}{            - law [str]: one of the defined laws (available with RedCorr.getLaws()) }
00051 \textcolor{stringliteral}{            - cHbeta: logarithmic extinction at Hbeta (prevalence on E\_BV)}
00052 \textcolor{stringliteral}{            - UserFunction X(wave, param): A user-defined function that accept 2 parameters: wavelength(s)
       in Angstrom }
00053 \textcolor{stringliteral}{            and an optional parameter and return X(lambda) = A(lambda)/E\_BV = R.A(lambda)/AV. }
00054 \textcolor{stringliteral}{            The correction is: 10**(0.4*E\_bv*X)}
00055 \textcolor{stringliteral}{            }
00056 \textcolor{stringliteral}{        """}
00057         
\hypertarget{red__corr_8py_source_l00058}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a712aff76d06f15896ed30e689103f66d}{00058}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a712aff76d06f15896ed30e689103f66d}{log\_} = pn.log\_ 
\hypertarget{red__corr_8py_source_l00059}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a30606dfd94b4cefefd10dbb1f7cbd473}{00059}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a30606dfd94b4cefefd10dbb1f7cbd473}{calling} = \textcolor{stringliteral}{'RedCorr'}
\hypertarget{red__corr_8py_source_l00060}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{00060}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict} = \{\} \textcolor{comment}{# dictionary pointing to a reddening function depending on the key}
00061         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'No correction'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad20df45ee0c6e9081245886135843e72}{\_zeros}
00062         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'CCM89'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0e1f547dbed4401b9c3d34658db9aaf7}{\_CCM89}
00063         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'CCM89 Bal07'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5422d3b4c568033cc97ada0b73670aa9}{\_CCM89\_Bal07}
00064         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'CCM89 oD94'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8d06942c28efecc3704d5e31c444ca1b}{\_CCM89\_oD94}
00065         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'S79 H83 CCM89'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5ca5f455ff115c36f4ea3367542cbafa}{\_S79\_H83\_CCM89}
00066         \textcolor{comment}{#self.\_laws\_dict['GCC 09'] = self.\_GCC09 }
00067         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'K76'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a9958bee692760f5d5037a5b195142c01}{\_K76}
00068         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'SM79 Gal'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a75a671c41944722df9d5fba814b83b3a}{\_SM79\_Gal}
00069         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'G03 LMC'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5e121988480c19aeb1fa5747b5d8d3a7}{\_G03\_LMC}
00070         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'MCC99 FM90 LMC'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_af97fbc015537102bbc163263b8582986}{\_MCC99\_FM90\_LMC}
00071         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'F99-like'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8eb0fe7f840c32a87adfcf7ddd98a095}{\_F99\_like}
00072         \textcolor{comment}{#self.\_laws\_dict['F99-like IDL'] = self.\_F99\_like\_IDL}
00073         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'F99'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8e249217925175868e6890e2e733c56a}{\_F99}
00074         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'F88 F99 LMC'}] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aae30a2150d566f04044db33a1612be8b}{\_FM88\_F99\_LMC}
00075 
00076         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a41b35235a0952185b3c7e34f6835511e}{UserFunction} = UserFunction
\hypertarget{red__corr_8py_source_l00077}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a7e1e251a6bd48ed36428c4654af46606}{00077}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a7e1e251a6bd48ed36428c4654af46606}{UserParams} = \textcolor{keywordtype}{None}
\hypertarget{red__corr_8py_source_l00078}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{00078}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams} = \textcolor{keywordtype}{None}
00079         
\hypertarget{red__corr_8py_source_l00080}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{00080}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} = \textcolor{keywordtype}{None}
00081         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law} = law
00082         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} = R\_V
00083         \textcolor{keywordflow}{if} cHbeta \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00084             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} = \textcolor{stringliteral}{'cHbeta'}
00085             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf16ae2a0bdb5dd620f9db382ffeebc9}{cHbeta} = cHbeta
00086         \textcolor{keywordflow}{else}:
00087             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} = \textcolor{stringliteral}{'E\_BV'}
00088             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV} = E\_BV
00089  
00090  
\hypertarget{red__corr_8py_source_l00091}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a1eb5bd704c5f5b7c2c94286b90d33dbb}{00091}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a1eb5bd704c5f5b7c2c94286b90d33dbb}{cHbetaFromEbv}(self, ebv):
00092         \textcolor{stringliteral}{"""}
00093 \textcolor{stringliteral}{        Return cHbeta from E(BV)}
00094 \textcolor{stringliteral}{        Usage: }
00095 \textcolor{stringliteral}{            (1-f\_lambda).cHbeta = 0.4.EBV.X\_lambda applied to lambda = 4861, with f\_beta = 0.:}
00096 \textcolor{stringliteral}{            cHbeta = 0.4 . EBV . X\_beta}
00097 \textcolor{stringliteral}{        }
00098 \textcolor{stringliteral}{        Parameter:}
00099 \textcolor{stringliteral}{            - ebv    E(B-V)}
00100 \textcolor{stringliteral}{            }
00101 \textcolor{stringliteral}{        """}
00102         Xbeta = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{X}(pn.CST.HBETA)
00103         \textcolor{keywordflow}{return} 0.4 * ebv * Xbeta
00104         \textcolor{comment}{#return np.asarray((-0.61 + (0.61 ** 2 + 4 * 0.024 * ebv) ** 0.5) / (2 * 0.024))}
00105     
00106  
\hypertarget{red__corr_8py_source_l00107}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab35df7348209fb79b956a3c8bb27e759}{00107}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab35df7348209fb79b956a3c8bb27e759}{EbvFromCHbeta}(self, cHbeta):
00108         \textcolor{stringliteral}{"""}
00109 \textcolor{stringliteral}{        Return E(B-V) from cHbeta}
00110 \textcolor{stringliteral}{        Using: }
00111 \textcolor{stringliteral}{            (1-f\_lambda).cHbeta = 0.4.EBV.X\_lambda applied to lambda = 4861, with f\_beta = 0.:}
00112 \textcolor{stringliteral}{            cHbeta = 0.4 . EBV . X\_beta}
00113 \textcolor{stringliteral}{        }
00114 \textcolor{stringliteral}{        Parameter:}
00115 \textcolor{stringliteral}{            - cHbeta}
00116 \textcolor{stringliteral}{            }
00117 \textcolor{stringliteral}{        """}
00118         Xbeta = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{X}(pn.CST.HBETA)
00119         \textcolor{keywordflow}{if} Xbeta != 0.:
00120             \textcolor{keywordflow}{return} cHbeta * 2.5 / Xbeta
00121         \textcolor{keywordflow}{else}:
00122             \textcolor{keywordflow}{return} np.zeros\_like(cHbeta)
00123         \textcolor{comment}{#return np.asarray(0.61 * cHbeta + 0.024 * cHbeta ** 2.)}
00124     
00125     
\hypertarget{red__corr_8py_source_l00126}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a84e13d28ffcddb1feeb32c0ab62ae29b}{00126}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a84e13d28ffcddb1feeb32c0ab62ae29b}{getLaws}(self):
00127         \textcolor{stringliteral}{"""}
00128 \textcolor{stringliteral}{        Return the dictionary keys for the extinction laws}
00129 \textcolor{stringliteral}{        }
00130 \textcolor{stringliteral}{        """}
00131         \textcolor{keywordflow}{return} self.\_laws\_dict.keys()
00132     
00133     
\hypertarget{red__corr_8py_source_l00134}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0f5ef5cac970e327841766c07f676c23}{00134}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0f5ef5cac970e327841766c07f676c23}{printLaws}(self):
00135         \textcolor{stringliteral}{"""}
00136 \textcolor{stringliteral}{        Print out the extinction laws}
00137 \textcolor{stringliteral}{        }
00138 \textcolor{stringliteral}{        """}
00139         \textcolor{keywordflow}{for} law \textcolor{keywordflow}{in} self.\_laws\_dict.keys():
00140             \textcolor{keywordflow}{try}:
00141                 doc = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[law].\_\_doc\_\_
00142             \textcolor{keywordflow}{except}:
00143                 doc = \textcolor{stringliteral}{''}
00144             print(\textcolor{stringliteral}{"'\{0\}': \{1\}"}.format(law, doc))
00145                          
\hypertarget{red__corr_8py_source_l00146}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ac33805bfaabab8f029f01b3dcdbffa4c}{00146}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ac33805bfaabab8f029f01b3dcdbffa4c}{\_get\_e\_bv}(self):
00147         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV}
\hypertarget{red__corr_8py_source_l00148}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a19b51d443c271dfbef23e853a2c0cacf}{00148}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a19b51d443c271dfbef23e853a2c0cacf}{\_get\_r\_v}(self):
00149         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a93f7e44201375bc6e05a20c092b6a1d6}{\_\_R\_V}
\hypertarget{red__corr_8py_source_l00150}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ae23e08c510a8de32425ec439023c00dc}{00150}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ae23e08c510a8de32425ec439023c00dc}{\_get\_law}(self):
00151         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a08b0e3499e1b8a289d7b2c7e805e6129}{\_\_law}
\hypertarget{red__corr_8py_source_l00152}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab4f5d5e32fb4be72e6cd703cd0dfb0df}{00152}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab4f5d5e32fb4be72e6cd703cd0dfb0df}{\_get\_cHbeta}(self):
00153         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab91dff40a007dd632c35d98042077f3d}{\_\_cHbeta}
\hypertarget{red__corr_8py_source_l00154}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a68f3c957fd80d17a976733494ec92c79}{00154}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a68f3c957fd80d17a976733494ec92c79}{\_get\_AV}(self):
00155         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a476840870719872a12ab48a0d1f1a839}{\_\_AV}
\hypertarget{red__corr_8py_source_l00156}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ae917e42eeee77f8070c8c9b8cc184a37}{00156}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ae917e42eeee77f8070c8c9b8cc184a37}{\_get\_uf}(self):
00157         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf6e0eb6732be82bc65b02c36a2429c2}{\_\_user\_function}
00158     
\hypertarget{red__corr_8py_source_l00159}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a435874b44a40876df8f828173171028c}{00159}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a435874b44a40876df8f828173171028c}{\_set\_e\_bv}(self, value):
\hypertarget{red__corr_8py_source_l00160}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{00160}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV} = np.asarray(value)
\hypertarget{red__corr_8py_source_l00161}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab91dff40a007dd632c35d98042077f3d}{00161}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab91dff40a007dd632c35d98042077f3d}{\_\_cHbeta} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a1eb5bd704c5f5b7c2c94286b90d33dbb}{cHbetaFromEbv}(self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV})
\hypertarget{red__corr_8py_source_l00162}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a476840870719872a12ab48a0d1f1a839}{00162}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a476840870719872a12ab48a0d1f1a839}{\_\_AV} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV} * self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V}
00163         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} = \textcolor{stringliteral}{'E\_BV'}
\hypertarget{red__corr_8py_source_l00164}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab6f42b2fb11938d407a960799784d5aa}{00164}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab6f42b2fb11938d407a960799784d5aa}{\_set\_cHbeta}(self, value):
00165         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab91dff40a007dd632c35d98042077f3d}{\_\_cHbeta} = np.asarray(value)
00166         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab35df7348209fb79b956a3c8bb27e759}{EbvFromCHbeta}(self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab91dff40a007dd632c35d98042077f3d}{\_\_cHbeta})
00167         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a476840870719872a12ab48a0d1f1a839}{\_\_AV} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV} * self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V}
00168         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} = \textcolor{stringliteral}{'cHbeta'}
\hypertarget{red__corr_8py_source_l00169}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a98a035be4770e0d690490821cd514a74}{00169}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a98a035be4770e0d690490821cd514a74}{\_set\_AV}(self, value):
00170         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a476840870719872a12ab48a0d1f1a839}{\_\_AV} = np.asarray(value)
00171         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a476840870719872a12ab48a0d1f1a839}{\_\_AV} / self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V}
00172         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ab91dff40a007dd632c35d98042077f3d}{\_\_cHbeta} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a1eb5bd704c5f5b7c2c94286b90d33dbb}{cHbetaFromEbv}(self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad223ec4556fb47fc607488c318e58b13}{\_\_E\_BV})
00173         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} = \textcolor{stringliteral}{'AV'}
\hypertarget{red__corr_8py_source_l00174}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a9802a083db9982d308b4a78388401b94}{00174}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a9802a083db9982d308b4a78388401b94}{\_set\_r\_v}(self, value):       
\hypertarget{red__corr_8py_source_l00175}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a93f7e44201375bc6e05a20c092b6a1d6}{00175}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a93f7e44201375bc6e05a20c092b6a1d6}{\_\_R\_V} = np.asarray(value)
\hypertarget{red__corr_8py_source_l00176}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aa205c5f56725816af787bdea7b8aa29c}{00176}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aa205c5f56725816af787bdea7b8aa29c}{\_set\_law}(self, value):
00177         \textcolor{keywordflow}{if} value \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.\_laws\_dict.keys():
00178             self.log\_.error(\textcolor{stringliteral}{'Unknown extinction law reference: \{0\}'}.format(value), calling=self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a30606dfd94b4cefefd10dbb1f7cbd473}{calling})
\hypertarget{red__corr_8py_source_l00179}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a08b0e3499e1b8a289d7b2c7e805e6129}{00179}             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a08b0e3499e1b8a289d7b2c7e805e6129}{\_\_law} = \textcolor{keywordtype}{None}
\hypertarget{red__corr_8py_source_l00180}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{00180}             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{X} = \textcolor{keywordtype}{None}
00181         \textcolor{keywordflow}{else}:
00182             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a08b0e3499e1b8a289d7b2c7e805e6129}{\_\_law} = value
00183             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{X} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law}]
00184             \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} == \textcolor{stringliteral}{'E\_BV'}:
00185                 self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV}
00186             \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} == \textcolor{stringliteral}{'cHbeta'}:  
00187                 self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf16ae2a0bdb5dd620f9db382ffeebc9}{cHbeta} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf16ae2a0bdb5dd620f9db382ffeebc9}{cHbeta}
00188             \textcolor{keywordflow}{elif} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a99ab4dcd33d50360f4fb61bc80fc90d5}{\_given} == \textcolor{stringliteral}{'AV'}:  
00189                 self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_acbf4ca9cf48abed38b1ffad057420c71}{AV} = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_acbf4ca9cf48abed38b1ffad057420c71}{AV}
\hypertarget{red__corr_8py_source_l00190}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aa2b2bda77fced31b3fb64de5731a3d61}{00190}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aa2b2bda77fced31b3fb64de5731a3d61}{\_set\_uf}(self, value):
\hypertarget{red__corr_8py_source_l00191}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf6e0eb6732be82bc65b02c36a2429c2}{00191}         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf6e0eb6732be82bc65b02c36a2429c2}{\_\_user\_function} = value
00192         \textcolor{keywordflow}{if} value \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00193             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'user'} \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}:
00194                 del self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'user'}]
00195         \textcolor{keywordflow}{else}:
00196             \textcolor{keyword}{def }\_uf2(wave):
00197                 \textcolor{comment}{#This transform the user function with 2 parameters in a function of one single parameter}
00198                 \textcolor{keywordflow}{return} np.asarray(self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf6e0eb6732be82bc65b02c36a2429c2}{\_\_user\_function}(wave, self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a7e1e251a6bd48ed36428c4654af46606}{UserParams}))
00199             \_uf2.\_\_doc\_\_ = self.\_\_user\_function.\_\_doc\_\_
00200             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[\textcolor{stringliteral}{'user'}] = \_uf2
00201         
00202     
\hypertarget{red__corr_8py_source_l00203}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{00203}     E\_BV = property(\_get\_e\_bv, \_set\_e\_bv, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})
\hypertarget{red__corr_8py_source_l00204}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{00204}     R\_V = property(\_get\_r\_v, \_set\_r\_v, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})
\hypertarget{red__corr_8py_source_l00205}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{00205}     law = property(\_get\_law, \_set\_law, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})
\hypertarget{red__corr_8py_source_l00206}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf16ae2a0bdb5dd620f9db382ffeebc9}{00206}     cHbeta = property(\_get\_cHbeta, \_set\_cHbeta, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})
\hypertarget{red__corr_8py_source_l00207}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_acbf4ca9cf48abed38b1ffad057420c71}{00207}     AV = property(\_get\_AV, \_set\_AV, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})
\hypertarget{red__corr_8py_source_l00208}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a41b35235a0952185b3c7e34f6835511e}{00208}     UserFunction = property(\_get\_uf, \_set\_uf, \textcolor{keywordtype}{None}, \textcolor{keywordtype}{None})
00209     
00210         
\hypertarget{red__corr_8py_source_l00211}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4fd27cfde692dbe6f3ff3d039bde2929}{00211}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4fd27cfde692dbe6f3ff3d039bde2929}{getCorr}(self, wave, rel\_wave=None): 
00212         \textcolor{stringliteral}{"""}
00213 \textcolor{stringliteral}{        Return the extinction correction as:}
00214 \textcolor{stringliteral}{            correction = 10**(0.4 * EBV * Xx) = 10**(A\_lambda / 2.5)}
00215 \textcolor{stringliteral}{}
00216 \textcolor{stringliteral}{        Usage:}
00217 \textcolor{stringliteral}{            RC.getCorr(5007)}
00218 \textcolor{stringliteral}{            RC.getCorr(5007, 4861)}
00219 \textcolor{stringliteral}{            }
00220 \textcolor{stringliteral}{        Parameters:}
00221 \textcolor{stringliteral}{            - wave      wavelength (Angstrom)}
00222 \textcolor{stringliteral}{            - rel\_wave  wavelength (Angstrom) for a relative correction}
00223 \textcolor{stringliteral}{}
00224 \textcolor{stringliteral}{        """}
00225         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law} \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00226             self.log\_.warn(\textcolor{stringliteral}{'No extinction law defined.'}, calling=self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a30606dfd94b4cefefd10dbb1f7cbd473}{calling})
00227             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00228         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a96fbed6f54a26dd2f59fe6441c9c3865}{\_laws\_dict}[self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law}] \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00229             self.log\_.warn(\textcolor{stringliteral}{'No user defined extinction law.'}, calling=self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a30606dfd94b4cefefd10dbb1f7cbd473}{calling})
00230             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00231         \textcolor{keywordflow}{else}:
00232             \textcolor{keywordflow}{if} rel\_wave \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00233                 rel\_corr = 1.
00234             \textcolor{keywordflow}{else}:
00235                 rel\_corr = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4fd27cfde692dbe6f3ff3d039bde2929}{getCorr}(rel\_wave) 
00236             X = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{X}(wave)
00237             \textcolor{keywordflow}{return} np.squeeze(10. ** (0.4 * np.outer(X, self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV}).reshape(X.shape + self.E\_BV.shape)))
       / rel\_corr
00238     
00239     
\hypertarget{red__corr_8py_source_l00240}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adcef55fc25b8cefce47a0462bf3f9172}{00240}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adcef55fc25b8cefce47a0462bf3f9172}{getCorrHb}(self, wave):
00241         \textcolor{stringliteral}{"""}
00242 \textcolor{stringliteral}{        Return the extinction correction normalized to the correction at 4861AA.}
00243 \textcolor{stringliteral}{            }
00244 \textcolor{stringliteral}{        Parameter:}
00245 \textcolor{stringliteral}{            - wave      wavelength (Angstrom)}
00246 \textcolor{stringliteral}{        }
00247 \textcolor{stringliteral}{        """}
00248         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4fd27cfde692dbe6f3ff3d039bde2929}{getCorr}(wave, np.ones\_like(wave) * pn.CST.HBETA)
00249     
00250     
\hypertarget{red__corr_8py_source_l00251}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a6e7097b97a6552f30422884af3faff69}{00251}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a6e7097b97a6552f30422884af3faff69}{getErrCorr}(self, wave, err\_E\_BV, rel\_wave=None):
00252         \textcolor{stringliteral}{"""}
00253 \textcolor{stringliteral}{        Return the error on the correction for a given wavelength, given the error on E(B-V)}
00254 \textcolor{stringliteral}{        }
00255 \textcolor{stringliteral}{        Parameters:}
00256 \textcolor{stringliteral}{            - wave         wavelength(s)}
00257 \textcolor{stringliteral}{            - err\_E\_BV     error on E(B-V)}
00258 \textcolor{stringliteral}{            - rel\_wave     reference wavelength for the normalization (optional)}
00259 \textcolor{stringliteral}{}
00260 \textcolor{stringliteral}{        """}
00261         \textcolor{keywordflow}{if} rel\_wave \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00262             rel\_X = 0.
00263         \textcolor{keywordflow}{else}:
00264             rel\_X = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{X}(rel\_wave)
00265         \textcolor{keywordflow}{return}  np.log(10) * abs(self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aac92bb80311cda78c01e61aa44655251}{X}(wave) - rel\_X) * 0.4 * err\_E\_BV * self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV}
00266 
00267 
\hypertarget{red__corr_8py_source_l00268}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8ed68e860066eafe017e5adcff6b56d9}{00268}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8ed68e860066eafe017e5adcff6b56d9}{getErrCorrHb}(self, wave, err\_E\_BV):
00269         \textcolor{stringliteral}{"""}
00270 \textcolor{stringliteral}{        Return the the error on the correction relative to Hbeta for a given wavelength, }
00271 \textcolor{stringliteral}{            given the error on E(B-V)}
00272 \textcolor{stringliteral}{        }
00273 \textcolor{stringliteral}{        Parameters:}
00274 \textcolor{stringliteral}{            - wave         wavelength(s)}
00275 \textcolor{stringliteral}{            - err\_E\_BV     error on E(B-V)}
00276 \textcolor{stringliteral}{}
00277 \textcolor{stringliteral}{        """}
00278         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a6e7097b97a6552f30422884af3faff69}{getErrCorr}(self, wave, err\_E\_BV, rel\_wave=pn.CST.HBETA)
00279 
00280     
\hypertarget{red__corr_8py_source_l00281}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a75e8027a7bd81d214ac16db221da8073}{00281}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a75e8027a7bd81d214ac16db221da8073}{setCorr}(self, obs\_over\_theo, wave1, wave2):
00282         \textcolor{stringliteral}{"""}
00283 \textcolor{stringliteral}{        Determination of the correction using the ratio of two observed line intensities }
00284 \textcolor{stringliteral}{            relative to the theoretical value.}
00285 \textcolor{stringliteral}{        }
00286 \textcolor{stringliteral}{        Usage:}
00287 \textcolor{stringliteral}{            rc.setCorr(6.5/2.85, 6563., 4861.)}
00288 \textcolor{stringliteral}{            }
00289 \textcolor{stringliteral}{        Parameters:}
00290 \textcolor{stringliteral}{            - obs\_over\_theo    ration of the observed ratio over the theoretical ratio}
00291 \textcolor{stringliteral}{            - wave1, wave2     wavelengths at which the line rations are taken.}
00292 \textcolor{stringliteral}{}
00293 \textcolor{stringliteral}{        """}
00294         COR = \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr}{RedCorr}(E\_BV= -2.5, R\_V=self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V}, law=self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law}, UserFunction=self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a41b35235a0952185b3c7e34f6835511e}{UserFunction})
00295         f1 = np.log10(COR.getCorr(wave1))
00296         f2 = np.log10(COR.getCorr(wave2))
00297         \textcolor{keywordflow}{if} f1 != f2:
00298             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV} = 2.5 * np.log10(obs\_over\_theo) / (f1 - f2)
00299         \textcolor{keywordflow}{else}:
00300             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV} = 0.
00301         del COR
00302 
\hypertarget{red__corr_8py_source_l00303}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a95f0d053c5dd67a00f1c1ceefc8da2c0}{00303}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a95f0d053c5dd67a00f1c1ceefc8da2c0}{plot}(self, w\_inf=1000., w\_sup=10000., laws=None, ax=None, **kwargs):
00304         \textcolor{stringliteral}{"""}
00305 \textcolor{stringliteral}{        Plot extinction laws}
00306 \textcolor{stringliteral}{}
00307 \textcolor{stringliteral}{        Parameters:}
00308 \textcolor{stringliteral}{            - w\_inf [float] lower limit of plot}
00309 \textcolor{stringliteral}{            - w\_sup [float] upper limit of plot}
00310 \textcolor{stringliteral}{            - laws [list of strings] list of extinction law labels. If set to 'all', all the laws are
       plotted}
00311 \textcolor{stringliteral}{            - ax : an axis object. If None, onr is created}
00312 \textcolor{stringliteral}{            - **kwargs arguments to plot}
00313 \textcolor{stringliteral}{}
00314 \textcolor{stringliteral}{        """}
00315         \textcolor{keywordflow}{if} ax \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00316             f, ax = plt.subplots()
00317         colors = [\textcolor{stringliteral}{'}\textcolor{stringliteral}{r', '}g', 'b', 'y', 'm', 'c']
00318         styles = [\textcolor{stringliteral}{'-'}, \textcolor{stringliteral}{'--'}, \textcolor{stringliteral}{'-:'}, \textcolor{stringliteral}{':'}]
00319         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} pn.config.INSTALLED[\textcolor{stringliteral}{'plt'}]:
00320             pn.log\_.error(\textcolor{stringliteral}{'matplotlib.pyplot not available for plotting'}, calling=self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a30606dfd94b4cefefd10dbb1f7cbd473}{calling})
00321         old\_E\_BV = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV}
00322         old\_law = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law}
00323         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV} = 2.5
00324         w = np.linspace(w\_inf, w\_sup, 1000)
00325         \textcolor{keywordflow}{if} laws \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00326             laws = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law}
00327         \textcolor{keywordflow}{elif} laws == \textcolor{stringliteral}{'all'}:
00328             laws = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a84e13d28ffcddb1feeb32c0ab62ae29b}{getLaws}()
00329         \textcolor{keywordflow}{if} type(laws) \textcolor{keywordflow}{is} str:
00330             laws = [laws]
00331         laws.sort()    
00332         \textcolor{keywordflow}{for} i, law \textcolor{keywordflow}{in} enumerate(laws):
00333             self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law} = law
00334             corr = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adcef55fc25b8cefce47a0462bf3f9172}{getCorrHb}(w)
00335             \textcolor{keywordflow}{if} corr \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00336                 ax.plot(w, np.log10(corr), label=law, c=colors[i % 6], linestyle=styles[i // 6], **kwargs)
00337         ax.legend()
00338         ax.set\_xlabel(\textcolor{stringliteral}{'Wavelength (A)'})
00339         ax.set\_ylabel(\textcolor{stringliteral}{'X'})
00340         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_adfed423013315bad4ba5dda2368dc3d0}{law} = old\_law
00341         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV} = old\_E\_BV
00342     
00343                             
\hypertarget{red__corr_8py_source_l00344}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0e1f547dbed4401b9c3d34658db9aaf7}{00344}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0e1f547dbed4401b9c3d34658db9aaf7}{\_CCM89}(self, wave):
00345         \textcolor{stringliteral}{"""}
00346 \textcolor{stringliteral}{        Cardelli, Clayton & Mathis 1989, ApJ 345, 245}
00347 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1989ApJ...345..245C}
00348 \textcolor{stringliteral}{}
00349 \textcolor{stringliteral}{        Comments: Depends on R\_V, default value being 3.1}
00350 \textcolor{stringliteral}{}
00351 \textcolor{stringliteral}{        Scope: Applicable to both dense and diffuse ISM}
00352 \textcolor{stringliteral}{        Range: UV through IR}
00353 \textcolor{stringliteral}{        }
00354 \textcolor{stringliteral}{        """}
00355         x = 1e4 / np.asarray([wave]) \textcolor{comment}{# inv microns}
00356         a = np.zeros\_like(x)
00357         b = np.zeros\_like(x)
00358         
00359         tt = (x > 0.3) & (x <= 1.1)
00360         a[tt] = 0.574 * x[tt] ** 1.61 
00361         b[tt] = -0.527 * x[tt] ** 1.61
00362     
00363         tt = (x > 1.1) & (x <= 3.3)
00364         yg = x[tt] - 1.82
00365         a[tt] = (1. + 0.17699 * yg - 0.50447 * yg ** 2. - 0.02427 * yg ** 3. + 0.72085 * yg ** 4. + 
00366                  0.01979 * yg ** 5. - 0.7753 * yg ** 6. + 0.32999 * yg ** 7.)
00367         b[tt] = (0. + 1.41338 * yg + 2.28305 * yg ** 2. + 1.07233 * yg ** 3. - 5.38434 * yg ** 4. - 
00368                  0.622510 * yg ** 5. + 5.3026 * yg ** 6. - 2.09002 * yg ** 7.)
00369         
00370         tt = (x > 3.3) & (x <= 5.9)
00371         a[tt] = 1.752 - 0.316 * x[tt] - 0.104 / ((x[tt] - 4.67) ** 2. + 0.341)
00372         b[tt] = -3.090 + 1.825 * x[tt] + 1.206 / ((x[tt] - 4.62) ** 2 + 0.263)
00373         
00374         tt = (x > 5.9) & (x <= 8.0)
00375         a[tt] = (1.752 - 0.316 * x[tt] - 0.104 / ((x[tt] - 4.67) ** 2. + 0.341) - 
00376                  0.04473 * (x[tt] - 5.9) ** 2. - 0.009779 * (x[tt] - 5.9) ** 3.)
00377         b[tt] = (-3.090 + 1.825 * x[tt] + 1.206 / ((x[tt] - 4.62) ** 2. + 0.263) + 
00378                  0.2130 * (x[tt] - 5.9) ** 2. + 0.1207 * (x[tt] - 5.9) ** 3.)
00379         
00380         tt = (x > 8.0) & (x < 10.0)
00381         a[tt] = (-1.073 - 0.628 * (x[tt] - 8) + 0.137 * (x[tt] - 8) ** 2. - 
00382                  0.070 * (x[tt] - 8) ** 3.)
00383         b[tt] = (13.670 + 4.257 * (x[tt] - 8) - 0.420 * (x[tt] - 8) ** 2. + 
00384                  0.374 * (x[tt] - 8) ** 3.)
00385         
00386         Xx = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} * a + b
00387         \textcolor{keywordflow}{return} np.squeeze(Xx)
00388 
00389 
\hypertarget{red__corr_8py_source_l00390}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5422d3b4c568033cc97ada0b73670aa9}{00390}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5422d3b4c568033cc97ada0b73670aa9}{\_CCM89\_Bal07}(self, wave):
00391         \textcolor{stringliteral}{"""}
00392 \textcolor{stringliteral}{        Galactic extinction law based on Cardelli et al 1989, modified by Blagrave et al 2007 }
00393 \textcolor{stringliteral}{        for 3.3 < x < 8 (1250 < lambda < 3030)}
00394 \textcolor{stringliteral}{        }
00395 \textcolor{stringliteral}{        Blagrave et al 2007, ApJ, 655, 299 }
00396 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/2007ApJ...655..299B}
00397 \textcolor{stringliteral}{        Cardelli, Clayton & Mathis 1989, ApJ 345, 245}
00398 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1989ApJ...345..245C}
00399 \textcolor{stringliteral}{}
00400 \textcolor{stringliteral}{        Comments:}
00401 \textcolor{stringliteral}{        Same as CCM89 for x<3.3 and x>8}
00402 \textcolor{stringliteral}{        Revised values for 3.3<x<8}
00403 \textcolor{stringliteral}{        Based on observation of Orion stars}
00404 \textcolor{stringliteral}{        Depends on R\_V, default value being 3.1}
00405 \textcolor{stringliteral}{}
00406 \textcolor{stringliteral}{        Range: UV through IR}
00407 \textcolor{stringliteral}{        }
00408 \textcolor{stringliteral}{        """}
00409         x = 1e4 / np.asarray([wave]) \textcolor{comment}{# inv microns}
00410         a = np.zeros\_like(x)
00411         b = np.zeros\_like(x)
00412         
00413         tt = (x > 0.3) & (x <= 1.1)
00414         a[tt] = 0.574 * x[tt] ** 1.61 
00415         b[tt] = -0.527 * x[tt] ** 1.61
00416     
00417         tt = (x > 1.1) & (x <= 3.3)
00418         yg = x[tt] - 1.82
00419         a[tt] = (1. + 0.17699 * yg - 0.50447 * yg ** 2. - 0.02427 * yg ** 3. + 0.72085 * yg ** 4. + 
00420                  0.01979 * yg ** 5. - 0.7753 * yg ** 6. + 0.32999 * yg ** 7.)
00421         b[tt] = (0. + 1.41338 * yg + 2.28305 * yg ** 2. + 1.07233 * yg ** 3. - 5.38434 * yg ** 4. - 
00422                  0.622510 * yg ** 5. + 5.3026 * yg ** 6. - 2.09002 * yg ** 7.)
00423         
00424         tt = (x > 3.3) & (x <= 5.9)
00425         a[tt] = 1.752 - 0.316 * x[tt] - 0.104 / ((x[tt] - 4.67) ** 2. + 0.341)
00426         b[tt] = -2.9 + 1.825 * x[tt] + 0.93 / ((x[tt] - 4.65) ** 2 + 0.263)
00427         
00428         
00429         tt = (x > 5.9) & (x <= 8.0)
00430         a[tt] = (1.752 - 0.316 * x[tt] - 0.104 / ((x[tt] - 4.67) ** 2. + 0.341) - 
00431                  0.04473 * (x[tt] - 5.9) ** 2. - 0.009779 * (x[tt] - 5.9) ** 3.)
00432         b[tt] = (-2.9 + 1.825 * x[tt] + 0.93 / ((x[tt] - 4.65) ** 2 + 0.263) + 
00433                  0.2130 * (x[tt] - 5.9) ** 2. + 0.1207 * (x[tt] - 5.9) ** 3.)
00434         
00435         tt = (x > 8.0) & (x < 10.0)
00436         a[tt] = (-1.073 - 0.628 * (x[tt] - 8) + 0.137 * (x[tt] - 8) ** 2. - 
00437                  0.070 * (x[tt] - 8) ** 3.)
00438         b[tt] = (13.670 + 4.257 * (x[tt] - 8) - 0.420 * (x[tt] - 8) ** 2. + 
00439                  0.374 * (x[tt] - 8) ** 3.)
00440         
00441         Xx = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} * a + b
00442         \textcolor{keywordflow}{return} np.squeeze(Xx)
00443     
00444 
\hypertarget{red__corr_8py_source_l00445}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8d06942c28efecc3704d5e31c444ca1b}{00445}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8d06942c28efecc3704d5e31c444ca1b}{\_CCM89\_oD94}(self, wave):
00446         \textcolor{stringliteral}{"""}
00447 \textcolor{stringliteral}{        Galactic extinction law based on Cardelli et al 1989, modified by O'Donnell 1994}
00448 \textcolor{stringliteral}{        for 1.1 < x < 3.3 (9100 < lambda < 3030)}
00449 \textcolor{stringliteral}{        }
00450 \textcolor{stringliteral}{        O'Donnell 1994, ApJ, 422, 1580}
00451 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1994ApJ...422..158O}
00452 \textcolor{stringliteral}{        Cardelli, Clayton & Mathis 1989, ApJ 345, 245}
00453 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1989ApJ...345..245C}
00454 \textcolor{stringliteral}{}
00455 \textcolor{stringliteral}{        Comments:}
00456 \textcolor{stringliteral}{        Same as CCM89 for x<1.1 and x>3.3}
00457 \textcolor{stringliteral}{        Revised values for 1.1<x<3.3}
00458 \textcolor{stringliteral}{        Produces lower correction in the near UV at low R\_V}
00459 \textcolor{stringliteral}{        }
00460 \textcolor{stringliteral}{        Scope: Galactic}
00461 \textcolor{stringliteral}{        Range: UV through IR}
00462 \textcolor{stringliteral}{        }
00463 \textcolor{stringliteral}{        """}
00464         x = 1e4 / np.asarray([wave]) \textcolor{comment}{# inv microns}
00465         a = np.zeros\_like(x)
00466         b = np.zeros\_like(x)
00467         
00468         tt = (x > 0.3) & (x <= 1.1)
00469         a[tt] = 0.574 * x[tt] ** 1.61 
00470         b[tt] = -0.527 * x[tt] ** 1.61
00471     
00472         tt = (x > 1.1) & (x <= 3.3)
00473         yg = x[tt] - 1.82
00474         a[tt] = (1. + 0.104 * yg - 0.609 * yg ** 2. + 0.701 * yg ** 3. + 1.137 * yg ** 4. - 
00475                  1.718 * yg ** 5. - 0.827 * yg ** 6. + 1.647 * yg ** 7. - 0.505 * yg ** 8.)
00476         b[tt] = (0. + 1.952 * yg + 2.908 * yg ** 2. - 3.989 * yg ** 3. - 7.985 * yg ** 4. + 
00477                  11.102 * yg ** 5. + 5.491 * yg ** 6. - 10.805 * yg ** 7. + 3.347 * yg ** 8.)
00478         
00479         tt = (x > 3.3) & (x <= 5.9)
00480         a[tt] = 1.752 - 0.316 * x[tt] - 0.104 / ((x[tt] - 4.67) ** 2. + 0.341)
00481         b[tt] = -3.090 + 1.825 * x[tt] + 1.206 / ((x[tt] - 4.62) ** 2 + 0.263)
00482         
00483         tt = (x > 5.9) & (x <= 8.0)
00484         a[tt] = (1.752 - 0.316 * x[tt] - 0.104 / ((x[tt] - 4.67) ** 2. + 0.341) - 
00485                  0.04473 * (x[tt] - 5.9) ** 2. - 0.009779 * (x[tt] - 5.9) ** 3.)
00486         b[tt] = (-3.090 + 1.825 * x[tt] + 1.206 / ((x[tt] - 4.62) ** 2. + 0.263) + 
00487                  0.2130 * (x[tt] - 5.9) ** 2. + 0.1207 * (x[tt] - 5.9) ** 3.)
00488         
00489         tt = (x > 8.0) & (x < 10.0)
00490         a[tt] = (-1.073 - 0.628 * (x[tt] - 8) + 0.137 * (x[tt] - 8) ** 2. - 
00491                  0.070 * (x[tt] - 8) ** 3.)
00492         b[tt] = (13.670 + 4.257 * (x[tt] - 8) - 0.420 * (x[tt] - 8) ** 2. + 
00493                  0.374 * (x[tt] - 8) ** 3.)
00494         
00495         Xx = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} * a + b
00496         \textcolor{keywordflow}{return} np.squeeze(Xx)
00497 
00498 
\hypertarget{red__corr_8py_source_l00499}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5ca5f455ff115c36f4ea3367542cbafa}{00499}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5ca5f455ff115c36f4ea3367542cbafa}{\_S79\_H83\_CCM89}(self, wave):
00500         \textcolor{stringliteral}{"""}
00501 \textcolor{stringliteral}{        Galactic extinction law (0-33000 A range):}
00502 \textcolor{stringliteral}{        - In the UV, from Seaton 1979}
00503 \textcolor{stringliteral}{        - In the opt/NIR (3600-9100) Howarth 1983}
00504 \textcolor{stringliteral}{        - In the FIR (9100-33000) Cardelly et al 1989}
00505 \textcolor{stringliteral}{        }
00506 \textcolor{stringliteral}{        Seaton 1979, MNRAS, 187, 73) and }
00507 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1979MNRAS.187P..73S}
00508 \textcolor{stringliteral}{        Howarth 1983, MNRAS, 203, 301) Galactic law}
00509 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1983MNRAS.204.1091H}
00510 \textcolor{stringliteral}{        Cardelli, Clayton and Mathis 1989, ApJ, 345, 245}
00511 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1989ApJ...345..245C}
00512 \textcolor{stringliteral}{        }
00513 \textcolor{stringliteral}{        Scope: Galactic}
00514 \textcolor{stringliteral}{        Range: UV through IR}
00515 \textcolor{stringliteral}{        }
00516 \textcolor{stringliteral}{        """}
00517         x = 1e4 / np.asarray([wave]) \textcolor{comment}{# inv microns}
00518         Xx = np.zeros\_like(x)
00519 
00520         \textcolor{comment}{# Cardelli, Clayton & Mathis 1989 33000-9000}
00521         tt = (x > 0.3) & (x <= 1.1)
00522         Xx[tt] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} * (0.574 * x[tt] ** 1.61) - 0.527 * x[tt] ** 1.61
00523         
00524         \textcolor{comment}{# Howarth 1983, Galactic 9000-5000}
00525         tt = (x > 1.1) & (x <= 1.83)
00526         Xx[tt] = (self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} - 3.1) + ((1.86 - 0.48 * x[tt]) * x[tt] - 0.1) * x[tt]
00527         
00528         \textcolor{comment}{# Howarth 1983, Galactic 5000-3600}
00529         tt = (x > 1.83) & (x <= 2.75)
00530         Xx[tt] = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} + 2.56 * (x[tt] - 1.83) - 0.993 * ((x[tt] - 1.83) ** 2)
00531 
00532         \textcolor{comment}{# Seaton 1979, Galactic}
00533         tt = (x > 2.75) & (x <= 3.65)
00534         Xx[tt] = (self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} - 3.2) + 1.56 + 1.048 * x[tt] + 1.01 / (((x[tt] - 4.6) ** 2) + 0.280)
00535         
00536         \textcolor{comment}{# Seaton 1979, Galactic}
00537         tt = (x > 3.65) & (x <= 7.14)
00538         Xx[tt] = (self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} - 3.2) + 2.29 + 0.848 * x[tt] + 1.01 / (((x[tt] - 4.6) ** 2) + 0.280)
00539         
00540         \textcolor{comment}{# Seaton 1979, Galactic}
00541         tt = (x > 7.14) 
00542         Xx[tt] = (self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} - 3.2) + 16.17 - 3.20 * x[tt] + 0.2975 * x[tt] ** 2
00543  
00544         \textcolor{keywordflow}{return} np.squeeze(Xx)
00545     
00546     
00547     \textcolor{comment}{# Removed from the code because it is most probably wrong}
00548     \textcolor{comment}{#def \_GCC09(self, wave):}
00549         \textcolor{stringliteral}{"""}
00550 \textcolor{stringliteral}{        Gordon, Cartledge & Clayton 2009, ApJ, 705, 1320}
00551 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/2009ApJ...705.1320G}
00552 \textcolor{stringliteral}{        }
00553 \textcolor{stringliteral}{        Comments:}
00554 \textcolor{stringliteral}{        Extinction function R.A(wave)/A(V) }
00555 \textcolor{stringliteral}{        R\_V dependent}
00556 \textcolor{stringliteral}{        WARNING: This law seems buggy in the 2200AA region.}
00557 \textcolor{stringliteral}{        }
00558 \textcolor{stringliteral}{        Scope:}
00559 \textcolor{stringliteral}{        UV}
00560 \textcolor{stringliteral}{           }
00561 \textcolor{stringliteral}{        """}
00562         \textcolor{stringliteral}{"""}
00563 \textcolor{stringliteral}{        x = 1e4 / np.asarray([wave]) # inv microns}
00564 \textcolor{stringliteral}{        Xx = np.zeros\_like(x)}
00565 \textcolor{stringliteral}{}
00566 \textcolor{stringliteral}{        tt = (x > 0.3) & (x <= 1.1)}
00567 \textcolor{stringliteral}{        Xx[tt] = (self.R\_V * 0.574 - 0.527) * x[tt] ** 1.61}
00568 \textcolor{stringliteral}{        }
00569 \textcolor{stringliteral}{        tt = (x > 1.1) & (x <= 3.3)}
00570 \textcolor{stringliteral}{        y = x[tt] - 1.82}
00571 \textcolor{stringliteral}{        a = 1 + y * (0.17699 + y * (-0.50447 + y * (-0.02427 + y * (0.72085 + \(\backslash\)}
00572 \textcolor{stringliteral}{                y * (0.01979 + y * (-0.77530 + y * 0.32999))))))}
00573 \textcolor{stringliteral}{        b = y * (1.41338 + y * (2.28305 + y * (1.07233 + y * (-5.38434 + \(\backslash\)}
00574 \textcolor{stringliteral}{            y * (-0.62251 + y * (5.30260 - y * 2.09002)))))) }
00575 \textcolor{stringliteral}{        Xx[tt] = self.R\_V * a + b}
00576 \textcolor{stringliteral}{}
00577 \textcolor{stringliteral}{        ##}
00578 \textcolor{stringliteral}{        # @bug The coefficients are obviously not correct; }
00579 \textcolor{stringliteral}{        tt = (x > 3.3) & (x <= 5.9)}
00580 \textcolor{stringliteral}{        a = 1.896 - 0.372 * x[tt] - 0.0108 / ((x[tt] - 4.57) ** 2 + 0.0422)}
00581 \textcolor{stringliteral}{        b = -3.503 + 2.057 * x[tt] + 0.7180 / ((x[tt] - 4.59) ** 2 + 0.0530)}
00582 \textcolor{stringliteral}{        Xx[tt] = self.R\_V * a + b}
00583 \textcolor{stringliteral}{}
00584 \textcolor{stringliteral}{        tt = (x > 5.9) & (x <= 11.0)}
00585 \textcolor{stringliteral}{        a = 1.896 - 0.372 * x[tt] - 0.0108 / ((x[tt] - 4.57) ** 2 + 0.0422)}
00586 \textcolor{stringliteral}{        b = -3.503 + 2.057 * x[tt] + 0.7180 / ((x[tt] - 4.59) ** 2 + 0.0530)}
00587 \textcolor{stringliteral}{        y = x[tt] - 5.9}
00588 \textcolor{stringliteral}{        a += -(0.110 + 0.0099 * y) * y ** 2}
00589 \textcolor{stringliteral}{        b += (0.537 + 0.0530 * y) * y ** 2}
00590 \textcolor{stringliteral}{        Xx[tt] = self.R\_V * a + b}
00591 \textcolor{stringliteral}{}
00592 \textcolor{stringliteral}{        return np.squeeze(Xx)}
00593 \textcolor{stringliteral}{        """}
00594 
\hypertarget{red__corr_8py_source_l00595}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a9958bee692760f5d5037a5b195142c01}{00595}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a9958bee692760f5d5037a5b195142c01}{\_K76}(self, wave):
00596         \textcolor{stringliteral}{"""}
00597 \textcolor{stringliteral}{        Kaler 1976, ApJS, 31, 517}
00598 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1976ApJS...31..517K}
00599 \textcolor{stringliteral}{        }
00600 \textcolor{stringliteral}{        Comments:}
00601 \textcolor{stringliteral}{        This function returns the correction relative to Hbeta (f\_lambda) and not}
00602 \textcolor{stringliteral}{        the extinction law (X(1/lambda)).}
00603 \textcolor{stringliteral}{        It cannot be used for absolute correction.}
00604 \textcolor{stringliteral}{        }
00605 \textcolor{stringliteral}{        Range: 3000 to >20000}
00606 \textcolor{stringliteral}{        }
00607 \textcolor{stringliteral}{        """}
00608         w = np.asarray([wave]) \textcolor{comment}{# inv microns}
00609         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV} == 0.:
00610             \textcolor{keywordflow}{return} np.ones\_like(w)
00611         f\_tab = np.loadtxt(\hyperlink{namespacepyneb_1_1utils_1_1misc_a937fc19e910346d9d288992e8eeab0ea}{execution\_path}(\textcolor{stringliteral}{'Gal\_Kaler.txt'}))
00612         f = np.interp(w, f\_tab[:, 0], f\_tab[:, 1])
00613         \textcolor{keywordflow}{return} np.squeeze(f * self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aaf16ae2a0bdb5dd620f9db382ffeebc9}{cHbeta} / 0.4 / self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a0bc581bcaa8eeeb67b83ffdec58bf164}{E\_BV})
00614     
00615 
\hypertarget{red__corr_8py_source_l00616}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a75a671c41944722df9d5fba814b83b3a}{00616}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a75a671c41944722df9d5fba814b83b3a}{\_SM79\_Gal}(self, wave):
00617         \textcolor{stringliteral}{"""}
00618 \textcolor{stringliteral}{        Galactic extinction law}
00619 \textcolor{stringliteral}{        Savage & Mathis 1979, ARA&A, 17, 73}
00620 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1979ARA%26A..17...73S}
00621 \textcolor{stringliteral}{        }
00622 \textcolor{stringliteral}{        Comments:}
00623 \textcolor{stringliteral}{        Average of several extinction laws}
00624 \textcolor{stringliteral}{        R\_V=3.1}
00625 \textcolor{stringliteral}{        }
00626 \textcolor{stringliteral}{        Scope: Galactic}
00627 \textcolor{stringliteral}{        Range: UV through IR}
00628 \textcolor{stringliteral}{        }
00629 \textcolor{stringliteral}{        """}
00630         x = 1e4 / np.asarray([wave]) \textcolor{comment}{# inv microns}
00631 
00632         X\_tab = np.loadtxt(\hyperlink{namespacepyneb_1_1utils_1_1misc_a937fc19e910346d9d288992e8eeab0ea}{execution\_path}(\textcolor{stringliteral}{'Gal\_SM79.txt'}))
00633         Xx = np.interp(x, X\_tab[:, 0], X\_tab[:, 1])
00634         \textcolor{keywordflow}{return} np.squeeze(Xx)
00635     
00636     
\hypertarget{red__corr_8py_source_l00637}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5e121988480c19aeb1fa5747b5d8d3a7}{00637}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a5e121988480c19aeb1fa5747b5d8d3a7}{\_G03\_LMC}(self, wave):
00638         \textcolor{stringliteral}{"""}
00639 \textcolor{stringliteral}{        Extinction curve for the LMC}
00640 \textcolor{stringliteral}{        Gordon et al. (2003, ApJ, 594,279)}
00641 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/2003ApJ...594..279G}
00642 \textcolor{stringliteral}{        }
00643 \textcolor{stringliteral}{        Comments:}
00644 \textcolor{stringliteral}{        Average curve for the LMC}
00645 \textcolor{stringliteral}{        R\_V = 3.41}
00646 \textcolor{stringliteral}{}
00647 \textcolor{stringliteral}{        Scope: LMC}
00648 \textcolor{stringliteral}{        Range: 1200 through fIR   }
00649 \textcolor{stringliteral}{}
00650 \textcolor{stringliteral}{        """}
00651         x = 1e4 / np.asarray([wave]) \textcolor{comment}{# inv microns}
00652 
00653         X\_tab = np.loadtxt(\hyperlink{namespacepyneb_1_1utils_1_1misc_a937fc19e910346d9d288992e8eeab0ea}{execution\_path}(\textcolor{stringliteral}{'LMC\_Gordon.txt'}))
00654         Xx = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} * np.interp(x, X\_tab[:, 0], X\_tab[:, 1])
00655         \textcolor{keywordflow}{return} np.squeeze(Xx)
00656     
00657     
\hypertarget{red__corr_8py_source_l00658}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8eb0fe7f840c32a87adfcf7ddd98a095}{00658}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8eb0fe7f840c32a87adfcf7ddd98a095}{\_F99\_like}(self, wave):
00659         \textcolor{stringliteral}{"""}
00660 \textcolor{stringliteral}{        In the UV, it returns the Fitzpatrick & Massa 1990 law.}
00661 \textcolor{stringliteral}{        In the opt/IR, it returns the Fitzpatrick & Massa 1990 law. }
00662 \textcolor{stringliteral}{        }
00663 \textcolor{stringliteral}{        Fitzpatrick 1999, PASP, 11, 63}
00664 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1999PASP..111...63F}
00665 \textcolor{stringliteral}{        Fitzpatrick & Massa 1990, ApJS, 72, 163}
00666 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1990ApJS...72..163F}
00667 \textcolor{stringliteral}{        }
00668 \textcolor{stringliteral}{        Comments:}
00669 \textcolor{stringliteral}{        The FM90 depends on 6 parameters which must be set by the user and are stored in
       RedCorr.FitzParams.}
00670 \textcolor{stringliteral}{        For the predefined set of parameters defined in FM99, use instead the F99 law.}
00671 \textcolor{stringliteral}{        R\_V must be provided, as the law depends on it. The dependence with R\_V follows Table 4 in the F99
       paper }
00672 \textcolor{stringliteral}{}
00673 \textcolor{stringliteral}{        Range: UV through IR}
00674 \textcolor{stringliteral}{        }
00675 \textcolor{stringliteral}{        """}
00676         \textcolor{keyword}{def }fit\_UV(x):
00677 
00678             Xx = c1 + c2 * x
00679             Xx += c3 * x ** 2 / ((x ** 2 - x0 ** 2) ** 2 + (x * gamma) ** 2)
00680             tt2 = (x > 5.9) 
00681             \textcolor{keywordflow}{if} tt2 \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keyword}{False}:
00682                 Xx[tt2] += c4 * (0.5392 * (x[tt2] - 5.9) ** 2 + 0.05644 * (x[tt2] - 5.9) ** 3)
00683             Xx += self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V}
00684             \textcolor{keywordflow}{return} Xx
00685             
00686         x = 1e4 / np.asarray([wave]) \textcolor{comment}{# inv microns}
00687         Xx = np.zeros\_like(x)
00688         \textcolor{keywordflow}{if} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams} \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00689             pn.log\_.warn(\textcolor{stringliteral}{'Fitzpatrick law requires FitzParams'}, calling=self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a30606dfd94b4cefefd10dbb1f7cbd473}{calling})
00690             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00691         x0 = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams}[0]
00692         gamma = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams}[1]
00693         c1 = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams}[2]
00694         c2 = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams}[3]
00695         c3 = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams}[4]
00696         c4 = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams}[5]
00697         
00698         \textcolor{comment}{# UV from the 1988 paper:}
00699         xcutuv = 10000.0 / 2700.0
00700         tt = (x >= xcutuv) 
00701         Xx[tt] = fit\_UV(x[tt])
00702         
00703         l2x = \textcolor{keyword}{lambda} l: 1e4 / l
00704         x\_opir = np.array([0, l2x(26500.0), l2x(12200.0), l2x(6000.0), l2x(5470.0), l2x(4670.0), l2x(4110.0
      ),
00705                   l2x(2700.), l2x(2600.)])
00706         norm = self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} / 3.1
00707 
00708         \textcolor{comment}{# Opt and IR from the 1999 paper}
00709         y\_opir = np.array([0., 0.265 * norm, 0.829 * norm, -0.426 + 1.0044 * self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V},
00710                            - 0.050 + 1.0016 * self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} , 0.701 + 1.0016 * self.
      \hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V},
00711                            1.208 + 1.0032 * self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} - 0.00033 * self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} ** 2, fit\_UV(l2x(2700.)), 
      fit\_UV(l2x(2600.))])
00712         tt = x < xcutuv
00713         \textcolor{keywordflow}{if} tt.sum() > 0:
00714             tck = interpolate.splrep(x\_opir, y\_opir)
00715             Xx[tt] = interpolate.splev(x[tt], tck, der=0)
00716         \textcolor{keywordflow}{return} np.squeeze(Xx)
00717 
00718 
00719 \textcolor{comment}{# Commented out because it duplicates \_F99\_like}
00720 \textcolor{comment}{#    def \_F99\_like\_IDL(self, wave):}
00721         \textcolor{stringliteral}{"""}
00722 \textcolor{stringliteral}{        Same as F99\_like, but with a different function in the opt/IR fitting, based on an IDL program}
00723 \textcolor{stringliteral}{        provided by F99. The results should be identical.}
00724 \textcolor{stringliteral}{    }
00725 \textcolor{stringliteral}{        In the UV, it returns the Fitzpatrick & Massa 1990 law.}
00726 \textcolor{stringliteral}{        In the opt/IR, it returns the Fitzpatrick 1990 law. }
00727 \textcolor{stringliteral}{        }
00728 \textcolor{stringliteral}{        Fitzpatrick 1999, PASP, 11, 63}
00729 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1999PASP..111...63F}
00730 \textcolor{stringliteral}{        Fitzpatrick & Massa 1990, ApJS, 72, 163}
00731 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1990ApJS...72..163F}
00732 \textcolor{stringliteral}{        }
00733 \textcolor{stringliteral}{        Comments:}
00734 \textcolor{stringliteral}{        The FM90 depends on 6 parameters which must be set by the user and are stored in
       RedCorr.FitzParams.}
00735 \textcolor{stringliteral}{        For the predefined set of parameters defined in FM99, use instead the F\_99 method.}
00736 \textcolor{stringliteral}{        R\_V must be provided, as the law depends on it. The dependence with R\_V follows Table 4 in the F99
       paper }
00737 \textcolor{stringliteral}{}
00738 \textcolor{stringliteral}{        Scope:    }
00739 \textcolor{stringliteral}{        Range: UV through IR}
00740 \textcolor{stringliteral}{        }
00741 \textcolor{stringliteral}{        }
00742 \textcolor{stringliteral}{        """}
00743         \textcolor{stringliteral}{"""}
00744 \textcolor{stringliteral}{        def fit\_UV(x):}
00745 \textcolor{stringliteral}{}
00746 \textcolor{stringliteral}{            Xx = c1 + c2 * x}
00747 \textcolor{stringliteral}{            Xx += c3 * x ** 2 / ((x ** 2 - x0 ** 2) ** 2 + (x * gamma) ** 2)}
00748 \textcolor{stringliteral}{            tt2 = (x > 5.9) }
00749 \textcolor{stringliteral}{            if tt2 is not False:}
00750 \textcolor{stringliteral}{                Xx[tt2] += c4 * (0.5392 * (x[tt2] - 5.9) ** 2 + 0.05644 * (x[tt2] - 5.9) ** 3)}
00751 \textcolor{stringliteral}{            Xx += self.R\_V}
00752 \textcolor{stringliteral}{            return Xx}
00753 \textcolor{stringliteral}{            }
00754 \textcolor{stringliteral}{        x = 1e4 / np.asarray([wave]) # inv microns}
00755 \textcolor{stringliteral}{        Xx = np.zeros\_like(x)}
00756 \textcolor{stringliteral}{        if self.FitzParams is None:}
00757 \textcolor{stringliteral}{            pn.log\_.error('Fitzpatrick law requires FitzParams to be set', calling=self.calling)}
00758 \textcolor{stringliteral}{            return None}
00759 \textcolor{stringliteral}{        x0 = self.FitzParams[0]}
00760 \textcolor{stringliteral}{        gamma = self.FitzParams[1]}
00761 \textcolor{stringliteral}{        c1 = self.FitzParams[2]}
00762 \textcolor{stringliteral}{        c2 = self.FitzParams[3]}
00763 \textcolor{stringliteral}{        c3 = self.FitzParams[4]}
00764 \textcolor{stringliteral}{        c4 = self.FitzParams[5]}
00765 \textcolor{stringliteral}{        }
00766 \textcolor{stringliteral}{        xcutuv = 10000.0 / 2700.0}
00767 \textcolor{stringliteral}{        tt = (x >= xcutuv) }
00768 \textcolor{stringliteral}{        Xx[tt] = fit\_UV(x[tt])}
00769 \textcolor{stringliteral}{        }
00770 \textcolor{stringliteral}{        l2x = lambda l: 1e4 / l}
00771 \textcolor{stringliteral}{        x\_opir = np.array([0, l2x(26500.0), l2x(12200.0), l2x(6000.0), l2x(5470.0), l2x(4670.0),
       l2x(4110.0),}
00772 \textcolor{stringliteral}{                  l2x(2700.), l2x(2600.)])}
00773 \textcolor{stringliteral}{        norm = self.R\_V / 3.1}
00774 \textcolor{stringliteral}{        }
00775 \textcolor{stringliteral}{        # Opt and IR computed with the IDL program provided by Fitzpatrick 1999:        }
00776 \textcolor{stringliteral}{        y\_opir = np.array([0.0, 0.26469 * norm, 0.82925 * norm, poly(self.R\_V, [-4.22809e-01, 1.00270,
       2.13572e-04]),}
00777 \textcolor{stringliteral}{                    poly(self.R\_V, [-5.13540e-02, 1.00216, -7.35778e-05]),}
00778 \textcolor{stringliteral}{                    poly(self.R\_V, [ 7.00127e-01, 1.00184, -3.32598e-05]),}
00779 \textcolor{stringliteral}{                    poly(self.R\_V, [ 1.19456, 1.01707, -5.46959e-03, 7.97809e-04, -4.45636e-05]),}
00780 \textcolor{stringliteral}{                    fit\_UV(l2x(2700.)), fit\_UV(l2x(2600.))])}
00781 \textcolor{stringliteral}{        }
00782 \textcolor{stringliteral}{        tt = x < xcutuv}
00783 \textcolor{stringliteral}{        if tt.sum() > 0:}
00784 \textcolor{stringliteral}{            tck = interpolate.splrep(x\_opir, y\_opir)}
00785 \textcolor{stringliteral}{            Xx[tt] = interpolate.splev(x[tt], tck, der=0)}
00786 \textcolor{stringliteral}{        return np.squeeze(Xx)}
00787 \textcolor{stringliteral}{        """}    
00788             
\hypertarget{red__corr_8py_source_l00789}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_af97fbc015537102bbc163263b8582986}{00789}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_af97fbc015537102bbc163263b8582986}{\_MCC99\_FM90\_LMC}(self, wave):
00790         \textcolor{stringliteral}{"""}
00791 \textcolor{stringliteral}{        In the UV, this method returns the extinction curve proposed for the LMC }
00792 \textcolor{stringliteral}{        by Misselt et al 1999 based on the 1990 variant of the Fitzpatrick & Massa law}
00793 \textcolor{stringliteral}{        In the opt/IR, it returns the Fitzpatrick & Massa 1990 law.}
00794 \textcolor{stringliteral}{}
00795 \textcolor{stringliteral}{        Misselt, Clayton & Gordon 1999 , ApJ, 515, 128 }
00796 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1999ApJ...515..128M}
00797 \textcolor{stringliteral}{        Fitzpatrick & Massa 1990, ApJS, 72, 163}
00798 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1990ApJS...72..163F}
00799 \textcolor{stringliteral}{        }
00800 \textcolor{stringliteral}{        Comments:}
00801 \textcolor{stringliteral}{        The Fitzpatrick & Massa 1990 law in the UV depends on 6 parameters, stored in RedCorr.FitzParams.}
00802 \textcolor{stringliteral}{        The method sets RedCorr.FitzParams to the values of set in the Fitzpatrick 1999 paper, }
00803 \textcolor{stringliteral}{        which includes an explicit dependence on R\_V.}
00804 \textcolor{stringliteral}{        R\_V must be provided, as the law depends on its value.}
00805 \textcolor{stringliteral}{        We refer to FM90 and not to the original FM88 because the value of a constant in F(lambda) slightly
       changed (0.0564 -> 0.05644)}
00806 \textcolor{stringliteral}{        The value of another constant of F(lambda) appears to change from FM90 to MCC99, but it is probably
       a typo (0.5392 -> 0.5329) }
00807 \textcolor{stringliteral}{        }
00808 \textcolor{stringliteral}{        Scope: LMC}
00809 \textcolor{stringliteral}{}
00810 \textcolor{stringliteral}{        """}
00811     
00812         x0 = 4.596  
00813         gamma = 0.91
00814         c1 = -1.28
00815         c2 = 1.11    
00816         c3 = 2.73    
00817         c4 = 0.64    
00818         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams} = [x0, gamma, c1, c2, c3, c4]
00819         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8eb0fe7f840c32a87adfcf7ddd98a095}{\_F99\_like}(wave)
00820 
00821 
\hypertarget{red__corr_8py_source_l00822}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8e249217925175868e6890e2e733c56a}{00822}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8e249217925175868e6890e2e733c56a}{\_F99}(self, wave):
00823         \textcolor{stringliteral}{"""}
00824 \textcolor{stringliteral}{        This method returns the R-dependent IR-through-UV extinction curve proposed by Fitzpatrick 1999.}
00825 \textcolor{stringliteral}{}
00826 \textcolor{stringliteral}{        Fitzpatrick 1999, PASP, 11, 63}
00827 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1999PASP..111...63F}
00828 \textcolor{stringliteral}{        based on: }
00829 \textcolor{stringliteral}{        Fitzpatrick & Massa 1990, ApJS, 72, 163}
00830 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1990ApJS...72..163F}
00831 \textcolor{stringliteral}{        }
00832 \textcolor{stringliteral}{        Comments:}
00833 \textcolor{stringliteral}{        The Fitzpatrick & Massa 1990 law in the UV depends on 6 parameters, stored in RedCorr.FitzParams.}
00834 \textcolor{stringliteral}{        The method sets RedCorr.FitzParams to the values of set in the Fitzpatrick 1999 paper, }
00835 \textcolor{stringliteral}{        which includes an explicit dependence on R\_V.}
00836 \textcolor{stringliteral}{        R\_V must be provided, as the law depends on its value.}
00837 \textcolor{stringliteral}{        }
00838 \textcolor{stringliteral}{        Range: UV through IR}
00839 \textcolor{stringliteral}{}
00840 \textcolor{stringliteral}{        """}
00841         x0 = 4.596  
00842         gamma = 0.99    
00843         c3 = 3.23    
00844         c4 = 0.41    
00845         c2 = -0.824 + 4.717 / self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a4696ecdd84c912c20e6aa19b1573e875}{R\_V} \textcolor{comment}{# 0.7 if RV=3.1}
00846         c1 = 2.030 - 3.007 * c2 \textcolor{comment}{# -0.0677 if RV = 3.1}
00847         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams} = [x0, gamma, c1, c2, c3, c4]
00848         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8eb0fe7f840c32a87adfcf7ddd98a095}{\_F99\_like}(wave)
00849 
00850 
\hypertarget{red__corr_8py_source_l00851}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aae30a2150d566f04044db33a1612be8b}{00851}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_aae30a2150d566f04044db33a1612be8b}{\_FM88\_F99\_LMC}(self, wave):
00852         \textcolor{stringliteral}{"""}
00853 \textcolor{stringliteral}{        This method returns:}
00854 \textcolor{stringliteral}{        - in the UV, the average LMC extinction curve derived by Fitzpatrick & Massa 1988}
00855 \textcolor{stringliteral}{        - in the opt/IR, the R-dependent extinction curve proposed by Fitzpatrick 1999.}
00856 \textcolor{stringliteral}{        }
00857 \textcolor{stringliteral}{        Fitzpatrick 1999, PASP, 11, 63}
00858 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1999PASP..111...63F}
00859 \textcolor{stringliteral}{        Fitzpatrick & Massa 1988, ApJ, 328, 734}
00860 \textcolor{stringliteral}{        http://adsabs.harvard.edu/abs/1988ApJ...328..734F}
00861 \textcolor{stringliteral}{        }
00862 \textcolor{stringliteral}{        Comments:}
00863 \textcolor{stringliteral}{        The Fitzpatrick and Massa law in the UV depends on 6 parameters, stored in RedCorr.FitzParams and }
00864 \textcolor{stringliteral}{        here set to the LMC values derived in FM88}
00865 \textcolor{stringliteral}{        R\_V must be provided, as the law depends on it}
00866 \textcolor{stringliteral}{        }
00867 \textcolor{stringliteral}{        Scope: LMC}
00868 \textcolor{stringliteral}{        Range: UV through IR}
00869 \textcolor{stringliteral}{}
00870 \textcolor{stringliteral}{        """}
00871         x0 = 4.608
00872         gamma = 0.994
00873         c1 = -0.687
00874         c2 = 0.891
00875         c3 = 2.55
00876         c4 = 0.504  
00877         self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a133fcc7513d358e629266b24cbe7bebc}{FitzParams} = [x0, gamma, c1, c2, c3, c4]
00878         \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_a8eb0fe7f840c32a87adfcf7ddd98a095}{\_F99\_like}(wave)
00879     
00880     
\hypertarget{red__corr_8py_source_l00881}{}\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad20df45ee0c6e9081245886135843e72}{00881}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1extinction_1_1red__corr_1_1_red_corr_ad20df45ee0c6e9081245886135843e72}{\_zeros}(self, wave):
00882         \textcolor{stringliteral}{"""}
00883 \textcolor{stringliteral}{        No correction, return 0.0}
00884 \textcolor{stringliteral}{        }
00885 \textcolor{stringliteral}{        """}
00886         \textcolor{keywordflow}{return} np.zeros\_like(wave)
00887     
\end{DoxyCode}
