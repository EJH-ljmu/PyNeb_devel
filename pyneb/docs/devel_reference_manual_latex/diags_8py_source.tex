\hypertarget{diags_8py_source}{}\section{diags.\+py}
\label{diags_8py_source}\index{pyneb/core/diags.\+py@{pyneb/core/diags.\+py}}

\begin{DoxyCode}
\hypertarget{diags_8py_source_l00001}{}\hyperlink{namespacepyneb_1_1core_1_1diags}{00001} \textcolor{stringliteral}{""" @module}
00002 \textcolor{stringliteral}{This module contains the admitted diagnostics.}
00003 \textcolor{stringliteral}{Diagnostics are stored in a dictionary. Keys are literal descriptions of the diagnostic }
00004 \textcolor{stringliteral}{(e.g. '[NI] 5198/5200') and items are tuples including a label ('N1'), an expression for the line ratio ('
      L(5198)/L(5200)',}
00005 \textcolor{stringliteral}{and an expression for the uncertainty on the line ratio as a function of the uncertainty on the individual
       lines ('RMS([E(5200), E(5198)])')}
00006 \textcolor{stringliteral}{}
00007 \textcolor{stringliteral}{"""}
00008 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np
00009 \textcolor{keyword}{import} pyneb \textcolor{keyword}{as} pn
00010 \textcolor{keyword}{from} \hyperlink{namespacepyneb_1_1utils_1_1misc}{pyneb.utils.misc} \textcolor{keyword}{import} int\_to\_roman, parseAtom
00011 \textcolor{keyword}{from} \hyperlink{namespacepyneb_1_1utils_1_1init}{pyneb.utils.init} \textcolor{keyword}{import} BLEND\_LIST
00012 
\hypertarget{diags_8py_source_l00013}{}\hyperlink{namespacepyneb_1_1core_1_1diags_a68f98ce12c5564de62b67feff671dc98}{00013} diags\_dict = \{\}
00014 
00015 diags\_dict[\textcolor{stringliteral}{'[CIII] 1909/1907'}] = (\textcolor{stringliteral}{'C3'}, \textcolor{stringliteral}{'L(1909)/L(1907)'}, \textcolor{stringliteral}{'RMS([E(1909), E(1907)])'})
00016 diags\_dict[\textcolor{stringliteral}{'[NI] 5198/5200'}] = (\textcolor{stringliteral}{'N1'}, \textcolor{stringliteral}{'I(3, 1)/I(2, 1)'}, \textcolor{stringliteral}{'RMS([E(5200), E(5198)])'})
00017 diags\_dict[\textcolor{stringliteral}{'[NII] 5755/6548'}] = (\textcolor{stringliteral}{'N2'}, \textcolor{stringliteral}{'L(5755)/L(6548)'}, \textcolor{stringliteral}{'RMS([E(6548), E(5755)])'})
00018 diags\_dict[\textcolor{stringliteral}{'[NII] 5755/6584'}] = (\textcolor{stringliteral}{'N2'}, \textcolor{stringliteral}{'L(5755)/L(6584)'}, \textcolor{stringliteral}{'RMS([E(6584), E(5755)])'})
00019 diags\_dict[\textcolor{stringliteral}{'[NII] 5755/6584+'}] = (\textcolor{stringliteral}{'N2'}, \textcolor{stringliteral}{'L(5755)/(L(6548)+L(6584))'}, \textcolor{stringliteral}{'
      RMS([E(6548)*L(6548)/(L(6548)+L(6584)), E(6584)*L(6584)/(L(6584)+L(6548)), E(5755)])'})
00020 diags\_dict[\textcolor{stringliteral}{'[NII] 121m/20.5m'}] = (\textcolor{stringliteral}{'N2'}, \textcolor{stringliteral}{'L(1214747)/L(2054427)'}, \textcolor{stringliteral}{'RMS([E(2054427)/E(1214747)])'})
00021 diags\_dict[\textcolor{stringliteral}{'[NIII] 1751+/57.4m'}] = (\textcolor{stringliteral}{'N3'}, \textcolor{stringliteral}{'B("1751A+")/L(574000)'}, \textcolor{stringliteral}{'RMS([E(574000), BE("1751A+")])'})
00022 \textcolor{comment}{#diags\_dict[''] = ('N3','L(1749)/L(1752)','RMS([E(1749), E(1752)])')}
00023 diags\_dict[\textcolor{stringliteral}{'[OI] 63m/147m'}] = (\textcolor{stringliteral}{'O1'}, \textcolor{stringliteral}{'L(632000)/L(1455000)'}, \textcolor{stringliteral}{'RMS([E(632000), E(1455000)])'})
00024 diags\_dict[\textcolor{stringliteral}{'[OI] 5577/6302'}] = (\textcolor{stringliteral}{'O1'}, \textcolor{stringliteral}{'L(5577)/L(6300)'}, \textcolor{stringliteral}{'RMS([E(6300), E(5577)])'})
00025 diags\_dict[\textcolor{stringliteral}{'[OI] 5577/6300'}] = (\textcolor{stringliteral}{'O1'}, \textcolor{stringliteral}{'L(5577)/L(6300)'}, \textcolor{stringliteral}{'RMS([E(6300), E(5577)])'})
00026 diags\_dict[\textcolor{stringliteral}{'[OI] 5577/6300+'}] = (\textcolor{stringliteral}{'O1'}, \textcolor{stringliteral}{'L(5577)/(L(6300)+L(6364))'}, \textcolor{stringliteral}{'
      RMS([E(6300)*L(6300)/(L(6300)+L(6364)), E(6364)*L(6364)/(L(6300)+L(6364)), E(5577)])'})
00027 diags\_dict[\textcolor{stringliteral}{'[OII] 3726/3729'}] = (\textcolor{stringliteral}{'O2'}, \textcolor{stringliteral}{'L(3726)/L(3729)'}, \textcolor{stringliteral}{'RMS([E(3729), E(3726)])'})
00028 diags\_dict[\textcolor{stringliteral}{'[OII] 3727+/7325+'}] = (\textcolor{stringliteral}{'O2'}, \textcolor{stringliteral}{'(L(3726)+L(3729))/(B("7319A+")+B("7330A+"))'},
00029               \textcolor{stringliteral}{'RMS([E(3726)*L(3726)/(L(3726)+L(3729)), E(3729)*L(3729)/(L(3726)+L(3729)),BE("7319A+")*B("
      7319A+")/(B("7319A+")+B("7330A+")),BE("7330A+")*B("7330A+")/(B("7319A+")+B("7330A+"))])'})
00030 \textcolor{comment}{#diags\_dict['[OII] 3727+/7325+'] = ('O2', '(L(3726)+L(3729))/(B("7325A+"))',
       'RMS([E(3726)*L(3726)/(L(3726)+L(3729)), E(3729)*L(3729)/(L(3726)+L(3729)),BE("7325A+")])')}
00031 diags\_dict[\textcolor{stringliteral}{'[OIII] 4363/5007'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'L(4363)/L(5007)'}, \textcolor{stringliteral}{'RMS([E(5007), E(4363)])'})
00032 diags\_dict[\textcolor{stringliteral}{'[OIII] 4363/5007+'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'L(4363)/(L(5007)+L(4959))'}, \textcolor{stringliteral}{'
      RMS([E(5007)*L(5007)/(L(5007)+L(4959)), E(4959)*L(4959)/(L(5007)+L(4959)), E(4363)])'})
00033 diags\_dict[\textcolor{stringliteral}{'[OIII] 5007/88m'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'L(5007)/L(883000)'}, \textcolor{stringliteral}{'RMS([E(883000), E(5007)])'})
00034 diags\_dict[\textcolor{stringliteral}{'[OIII] 51m/88m'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'L(518000)/L(883000)'}, \textcolor{stringliteral}{'RMS([E(883000), E(518000)])'})
00035 diags\_dict[\textcolor{stringliteral}{'[OIII] 1666/5007+'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'L(1666)/(L(5007)+L(4959))'}, \textcolor{stringliteral}{'
      RMS([E(5007)*L(5007)/(L(5007)+L(4959)), E(4959)*L(4959)/(L(5007)+L(4959)), E(1666)])'})
00036 diags\_dict[\textcolor{stringliteral}{'[OIII] 1666/5007'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'L(1666)/L(5007)'}, \textcolor{stringliteral}{'RMS([E(5007), E(1666)])'})
00037 diags\_dict[\textcolor{stringliteral}{'[OIII] 1664+/5007'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'(B("1664A+"))/L(5007)'}, \textcolor{stringliteral}{'RMS([BE("1664A+"), E(5007)])'})
00038 diags\_dict[\textcolor{stringliteral}{'[OIII] 1666/4363'}] = (\textcolor{stringliteral}{'O3'}, \textcolor{stringliteral}{'L(1666)/L(4363)'}, \textcolor{stringliteral}{'RMS([E(4363), E(1666)])'})
00039 diags\_dict[\textcolor{stringliteral}{'[OIV] 1401/1405'}] = (\textcolor{stringliteral}{'O4'}, \textcolor{stringliteral}{'L(1401)/L(1405)'}, \textcolor{stringliteral}{'RMS([E(1401), E(1405)])'})
00040 diags\_dict[\textcolor{stringliteral}{'[OIV] 1400+/25.9m'}] = (\textcolor{stringliteral}{'O4'}, \textcolor{stringliteral}{'B("1400A+")/L(259000)'}, \textcolor{stringliteral}{'RMS([BE("1400A+"), E(259000)])'})
00041 diags\_dict[\textcolor{stringliteral}{'[SII] 6731/6716'}] = (\textcolor{stringliteral}{'S2'}, \textcolor{stringliteral}{'L(6731)/L(6716)'}, \textcolor{stringliteral}{'RMS([E(6716), E(6731)])'})
00042 diags\_dict[\textcolor{stringliteral}{'[SII] 4069/4076'}] = (\textcolor{stringliteral}{'S2'}, \textcolor{stringliteral}{'L(4069)/L(4076)'}, \textcolor{stringliteral}{'RMS([E(4069), E(4076)])'})
00043 diags\_dict[\textcolor{stringliteral}{'[SII] 4072+/6720+'}] = (\textcolor{stringliteral}{'S2'}, \textcolor{stringliteral}{'(L(4069)+L(4076))/(L(6716)+L(6731))'},
00044               \textcolor{stringliteral}{'RMS([E(6716)*L(6716)/(L(6716)+L(6731)), E(6731)*L(6731)/(L(6716)+L(6731)),
       E(4069)*L(4069)/(L(4069)+L(4076)), E(4076)*L(4076)/(L(4069)+L(4076))])'})
00045 diags\_dict[\textcolor{stringliteral}{'[SIII] 18.7m/33.5m'}] = (\textcolor{stringliteral}{'S3'}, \textcolor{stringliteral}{'L(187000)/L(335000)'}, \textcolor{stringliteral}{'RMS([E(335000), E(187000)])'})
00046 diags\_dict[\textcolor{stringliteral}{'[SIII] 6312/18.7m'}] = (\textcolor{stringliteral}{'S3'}, \textcolor{stringliteral}{'L(6312)/L(187000)'}, \textcolor{stringliteral}{'RMS([E(187000), E(6312)])'})
00047 diags\_dict[\textcolor{stringliteral}{'[SIII] 9069/18.7m'}] = (\textcolor{stringliteral}{'S3'}, \textcolor{stringliteral}{'L(9069)/L(187000)'}, \textcolor{stringliteral}{'RMS([E(187000), E(9069)])'})
00048 diags\_dict[\textcolor{stringliteral}{'[SIII] 6312/9200+'}] = (\textcolor{stringliteral}{'S3'}, \textcolor{stringliteral}{'L(6312)/(L(9069)+L(9531))'}, \textcolor{stringliteral}{'
      RMS([E(9069)*L(9069)/(L(9069)+L(9531)), E(9531)*L(9531)/(L(9069)+L(9531)), E(6312)])'})
00049 diags\_dict[\textcolor{stringliteral}{'[SIII] 6312/9069'}] = (\textcolor{stringliteral}{'S3'}, \textcolor{stringliteral}{'L(6312)/L(9069)'}, \textcolor{stringliteral}{'RMS([E(9069), E(6312)])'})
00050 diags\_dict[\textcolor{stringliteral}{'[NeIII] 15.6m/36.0m'}] = (\textcolor{stringliteral}{'Ne3'}, \textcolor{stringliteral}{'L(156000)/L(360000)'}, \textcolor{stringliteral}{'RMS([E(156000), E(360000)])'})
00051 diags\_dict[\textcolor{stringliteral}{'[NeIII] 3869/15.6m'}] = (\textcolor{stringliteral}{'Ne3'}, \textcolor{stringliteral}{'L(3869)/L(156000)'}, \textcolor{stringliteral}{'RMS([E(156000), E(3869)])'})
00052 diags\_dict[\textcolor{stringliteral}{'[NeIII] 3930+/15.6m'}] = (\textcolor{stringliteral}{'Ne3'}, \textcolor{stringliteral}{'(L(3869)+L(3968))/L(156000)'}, \textcolor{stringliteral}{'RMS([E(156000),
       E(3869)*L(3869)/(L(3869)+L(3968)), E(3968)*L(3968)/(L(3869)+L(3968))])'})
00053 diags\_dict[\textcolor{stringliteral}{'[NeIII] 3344/3930+'}] = (\textcolor{stringliteral}{'Ne3'}, \textcolor{stringliteral}{'L(3343)/(L(3869)+L(3968))'}, \textcolor{stringliteral}{'
      RMS([E(3869)*L(3869)/(L(3869)+L(3968)), E(3968)*L(3968)/(L(3869)+L(3968)), E(3343)])'})
00054 diags\_dict[\textcolor{stringliteral}{'[NeIII] 3343/3930+'}] = (\textcolor{stringliteral}{'Ne3'}, \textcolor{stringliteral}{'L(3343)/(L(3869)+L(3968))'}, \textcolor{stringliteral}{'
      RMS([E(3869)*L(3869)/(L(3869)+L(3968)), E(3968)*L(3968)/(L(3869)+L(3968)), E(3343)])'})
00055 diags\_dict[\textcolor{stringliteral}{'[NeV] 2973/3370+'}] = (\textcolor{stringliteral}{'Ne5'}, \textcolor{stringliteral}{'L(2973)/(L(3426)+L(3346))'}, \textcolor{stringliteral}{'
      RMS([E(3426)*L(3426)/(L(3426)+L(3346)), E(3346)*L(3346)/(L(3426)+L(3346)), E(2973)])'})
00056 diags\_dict[\textcolor{stringliteral}{'[NeV] 1575/3426'}] = (\textcolor{stringliteral}{'Ne5'}, \textcolor{stringliteral}{'L(1575)/L(3426)'}, \textcolor{stringliteral}{'RMS([E(1575), E(3426)])'})
00057 diags\_dict[\textcolor{stringliteral}{'[NeV] 14.3m/24.2m'}] = (\textcolor{stringliteral}{'Ne5'}, \textcolor{stringliteral}{'L(143000)/L(242000)'}, \textcolor{stringliteral}{'RMS([E(143000), E(242000)])'})
00058 diags\_dict[\textcolor{stringliteral}{'[NeV] 3426/24.2m'}] = (\textcolor{stringliteral}{'Ne5'}, \textcolor{stringliteral}{'L(3426)/L(242000)'}, \textcolor{stringliteral}{'RMS([E(3426), E(242000)])'})
00059 diags\_dict[\textcolor{stringliteral}{'[ClIII] 5538/5518'}] = (\textcolor{stringliteral}{'Cl3'}, \textcolor{stringliteral}{'L(5538)/L(5518)'}, \textcolor{stringliteral}{'RMS([E(5518), E(5538)])'})
00060 diags\_dict[\textcolor{stringliteral}{'[ClIV] 5323/7531'}] = (\textcolor{stringliteral}{'Cl4'}, \textcolor{stringliteral}{'L(5323)/L(7531)'}, \textcolor{stringliteral}{'RMS([E(7531), E(5323)])'})
00061 diags\_dict[\textcolor{stringliteral}{'[ClIV] 5323/7700+'}] = (\textcolor{stringliteral}{'Cl4'}, \textcolor{stringliteral}{'L(5323)/(L(7531)+L(8046))'}, \textcolor{stringliteral}{'
      RMS([E(7531)*L(7531)/(L(7531)+L(8046)), E(8046)*L(8046)/(L(7531)+L(8046)), E(5323)])'})
00062 diags\_dict[\textcolor{stringliteral}{'[ArIII] (7751+7136)/9m'}] = (\textcolor{stringliteral}{'Ar3'}, \textcolor{stringliteral}{'(L(7751)+L(7136))/L(90000)'}, \textcolor{stringliteral}{'RMS([E(90000),
       E(7751)*L(7751)/(L(7751)+L(7136)), E(7136)*L(7136)/(L(7751)+L(7136))])'})
00063 diags\_dict[\textcolor{stringliteral}{'[ArIII] 7136/9m'}] = (\textcolor{stringliteral}{'Ar3'}, \textcolor{stringliteral}{'L(7136)/L(90000)'}, \textcolor{stringliteral}{'RMS([E(90000), E(7136)])'})
00064 diags\_dict[\textcolor{stringliteral}{'[ArIII] 5192/7300+'}] = (\textcolor{stringliteral}{'Ar3'}, \textcolor{stringliteral}{'L(5192)/(L(7751)+L(7136))'}, \textcolor{stringliteral}{'
      RMS([E(7751)*L(7751)/(L(7751)+L(7136)), E(7136)*L(7136)/(L(7751)+L(7136)), E(5192)])'})
00065 diags\_dict[\textcolor{stringliteral}{'[ArIII] 5192/7136'}] = (\textcolor{stringliteral}{'Ar3'}, \textcolor{stringliteral}{'L(5192)/L(7136)'}, \textcolor{stringliteral}{'RMS([E(7136), E(5192)])'})
00066 diags\_dict[\textcolor{stringliteral}{'[ArIII] 9.0m/21.8m'}] = (\textcolor{stringliteral}{'Ar3'}, \textcolor{stringliteral}{'L(89897)/L(218000)'}, \textcolor{stringliteral}{'RMS([E(89897), E(218000)])'})
00067 diags\_dict[\textcolor{stringliteral}{'[ArIV] 4740/4711'}] = (\textcolor{stringliteral}{'Ar4'}, \textcolor{stringliteral}{'L(4740)/L(4711)'}, \textcolor{stringliteral}{'RMS([E(4711), E(4740)])'})
00068 diags\_dict[\textcolor{stringliteral}{'[ArIV] 2860+/4720+'}] = (\textcolor{stringliteral}{'Ar4'}, \textcolor{stringliteral}{'(L(2854)+L(2868))/(L(4711)+L(4740))'},
00069               \textcolor{stringliteral}{'RMS([E(4711)*L(4711)/(L(4711)+L(4740)), E(4740)*L(4740)/(L(4711)+L(4740)),
       E(2854)*L(2854)/(L(2854)+L(2868)), E(2868)*L(2854)/(L(2854)+L(2868))])'})
00070 diags\_dict[\textcolor{stringliteral}{'[ArIV] 7230+/4720+'}] = (\textcolor{stringliteral}{'Ar4'}, \textcolor{stringliteral}{'(L(7170)+L(7263))/(L(4711)+L(4740))'},
00071               \textcolor{stringliteral}{'RMS([E(4711)*L(4711)/(L(4711)+L(4740)), E(4740)*L(4740)/(L(4711)+L(4740)),
       E(7170)*L(7170)/(L(7170)+L(7263)), E(7263)*L(7263)/(L(7170)+L(7263))])'})
00072 diags\_dict[\textcolor{stringliteral}{'[ArV] 4626/6600+'}] = (\textcolor{stringliteral}{'Ar5'}, \textcolor{stringliteral}{'L(4626)/(L(6435)+L(7005))'}, \textcolor{stringliteral}{'
      RMS([E(6435)*L(6435)/(L(6435)+L(7005)), E(7005)*L(7005)/(L(6435)+L(7005)), E(4626)])'})
00073 
00074 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4987'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4987)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4987)])'})
00075 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4925'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4925)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4925)])'})
00076 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4881'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4881)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4881)])'})
00077 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/5011'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(5011)'}, \textcolor{stringliteral}{'RMS([E(5270), E(5011)])'})
00078 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4931'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4931)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4931)])'})
00079 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4659'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4659)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4659)])'})
00080 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4701'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4701)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4701)])'})
00081 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4734)])'})
00082 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5270/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5270)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(5270), E(4009)])'})
00083 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/4925'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(4925)'}, \textcolor{stringliteral}{'RMS([E(4987), E(4925)])'})
00084 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/4881'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(4881)'}, \textcolor{stringliteral}{'RMS([E(4987), E(4881)])'})
00085 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/5011'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(5011)'}, \textcolor{stringliteral}{'RMS([E(4987), E(5011)])'})
00086 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/4931'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(4931)'}, \textcolor{stringliteral}{'RMS([E(4987), E(4931)])'})
00087 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/4659'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(4659)'}, \textcolor{stringliteral}{'RMS([E(4987), E(4659)])'})
00088 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/4701'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(4701)'}, \textcolor{stringliteral}{'RMS([E(4987), E(4701)])'})
00089 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(4987), E(4734)])'})
00090 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4987/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4987)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(4987), E(4009)])'})
00091 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4925/4881'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4925)/L(4881)'}, \textcolor{stringliteral}{'RMS([E(4925), E(4881)])'})
00092 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4925/5011'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4925)/L(5011)'}, \textcolor{stringliteral}{'RMS([E(4925), E(5011)])'})
00093 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4925/4931'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4925)/L(4931)'}, \textcolor{stringliteral}{'RMS([E(4925), E(4931)])'})
00094 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4925/4659'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4925)/L(4659)'}, \textcolor{stringliteral}{'RMS([E(4925), E(4659)])'})
00095 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4925/4701'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4925)/L(4701)'}, \textcolor{stringliteral}{'RMS([E(4925), E(4701)])'})
00096 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4925/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4925)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(4925), E(4734)])'})
00097 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4925/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4925)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(4925), E(4009)])'})
00098 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4881/5011'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4881)/L(5011)'}, \textcolor{stringliteral}{'RMS([E(4881), E(5011)])'})
00099 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4881/4931'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4881)/L(4931)'}, \textcolor{stringliteral}{'RMS([E(4881), E(4931)])'})
00100 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4881/4659'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4881)/L(4659)'}, \textcolor{stringliteral}{'RMS([E(4881), E(4659)])'})
00101 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4881/4701'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4881)/L(4701)'}, \textcolor{stringliteral}{'RMS([E(4881), E(4701)])'})
00102 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4881/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4881)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(4881), E(4734)])'})
00103 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4881/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4881)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(4881), E(4009)])'})
00104 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5011/4931'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5011)/L(4931)'}, \textcolor{stringliteral}{'RMS([E(5011), E(4931)])'})
00105 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5011/4659'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5011)/L(4659)'}, \textcolor{stringliteral}{'RMS([E(5011), E(4659)])'})
00106 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5011/4701'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5011)/L(4701)'}, \textcolor{stringliteral}{'RMS([E(5011), E(4701)])'})
00107 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5011/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5011)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(5011), E(4734)])'})
00108 diags\_dict[\textcolor{stringliteral}{'[FeIII] 5011/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(5011)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(5011), E(4009)])'})
00109 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4931/4659'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4931)/L(4659)'}, \textcolor{stringliteral}{'RMS([E(4931), E(4659)])'})
00110 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4931/4701'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4931)/L(4701)'}, \textcolor{stringliteral}{'RMS([E(4931), E(4701)])'})
00111 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4931/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4931)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(4931), E(4734)])'})
00112 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4931/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4931)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(4931), E(4009)])'})
00113 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4659/4701'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4659)/L(4701)'}, \textcolor{stringliteral}{'RMS([E(4659), E(4701)])'})
00114 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4659/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4659)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(4659), E(4734)])'})
00115 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4659/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4659)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(4659), E(4009)])'})
00116 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4701/4734'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4701)/L(4734)'}, \textcolor{stringliteral}{'RMS([E(4701), E(4734)])'})
00117 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4701/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4701)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(4701), E(4009)])'})
00118 diags\_dict[\textcolor{stringliteral}{'[FeIII] 4734/4009'}] = (\textcolor{stringliteral}{'Fe3'}, \textcolor{stringliteral}{'L(4734)/L(4009)'}, \textcolor{stringliteral}{'RMS([E(4734), E(4009)])'})
00119 \textcolor{comment}{# To be checked:}
00120 \textcolor{comment}{# 4989 is to be changed into 4987, but what about 4987?}
00121 \textcolor{comment}{# which is the relationship between the 3 lines in the numerator?}
00122 \textcolor{comment}{# is the error right?}
00123 \textcolor{comment}{# diags\_dict['[FeIII] 4659+/4987+'] = ('Fe3', '(L(4659)+L(4734)+L(4009))/(L(4987)+L(4989))', 'RMS([E(4659),
       E(4987)])')}
00124 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6000/7890'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6000)/L(7890)'}, \textcolor{stringliteral}{'RMS([E(6000), E(7890)])'})
00125 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6401/7890'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6401)/L(7890)'}, \textcolor{stringliteral}{'RMS([E(6401), E(7890)])'})
00126 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6534/7890'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6534)/L(7890)'}, \textcolor{stringliteral}{'RMS([E(6534), E(7890)])'})
00127 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6682/7890'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6682)/L(7890)'}, \textcolor{stringliteral}{'RMS([E(6682), E(7890)])'})
00128 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6797/7890'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6797)/L(7890)'}, \textcolor{stringliteral}{'RMS([E(6797), E(7890)])'})
00129 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6946/7890'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6946)/L(7890)'}, \textcolor{stringliteral}{'RMS([E(6946), E(7890)])'})
00130 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6000/8500'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6000)/L(8500)'}, \textcolor{stringliteral}{'RMS([E(6000), E(8500)])'})
00131 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6401/8500'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6401)/L(8500)'}, \textcolor{stringliteral}{'RMS([E(6401), E(8500)])'})
00132 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6534/8500'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6534)/L(8500)'}, \textcolor{stringliteral}{'RMS([E(6534), E(8500)])'})
00133 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6682/8500'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6682)/L(8500)'}, \textcolor{stringliteral}{'RMS([E(6682), E(8500)])'})
00134 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6797/8500'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6797)/L(8500)'}, \textcolor{stringliteral}{'RMS([E(6797), E(8500)])'})
00135 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6946/8500'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6946)/L(8500)'}, \textcolor{stringliteral}{'RMS([E(6946), E(8500)])'})
00136 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6000/7125'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6000)/L(7125)'}, \textcolor{stringliteral}{'RMS([E(6000), E(7125)])'})
00137 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6401/7125'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6401)/L(7125)'}, \textcolor{stringliteral}{'RMS([E(6401), E(7125)])'})
00138 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6534/7125'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6534)/L(7125)'}, \textcolor{stringliteral}{'RMS([E(6534), E(7125)])'})
00139 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6682/7125'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6682)/L(7125)'}, \textcolor{stringliteral}{'RMS([E(6682), E(7125)])'})
00140 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6797/7125'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6797)/L(7125)'}, \textcolor{stringliteral}{'RMS([E(6797), E(7125)])'})
00141 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6946/7125'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6946)/L(7125)'}, \textcolor{stringliteral}{'RMS([E(6946), E(7125)])'})
00142 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6000/6401'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6000)/L(6401)'}, \textcolor{stringliteral}{'RMS([E(6000), E(6401)])'})
00143 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6534/6401'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6534)/L(6401)'}, \textcolor{stringliteral}{'RMS([E(6534), E(6401)])'})
00144 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6946/6401'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6946)/L(6401)'}, \textcolor{stringliteral}{'RMS([E(6946), E(6401)])'})
00145 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6000/6797'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6000)/L(6797)'}, \textcolor{stringliteral}{'RMS([E(6000), E(6797)])'})
00146 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6534/6797'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6534)/L(6797)'}, \textcolor{stringliteral}{'RMS([E(6534), E(6797)])'})
00147 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6946/6797'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6946)/L(6797)'}, \textcolor{stringliteral}{'RMS([E(6946), E(6797)])'})
00148 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6000/6682'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6000)/L(6682)'}, \textcolor{stringliteral}{'RMS([E(6000), E(6682)])'})
00149 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6534/6682'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6534)/L(6682)'}, \textcolor{stringliteral}{'RMS([E(6534), E(6682)])'})
00150 diags\_dict[\textcolor{stringliteral}{'[NiIII] 6946/6682'}] = (\textcolor{stringliteral}{'Ni3'}, \textcolor{stringliteral}{'L(6946)/L(6682)'}, \textcolor{stringliteral}{'RMS([E(6946), E(6682)])'})
00151 
\hypertarget{diags_8py_source_l00152}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics}{00152} \textcolor{keyword}{class }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics}{Diagnostics}(object):
00153     \textcolor{stringliteral}{"""}
00154 \textcolor{stringliteral}{    Diagnostics is the class used to manage the diagnostics and to computed physical conditions }
00155 \textcolor{stringliteral}{        (electron temperatures and densities) from them. }
00156 \textcolor{stringliteral}{    It is also the class that plots the diagnostic Te-Ne diagrams.}
00157 \textcolor{stringliteral}{}
00158 \textcolor{stringliteral}{    """}    
00159     \textcolor{keyword}{def }\_\_init\_\_(self, addAll=False, OmegaInterp='Cheb'):
00160         \textcolor{stringliteral}{"""}
00161 \textcolor{stringliteral}{        Diagnostics constructor}
00162 \textcolor{stringliteral}{        }
00163 \textcolor{stringliteral}{        Parameters:}
00164 \textcolor{stringliteral}{            - addAll        switch to include all defined diagnostics (default = False)}
00165 \textcolor{stringliteral}{            - OmegaInterp   parameter sent to Atom, default is 'Cheb', other can be 'linear'}
00166 \textcolor{stringliteral}{            }
00167 \textcolor{stringliteral}{        """}
\hypertarget{diags_8py_source_l00168}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a20b70abfa1fd458af2b797e06da01ed0}{00168}         self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a20b70abfa1fd458af2b797e06da01ed0}{log\_} = pn.log\_ 
\hypertarget{diags_8py_source_l00169}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{00169}         self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} = \textcolor{stringliteral}{'Diagnostics'}
00170         \textcolor{comment}{##            }
00171         \textcolor{comment}{# @var diags}
00172         \textcolor{comment}{# The dictionary containing the diagnostics}
\hypertarget{diags_8py_source_l00173}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{00173}         self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags} = \{\}
00174         \textcolor{comment}{##}
00175         \textcolor{comment}{# @var atomDict}
00176         \textcolor{comment}{# The dictionary containing the atoms used for the diagnostics        }
00177         self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict} = \{\}
00178         self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_acfd0638b293790832bcee3cd9f3ec342}{OmegaInterp} = OmegaInterp
00179         \textcolor{keywordflow}{if} addAll:
00180             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_aab98440027bccb4e851da6803f0ee398}{addAll}()
00181 
00182 
\hypertarget{diags_8py_source_l00183}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_acf43d1129a2fbbdcecb4bbf1389872bc}{00183}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_acf43d1129a2fbbdcecb4bbf1389872bc}{getDiagFromLabel}(self, label):
00184         \textcolor{stringliteral}{"""}
00185 \textcolor{stringliteral}{        Return the definition of a diagnostic (the 3 or 4 elements tuple)}
00186 \textcolor{stringliteral}{        }
00187 \textcolor{stringliteral}{        Usage:}
00188 \textcolor{stringliteral}{            diags.getDiagFromLabel('[NII] 5755/6548')}
00189 \textcolor{stringliteral}{        }
00190 \textcolor{stringliteral}{        Parameters:}
00191 \textcolor{stringliteral}{            -label a diagnostic label }
00192 \textcolor{stringliteral}{            }
00193 \textcolor{stringliteral}{        """}
00194         \textcolor{keywordflow}{if} label \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00195             \textcolor{keywordflow}{return} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label]
00196         \textcolor{keywordflow}{else}:
00197             self.log\_.warn(\textcolor{stringliteral}{'\{0\} not in diagnostic'}.format(label), calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00198             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00199 
00200         
\hypertarget{diags_8py_source_l00201}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36b89ad0fa12a9406f7ad29f22a18799}{00201}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36b89ad0fa12a9406f7ad29f22a18799}{getDiags}(self):
00202         \textcolor{stringliteral}{"""}
00203 \textcolor{stringliteral}{        Return the definitions (tuples) of all the diagnostics defined in the Object.}
00204 \textcolor{stringliteral}{        No parameter.}
00205 \textcolor{stringliteral}{        }
00206 \textcolor{stringliteral}{        """}
00207         \textcolor{keywordflow}{return} [self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_acf43d1129a2fbbdcecb4bbf1389872bc}{getDiagFromLabel}(label) \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}]
00208 
00209             
\hypertarget{diags_8py_source_l00210}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a74db66bd37fcea46097e4dfad4113b41}{00210}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a74db66bd37fcea46097e4dfad4113b41}{getDiagLabels}(self):
00211         \textcolor{stringliteral}{"""}
00212 \textcolor{stringliteral}{        Return the labels of all the diagnostics defined in the Object}
00213 \textcolor{stringliteral}{        No parameter.}
00214 \textcolor{stringliteral}{        }
00215 \textcolor{stringliteral}{        """}
00216         \textcolor{keywordflow}{return} self.diags.keys()    
00217 
00218     
\hypertarget{diags_8py_source_l00219}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a7113a391e6899be51eb87c9194016d43}{00219}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a7113a391e6899be51eb87c9194016d43}{getAllDiags}(self):
00220         \textcolor{stringliteral}{"""}
00221 \textcolor{stringliteral}{        Return the definitions (tuples) of all the possible diagnostics.}
00222 \textcolor{stringliteral}{        No parameter.}
00223 \textcolor{stringliteral}{        }
00224 \textcolor{stringliteral}{        """}
00225         \textcolor{keywordflow}{return} diags\_dict
00226 
00227             
\hypertarget{diags_8py_source_l00228}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a4c5666c3444b87d30e60da598d2642fd}{00228}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a4c5666c3444b87d30e60da598d2642fd}{getAllDiagLabels}(self):
00229         \textcolor{stringliteral}{"""}
00230 \textcolor{stringliteral}{        Return the labels of all the possible diagnostics.}
00231 \textcolor{stringliteral}{        No parameter.}
00232 \textcolor{stringliteral}{        }
00233 \textcolor{stringliteral}{        """}
00234         \textcolor{keywordflow}{return} diags\_dict.keys()    
00235 
00236     
\hypertarget{diags_8py_source_l00237}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a3eeb7d0c7e4c33831c0efd8f7a74e80c}{00237}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a3eeb7d0c7e4c33831c0efd8f7a74e80c}{getUniqueAtoms}(self):
00238         \textcolor{stringliteral}{"""}
00239 \textcolor{stringliteral}{        Return a numpy.ndarray of the ions needed by the diagnostics. Unique is applied to the list before
       returning.}
00240 \textcolor{stringliteral}{        No parameter.}
00241 \textcolor{stringliteral}{        }
00242 \textcolor{stringliteral}{        """}
00243         \textcolor{keywordflow}{return} np.unique([self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[d][0] \textcolor{keywordflow}{for} d \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags} \textcolor{keywordflow}{if} self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[d] \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}])
00244     
00245     
\hypertarget{diags_8py_source_l00246}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{00246}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(self, label=None, diag\_tuple=None, atom=None, wave\_range=None):
00247         \textcolor{stringliteral}{"""}
00248 \textcolor{stringliteral}{        Add diagnostics to the list of available diagnostics. It can either be one of the built-in
       diagnostics,}
00249 \textcolor{stringliteral}{        a new, user-defined one, or a subset of the built-in diagnostics corresponding to a given atom or
       wavelength.}
00250 \textcolor{stringliteral}{        }
00251 \textcolor{stringliteral}{        Parameters:}
00252 \textcolor{stringliteral}{            - label        a string or a list of strings describing the diagnostic, e.g. '[OIII] 4363/5007'
      . }
00253 \textcolor{stringliteral}{                           If it is not a key of diags\_dict (a diagnostic define by PyNeb), diag\_tuple must
       also be specified}
00254 \textcolor{stringliteral}{            - diag\_tuple   a 3 elements tuple containing:}
00255 \textcolor{stringliteral}{                           + the atom, e.g. 'Ar5'}
00256 \textcolor{stringliteral}{                           + the algebraic description of the diagnostic, in terms of line wavelengths or
       blends or levels, }
00257 \textcolor{stringliteral}{                             e.g. '(L(6435)+L(7006))/L(4626)'}
00258 \textcolor{stringliteral}{                           + the algebraic description of the error, e.g. }
00259 \textcolor{stringliteral}{                             'RMS([E(6435)*L(6435)/(L(6435)+L(7006)), E(7006)*L(7006)/(L(6435)+L(7006)),
       E(4626)])'}
00260 \textcolor{stringliteral}{            - atom         the selected atom, e.g. 'O3'}
00261 \textcolor{stringliteral}{            - wave\_range   the selected wavelength range}
00262 \textcolor{stringliteral}{            }
00263 \textcolor{stringliteral}{        Usage:}
00264 \textcolor{stringliteral}{        diags.addDiag('[OIII] 4363/5007')}
00265 \textcolor{stringliteral}{        diags.addDiag('[OIII] 5007/51m', ('O3', 'L(5007)/L(51800)', 'RMS([E(51800), E(5007)])'))}
00266 \textcolor{stringliteral}{        diags.addDiag(atom='O3')}
00267 \textcolor{stringliteral}{        diags.addDiag(wave\_range=[4000, 6000])}
00268 \textcolor{stringliteral}{}
00269 \textcolor{stringliteral}{        """}
00270         \textcolor{keywordflow}{if} type(label) \textcolor{keywordflow}{is} list:
00271             \textcolor{keywordflow}{for} lab \textcolor{keywordflow}{in} label:
00272                 self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(lab)
00273         \textcolor{keywordflow}{elif} label \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00274             self.log\_.warn(\textcolor{stringliteral}{'\{0\} already in diagnostic'}.format(label), calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00275         \textcolor{keywordflow}{elif} label \textcolor{keywordflow}{in} diags\_dict:
00276             self.log\_.message(\textcolor{stringliteral}{'Adding diag \{0\}'}.format(label), calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00277             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label] = diags\_dict[label]
00278             atom = diags\_dict[label][0]
00279         \textcolor{keywordflow}{elif} type(diag\_tuple) \textcolor{keywordflow}{is} tuple:
00280             \textcolor{keywordflow}{if} len(diag\_tuple) == 3:    
00281                 self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label] = diag\_tuple
00282                 atom = diag\_tuple[0]
00283             \textcolor{keywordflow}{else}:
00284                 self.log\_.error(\textcolor{stringliteral}{'\{0\} is not in the list of diagnostics. The parameter diag\_tuple must be a
       3-elements tuple describing the diagnostic'}.format(label), calling=self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.addDiag'})
00285         \textcolor{keywordflow}{elif} atom \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00286             \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} diags\_dict:
00287                 \textcolor{keywordflow}{if} diags\_dict[label][0] == atom:
00288                     self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(label)
00289 \textcolor{comment}{#                    if atom not in self.atomDict:}
00290 \textcolor{comment}{#                        self.atomDict[atom] = pn.Atom(parseAtom(atom)[0], parseAtom(atom)[1])}
00291         \textcolor{keywordflow}{elif} wave\_range \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00292 \textcolor{comment}{# To be done: add the possibility to use several independent ranges. The following bit does the trick, but}
00293 \textcolor{comment}{# only if all the wavelengths of a diagnostic are included in the same range}
00294 \textcolor{comment}{#            if type(wave\_range[0]) is list:}
00295 \textcolor{comment}{#                for subrange in wave\_range:}
00296 \textcolor{comment}{#                    self.addDiag(label, diag\_tuple, atom, subrange)}
00297                  
00298             \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} diags\_dict:
00299                 expr = diags\_dict[label][1]
00300                 waves = []
00301                 wave = \textcolor{stringliteral}{''}
00302                 in\_wave = \textcolor{keyword}{False}
00303                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} expr:
00304                     \textcolor{keywordflow}{if} i.isdigit():
00305                         wave = wave + i
00306                         in\_wave = \textcolor{keyword}{True}
00307                     \textcolor{keywordflow}{elif} (i == \textcolor{stringliteral}{'m'}):
00308                         \textcolor{keywordflow}{if} in\_wave == \textcolor{keyword}{True}:
00309                             waves.append(int(wave) * 10000.)
00310                             in\_wave = \textcolor{keyword}{False}
00311                             wave = \textcolor{stringliteral}{''}
00312                     \textcolor{keywordflow}{else}:
00313                         \textcolor{keywordflow}{if} in\_wave == \textcolor{keyword}{True}:
00314                             waves.append(int(wave))
00315                             in\_wave = \textcolor{keyword}{False}
00316                             wave = \textcolor{stringliteral}{''}
00317                 \textcolor{keywordflow}{if} (min(waves) > min(wave\_range)) \textcolor{keywordflow}{and} (max(waves) < max(wave\_range)):
00318                     self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(label)
00319         \textcolor{keywordflow}{else}:
00320             self.log\_.error(\textcolor{stringliteral}{'Bad syntax. You must either give the label of an existing diagnostic, or the
       label and the tuple of a new one,'} + 
00321                             \textcolor{stringliteral}{'or an ion, or a wave range. label=\{0\}, diag\_tuple=\{1\}, atom=\{2\},
       wave\_range=\{3\}'}.format(label, diag\_tuple, atom, wave\_range),
00322                             calling=self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.addDiag'})
00323         \textcolor{keywordflow}{if} atom \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict} \textcolor{keywordflow}{and} (type(label) \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} list):
00324             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}[atom] = pn.Atom(\hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom)[0], 
      \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom)[1])
00325                
00326                
\hypertarget{diags_8py_source_l00327}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_aab98440027bccb4e851da6803f0ee398}{00327}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_aab98440027bccb4e851da6803f0ee398}{addAll}(self):
00328         \textcolor{stringliteral}{"""}
00329 \textcolor{stringliteral}{        Insert all the possible diagnostics in the Object (no parameters)}
00330 \textcolor{stringliteral}{        }
00331 \textcolor{stringliteral}{        """}
00332         \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} diags\_dict:
00333             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(label)
00334             
00335             
\hypertarget{diags_8py_source_l00336}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a64bbc36bfe0bb22570a1cb500cc395ef}{00336}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a64bbc36bfe0bb22570a1cb500cc395ef}{delDiag}(self, label=None):
00337         \textcolor{stringliteral}{"""}
00338 \textcolor{stringliteral}{        Remove a diagnostic, based on its label.}
00339 \textcolor{stringliteral}{        }
00340 \textcolor{stringliteral}{        Parameter:}
00341 \textcolor{stringliteral}{            - label  the label of the diagnostic ('all': removes all the diagnostics)}
00342 \textcolor{stringliteral}{}
00343 \textcolor{stringliteral}{        """}
00344         \textcolor{keywordflow}{if} label == \textcolor{stringliteral}{'all'}:
00345             \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00346                 self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a64bbc36bfe0bb22570a1cb500cc395ef}{delDiag}(item)
00347         \textcolor{keywordflow}{elif} label \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00348             del self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label]
00349         \textcolor{keywordflow}{else}:
00350             self.log\_.warn(\textcolor{stringliteral}{'\{0\} not in diagnostic, cannot be removed'}.format(label), calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00351     
00352     
\hypertarget{diags_8py_source_l00353}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a226aecfddebb567e7fe55731363635fc}{00353}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a226aecfddebb567e7fe55731363635fc}{addDiagsFromObs}(self, obs):
00354         \textcolor{stringliteral}{"""}
00355 \textcolor{stringliteral}{        Add all the possible diagnostics that can be computed from an Observation object}
00356 \textcolor{stringliteral}{        }
00357 \textcolor{stringliteral}{        Usage:}
00358 \textcolor{stringliteral}{            diags.addDiagsFromObs(obs)}
00359 \textcolor{stringliteral}{            }
00360 \textcolor{stringliteral}{        Parameter:}
00361 \textcolor{stringliteral}{            obs     an Observation object}
00362 \textcolor{stringliteral}{        """}
00363         
00364         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(obs, pn.Observation):
00365             pn.log\_.error(\textcolor{stringliteral}{'The argument must be an Observation object'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'addDiagsFromObs'})
00366         old\_level = pn.log\_.level
00367         pn.log\_.level = 1
00368         \textcolor{keyword}{def }I(i, j):
00369             wave = atom.wave\_Ang[i - 1, j - 1]
00370             corrIntens = obs.getLine(sym, spec, wave).corrIntens
00371             \textcolor{keywordflow}{return} corrIntens
00372         \textcolor{keyword}{def }L(wave):
00373             corrIntens = obs.getLine(sym, spec, wave).corrIntens
00374             \textcolor{keywordflow}{return} corrIntens
00375         \textcolor{keyword}{def }B(label):
00376             full\_label = atom + \textcolor{stringliteral}{'\_'} + label
00377             corrIntens = obs.getLine(label=full\_label).corrIntens
00378             \textcolor{keywordflow}{return} corrIntens
00379         
00380         \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} diags\_dict:
00381             atom, diag\_expression, error = diags\_dict[label]
00382             sym, spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom)
00383             \textcolor{keywordflow}{try}:
00384                 diag\_value = eval(diag\_expression)
00385                 \textcolor{keywordflow}{if} atom \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}:
00386                     self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}[atom] = pn.Atom(atom=atom)
00387                 self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(label)
00388             \textcolor{keywordflow}{except} Exception \textcolor{keyword}{as} ex:
00389                 \textcolor{keywordflow}{pass}
00390         pn.log\_.level = old\_level
00391     
00392     
\hypertarget{diags_8py_source_l00393}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a01ad01e336115e86eada60350060bb9b}{00393}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a01ad01e336115e86eada60350060bb9b}{setAtoms}(self, atom\_dic):
00394         \textcolor{stringliteral}{"""}
00395 \textcolor{stringliteral}{        Define the dictionary containing the atoms used for the diagnostics.}
00396 \textcolor{stringliteral}{        A dictionary of atom instantiations refereed by atom strings, for example:}
00397 \textcolor{stringliteral}{        \{'O3': pn.Atom('O', 3)\}}
00398 \textcolor{stringliteral}{        }
00399 \textcolor{stringliteral}{        """}
00400         \textcolor{keywordflow}{if} type(atom\_dic) != type(\{\}):
00401             self.log\_.error(\textcolor{stringliteral}{'the parameter must be a dictionary.'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.setAtoms'})
00402             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00403         \textcolor{keywordflow}{for} atom \textcolor{keywordflow}{in} atom\_dic:
00404             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(atom\_dic[atom], pn.Atom) \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} isinstance(atom\_dic[atom], pn.RecAtom):
00405                 self.log\_.error(\textcolor{stringliteral}{'the parameter must be a dictionary of Atom.'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.setAtoms'})
00406                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
\hypertarget{diags_8py_source_l00407}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{00407}         self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict} = atom\_dic
00408     
00409     
\hypertarget{diags_8py_source_l00410}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a4215075075b04c31b533a1a5c61ddd8b}{00410}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a4215075075b04c31b533a1a5c61ddd8b}{addClabel}(self, label, clabel):
00411         \textcolor{stringliteral}{"""}
00412 \textcolor{stringliteral}{        Add an alternative label to a diagnostic that can be used when plotting diagnostic diagrams.}
00413 \textcolor{stringliteral}{        }
00414 \textcolor{stringliteral}{        """}
00415         \textcolor{keywordflow}{if} label \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00416             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label] = (self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label][0], self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label][1], self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label][2], clabel)
00417         \textcolor{keywordflow}{else}:
00418             pn.log\_.warn(\textcolor{stringliteral}{'Try to add clabel in undefined label \{0\}'}.format(label), calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00419     
00420     
\hypertarget{diags_8py_source_l00421}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_af8b435b5fd63db75d207a7d1327ce65a}{00421}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_af8b435b5fd63db75d207a7d1327ce65a}{plot}(self, emis\_grids, obs, quad=True, i\_obs=None, alpha=0.3, ax=None):
00422         \textcolor{stringliteral}{"""}
00423 \textcolor{stringliteral}{        PLotting tool to generate Te-Ne diagrams.}
00424 \textcolor{stringliteral}{        }
00425 \textcolor{stringliteral}{        Usage:}
00426 \textcolor{stringliteral}{            diags.plot(emisgrids, obs, i\_obs=3)}
00427 \textcolor{stringliteral}{            }
00428 \textcolor{stringliteral}{        Parameters:}
00429 \textcolor{stringliteral}{            - emis\_grids    A dictionary of EmisGrid objects refereed by their atom strings (e.g. 'O3')}
00430 \textcolor{stringliteral}{                            This can for example be the output of pn.getEmisGridDict()}
00431 \textcolor{stringliteral}{            - obs           A pn.Observation object that is supposed to contain the line intensities}
00432 \textcolor{stringliteral}{                            used for the plot (corrected intensities).}
00433 \textcolor{stringliteral}{            - quad          If True (default) the sum of the error is quadratic,otherwise is linear.}
00434 \textcolor{stringliteral}{            - i\_obs         reference for the observation to be plotted, in case there is more than one}
00435 \textcolor{stringliteral}{                            in the obs object}
00436 \textcolor{stringliteral}{            - alpha         Transparency for the error bands in the plot}
00437 \textcolor{stringliteral}{            }
00438 \textcolor{stringliteral}{        """}
00439         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} pn.config.INSTALLED[\textcolor{stringliteral}{'plt'}]: 
00440             pn.log\_.error(\textcolor{stringliteral}{'Matplotlib not available, no plot'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.plot'})
00441             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00442         \textcolor{keywordflow}{else}:
00443             \textcolor{keyword}{import} matplotlib.pyplot \textcolor{keyword}{as} plt
00444         \textcolor{keywordflow}{if} type(emis\_grids) != type(\{\}):
00445             self.log\_.error(\textcolor{stringliteral}{'the first parameter must be a dictionary'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.plot'})
00446             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00447         \textcolor{keywordflow}{for} em \textcolor{keywordflow}{in} emis\_grids:
00448             \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(emis\_grids[em], pn.EmisGrid):
00449                 self.log\_.error(\textcolor{stringliteral}{'the first parameter must be a dictionary of EmisGrid'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.plot'})
00450                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00451         \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} isinstance(obs, pn.Observation):
00452             self.log\_.error(\textcolor{stringliteral}{'the second parameter must be an Observation'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling} + \textcolor{stringliteral}{'.plot'})
00453             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00454         \textcolor{keywordflow}{if} (i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (obs.n\_obs != 1):
00455             self.log\_.error(\textcolor{stringliteral}{'i\_obs must be specified when obs is multiple. try i\_obs=0'}, calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00456             \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00457         \textcolor{keywordflow}{if} ax \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00458             f, ax = plt.subplots()
00459         \textcolor{keywordflow}{else}:
00460             f = plt.gcf()
00461         X = np.log10(emis\_grids[emis\_grids.keys()[0]].den2D)
00462         Y = emis\_grids[emis\_grids.keys()[0]].tem2D
00463         \textcolor{keywordflow}{for} label \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00464             diag = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[label]
00465             atom = diag[0]
00466             \textcolor{keyword}{def }I(i, j):
00467                 \textcolor{keywordflow}{return} emis\_grids[atom].getGrid(lev\_i=i, lev\_j=j)
00468             \textcolor{keyword}{def }L(wave):
00469                 \textcolor{keywordflow}{return} emis\_grids[atom].getGrid(wave=wave)
00470             \textcolor{keyword}{def }B(label, I=I, L=L):
00471                 full\_label = atom + \textcolor{stringliteral}{'\_'} + label
00472                 \textcolor{keywordflow}{if} full\_label \textcolor{keywordflow}{in} BLEND\_LIST:
00473                     to\_eval = BLEND\_LIST[full\_label]
00474                 \textcolor{keywordflow}{else}:
00475                     self.log\_.warn(\textcolor{stringliteral}{'\{0\} not in BLEND\_LIST'}.format(full\_label), calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00476                     \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00477                 \textcolor{keywordflow}{return} eval(to\_eval)
00478             \textcolor{keywordflow}{try}:
00479                 diag\_map = eval(diag[1])
00480             \textcolor{keywordflow}{except}:
00481                 diag\_map = \textcolor{keywordtype}{None}
00482                 self.log\_.warn(\textcolor{stringliteral}{'diag \{0\} \{1\} not used'}.format(diag[0], diag[1]), calling=self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00483             \textcolor{keywordflow}{if} diag\_map \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00484                 sym, spec = \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom)
00485                 \textcolor{keyword}{def }I(i, j):
00486                     wave = emis\_grids[atom].atom.wave\_Ang[i - 1, j - 1]
00487                     corrIntens = obs.getLine(sym, spec, wave).corrIntens
00488                     \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00489                         \textcolor{keywordflow}{return} corrIntens
00490                     \textcolor{keywordflow}{else}:
00491                         \textcolor{keywordflow}{return} corrIntens[i\_obs]
00492                 \textcolor{keyword}{def }L(wave):
00493                     corrIntens = obs.getLine(sym, spec, wave).corrIntens
00494                     \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00495                         \textcolor{keywordflow}{return} corrIntens
00496                     \textcolor{keywordflow}{else}:
00497                         \textcolor{keywordflow}{return} corrIntens[i\_obs]
00498                 \textcolor{keyword}{def }B(label):
00499                     full\_label = atom + \textcolor{stringliteral}{'\_'} + label
00500                     corrIntens = obs.getLine(label=full\_label).corrIntens
00501                     \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00502                         \textcolor{keywordflow}{return} corrIntens
00503                     \textcolor{keywordflow}{else}:
00504                         \textcolor{keywordflow}{return} corrIntens[i\_obs]
00505                 \textcolor{keywordflow}{try}:
00506                     diag\_value = eval(diag[1])
00507                 \textcolor{keywordflow}{except}:
00508                     diag\_value = \textcolor{keywordtype}{None}
00509                     self.log\_.warn(\textcolor{stringliteral}{'A line in diagnostic \{0\} of \{1\}\{2\} is missing'}.format(diag[1], sym, 
      spec),
00510                                    calling=self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00511                 \textcolor{keywordflow}{if} diag\_value \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} np.isnan(diag\_value) \textcolor{keywordflow}{and} \textcolor{keywordflow}{not} np.isinf(diag\_value):
00512                     \textcolor{keyword}{def }E(wave):
00513                         err = obs.getLine(sym, spec, wave).corrError
00514                         \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00515                             \textcolor{keywordflow}{return} err
00516                         \textcolor{keywordflow}{else}:
00517                             \textcolor{keywordflow}{return} err[i\_obs]
00518                     \textcolor{keyword}{def }BE(label):
00519                         full\_label = atom + \textcolor{stringliteral}{'\_'} + label
00520                         err = obs.getLine(label=full\_label).corrError
00521                         \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00522                             \textcolor{keywordflow}{return} err
00523                         \textcolor{keywordflow}{else}:
00524                             \textcolor{keywordflow}{return} err[i\_obs]
00525                     \textcolor{keywordflow}{if} quad \textcolor{keywordflow}{is} \textcolor{keyword}{True}:
00526                         RMS = \textcolor{keyword}{lambda} err: np.sqrt((np.asarray(err) ** 2.).sum())
00527                     \textcolor{keywordflow}{else}:
00528                         RMS = \textcolor{keyword}{lambda} err: (np.asarray(err)).sum() 
00529                     tol\_value = eval(diag[2])
00530                     col\_dic = \{\textcolor{stringliteral}{'C'}:\textcolor{stringliteral}{'cyan'}, \textcolor{stringliteral}{'N'}:\textcolor{stringliteral}{'blue'}, \textcolor{stringliteral}{'O'}:\textcolor{stringliteral}{'green'}, \textcolor{stringliteral}{'Ne'}:\textcolor{stringliteral}{'magenta'},
00531                                \textcolor{stringliteral}{'Ar'}:\textcolor{stringliteral}{'red'}, \textcolor{stringliteral}{'Cl'}:\textcolor{stringliteral}{'magenta'}, \textcolor{stringliteral}{'S'}:\textcolor{stringliteral}{'black'}, \textcolor{stringliteral}{'Fe'}:\textcolor{stringliteral}{'blue'}\}
00532                     col = col\_dic[atom[:-1]]
00533                     style\_dic = \{\textcolor{stringliteral}{'1'}:\textcolor{stringliteral}{'-'}, \textcolor{stringliteral}{'2'}:\textcolor{stringliteral}{'--'}, \textcolor{stringliteral}{'3'}:\textcolor{stringliteral}{':'}, \textcolor{stringliteral}{'4'}:\textcolor{stringliteral}{'-.'}, \textcolor{stringliteral}{'5'}:\textcolor{stringliteral}{'-'}, \textcolor{stringliteral}{'6'}:\textcolor{stringliteral}{'--'}\}
00534                     style = style\_dic[atom[-1]]
00535                     \textcolor{keywordflow}{if} tol\_value > 0.:
00536                         levels = [(1 - tol\_value) * diag\_value, (1 + tol\_value) * diag\_value]
00537                         CS = ax.contourf(X, Y, diag\_map, levels=levels, alpha=alpha, colors=col)
00538                     CS = ax.contour(X, Y, diag\_map, levels=[diag\_value], colors=col, linestyles=style)
00539                     ax.set\_xlabel(\textcolor{stringliteral}{r'log(n$\_\{\(\backslash\)rm e\}$) [cm$^\{-3\}$]'})
00540                     ax.set\_ylabel(\textcolor{stringliteral}{r'T$\_\{\(\backslash\)rm e\}$ [K]'})
00541                     \textcolor{keywordflow}{if} len(diag) >= 4:
00542                         fmt = diag[3]
00543                     \textcolor{keywordflow}{else}:
00544                         fmt = \textcolor{stringliteral}{'[\{0\}\{1\}]'}.format(atom[0:-1], \hyperlink{namespacepyneb_1_1utils_1_1misc_aec4e973d4cb9299f749ef190ea636a06}{int\_to\_roman}(int(atom[-1])))
00545                     ax.clabel(CS, inline=\textcolor{keyword}{True}, fmt=fmt, fontsize=15, colors=col)
00546                     \textcolor{keywordflow}{if} type(diag\_value) \textcolor{keywordflow}{is} np.ndarray:
00547                         diag\_value = diag\_value[0]
00548                     self.log\_.message(\textcolor{stringliteral}{'plotting \{0\}: \{1\} = \{2:.2\} with error of \{3:.2\} %'}.format(fmt, label
      , diag\_value, tol\_value * 100),
00549                                       calling=self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a07dce673fec8b2383ef411ab94b0b2fe}{calling})
00550         
00551         
00552     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a2b0ebbaab7ce09624c1bc930e62bc228}{getCrossTemDen}(self, diag\_tem, diag\_den, value\_tem=None, value\_den=None, obs=None, 
      i\_obs=None,
00553                        guess\_tem=10000, tol\_tem=1., tol\_den=1., max\_iter=5, maxError=1e-3,
\hypertarget{diags_8py_source_l00554}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a2b0ebbaab7ce09624c1bc930e62bc228}{00554}                        start\_tem= -1, end\_tem= -1, start\_den= -1, end\_den= -1):
00555         \textcolor{stringliteral}{"""}
00556 \textcolor{stringliteral}{        Cross-converge the temperature and density derived from two sensitive line ratios, by inputting the
       quantity }
00557 \textcolor{stringliteral}{        derived with one line ratio into the other and then iterating.}
00558 \textcolor{stringliteral}{        The temperature- and density-sensitive ratios can be input directly or as an Observation object}
00559 \textcolor{stringliteral}{    }
00560 \textcolor{stringliteral}{        Parameters:}
00561 \textcolor{stringliteral}{    }
00562 \textcolor{stringliteral}{        - diag\_tem   temperature-sensitive diagnostic line ratio}
00563 \textcolor{stringliteral}{        - diag\_den   density-sensitive diagnostic line ratio}
00564 \textcolor{stringliteral}{        - value\_tem  value of the temperature-sensitive diagnostic}
00565 \textcolor{stringliteral}{        - value\_den  value of the density-sensitive diagnostic}
00566 \textcolor{stringliteral}{        - obs        np.Observation object. Values for observed temperature and density diagnostics are}
00567 \textcolor{stringliteral}{                        taken from it if value\_tem and value\_den are None}
00568 \textcolor{stringliteral}{        - i\_obs      index of the observations to be used from obs. }
00569 \textcolor{stringliteral}{                        If None, all the observations are considered.}
00570 \textcolor{stringliteral}{                        May be a boolean array}
00571 \textcolor{stringliteral}{        - guess\_tem  temperature assumed in the first iteration, in K}
00572 \textcolor{stringliteral}{        - tol\_tem    tolerance of the temperature result, in %}
00573 \textcolor{stringliteral}{        - tol\_den    tolerance of the density result, in %}
00574 \textcolor{stringliteral}{        - max\_iter   maximum number of iterations to be performed, after which the function will throw a
       result}
00575 \textcolor{stringliteral}{        - maxError   maximum error in the calls to getTemDen, in %}
00576 \textcolor{stringliteral}{        - start\_tem, end\_tem  lower and upper limit of the explored temperature range }
00577 \textcolor{stringliteral}{        - start\_den, end\_den  lower and upper limit of the explored density range }
00578 \textcolor{stringliteral}{    }
00579 \textcolor{stringliteral}{        Example:}
00580 \textcolor{stringliteral}{            tem, den = diags.getCrossTemDen('[OIII] 4363/5007', '[SII] 6731/6716', 0.0050, 1.0, }
00581 \textcolor{stringliteral}{                        guess\_tem=10000, tol\_tem = 1., tol\_den = 1., max\_iter = 5)}
00582 \textcolor{stringliteral}{}
00583 \textcolor{stringliteral}{        """}
00584         \textcolor{comment}{# TODO:}
00585         \textcolor{comment}{# Define a lower/upper density and temperature }
00586         \textcolor{comment}{# to be used in case the diag is pointing to values out of the boundaires}
00587         \textcolor{keywordflow}{if} diag\_tem \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00588             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(diag\_tem)
00589         atom\_tem = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[diag\_tem][0]
00590         elem\_tem, spec\_tem = \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(atom\_tem)
00591         \textcolor{keywordflow}{if} atom\_tem \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}:
00592             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}[atom\_tem] = pn.Atom(elem\_tem, spec\_tem, self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_acfd0638b293790832bcee3cd9f3ec342}{OmegaInterp})
00593         atom\_tem = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}[atom\_tem]
00594         \textcolor{keywordflow}{if} diag\_den \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}:
00595             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a508fa9c5a2216f9eb4128338c33a6f75}{addDiag}(diag\_den)
00596         atom\_den = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[diag\_den][0]
00597         elem\_den, spec\_den = \hyperlink{namespacepyneb_1_1utils_1_1misc_a8c069186002a3e73dd474958e35034d5}{parseAtom}(self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[diag\_den][0])
00598         \textcolor{keywordflow}{if} (atom\_den) \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}:
00599             self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}[atom\_den] = pn.Atom(elem\_den, spec\_den, self.
      \hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_acfd0638b293790832bcee3cd9f3ec342}{OmegaInterp})
00600         atom\_den = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}[atom\_den]
00601         eval\_tem = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[diag\_tem][1]
00602         eval\_den = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[diag\_den][1]
00603         calling = \textcolor{stringliteral}{'Diag.getCrossTemDen %s %s'} % (diag\_tem, diag\_den)
00604         \textcolor{keywordflow}{if} value\_tem \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00605             \textcolor{keyword}{def }L(wave):
00606                 \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00607                     \textcolor{keywordflow}{return} obs.getLine(elem\_tem, spec\_tem, wave).corrIntens
00608                 \textcolor{keywordflow}{else}:
00609                     \textcolor{keywordflow}{return} obs.getLine(elem\_tem, spec\_tem, wave).corrIntens[i\_obs]
00610             \textcolor{keyword}{def }I(i, j):
00611                 wave = atom\_tem.wave\_Ang[i - 1, j - 1]
00612                 \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00613                     \textcolor{keywordflow}{return} obs.getLine(elem\_tem, spec\_tem, wave).corrIntens
00614                 \textcolor{keywordflow}{else}:
00615                     \textcolor{keywordflow}{return} obs.getLine(elem\_tem, spec\_tem, wave).corrIntens[i\_obs]
00616             \textcolor{keyword}{def }B(label, I=I, L=L):
00617                 full\_label = elem\_tem + spec\_tem + \textcolor{stringliteral}{'\_'} + label
00618                 \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00619                     corrIntens = obs.getLine(label=full\_label).corrIntens
00620                 \textcolor{keywordflow}{else}:
00621                     corrIntens = obs.getLine(label=full\_label).corrIntens[i\_obs]
00622                 \textcolor{keywordflow}{return} corrIntens
00623             \textcolor{comment}{#pn.log\_.debug('to eval is \{0\}'.format(eval\_tem), calling=calling + 'TEST')}
00624             \textcolor{keywordflow}{try}:
00625                 value\_tem = eval(eval\_tem)
00626                 \textcolor{comment}{#pn.log\_.debug('to eval = \{0\}'.format(value\_tem), calling=calling + 'TEST')}
00627             \textcolor{keywordflow}{except}:
00628                 pn.log\_.warn(\textcolor{stringliteral}{'No value for \{0\} \{1\}: \{2\} in obs'}.format(elem\_tem, spec\_tem, diag\_tem), 
      calling=calling)
00629                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00630         \textcolor{keywordflow}{else}:
00631             \textcolor{keywordflow}{if} type(value\_tem) == type([]): value\_tem = np.asarray(value\_tem)
00632         \textcolor{keywordflow}{if} value\_den \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00633             \textcolor{keyword}{def }L(wave): 
00634                 \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00635                     \textcolor{keywordflow}{return} obs.getLine(elem\_den, spec\_den, wave).corrIntens
00636                 \textcolor{keywordflow}{else}:
00637                     \textcolor{keywordflow}{return} obs.getLine(elem\_den, spec\_den, wave).corrIntens[i\_obs]
00638             \textcolor{keyword}{def }I(i, j):
00639                 wave = atom\_den.wave\_Ang[i - 1, j - 1]
00640                 pn.log\_.debug(\textcolor{stringliteral}{'wave is \{0\}'}.format(wave), calling=calling + \textcolor{stringliteral}{'TEST3'})
00641                 \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00642                     \textcolor{keywordflow}{return} obs.getLine(elem\_den, spec\_den, wave).corrIntens
00643                 \textcolor{keywordflow}{else}:
00644                     \textcolor{keywordflow}{return} obs.getLine(elem\_den, spec\_den, wave).corrIntens[i\_obs]
00645             \textcolor{keyword}{def }B(label, I=I, L=L):
00646                 full\_label = elem\_den + spec\_den + \textcolor{stringliteral}{'\_'} + label
00647                 \textcolor{keywordflow}{if} i\_obs \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00648                     corrIntens = obs.getLine(label=full\_label).corrIntens
00649                 \textcolor{keywordflow}{else}:
00650                     corrIntens = obs.getLine(label=full\_label).corrIntens[i\_obs]
00651                 \textcolor{keywordflow}{return} corrIntens
00652             \textcolor{comment}{#pn.log\_.debug('to eval is \{0\}'.format(eval\_den), calling=calling + ' TEST')}
00653             \textcolor{keywordflow}{try}:
00654                 value\_den = eval(eval\_den)
00655                 \textcolor{comment}{#pn.log\_.debug('to eval = \{0\}'.format(value\_den), calling=calling + ' TEST1')}
00656             \textcolor{keywordflow}{except}:
00657                 pn.log\_.warn(\textcolor{stringliteral}{'No value for \{0\} \{1\}: \{2\} in obs'}.format(elem\_den, spec\_den, diag\_den), 
      calling=calling)
00658                 \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00659         \textcolor{keywordflow}{else}:
00660             \textcolor{keywordflow}{if} type(value\_den) == type([]): value\_den = np.asarray(value\_den)
00661         den = atom\_den.getTemDen(value\_den, tem=guess\_tem, to\_eval=eval\_den,
00662                                  maxError=maxError, start\_x=start\_den, end\_x=end\_den)
00663         
00664         tem = atom\_tem.getTemDen(value\_tem, den=den, to\_eval=eval\_tem,
00665                                  maxError=maxError, start\_x=start\_tem, end\_x=end\_tem)
00666 \textcolor{comment}{#        self.log\_.debug('tem: ' + str(tem) + ' den:' + str(den), calling='getCrossTemDen')}
00667         no\_conv = np.ones\_like(den).astype(bool)
00668         n\_tot = np.asarray(value\_tem).size
00669         \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} np.arange(max\_iter):
00670             \textcolor{keywordflow}{if} type(tem) == type(1.):
00671                 tem\_old = tem
00672             \textcolor{keywordflow}{else}:
00673                 tem\_old = tem.copy()
00674             \textcolor{keywordflow}{if} type(den) == type(1.):
00675                 den\_old = den
00676             \textcolor{keywordflow}{else}:
00677                 den\_old = den.copy()
00678             
00679             \textcolor{keywordflow}{if} n\_tot > 1:
00680                 den[no\_conv] = atom\_den.getTemDen(value\_den[no\_conv], tem=tem\_old[no\_conv],
00681                                                   to\_eval=eval\_den, start\_x=start\_den, end\_x=end\_den)
00682                 tem[no\_conv] = atom\_tem.getTemDen(value\_tem[no\_conv], den=den\_old[no\_conv],
00683                                                   to\_eval=eval\_tem, start\_x=start\_tem, end\_x=end\_tem)
00684             \textcolor{keywordflow}{else}:
00685                 den = atom\_den.getTemDen(value\_den, tem=tem\_old, to\_eval=eval\_den, start\_x=start\_den, end\_x
      =end\_den)
00686                 tem = atom\_tem.getTemDen(value\_tem, den=den\_old, to\_eval=eval\_tem, start\_x=start\_tem, end\_x
      =end\_tem)
00687                 
00688             no\_conv = ((abs(den\_old - den) / den * 100) > tol\_den) | ((abs(tem\_old - tem) / tem * 100) > 
      tol\_tem)
00689             \textcolor{keywordflow}{if} type(no\_conv) == type(\textcolor{keyword}{True}):
00690                 n\_no\_conv = int(no\_conv)
00691             \textcolor{keywordflow}{else}:
00692                 n\_no\_conv = no\_conv.sum()
00693             
00694             pn.log\_.message(\textcolor{stringliteral}{'\{0\} (max=\{1\}): not converged \{2\} of \{3\}.'}.format(i, max\_iter, n\_no\_conv, n\_tot
      ),
00695                             calling=calling)
00696             \textcolor{keywordflow}{if} n\_no\_conv == 0:
00697                 \textcolor{keywordflow}{return} tem, den
00698         \textcolor{keywordflow}{if} n\_tot == 1:
00699             tem = np.nan
00700             den = np.nan
00701         \textcolor{keywordflow}{else}:
00702             tem[no\_conv] = np.nan
00703             den[no\_conv] = np.nan
00704         \textcolor{keywordflow}{return} tem, den
00705     
\hypertarget{diags_8py_source_l00706}{}\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_ab136b902dcdc56ce3372a85c1f6a7b44}{00706}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_ab136b902dcdc56ce3372a85c1f6a7b44}{getDiagLimits}(self, diag):
00707         \textcolor{stringliteral}{"""}
00708 \textcolor{stringliteral}{        Return the low and high density values for a given diagnostic}
00709 \textcolor{stringliteral}{        """}
00710         atom = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a36301f268745b33abe6cfeb3e41a6356}{atomDict}[self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[diag][0]]
00711         to\_eval = self.\hyperlink{classpyneb_1_1core_1_1diags_1_1_diagnostics_a0c0f7e36097677f61a6a14a0c3127b02}{diags}[diag][1]
00712         HDR = atom.getHighDensRatio(to\_eval = to\_eval)
00713         LDR = atom.getLowDensRatio(to\_eval = to\_eval)
00714         return(np.sort((LDR, HDR)))
00715     
00716     
\end{DoxyCode}
