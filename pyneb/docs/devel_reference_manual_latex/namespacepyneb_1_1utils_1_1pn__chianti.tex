\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti}{\section{pyneb.\-utils.\-pn\-\_\-chianti Namespace Reference}
\label{namespacepyneb_1_1utils_1_1pn__chianti}\index{pyneb.\-utils.\-pn\-\_\-chianti@{pyneb.\-utils.\-pn\-\_\-chianti}}
}
\subsection*{Classes}
\begin{DoxyCompactItemize}
\item 
class \hyperlink{classpyneb_1_1utils_1_1pn__chianti_1_1___atom_chianti}{\-\_\-\-Atom\-Chianti}
\item 
class \hyperlink{classpyneb_1_1utils_1_1pn__chianti_1_1___coll_chianti}{\-\_\-\-Coll\-Chianti}
\end{DoxyCompactItemize}
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_ae49411e98cb7ac96f53887d3f277a041}{Chianti\-\_\-get\-A}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_af2ab54887a9b6970ef047eb14a81357d}{Chianti\-\_\-get\-E}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_aa5ac8c15155a7a63ddaefa054349ea16}{get\-\_\-levs\-\_\-order}
\item 
def \hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_a651b939729d0f5afb817a47a974bfaa1}{Chianti\-\_\-get\-Omega}
\end{DoxyCompactItemize}


\subsection{Function Documentation}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_ae49411e98cb7ac96f53887d3f277a041}{\index{pyneb\-::utils\-::pn\-\_\-chianti@{pyneb\-::utils\-::pn\-\_\-chianti}!Chianti\-\_\-get\-A@{Chianti\-\_\-get\-A}}
\index{Chianti\-\_\-get\-A@{Chianti\-\_\-get\-A}!pyneb::utils::pn_chianti@{pyneb\-::utils\-::pn\-\_\-chianti}}
\subsubsection[{Chianti\-\_\-get\-A}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-pn\-\_\-chianti.\-Chianti\-\_\-get\-A (
\begin{DoxyParamCaption}
\item[{}]{ion\-\_\-chianti, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1pn__chianti_ae49411e98cb7ac96f53887d3f277a041}
\begin{DoxyVerb}Return As from Chianti database.
Usage:
    As_O3 = Chianti_getA('o_3')
\end{DoxyVerb}
 

Definition at line \hyperlink{pn__chianti_8py_source_l00015}{15} of file \hyperlink{pn__chianti_8py_source}{pn\-\_\-chianti.\-py}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_l00015}{}\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_ae49411e98cb7ac96f53887d3f277a041}{00015} 
00016 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_ae49411e98cb7ac96f53887d3f277a041}{Chianti\_getA}(ion\_chianti, NLevels=None):
00017     \textcolor{stringliteral}{"""}
00018 \textcolor{stringliteral}{    Return As from Chianti database.}
00019 \textcolor{stringliteral}{    Usage:}
00020 \textcolor{stringliteral}{        As\_O3 = Chianti\_getA('o\_3')}
00021 \textcolor{stringliteral}{    """}
00022     wgfa = \_chianti\_tools.wgfaRead(ion\_chianti)
00023     NLevels = np.max(wgfa[\textcolor{stringliteral}{'lvl2'}])
00024     As = np.zeros((NLevels, NLevels))
00025     \textcolor{keywordflow}{for} i, j, a \textcolor{keywordflow}{in} zip(wgfa[\textcolor{stringliteral}{'lvl2'}], wgfa[\textcolor{stringliteral}{'lvl1'}], wgfa[\textcolor{stringliteral}{'avalue'}]):
00026         As[i-1, j-1] = a
00027     \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00028         As = As[0:NLevels, 0:NLevels]
00029     \textcolor{keywordflow}{return} As

\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_af2ab54887a9b6970ef047eb14a81357d}{\index{pyneb\-::utils\-::pn\-\_\-chianti@{pyneb\-::utils\-::pn\-\_\-chianti}!Chianti\-\_\-get\-E@{Chianti\-\_\-get\-E}}
\index{Chianti\-\_\-get\-E@{Chianti\-\_\-get\-E}!pyneb::utils::pn_chianti@{pyneb\-::utils\-::pn\-\_\-chianti}}
\subsubsection[{Chianti\-\_\-get\-E}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-pn\-\_\-chianti.\-Chianti\-\_\-get\-E (
\begin{DoxyParamCaption}
\item[{}]{ion\-\_\-chianti, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1pn__chianti_af2ab54887a9b6970ef047eb14a81357d}
\begin{DoxyVerb}Return energies from the Chianti database
Usage:
    E_O3 = Chianti_getE('o_3')
\end{DoxyVerb}
 

Definition at line \hyperlink{pn__chianti_8py_source_l00030}{30} of file \hyperlink{pn__chianti_8py_source}{pn\-\_\-chianti.\-py}.



Referenced by \hyperlink{pn__chianti_8py_source_l00051}{pyneb.\-utils.\-pn\-\_\-chianti.\-get\-\_\-levs\-\_\-order()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_l00030}{}\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_af2ab54887a9b6970ef047eb14a81357d}{00030} 
00031 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_af2ab54887a9b6970ef047eb14a81357d}{Chianti\_getE}(ion\_chianti, NLevels=None):
00032     \textcolor{stringliteral}{"""}
00033 \textcolor{stringliteral}{    Return energies from the Chianti database}
00034 \textcolor{stringliteral}{    Usage:}
00035 \textcolor{stringliteral}{        E\_O3 = Chianti\_getE('o\_3')}
00036 \textcolor{stringliteral}{    """}
00037     
00038     Es = \_chianti\_tools.elvlcRead(ion\_chianti)
00039     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} \textcolor{stringliteral}{'j'} \textcolor{keywordflow}{in} Es:
00040         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00041     dtype = [(\textcolor{stringliteral}{'ecmth'}, \textcolor{stringliteral}{'<f8'}), (\textcolor{stringliteral}{'ionS'}, \textcolor{stringliteral}{'S10'}), (\textcolor{stringliteral}{'term'}, \textcolor{stringliteral}{'S20'}),  (\textcolor{stringliteral}{'pretty'}, \textcolor{stringliteral}{'S30'}), 
00042              (\textcolor{stringliteral}{'spd'}, \textcolor{stringliteral}{'S10'}), (\textcolor{stringliteral}{'ecm'}, \textcolor{stringliteral}{'<f8'}), (\textcolor{stringliteral}{'j'}, \textcolor{stringliteral}{'<f8'}), (\textcolor{stringliteral}{'l'}, \textcolor{stringliteral}{'<i8'}), (\textcolor{stringliteral}{'erydth'}, \textcolor{stringliteral}{'<f8'}), 
00043              (\textcolor{stringliteral}{'conf'}, \textcolor{stringliteral}{'<i8'}), (\textcolor{stringliteral}{'lvl'}, \textcolor{stringliteral}{'<i8'}), (\textcolor{stringliteral}{'spin'}, \textcolor{stringliteral}{'<i8'}), (\textcolor{stringliteral}{'eryd'}, \textcolor{stringliteral}{'<f8'}), (\textcolor{stringliteral}{'mult'}, \textcolor{stringliteral}{'<i8'})]
00044     arr = np.recarray((len(Es[\textcolor{stringliteral}{'j'}]),), dtype=dtype)
00045     \textcolor{keywordflow}{for} k \textcolor{keywordflow}{in} Es.keys():
00046         \textcolor{keywordflow}{if} k \textcolor{keywordflow}{not} \textcolor{keywordflow}{in} (\textcolor{stringliteral}{'status'}, \textcolor{stringliteral}{'ref'}, \textcolor{stringliteral}{'label'}, \textcolor{stringliteral}{'filename'}):
00047             arr[k] = Es[k]
00048     \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None}:
00049         arr = arr[0:NLevels]
00050     \textcolor{keywordflow}{return} arr

\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_a651b939729d0f5afb817a47a974bfaa1}{\index{pyneb\-::utils\-::pn\-\_\-chianti@{pyneb\-::utils\-::pn\-\_\-chianti}!Chianti\-\_\-get\-Omega@{Chianti\-\_\-get\-Omega}}
\index{Chianti\-\_\-get\-Omega@{Chianti\-\_\-get\-Omega}!pyneb::utils::pn_chianti@{pyneb\-::utils\-::pn\-\_\-chianti}}
\subsubsection[{Chianti\-\_\-get\-Omega}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-pn\-\_\-chianti.\-Chianti\-\_\-get\-Omega (
\begin{DoxyParamCaption}
\item[{}]{ion\-\_\-chianti, }
\item[{}]{tem, }
\item[{}]{lev1 = {\ttfamily None}, }
\item[{}]{lev2 = {\ttfamily None}, }
\item[{}]{Splups = {\ttfamily None}, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1pn__chianti_a651b939729d0f5afb817a47a974bfaa1}
\begin{DoxyVerb}Return the values of Upsilon at a given temperature (may be a table)
Usage:
    Chianti_getOmega('o_3', 10000)
    Chianti_getOmega('o_3', np.linspace(5000, 20000, 20))
lower and upper levels can be given as lev1 and lev2. If not, full table is return
Splups is the result of _chianti_tools.splupsRead(ion_chianti), can be passed to avoid reloading it
NLevelsMax reduce the number of levels considered.
\end{DoxyVerb}
 

Definition at line \hyperlink{pn__chianti_8py_source_l00119}{119} of file \hyperlink{pn__chianti_8py_source}{pn\-\_\-chianti.\-py}.



Referenced by \hyperlink{pn__chianti_8py_source_l00507}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_l00119}{}\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_a651b939729d0f5afb817a47a974bfaa1}{00119} 
00120 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_a651b939729d0f5afb817a47a974bfaa1}{Chianti\_getOmega}(ion\_chianti, tem, lev1=None, lev2=None, Splups=None, NLevels=None):
00121     \textcolor{stringliteral}{"""}
00122 \textcolor{stringliteral}{    Return the values of Upsilon at a given temperature (may be a table)}
00123 \textcolor{stringliteral}{    Usage:}
00124 \textcolor{stringliteral}{        Chianti\_getOmega('o\_3', 10000)}
00125 \textcolor{stringliteral}{        Chianti\_getOmega('o\_3', np.linspace(5000, 20000, 20))}
00126 \textcolor{stringliteral}{    lower and upper levels can be given as lev1 and lev2. If not, full table is return}
00127 \textcolor{stringliteral}{    Splups is the result of \_chianti\_tools.splupsRead(ion\_chianti), can be passed to avoid reloading it}
00128 \textcolor{stringliteral}{    NLevelsMax reduce the number of levels considered.}
00129 \textcolor{stringliteral}{    """}
00130     temp=np.asarray(tem)
00131     \textcolor{keywordflow}{if} Splups \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00132         \textcolor{keywordflow}{if} pn.config.Chianti\_version\_main == \textcolor{stringliteral}{'8'}:
00133             Splups = \_chianti\_tools.scupsRead(ion\_chianti)
00134             print(Splups.keys())
00135         \textcolor{keywordflow}{elif} pn.config.Chianti\_version\_main == \textcolor{stringliteral}{'7'}:
00136             Splups = \_chianti\_tools.splupsRead(ion\_chianti)
00137     \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00138         nsplups = len(Splups[\textcolor{stringliteral}{"lvl1"}])
00139         nlevels = np.max(Splups[\textcolor{stringliteral}{"lvl2"}])
00140     \textcolor{keywordflow}{else}:
00141         nsplups = np.min((len(Splups[\textcolor{stringliteral}{"lvl1"}]), NLevels))
00142         nlevels = np.min((np.max(Splups[\textcolor{stringliteral}{"lvl2"}]), NLevels))
00143     ntemp=temp.size
00144     \textcolor{keywordflow}{if} (lev1 \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (lev2 \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}):
00145         Omega = np.zeros((nlevels, nlevels, ntemp))
00146     \textcolor{keywordflow}{else}:
00147         Omega = np.zeros(ntemp)
00148     lvl1 = np.array(Splups[\textcolor{stringliteral}{"lvl1"}])
00149     lvl2 = np.array(Splups[\textcolor{stringliteral}{"lvl2"}])
00150     \textcolor{keywordflow}{if} lev1 \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00151         range1 = np.arange(nlevels)
00152     \textcolor{keywordflow}{else}:
00153         range1 = np.array([lev1-1])
00154     \textcolor{keywordflow}{if} lev2 \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00155         range2 = np.arange(nlevels)
00156     \textcolor{keywordflow}{else}:
00157         range2 = np.array([lev2-1])
00158     \textcolor{keywordflow}{for} l1 \textcolor{keywordflow}{in} range1:
00159         \textcolor{keywordflow}{for} l2 \textcolor{keywordflow}{in} range2:
00160             isplups = np.where(((lvl1 == (l1+1)) & (lvl2 == (l2+1))))
00161             \textcolor{keywordflow}{if} type(isplups) == type(()):
00162                 isplups = isplups[0]                
00163             \textcolor{keywordflow}{if} len(isplups) == 0:
00164                 ups = np.zeros(ntemp)
00165             \textcolor{keywordflow}{else}:
00166                 ttype=Splups[\textcolor{stringliteral}{"ttype"}][isplups]
00167                 cups=Splups[\textcolor{stringliteral}{"cups"}][isplups]
00168                 \textcolor{keywordflow}{if} pn.config.Chianti\_version\_main == \textcolor{stringliteral}{'8'}:
00169                     nspl=Splups[\textcolor{stringliteral}{"ntemp"}][isplups]
00170                     dx=1./(float(nspl)-1.)
00171                     xs = Splups[\textcolor{stringliteral}{'btemp'}][isplups]
00172                     splups=Splups[\textcolor{stringliteral}{"bscups"}][isplups]
00173                 \textcolor{keywordflow}{elif} pn.config.Chianti\_version\_main == \textcolor{stringliteral}{'7'}:
00174                     nspl=Splups[\textcolor{stringliteral}{"nspl"}][isplups]
00175                     dx=1./(float(nspl)-1.)
00176                     xs=dx*np.arange(nspl)
00177                     splups=Splups[\textcolor{stringliteral}{"splups"}][isplups]
00178                 de=Splups[\textcolor{stringliteral}{'de'}][isplups]
00179                 kte = const.boltzmann*temp/(de*const.ryd2erg)
00180                 der=0
00181                 \textcolor{keywordflow}{if} ttype == 1:
00182                     st=1.-np.log(cups)/np.log(kte+cups)
00183                     y2=interpolate.splrep(xs,splups,s=0)
00184                     sups=interpolate.splev(st,y2,der=der)
00185                     ups=sups*np.log(kte+np.exp(1.))
00186                 \textcolor{keywordflow}{elif} ttype == 2:
00187                     st=kte/(kte+cups)
00188                     y2=interpolate.splrep(xs,splups,s=0)
00189                     sups=interpolate.splev(st,y2,der=der)
00190                     ups=sups
00191                 \textcolor{keywordflow}{elif} ttype == 3:
00192                     st=kte/(kte+cups)
00193                     y2=interpolate.splrep(xs,splups,s=0)
00194                     sups=interpolate.splev(st,y2,der=der)
00195                     ups=sups/(kte+1.)
00196                 \textcolor{keywordflow}{elif} ttype == 4:
00197                     st=1.-np.log(cups)/np.log(kte+cups)
00198                     y2=interpolate.splrep(xs,splups,s=0)
00199                     sups=interpolate.splev(st,y2,der=der)
00200                     ups=sups*np.log(kte+cups)
00201                 \textcolor{keywordflow}{elif} ttype == 5:
00202                     \textcolor{comment}{# dielectronic rates}
00203                     st=kte/(kte+cups)
00204                     y2=interpolate.splrep(xs,splups,s=0)
00205                     sups=interpolate.splev(st,y2,der=der)
00206                     ups=sups/(kte+0.)
00207                 \textcolor{keywordflow}{elif} ttype == 6:
00208                     st=kte/(kte+cups)
00209                     y2=interpolate.splrep(xs,splups,s=0)
00210                     sups=interpolate.splev(st,y2,der=der)
00211                     ups=10.**sups
00212                 \textcolor{keywordflow}{elif} ttype > 6:
00213                     pn.log\_.warning(\textcolor{stringliteral}{' t\_type ne 1,2,3,4,5=\{\} \{\} \{\}'}.format(ttype,l1,l2), calling=\textcolor{stringliteral}{'
      pn.chianti.Chianti\_getOmega'})
00214             \textcolor{keywordflow}{if} (lev1 \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}) \textcolor{keywordflow}{and} (lev2 \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}):
00215                 Omega[l2, l1, :] = ups
00216             \textcolor{keywordflow}{else}:
00217                 Omega = ups
00218 
00219     Omega = np.where(Omega > 0.,Omega,0.)
00220     \textcolor{keywordflow}{return} Omega

\end{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_aa5ac8c15155a7a63ddaefa054349ea16}{\index{pyneb\-::utils\-::pn\-\_\-chianti@{pyneb\-::utils\-::pn\-\_\-chianti}!get\-\_\-levs\-\_\-order@{get\-\_\-levs\-\_\-order}}
\index{get\-\_\-levs\-\_\-order@{get\-\_\-levs\-\_\-order}!pyneb::utils::pn_chianti@{pyneb\-::utils\-::pn\-\_\-chianti}}
\subsubsection[{get\-\_\-levs\-\_\-order}]{\setlength{\rightskip}{0pt plus 5cm}def pyneb.\-utils.\-pn\-\_\-chianti.\-get\-\_\-levs\-\_\-order (
\begin{DoxyParamCaption}
\item[{}]{atom, }
\item[{}]{N\-Levels = {\ttfamily None}}
\end{DoxyParamCaption}
)}}\label{namespacepyneb_1_1utils_1_1pn__chianti_aa5ac8c15155a7a63ddaefa054349ea16}
\begin{DoxyVerb}Returns a dictionary giving the correspondence of indices between NIST and Chianti energy level tables.\end{DoxyVerb}
 

Definition at line \hyperlink{pn__chianti_8py_source_l00051}{51} of file \hyperlink{pn__chianti_8py_source}{pn\-\_\-chianti.\-py}.



References \hyperlink{manage__atomic__data_8py_source_l00009}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-atom2chianti()}, \hyperlink{pn__chianti_8py_source_l00030}{pyneb.\-utils.\-pn\-\_\-chianti.\-Chianti\-\_\-get\-E()}, and \hyperlink{manage__atomic__data_8py_source_l00606}{pyneb.\-utils.\-manage\-\_\-atomic\-\_\-data.\-get\-Levels\-N\-I\-S\-T()}.



Referenced by \hyperlink{pn__chianti_8py_source_l00507}{pyneb.\-utils.\-pn\-\_\-chianti.\-\_\-\-Coll\-Chianti.\-get\-Omega()}.


\begin{DoxyCode}
\hypertarget{namespacepyneb_1_1utils_1_1pn__chianti_l00051}{}\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_aa5ac8c15155a7a63ddaefa054349ea16}{00051} 
00052 \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_aa5ac8c15155a7a63ddaefa054349ea16}{get\_levs\_order}(atom, NLevels=None):
00053     \textcolor{stringliteral}{"""}
00054 \textcolor{stringliteral}{    Returns a dictionary giving the correspondence of indices between NIST and Chianti energy level tables.}
00055 \textcolor{stringliteral}{    }
00056 \textcolor{stringliteral}{    """}
00057     E\_chianti = \hyperlink{namespacepyneb_1_1utils_1_1pn__chianti_af2ab54887a9b6970ef047eb14a81357d}{Chianti\_getE}(\hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_a2c05deb31d8bc74727659c88846651a1}{atom2chianti}(atom))
00058     \textcolor{keywordflow}{if} E\_chianti \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00059         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00060     E\_NIST = \hyperlink{namespacepyneb_1_1utils_1_1manage__atomic__data_ad09376e8676854d44680ae14210b5589}{getLevelsNIST}(atom)
00061     \textcolor{keywordflow}{if} E\_NIST \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00062         \textcolor{keywordflow}{return} \textcolor{keywordtype}{None}
00063     \textcolor{comment}{# Here follow a list of filter to try to find coincidence between the configuration used in Chanti and
       in NIST}
00064     remove\_stars = \textcolor{keyword}{lambda} str: re.sub(\textcolor{stringliteral}{'\(\backslash\)*'},\textcolor{stringliteral}{''}, str)
00065     remove\_par = \textcolor{keyword}{lambda} str: re.sub(\textcolor{stringliteral}{r'\(\backslash\)([^)]*\(\backslash\))'},\textcolor{stringliteral}{''}, str)
00066     change\_2pto1p = \textcolor{keyword}{lambda} str: re.sub(\textcolor{stringliteral}{'\(\backslash\).\(\backslash\).'}, \textcolor{stringliteral}{'.'}, str)
00067     change\_2pto0p = \textcolor{keyword}{lambda} str: re.sub(\textcolor{stringliteral}{'\(\backslash\).\(\backslash\).'}, \textcolor{stringliteral}{''}, str)
00068     remove\_point\_before\_par = \textcolor{keyword}{lambda} str: re.sub(\textcolor{stringliteral}{'\(\backslash\).\(\backslash\)('}, \textcolor{stringliteral}{'('}, str)
00069     remove\_before\_firstp = \textcolor{keyword}{lambda} str: re.sub(\textcolor{stringliteral}{'^[^.]*.'}, \textcolor{stringliteral}{''}, str)
00070     change\_ptpsp = \textcolor{keyword}{lambda} str: re.sub(\textcolor{stringliteral}{'\(\backslash\).'}, \textcolor{stringliteral}{' '}, str)
00071     \textcolor{comment}{# Define the Dictionary}
00072     Chianti2NIST = \{\}
00073     \textcolor{keywordflow}{for} i\_N, E \textcolor{keywordflow}{in} enumerate(E\_NIST):
00074         \textcolor{keywordflow}{if} i\_N >= len(E\_chianti):
00075             \textcolor{keywordflow}{break}
00076         \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} i\_N > NLevels:
00077             \textcolor{keywordflow}{break}
00078         
00079         term = remove\_stars(E[\textcolor{stringliteral}{'term'}])
00080 
00081         c1 = remove\_stars(E[\textcolor{stringliteral}{'conf'}])
00082         
00083         c12 = remove\_par(c1)
00084         c123 = change\_2pto1p(c12)
00085         c124 = change\_2pto0p(c12)
00086         
00087         c15 = remove\_point\_before\_par(c1) 
00088         
00089         c16 = remove\_before\_firstp(c1)
00090         c126 = remove\_before\_firstp(c12)
00091         c1236 = remove\_before\_firstp(c123)
00092         c1246 = remove\_before\_firstp(c124)
00093         c156 = remove\_before\_firstp(c15)
00094         
00095         c17 = change\_ptpsp(c1)
00096         c127 = change\_ptpsp(c12)
00097         c1237 = change\_ptpsp(c123)
00098         c1247 = change\_ptpsp(c124)
00099         c157 = change\_ptpsp(c15)
00100         c167 = change\_ptpsp(c16)
00101         c1267 = change\_ptpsp(c126)
00102         c12367 = change\_ptpsp(c1236)
00103         c12467 = change\_ptpsp(c1246)
00104         c1567 = change\_ptpsp(c156)
00105        
00106         confs = (c1, c12, c123, c124, c15, c16, c126, c1236, c1246, c156,
00107                  c17, c127, c1237, c1247, c157, c167, c1267, c12367, c12467, c1567)
00108         \textcolor{keywordflow}{for} conf \textcolor{keywordflow}{in} confs:   
00109             pretty = \textcolor{stringliteral}{'\{0\} \{1\}\{2\}'}.format(conf, term, E[\textcolor{stringliteral}{'J'}])
00110             i\_Ch = np.where(E\_chianti[\textcolor{stringliteral}{'pretty'}] == pretty)[0]
00111             \textcolor{keywordflow}{if} len(i\_Ch) == 1:
00112                 \textcolor{keywordflow}{if} NLevels \textcolor{keywordflow}{is} \textcolor{keywordflow}{not} \textcolor{keywordtype}{None} \textcolor{keywordflow}{and} i\_Ch[0] <= NLevels:
00113                     Chianti2NIST[i\_N] = i\_Ch[0]
00114     \textcolor{keywordflow}{if} len(Chianti2NIST) == 0:
00115         Chianti2NIST = \textcolor{keywordtype}{None}
00116         
00117         \textcolor{comment}{### Il faut que ni i\_N ni i\_Ch depasse NLvels. Et il faut que NLevels soit diminue dansla cas
       contraire.}
00118     \textcolor{keywordflow}{return} Chianti2NIST
        
\end{DoxyCode}
