\hypertarget{unit_test_8py}{\section{unit\-Test.\-py}
\label{unit_test_8py}\index{pyneb/test/unit\-Test.\-py@{pyneb/test/unit\-Test.\-py}}
}

\begin{DoxyCode}
\hypertarget{unit_test_8py_source_l00001}{}\hyperlink{namespacepyneb_1_1test_1_1unit_test}{00001} \textcolor{keyword}{import} unittest
00002 \textcolor{keyword}{import} pyneb \textcolor{keyword}{as} pn
00003 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np
00004 
\hypertarget{unit_test_8py_source_l00005}{}\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{00005} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(calculated, expected):
00006         \textcolor{keywordflow}{return} (abs((expected - calculated) * 1.0) / (expected * 1.0))
00007 
\hypertarget{unit_test_8py_source_l00008}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test}{00008} \textcolor{keyword}{class }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test}{UnitTest}(unittest.TestCase):
00009 
\hypertarget{unit_test_8py_source_l00010}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a3537bc36150d7be4c29ce457d7516056}{00010}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a3537bc36150d7be4c29ce457d7516056}{getTransitions} (self):
00011                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 3)
00012                 tran01 = atom.getTransition(4363)
00013                 tran02 = atom.getTransition(4959)
00014                 tran03 = atom.getTransition(5010)
00015                 \textcolor{keywordflow}{print} tran01, tran02, tran03
00016 
\hypertarget{unit_test_8py_source_l00017}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_ac77797fa5bbeb259cf0c9e29ea02cf0b}{00017}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_ac77797fa5bbeb259cf0c9e29ea02cf0b}{testInit}(self):
00018                 atomO2 = pn.Atom(\textcolor{stringliteral}{"O"}, 2)
00019                 \textcolor{keyword}{assert} (atomO2.elem == \textcolor{stringliteral}{"O"})
00020                 \textcolor{keyword}{assert} (atomO2.spec == 2)
00021                 \textcolor{keyword}{assert} (atomO2.atom == \textcolor{stringliteral}{"O2"})
00022 
\hypertarget{unit_test_8py_source_l00023}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_aaf8316a5619d701aaae56fdd26dd167b}{00023}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_aaf8316a5619d701aaae56fdd26dd167b}{testEmissivity}(self, error=5e-2):
00024                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 3)
00025 
00026                 result = atom.getEmissivity(20000, 1e2)
00027                 emi = [9.749E-22, 4.107E-28, 8.131E-22, 1.012E-24, 4.165E-21, 1.204E-20, 1.087E-22, 
00028                         2.906E-25, 3.979E-22, 3.850E-22, 9.559E-22, 5.517E-27]
00029                 a = []
00030                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} result:
00031                         \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} i:
00032                                 \textcolor{keywordflow}{if} (j > 0) :
00033                                         a.append(j)
00034 
00035                 \textcolor{keywordflow}{for} aux \textcolor{keywordflow}{in} range(len(a) - 1):
00036                         result = (a[aux] / emi[aux])
00037                         \textcolor{keyword}{assert} (\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(a[aux], emi[aux]) < error)
00038         
\hypertarget{unit_test_8py_source_l00039}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_ab20c505e3d6c94360bcf1bf5cdd4278d}{00039}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_ab20c505e3d6c94360bcf1bf5cdd4278d}{testEmissivityShape}(self):
00040                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 3)
00041                 result = atom.getEmissivity(20000, 1e2)
00042                 \textcolor{keyword}{assert} (result.shape == (6, 6))
00043                 result = atom.getEmissivity(20000, [1e2, 1e3])
00044                 \textcolor{keyword}{assert} (result.shape == (6, 6, 2))
00045                 result = atom.getEmissivity([20000, 10000], 1e2)
00046                 \textcolor{keyword}{assert} (result.shape == (6, 6, 2))
00047                 result = atom.getEmissivity([20000, 10000], [1e2, 1e3])         
00048                 \textcolor{keyword}{assert} (result.shape == (6, 6, 2, 2))
00049                 result = atom.getEmissivity([20000, 10000], [1e2, 1e3], product = \textcolor{keyword}{True})         
00050                 \textcolor{keyword}{assert} (result.shape == (6, 6, 2, 2))
00051                 result = atom.getEmissivity([20000, 10000], [1e2, 1e3], product = \textcolor{keyword}{False})                
00052                 \textcolor{keyword}{assert} (result \textcolor{keywordflow}{is} \textcolor{keywordtype}{None})
00053                 
00054                 result = atom.getEmissivity(20000, 1e2, wave = 5007)
00055                 \textcolor{keyword}{assert} (result.shape == ())
00056                 result = atom.getEmissivity(20000, [1e2, 1e3], wave = 5007)
00057                 \textcolor{keyword}{assert} (result.shape == (2,))
00058                 result = atom.getEmissivity([20000, 10000], 1e2, wave = 5007)
00059                 \textcolor{keyword}{assert} (result.shape == (2,)) \textcolor{comment}{# the bug I'm looking for}
00060                 result = atom.getEmissivity([20000, 10000], [1e2, 1e3], wave = 5007)            
00061                 \textcolor{keyword}{assert} (result.shape == (2, 2))
00062                 result = atom.getEmissivity([20000, 10000], [1e2, 1e3], product = \textcolor{keyword}{True}, wave = 5007)            
00063                 \textcolor{keyword}{assert} (result.shape == (2, 2))
00064                 
00065 
\hypertarget{unit_test_8py_source_l00066}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a2f991eb62fa070893eacc36ce1879004}{00066}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a2f991eb62fa070893eacc36ce1879004}{testHbEmissivity}(self, max\_error=5e-4):
00067                 H1 = pn.RecAtom(\textcolor{stringliteral}{'H'}, 1)
00068                 tem = np.array([.5, 1, 1.5, 2., 3., 5.]) * 1e4
00069                 den = 1e2
00070                 Hb\_expected = np.array([2.255e-25, 1.258e-25, 8.724e-26, 6.683e-26, 4.560e-26, 2.796e-26])
00071                 Hb\_computed = H1.getEmissivity(tem, den, label=\textcolor{stringliteral}{'4\_2'})
00072                 \textcolor{keywordflow}{for} i \textcolor{keywordflow}{in} range(len(tem)):
00073                         assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(H1.getEmissivity(tem[i], den, label=\textcolor{stringliteral}{'4\_2'}), Hb\_expected[i
      ]) < max\_error)
00074                         assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}((Hb\_computed[i]), Hb\_expected[i]) < max\_error)
00075                 
\hypertarget{unit_test_8py_source_l00076}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a7a316a645d962527433b1e5b4de4f5ce}{00076}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a7a316a645d962527433b1e5b4de4f5ce}{testIonAbundance}(self, max\_error=5e-3):
00077                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 3)
00078                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(10000, 10000, 100, 4, 3), 3.562e-3) < 
      max\_error)
00079                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(10000, 10000, 100, 4, 3), 3.562e-3) < 
      max\_error)
00080                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(10000, 20000, 100, 4, 3), 5.552e-4) < 
      max\_error)
00081                 atom = pn.Atom(\textcolor{stringliteral}{"S"}, 2)
00082                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(200, 20000, 100, 3, 1), 2.202e-6) < 
      max\_error)
00083                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 2)
00084                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(200, 20000, 1000, 3, 1), 1.608e-5) < 
      max\_error)
00085                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 3)
00086                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(10000, 10000, 100, wave=5007), 3.562e-3) < 
      max\_error)
00087                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(10000, 10000, 100, -5, 1, 5007), 3.562e-3) <
       max\_error)
00088                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getIonAbundance(10000, 20000, 100, wave=5007), 5.552e-4) < 
      max\_error)
00089 
\hypertarget{unit_test_8py_source_l00090}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a2aacf1ea25a476599f1e7cf83de571b2}{00090}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a2aacf1ea25a476599f1e7cf83de571b2}{testGetA}(self, max\_error=5e-3):
00091                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 3)
00092                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getA(1, 1) + 1, 1.0) < max\_error)
00093                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getA(2, 1), 2.664e-05) < max\_error)
00094                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getA(3, 1), 3.094e-11) < max\_error)
00095                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getA(4, 1), 1.69e-06) < max\_error)
00096                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getA(3, 2), 9.695e-05) < max\_error)
00097                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getA(4, 2), 0.006995) < max\_error)
00098                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getA(5, 2), 0.2268) < max\_error)
00099 
\hypertarget{unit_test_8py_source_l00100}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a75cb0860a7a06b129a1028ca635eacf6}{00100}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a75cb0860a7a06b129a1028ca635eacf6}{testGetOmega}(self, max\_error=5e-3):
00101                 atom = pn.Atom(\textcolor{stringliteral}{"O"}, 3)
00102                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, 2, 1), 0.543264060967) < max\_error)
00103                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, 3, 1), 0.27035364411) < max\_error)
00104                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, 4, 1), 0.25398979945) < max\_error)
00105                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, 5, 1), 0.0325890388813) < max\_error)
00106                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, 3, 2), 1.28634364203) < max\_error)
00107                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, 4, 2), 0.761941062781) < max\_error)
00108                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, 5, 2), 0.0977670995235) < max\_error)
00109                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getOmega(10000, wave=5007), 1.2698350039427169) < max\_error)
00110                 
\hypertarget{unit_test_8py_source_l00111}{}\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a8340dae4a77382c9c82c1ce67209d47a}{00111}         \textcolor{keyword}{def }\hyperlink{classpyneb_1_1test_1_1unit_test_1_1_unit_test_a8340dae4a77382c9c82c1ce67209d47a}{testGetTemDen}(self, max\_error=5e-3):
00112                 atom = pn.Atom(\textcolor{stringliteral}{'O'}, 3)
00113                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getTemDen(100., den=10000., wave1=5007, wave2=4363), 11444.2
      ) < max\_error)
00114                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getTemDen(1., tem=10000., wave1=88e4, wave2=52e4), 174.379) 
      < max\_error)
00115                 atom = pn.Atom(\textcolor{stringliteral}{'O'}, 2)
00116                 assert(\hyperlink{namespacepyneb_1_1test_1_1unit_test_a3c7e23eb1c34daaa75eec988c96dc7b9}{rel\_error}(atom.getTemDen(1.5, tem=10000., wave1=3726, wave2=3729), 1095.59)
       < max\_error)
00117 
00118 
00119 \textcolor{keywordflow}{if} \_\_name\_\_ == \textcolor{stringliteral}{'\_\_main\_\_'}:
00120 
00121         unittest.main()
\end{DoxyCode}
