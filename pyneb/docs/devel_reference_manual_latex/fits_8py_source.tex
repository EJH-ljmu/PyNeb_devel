\hypertarget{fits_8py}{\section{fits.\-py}
\label{fits_8py}\index{pyneb/utils/fits.\-py@{pyneb/utils/fits.\-py}}
}

\begin{DoxyCode}
\hypertarget{fits_8py_source_l00001}{}\hyperlink{namespacepyneb_1_1utils_1_1fits}{00001} \textcolor{keyword}{import} os, sys
00002 \textcolor{keyword}{import} pyneb \textcolor{keyword}{as} pn
00003 \textcolor{keyword}{import} numpy \textcolor{keyword}{as} np
00004 \textcolor{keyword}{from} \hyperlink{namespacepyneb_1_1utils_1_1misc}{pyneb.utils.misc} \textcolor{keyword}{import} int\_to\_roman, roman\_to\_int
00005 \textcolor{keywordflow}{try}:
00006     \textcolor{keyword}{import} pyfits
00007 \textcolor{keywordflow}{except}:
00008     \textcolor{keywordflow}{try}:
00009         \textcolor{keyword}{import} astropy.io.fits \textcolor{keyword}{as} pyfits
00010     \textcolor{keywordflow}{except}:
00011         pn.log\_.error(\textcolor{stringliteral}{'pyfits not installed'})
00012 \textcolor{keyword}{from} physics \textcolor{keyword}{import} sym2name, gsDict
00013 
00014     
\hypertarget{fits_8py_source_l00015}{}\hyperlink{namespacepyneb_1_1utils_1_1fits_a40031d2d7de219b95d7475243b3888eb}{00015} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1fits_a40031d2d7de219b95d7475243b3888eb}{\_updateHeader}(hdu, input\_file, content, elem, spec):
00016     \textcolor{stringliteral}{"""}
00017 \textcolor{stringliteral}{    Update the header of the output fits file}
00018 \textcolor{stringliteral}{}
00019 \textcolor{stringliteral}{    Parameters: }
00020 \textcolor{stringliteral}{        - hdu          pyfits file}
00021 \textcolor{stringliteral}{        - input\_file   name of the ascii files containing the original data}
00022 \textcolor{stringliteral}{        - content      type of physical quantities contained in the file}
00023 \textcolor{stringliteral}{        - elem         symbol of the selected element}
00024 \textcolor{stringliteral}{        - spec         ionization stage in spectroscopic notation (I = 1, II = 2, etc.)}
00025 \textcolor{stringliteral}{        }
00026 \textcolor{stringliteral}{    """}
00027     hdu.header.update(\textcolor{stringliteral}{'ORIGIN'}, \textcolor{stringliteral}{'File \{0\}, PyNeb v\{1\}'}.format(input\_file, pn.\_\_version\_\_))
00028     hdu.header.update(\textcolor{stringliteral}{'CONTENT'}, content)
00029     hdu.header.update(\textcolor{stringliteral}{'ATOM'}, sym2name[elem.capitalize()])
00030     hdu.header.update(\textcolor{stringliteral}{'SPECTRUM'}, \hyperlink{namespacepyneb_1_1utils_1_1misc_ae67dbd6bb48d64216bc162ebdc25a183}{roman\_to\_int}(spec))
00031     atom = elem.capitalize() + str(\hyperlink{namespacepyneb_1_1utils_1_1misc_ae67dbd6bb48d64216bc162ebdc25a183}{roman\_to\_int}(spec))
00032     \textcolor{keywordflow}{for} key \textcolor{keywordflow}{in} gsDict.keys():
00033         \textcolor{keywordflow}{if} (atom \textcolor{keywordflow}{in} gsDict[key]):
00034             gs = key
00035         \textcolor{keywordflow}{else}:
00036             gs = \textcolor{stringliteral}{'unknown'}
00037     hdu.header.update(\textcolor{stringliteral}{'GSCONFIG'}, gs)
00038     
00039 
\hypertarget{fits_8py_source_l00040}{}\hyperlink{namespacepyneb_1_1utils_1_1fits_a8055efc148e2aef26439d0a79a26549b}{00040} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1fits_a8055efc148e2aef26439d0a79a26549b}{writeAtom}(input\_file):
00041     \textcolor{stringliteral}{""" }
00042 \textcolor{stringliteral}{    Write the Es and As read from an ascii file into a fits file in PyNeb format.}
00043 \textcolor{stringliteral}{    The bibliographic references are read from comment lines in the file.}
00044 \textcolor{stringliteral}{        }
00045 \textcolor{stringliteral}{    Parameters:}
00046 \textcolor{stringliteral}{        - input\_file    name of the ascii input file containing the energy levels (in 1/A or eV) and the
       Aij,}
00047 \textcolor{stringliteral}{                        in the format elem\_spec\_atom\_REF-STRING.dat}
00048 \textcolor{stringliteral}{}
00049 \textcolor{stringliteral}{    Example: }
00050 \textcolor{stringliteral}{    writeAtom('o\_iii\_atom\_AB01-CD02-EFG03.dat')}
00051 \textcolor{stringliteral}{}
00052 \textcolor{stringliteral}{    """}
00053     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(input\_file):
00054         pn.log\_.error(\textcolor{stringliteral}{'\{0\} not found.'}.format(input\_file), calling=\textcolor{stringliteral}{'writeAtom'})
00055         sys.exit(0)
00056     data\_type = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[2]
00057     \textcolor{keywordflow}{if} (data\_type != \textcolor{stringliteral}{'atom'}):
00058         pn.log\_.error(\textcolor{stringliteral}{'The name of \{0\} does not conform to the prescribed format.'}.format(input\_file), 
      calling=\textcolor{stringliteral}{'writeAtom'})
00059         sys.exit(0)
00060     elem = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[0]
00061     spec = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[1]
00062     ref = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[-1]
00063     out\_fits = \textcolor{stringliteral}{'\{0\}\_\{1\}\_\{2\}\_\{3\}.fits'}.format(elem.lower(), spec.lower(), data\_type, ref)
00064     atom\_dat = []
00065 
00066     \textcolor{comment}{# Read data from ascii file}
00067     \textcolor{comment}{#}
00068     \textcolor{comment}{# Read energies and stat weights }
00069     f = open(input\_file)
00070     units = f.readlines()[1].split()[0]
00071     all\_data = np.genfromtxt(input\_file, comments=\textcolor{stringliteral}{'***'}, skip\_header=2, unpack=\textcolor{keyword}{True})
00072     \textcolor{comment}{# Read Es}
00073     energy = all\_data[0, :]
00074     NLevels = len(energy)
00075     \textcolor{keywordflow}{if} units[0] \textcolor{keywordflow}{is} \textcolor{stringliteral}{'eV'}: 
00076         energy = energy / (pn.CST.RYD\_EV * pn.CST.RYD\_ANG)
00077     \textcolor{comment}{# Read statistical weights}
00078     stat\_weight = all\_data[1, :]
00079     atom\_dat.append(pyfits.Column(name=\textcolor{stringliteral}{'Energy'}, format=\textcolor{stringliteral}{'1D'}, unit=\textcolor{stringliteral}{'1/Ang'}, array=energy))
00080     atom\_dat.append(pyfits.Column(name=\textcolor{stringliteral}{'Stat\_Weight'}, format=\textcolor{stringliteral}{'1J'}, unit=\textcolor{stringliteral}{'none'}, array=stat\_weight))    
00081     \textcolor{comment}{# Read As}
00082     \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} np.arange(NLevels - 1):
00083         lev\_j = j + 1
00084         fieldName = \textcolor{stringliteral}{'A(*->\{0\})'}.format(lev\_j)
00085         atom\_dat.append(pyfits.Column(name=fieldName, format=\textcolor{stringliteral}{'1D'}, unit=\textcolor{stringliteral}{'1/sec'}, array=all\_data[1 + lev\_j, 
      :]))
00086 
00087     \textcolor{comment}{# Create fits file and start adding info to the header}
00088     atom\_hdu = pyfits.new\_table(atom\_dat)   
00089             
00090     \textcolor{comment}{# Primary header (extension 0)}
00091     hdu = pyfits.PrimaryHDU()
00092     hdu.header.update(\textcolor{stringliteral}{'FILENAME'}, out\_fits)
00093     hdu.header.update(\textcolor{stringliteral}{'NEXTEND'}, 1)
00094  
00095     \textcolor{comment}{# Write references in the header}
00096     refs = []
00097     \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} open(input\_file):
00098         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'***'} \textcolor{keywordflow}{in} line:
00099             text = line.strip(\textcolor{stringliteral}{"***"}).split(\textcolor{stringliteral}{"'"})
00100             \textcolor{keywordflow}{if} (\textcolor{stringliteral}{'SOURCE'} \textcolor{keywordflow}{in} text[0]) \textcolor{keywordflow}{or} (\textcolor{stringliteral}{'NOTE'} \textcolor{keywordflow}{in} text[0]):
00101                 refs.append((text[0], text[1]))
00102 
00103     \hyperlink{namespacepyneb_1_1utils_1_1fits_a40031d2d7de219b95d7475243b3888eb}{\_updateHeader}(atom\_hdu, input\_file, \textcolor{stringliteral}{'Energy levels and transition probabilities'}, elem, 
      spec)
00104     \hyperlink{namespacepyneb_1_1utils_1_1fits_a40031d2d7de219b95d7475243b3888eb}{\_updateHeader}(hdu, input\_file, \textcolor{stringliteral}{'Energy levels and transition probabilities'}, elem, spec)
00105     atom\_hdu.header.update(\textcolor{stringliteral}{'N\_LEVELS'}, NLevels)
00106     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} refs:
00107         atom\_hdu.header.update(item[0], item[1])
00108 
00109     hdulist = pyfits.HDUList([hdu])
00110     hdulist.append(atom\_hdu)
00111     hdulist.writeto(out\_fits, clobber=\textcolor{keyword}{True})
00112 
00113 
\hypertarget{fits_8py_source_l00114}{}\hyperlink{namespacepyneb_1_1utils_1_1fits_a468ecdfaa21de61a1037128ee889fd76}{00114} \textcolor{keyword}{def }\hyperlink{namespacepyneb_1_1utils_1_1fits_a468ecdfaa21de61a1037128ee889fd76}{writeColl}(input\_file, temp\_in\_cols = True, chebOrder = None):
00115     \textcolor{stringliteral}{""" }
00116 \textcolor{stringliteral}{    Write the Omegas read from an ascii file into a fits file in PyNeb format.}
00117 \textcolor{stringliteral}{    The bibliographic references are read from comment lines in the file.}
00118 \textcolor{stringliteral}{        }
00119 \textcolor{stringliteral}{    Parameters:}
00120 \textcolor{stringliteral}{        - input\_file    name of the ascii input file containing the Omegas,}
00121 \textcolor{stringliteral}{                        in the format elem\_spec\_coll\_REF-STRING.dat}
00122 \textcolor{stringliteral}{        - temp\_in\_cols  If True, each column of the input file corresponds to a given Te, }
00123 \textcolor{stringliteral}{                         otherwise each rows corresponds to a given Te (a transposition is }
00124 \textcolor{stringliteral}{                         thus applied to the data)}
00125 \textcolor{stringliteral}{    Example: }
00126 \textcolor{stringliteral}{    writeColl('o\_iii\_coll\_AB01-CD02-EFG03.dat')}
00127 \textcolor{stringliteral}{}
00128 \textcolor{stringliteral}{    """}
00129     \textcolor{keyword}{def }\_omegaArray(lev\_j, lev\_i):
00130         \textcolor{stringliteral}{"""}
00131 \textcolor{stringliteral}{        Return the array of collision strength values for given levels}
00132 \textcolor{stringliteral}{ }
00133 \textcolor{stringliteral}{        """}       
00134         ij = (cs[:, 0] == lev\_j) & (cs[:, 1] == lev\_i)
00135         \textcolor{keywordflow}{if} ij.sum() == 0.:
00136             \textcolor{keywordflow}{return} np.zeros(n\_temp)
00137         \textcolor{keywordflow}{else}:
00138             \textcolor{keywordflow}{return} cs[ij, 2::].reshape(n\_temp)
00139 
00140     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} os.path.exists(input\_file):
00141         pn.log\_.error(\textcolor{stringliteral}{'\{0\} not found.'}.format(input\_file), calling=\textcolor{stringliteral}{'writeColl'})
00142         sys.exit(0)
00143     data\_type = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[2]
00144     \textcolor{keywordflow}{if} (data\_type != \textcolor{stringliteral}{'coll'}):
00145         pn.log\_.error(\textcolor{stringliteral}{'The name of \{0\} does not conform to the prescribed format.'}.format(input\_file), 
      calling=\textcolor{stringliteral}{'writeColl'})
00146         sys.exit(0)
00147     elem = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[0]
00148     spec = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[1]
00149     ref = input\_file.split(\textcolor{stringliteral}{"."})[0].split(\textcolor{stringliteral}{"\_"})[-1]
00150     out\_fits = \textcolor{stringliteral}{'\{0\}\_\{1\}\_\{2\}\_\{3\}.fits'}.format(elem.lower(), spec.lower(), data\_type, ref)
00151     coll\_dat = []
00152 
00153     \textcolor{comment}{# Read Omegas}
00154     cs = np.genfromtxt(input\_file, comments=\textcolor{stringliteral}{'***'})
00155     \textcolor{keywordflow}{if} \textcolor{keywordflow}{not} temp\_in\_cols:
00156         cs = cs.transpose()
00157     n\_temp = np.size(cs[0]) - 2
00158     temArray = cs[0, 2::]
00159     NLevels = int(np.max(cs[:, 1]))
00160     \textcolor{keywordflow}{if} chebOrder \textcolor{keywordflow}{is} \textcolor{keywordtype}{None}:
00161         chebOrder = n\_temp
00162     coll\_dat.append(pyfits.Column(name=\textcolor{stringliteral}{'Te'}, format=\textcolor{stringliteral}{'1E'}, unit=\textcolor{stringliteral}{'log(K)'}, array=temArray)) \textcolor{comment}{# Change if
       linear T used (see below)}
00163     \textcolor{keywordflow}{for} j \textcolor{keywordflow}{in} np.arange(NLevels - 1):
00164         lev\_j = j + 1
00165         lev\_i = lev\_j + 1
00166         \textcolor{keywordflow}{while} (lev\_i < NLevels + 1):
00167             fieldName = \textcolor{stringliteral}{'Omega(\{0\}->\{1\})'}.format(int(lev\_i), int(lev\_j))
00168             omegaArray = \_omegaArray(lev\_j, lev\_i)
00169             coll\_dat.append(pyfits.Column(name=fieldName, format=\textcolor{stringliteral}{'1E'}, unit=chebOrder, array=omegaArray))
00170             lev\_i += 1
00171     coll\_hdu = pyfits.new\_table(coll\_dat)        
00172             
00173     \textcolor{comment}{# Primary header (extension 0)}
00174     hdu = pyfits.PrimaryHDU()
00175     hdu.header.update(\textcolor{stringliteral}{'FILENAME'}, out\_fits)
00176     hdu.header.update(\textcolor{stringliteral}{'NEXTEND'}, 1)
00177  
00178     \textcolor{comment}{# Write references in the header}
00179     refs = []
00180     \textcolor{keywordflow}{for} line \textcolor{keywordflow}{in} open(input\_file):
00181         \textcolor{keywordflow}{if} \textcolor{stringliteral}{'***'} \textcolor{keywordflow}{in} line:
00182             text = line.strip(\textcolor{stringliteral}{"***"}).split(\textcolor{stringliteral}{"'"})
00183             \textcolor{keywordflow}{if} (\textcolor{stringliteral}{'SOURCE'} \textcolor{keywordflow}{in} text[0]) \textcolor{keywordflow}{or} (\textcolor{stringliteral}{'NOTE'} \textcolor{keywordflow}{in} text[0]):
00184                 refs.append((text[0], text[1]))
00185 
00186     \hyperlink{namespacepyneb_1_1utils_1_1fits_a40031d2d7de219b95d7475243b3888eb}{\_updateHeader}(coll\_hdu, input\_file, \textcolor{stringliteral}{'Collision strengths'}, elem, spec)
00187     \hyperlink{namespacepyneb_1_1utils_1_1fits_a40031d2d7de219b95d7475243b3888eb}{\_updateHeader}(hdu, input\_file, \textcolor{stringliteral}{'Collision strengths'}, elem, spec)
00188     coll\_hdu.header.update(\textcolor{stringliteral}{'N\_LEVELS'}, NLevels)
00189     \textcolor{keywordflow}{for} item \textcolor{keywordflow}{in} refs:
00190         coll\_hdu.header.update(item[0], item[1])
00191 
00192     hdulist = pyfits.HDUList([hdu])
00193     hdulist.append(coll\_hdu)
00194     hdulist.writeto(out\_fits, clobber=\textcolor{keyword}{True})
00195 
00196 
\hypertarget{fits_8py_source_l00197}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr}{00197} \textcolor{keyword}{class }\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr}{Hdr}(object):
00198     \textcolor{stringliteral}{"""}
00199 \textcolor{stringliteral}{    Explore and update headers of fits files}
00200 \textcolor{stringliteral}{    }
00201 \textcolor{stringliteral}{    Parameters:}
00202 \textcolor{stringliteral}{        - fitsFile  name of the fits file}
00203 \textcolor{stringliteral}{        - ext       file extension}
00204 \textcolor{stringliteral}{    }
00205 \textcolor{stringliteral}{    Examples:}
00206 \textcolor{stringliteral}{        f=hdr('o\_iii.fits', 2)}
00207 \textcolor{stringliteral}{        f.show()}
00208 \textcolor{stringliteral}{        f.up('ATOM', 'kriptonyte')}
00209 \textcolor{stringliteral}{        f.up('NATURE', 'invented')}
00210 \textcolor{stringliteral}{        f.save}
00211 \textcolor{stringliteral}{        }
00212 \textcolor{stringliteral}{    """}    
\hypertarget{fits_8py_source_l00213}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a154b37ae24e96d14ffff5e878fbb1760}{00213}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a154b37ae24e96d14ffff5e878fbb1760}{\_\_init\_\_}(self, fitsFile, ext):
\hypertarget{fits_8py_source_l00214}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a7c4dc491907edb52649262563df2e23c}{00214}         self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a7c4dc491907edb52649262563df2e23c}{fitsFile} = fitsFile
\hypertarget{fits_8py_source_l00215}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a23de98701ac30e7c56654f92d9956fca}{00215}         self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a23de98701ac30e7c56654f92d9956fca}{hdu} = pyfits.open(fitsFile, ignore\_missing\_end=\textcolor{keyword}{True})
\hypertarget{fits_8py_source_l00216}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a1c2f102effab05a497e3a21ed3291359}{00216}         self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a1c2f102effab05a497e3a21ed3291359}{ext} = ext
00217     
00218 
\hypertarget{fits_8py_source_l00219}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a956d2cda7ca4e515f4a5dfaf0f6c465a}{00219}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a956d2cda7ca4e515f4a5dfaf0f6c465a}{show}(self):
00220         \textcolor{keywordflow}{print} self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a23de98701ac30e7c56654f92d9956fca}{hdu}[self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a1c2f102effab05a497e3a21ed3291359}{ext}].header
00221     
00222 
\hypertarget{fits_8py_source_l00223}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a52ee04bb03279ed65bbd5412154d08e2}{00223}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a52ee04bb03279ed65bbd5412154d08e2}{up}(self, key, value):
00224         \textcolor{stringliteral}{""" This will be changed to header.set at some point"""}
00225         self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a23de98701ac30e7c56654f92d9956fca}{hdu}[self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a1c2f102effab05a497e3a21ed3291359}{ext}].header.update(key, value)
00226         
00227 
\hypertarget{fits_8py_source_l00228}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_adffa3ce71f4ab2b1f0428a9fa6fee117}{00228}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_adffa3ce71f4ab2b1f0428a9fa6fee117}{delete}(self, key):
00229         del self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a23de98701ac30e7c56654f92d9956fca}{hdu}[self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a1c2f102effab05a497e3a21ed3291359}{ext}].header[key]
00230 
00231 
\hypertarget{fits_8py_source_l00232}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_ae3914322f5f8fa906d003987bb4dfb9a}{00232}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_ae3914322f5f8fa906d003987bb4dfb9a}{cheb}(self, orderFile):    
00233         \textcolor{stringliteral}{""" }
00234 \textcolor{stringliteral}{        Update the Chebyshev order of a coll fits file.}
00235 \textcolor{stringliteral}{        }
00236 \textcolor{stringliteral}{        Parameters:}
00237 \textcolor{stringliteral}{            - orderFile    ascii file with upper level, lower level, order}
00238 \textcolor{stringliteral}{        }
00239 \textcolor{stringliteral}{        """}    
00240         j\_order, i\_order, order = np.genfromtxt(orderFile, comments=\textcolor{stringliteral}{'***'}, usecols=(0, 1, 2), unpack=\textcolor{keyword}{True}) 
         
00241         NLevels = np.max(j\_order)
00242         order\_array = np.zeros([NLevels, NLevels])
00243         \textcolor{keywordflow}{for} index \textcolor{keywordflow}{in} range(len(j\_order)):
00244             order\_array[int(j\_order[index] - 1), int(i\_order[index] - 1)] = int(order[index])
00245             
00246         \textcolor{comment}{# Iterate over the keys to associate each unit with its Omega(*->*) field}
00247         \textcolor{keywordflow}{for} key \textcolor{keywordflow}{in} self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a23de98701ac30e7c56654f92d9956fca}{hdu}[self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a1c2f102effab05a497e3a21ed3291359}{ext}].header.keys():
00248             \textcolor{keywordflow}{if} \textcolor{stringliteral}{'TTYPE'} \textcolor{keywordflow}{in} key:
00249                 num = key.strip(\textcolor{stringliteral}{'TTYPE'})
00250                 unit = \textcolor{stringliteral}{'TUNIT'} + num
00251                 field\_name = self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a23de98701ac30e7c56654f92d9956fca}{hdu}[self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a1c2f102effab05a497e3a21ed3291359}{ext}].header[key]
00252                 \textcolor{comment}{# The try is to skip the Te field}
00253                 \textcolor{keywordflow}{try}:
00254                     lev\_j = field\_name.split(\textcolor{stringliteral}{'->'})[0].split(\textcolor{stringliteral}{'Omega('})[1]
00255                     lev\_i = field\_name.split(\textcolor{stringliteral}{'->'})[1].split(\textcolor{stringliteral}{')'})[0]
00256                     j = int(lev\_j) - 1
00257                     i = int(lev\_i) - 1
00258                     self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a52ee04bb03279ed65bbd5412154d08e2}{up}(unit, order\_array[j, i])
00259                 \textcolor{keywordflow}{except}:
00260                     \textcolor{keywordflow}{pass}
00261 
00262 
\hypertarget{fits_8py_source_l00263}{}\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a81eb3b4cdfcc302e40f447eb399a60e1}{00263}     \textcolor{keyword}{def }\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a81eb3b4cdfcc302e40f447eb399a60e1}{save}(self):
00264         self.hdu.writeto(self.\hyperlink{classpyneb_1_1utils_1_1fits_1_1_hdr_a7c4dc491907edb52649262563df2e23c}{fitsFile}, clobber=\textcolor{keyword}{True})
00265 
00266 \textcolor{comment}{# Test}
00267 \textcolor{comment}{# writeAtom('o\_ii\_atom\_TEST.dat')}
00268 \textcolor{comment}{# writeColl('o\_ii\_coll\_TEST.dat')}
\end{DoxyCode}
